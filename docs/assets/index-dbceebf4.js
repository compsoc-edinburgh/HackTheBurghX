var aD=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var Ij=aD((Oj,T0)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var Rm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function t0(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function wR(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),t}var AR={exports:{}},n0={},MR={exports:{}},Dt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nf=Symbol.for("react.element"),lD=Symbol.for("react.portal"),uD=Symbol.for("react.fragment"),cD=Symbol.for("react.strict_mode"),hD=Symbol.for("react.profiler"),dD=Symbol.for("react.provider"),fD=Symbol.for("react.context"),pD=Symbol.for("react.forward_ref"),mD=Symbol.for("react.suspense"),gD=Symbol.for("react.memo"),_D=Symbol.for("react.lazy"),yb=Symbol.iterator;function vD(n){return n===null||typeof n!="object"?null:(n=yb&&n[yb]||n["@@iterator"],typeof n=="function"?n:null)}var CR={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},RR=Object.assign,PR={};function qc(n,e,t){this.props=n,this.context=e,this.refs=PR,this.updater=t||CR}qc.prototype.isReactComponent={};qc.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};qc.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function IR(){}IR.prototype=qc.prototype;function lS(n,e,t){this.props=n,this.context=e,this.refs=PR,this.updater=t||CR}var uS=lS.prototype=new IR;uS.constructor=lS;RR(uS,qc.prototype);uS.isPureReactComponent=!0;var xb=Array.isArray,LR=Object.prototype.hasOwnProperty,cS={current:null},DR={key:!0,ref:!0,__self:!0,__source:!0};function NR(n,e,t){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)LR.call(e,i)&&!DR.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:nf,type:n,key:s,ref:o,props:r,_owner:cS.current}}function yD(n,e){return{$$typeof:nf,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function hS(n){return typeof n=="object"&&n!==null&&n.$$typeof===nf}function xD(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Sb=/\/+/g;function K_(n,e){return typeof n=="object"&&n!==null&&n.key!=null?xD(""+n.key):e.toString(36)}function Pm(n,e,t,i,r){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case nf:case lD:o=!0}}if(o)return o=n,r=r(o),n=i===""?"."+K_(o,0):i,xb(r)?(t="",n!=null&&(t=n.replace(Sb,"$&/")+"/"),Pm(r,e,t,"",function(u){return u})):r!=null&&(hS(r)&&(r=yD(r,t+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(Sb,"$&/")+"/")+n)),e.push(r)),1;if(o=0,i=i===""?".":i+":",xb(n))for(var a=0;a<n.length;a++){s=n[a];var l=i+K_(s,a);o+=Pm(s,e,t,l,r)}else if(l=vD(n),typeof l=="function")for(n=l.call(n),a=0;!(s=n.next()).done;)s=s.value,l=i+K_(s,a++),o+=Pm(s,e,t,l,r);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function sp(n,e,t){if(n==null)return n;var i=[],r=0;return Pm(n,i,"","",function(s){return e.call(t,s,r++)}),i}function SD(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Bi={current:null},Im={transition:null},ED={ReactCurrentDispatcher:Bi,ReactCurrentBatchConfig:Im,ReactCurrentOwner:cS};Dt.Children={map:sp,forEach:function(n,e,t){sp(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return sp(n,function(){e++}),e},toArray:function(n){return sp(n,function(e){return e})||[]},only:function(n){if(!hS(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Dt.Component=qc;Dt.Fragment=uD;Dt.Profiler=hD;Dt.PureComponent=lS;Dt.StrictMode=cD;Dt.Suspense=mD;Dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ED;Dt.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=RR({},n.props),r=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=cS.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)LR.call(e,l)&&!DR.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:nf,type:n.type,key:r,ref:s,props:i,_owner:o}};Dt.createContext=function(n){return n={$$typeof:fD,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:dD,_context:n},n.Consumer=n};Dt.createElement=NR;Dt.createFactory=function(n){var e=NR.bind(null,n);return e.type=n,e};Dt.createRef=function(){return{current:null}};Dt.forwardRef=function(n){return{$$typeof:pD,render:n}};Dt.isValidElement=hS;Dt.lazy=function(n){return{$$typeof:_D,_payload:{_status:-1,_result:n},_init:SD}};Dt.memo=function(n,e){return{$$typeof:gD,type:n,compare:e===void 0?null:e}};Dt.startTransition=function(n){var e=Im.transition;Im.transition={};try{n()}finally{Im.transition=e}};Dt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Dt.useCallback=function(n,e){return Bi.current.useCallback(n,e)};Dt.useContext=function(n){return Bi.current.useContext(n)};Dt.useDebugValue=function(){};Dt.useDeferredValue=function(n){return Bi.current.useDeferredValue(n)};Dt.useEffect=function(n,e){return Bi.current.useEffect(n,e)};Dt.useId=function(){return Bi.current.useId()};Dt.useImperativeHandle=function(n,e,t){return Bi.current.useImperativeHandle(n,e,t)};Dt.useInsertionEffect=function(n,e){return Bi.current.useInsertionEffect(n,e)};Dt.useLayoutEffect=function(n,e){return Bi.current.useLayoutEffect(n,e)};Dt.useMemo=function(n,e){return Bi.current.useMemo(n,e)};Dt.useReducer=function(n,e,t){return Bi.current.useReducer(n,e,t)};Dt.useRef=function(n){return Bi.current.useRef(n)};Dt.useState=function(n){return Bi.current.useState(n)};Dt.useSyncExternalStore=function(n,e,t){return Bi.current.useSyncExternalStore(n,e,t)};Dt.useTransition=function(){return Bi.current.useTransition()};Dt.version="18.2.0";MR.exports=Dt;var ge=MR.exports;const Bs=t0(ge);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TD=ge,bD=Symbol.for("react.element"),wD=Symbol.for("react.fragment"),AD=Object.prototype.hasOwnProperty,MD=TD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,CD={key:!0,ref:!0,__self:!0,__source:!0};function UR(n,e,t){var i,r={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)AD.call(e,i)&&!CD.hasOwnProperty(i)&&(r[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:bD,type:n,key:s,ref:o,props:r,_owner:MD.current}}n0.Fragment=wD;n0.jsx=UR;n0.jsxs=UR;AR.exports=n0;var dS=AR.exports;const ad=dS.Fragment,me=dS.jsx,sn=dS.jsxs;var Qy={},FR={exports:{}},dr={},OR={exports:{}},BR={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(O,H){var B=O.length;O.push(H);e:for(;0<B;){var G=B-1>>>1,ne=O[G];if(0<r(ne,H))O[G]=H,O[B]=ne,B=G;else break e}}function t(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var H=O[0],B=O.pop();if(B!==H){O[0]=B;e:for(var G=0,ne=O.length,ee=ne>>>1;G<ee;){var ie=2*(G+1)-1,pe=O[ie],ve=ie+1,Me=O[ve];if(0>r(pe,B))ve<ne&&0>r(Me,pe)?(O[G]=Me,O[ve]=B,G=ve):(O[G]=pe,O[ie]=B,G=ie);else if(ve<ne&&0>r(Me,B))O[G]=Me,O[ve]=B,G=ve;else break e}}return H}function r(O,H){var B=O.sortIndex-H.sortIndex;return B!==0?B:O.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,f=null,p=3,m=!1,v=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(O){for(var H=t(u);H!==null;){if(H.callback===null)i(u);else if(H.startTime<=O)i(u),H.sortIndex=H.expirationTime,e(l,H);else break;H=t(u)}}function w(O){if(x=!1,S(O),!v)if(t(l)!==null)v=!0,Z(M);else{var H=t(u);H!==null&&$(w,H.startTime-O)}}function M(O,H){v=!1,x&&(x=!1,g(N),N=-1),m=!0;var B=p;try{for(S(H),f=t(l);f!==null&&(!(f.expirationTime>H)||O&&!Q());){var G=f.callback;if(typeof G=="function"){f.callback=null,p=f.priorityLevel;var ne=G(f.expirationTime<=H);H=n.unstable_now(),typeof ne=="function"?f.callback=ne:f===t(l)&&i(l),S(H)}else i(l);f=t(l)}if(f!==null)var ee=!0;else{var ie=t(u);ie!==null&&$(w,ie.startTime-H),ee=!1}return ee}finally{f=null,p=B,m=!1}}var R=!1,P=null,N=-1,C=5,L=-1;function Q(){return!(n.unstable_now()-L<C)}function W(){if(P!==null){var O=n.unstable_now();L=O;var H=!0;try{H=P(!0,O)}finally{H?z():(R=!1,P=null)}}else R=!1}var z;if(typeof T=="function")z=function(){T(W)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,X=F.port2;F.port1.onmessage=W,z=function(){X.postMessage(null)}}else z=function(){y(W,0)};function Z(O){P=O,R||(R=!0,z())}function $(O,H){N=y(function(){O(n.unstable_now())},H)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(O){O.callback=null},n.unstable_continueExecution=function(){v||m||(v=!0,Z(M))},n.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<O?Math.floor(1e3/O):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(O){switch(p){case 1:case 2:case 3:var H=3;break;default:H=p}var B=p;p=H;try{return O()}finally{p=B}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(O,H){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var B=p;p=O;try{return H()}finally{p=B}},n.unstable_scheduleCallback=function(O,H,B){var G=n.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?G+B:G):B=G,O){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=B+ne,O={id:d++,callback:H,priorityLevel:O,startTime:B,expirationTime:ne,sortIndex:-1},B>G?(O.sortIndex=B,e(u,O),t(l)===null&&O===t(u)&&(x?(g(N),N=-1):x=!0,$(w,B-G))):(O.sortIndex=ne,e(l,O),v||m||(v=!0,Z(M))),O},n.unstable_shouldYield=Q,n.unstable_wrapCallback=function(O){var H=p;return function(){var B=p;p=H;try{return O.apply(this,arguments)}finally{p=B}}}})(BR);OR.exports=BR;var RD=OR.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kR=ge,cr=RD;function xe(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zR=new Set,Cd={};function ql(n,e){Cc(n,e),Cc(n+"Capture",e)}function Cc(n,e){for(Cd[n]=e,n=0;n<e.length;n++)zR.add(e[n])}var Po=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jy=Object.prototype.hasOwnProperty,PD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Eb={},Tb={};function ID(n){return Jy.call(Tb,n)?!0:Jy.call(Eb,n)?!1:PD.test(n)?Tb[n]=!0:(Eb[n]=!0,!1)}function LD(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function DD(n,e,t,i){if(e===null||typeof e>"u"||LD(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ki(n,e,t,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var pi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){pi[n]=new ki(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];pi[e]=new ki(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){pi[n]=new ki(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){pi[n]=new ki(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){pi[n]=new ki(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){pi[n]=new ki(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){pi[n]=new ki(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){pi[n]=new ki(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){pi[n]=new ki(n,5,!1,n.toLowerCase(),null,!1,!1)});var fS=/[\-:]([a-z])/g;function pS(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(fS,pS);pi[e]=new ki(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(fS,pS);pi[e]=new ki(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(fS,pS);pi[e]=new ki(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){pi[n]=new ki(n,1,!1,n.toLowerCase(),null,!1,!1)});pi.xlinkHref=new ki("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){pi[n]=new ki(n,1,!1,n.toLowerCase(),null,!0,!0)});function mS(n,e,t,i){var r=pi.hasOwnProperty(e)?pi[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(DD(e,t,r,i)&&(t=null),i||r===null?ID(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,i=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var Oo=kR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,op=Symbol.for("react.element"),Ku=Symbol.for("react.portal"),Zu=Symbol.for("react.fragment"),gS=Symbol.for("react.strict_mode"),ex=Symbol.for("react.profiler"),GR=Symbol.for("react.provider"),HR=Symbol.for("react.context"),_S=Symbol.for("react.forward_ref"),tx=Symbol.for("react.suspense"),nx=Symbol.for("react.suspense_list"),vS=Symbol.for("react.memo"),sa=Symbol.for("react.lazy"),VR=Symbol.for("react.offscreen"),bb=Symbol.iterator;function wh(n){return n===null||typeof n!="object"?null:(n=bb&&n[bb]||n["@@iterator"],typeof n=="function"?n:null)}var yn=Object.assign,Z_;function $h(n){if(Z_===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Z_=e&&e[1]||""}return`
`+Z_+n}var Q_=!1;function J_(n,e){if(!n||Q_)return"";Q_=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){i=u}n.call(e.prototype)}else{try{throw Error()}catch(u){i=u}n()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{Q_=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?$h(n):""}function ND(n){switch(n.tag){case 5:return $h(n.type);case 16:return $h("Lazy");case 13:return $h("Suspense");case 19:return $h("SuspenseList");case 0:case 2:case 15:return n=J_(n.type,!1),n;case 11:return n=J_(n.type.render,!1),n;case 1:return n=J_(n.type,!0),n;default:return""}}function ix(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Zu:return"Fragment";case Ku:return"Portal";case ex:return"Profiler";case gS:return"StrictMode";case tx:return"Suspense";case nx:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case HR:return(n.displayName||"Context")+".Consumer";case GR:return(n._context.displayName||"Context")+".Provider";case _S:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case vS:return e=n.displayName||null,e!==null?e:ix(n.type)||"Memo";case sa:e=n._payload,n=n._init;try{return ix(n(e))}catch{}}return null}function UD(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ix(e);case 8:return e===gS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ia(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function WR(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function FD(n){var e=WR(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function ap(n){n._valueTracker||(n._valueTracker=FD(n))}function XR(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=WR(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function ng(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function rx(n,e){var t=e.checked;return yn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function wb(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=Ia(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function jR(n,e){e=e.checked,e!=null&&mS(n,"checked",e,!1)}function sx(n,e){jR(n,e);var t=Ia(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?ox(n,e.type,t):e.hasOwnProperty("defaultValue")&&ox(n,e.type,Ia(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Ab(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function ox(n,e,t){(e!=="number"||ng(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Yh=Array.isArray;function dc(n,e,t,i){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&i&&(n[t].defaultSelected=!0)}else{for(t=""+Ia(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,i&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function ax(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(xe(91));return yn({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Mb(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(xe(92));if(Yh(t)){if(1<t.length)throw Error(xe(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Ia(t)}}function $R(n,e){var t=Ia(e.value),i=Ia(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function Cb(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function YR(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lx(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?YR(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var lp,qR=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(lp=lp||document.createElement("div"),lp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=lp.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Rd(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var ld={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},OD=["Webkit","ms","Moz","O"];Object.keys(ld).forEach(function(n){OD.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),ld[e]=ld[n]})});function KR(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||ld.hasOwnProperty(n)&&ld[n]?(""+e).trim():e+"px"}function ZR(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,r=KR(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,r):n[t]=r}}var BD=yn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ux(n,e){if(e){if(BD[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(xe(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(xe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(xe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(xe(62))}}function cx(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hx=null;function yS(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var dx=null,fc=null,pc=null;function Rb(n){if(n=of(n)){if(typeof dx!="function")throw Error(xe(280));var e=n.stateNode;e&&(e=a0(e),dx(n.stateNode,n.type,e))}}function QR(n){fc?pc?pc.push(n):pc=[n]:fc=n}function JR(){if(fc){var n=fc,e=pc;if(pc=fc=null,Rb(n),e)for(n=0;n<e.length;n++)Rb(e[n])}}function e2(n,e){return n(e)}function t2(){}var ev=!1;function n2(n,e,t){if(ev)return n(e,t);ev=!0;try{return e2(n,e,t)}finally{ev=!1,(fc!==null||pc!==null)&&(t2(),JR())}}function Pd(n,e){var t=n.stateNode;if(t===null)return null;var i=a0(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(xe(231,e,typeof t));return t}var fx=!1;if(Po)try{var Ah={};Object.defineProperty(Ah,"passive",{get:function(){fx=!0}}),window.addEventListener("test",Ah,Ah),window.removeEventListener("test",Ah,Ah)}catch{fx=!1}function kD(n,e,t,i,r,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(d){this.onError(d)}}var ud=!1,ig=null,rg=!1,px=null,zD={onError:function(n){ud=!0,ig=n}};function GD(n,e,t,i,r,s,o,a,l){ud=!1,ig=null,kD.apply(zD,arguments)}function HD(n,e,t,i,r,s,o,a,l){if(GD.apply(this,arguments),ud){if(ud){var u=ig;ud=!1,ig=null}else throw Error(xe(198));rg||(rg=!0,px=u)}}function Kl(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function i2(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Pb(n){if(Kl(n)!==n)throw Error(xe(188))}function VD(n){var e=n.alternate;if(!e){if(e=Kl(n),e===null)throw Error(xe(188));return e!==n?null:n}for(var t=n,i=e;;){var r=t.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){t=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===t)return Pb(r),n;if(s===i)return Pb(r),e;s=s.sibling}throw Error(xe(188))}if(t.return!==i.return)t=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===t){o=!0,t=r,i=s;break}if(a===i){o=!0,i=r,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,i=r;break}if(a===i){o=!0,i=s,t=r;break}a=a.sibling}if(!o)throw Error(xe(189))}}if(t.alternate!==i)throw Error(xe(190))}if(t.tag!==3)throw Error(xe(188));return t.stateNode.current===t?n:e}function r2(n){return n=VD(n),n!==null?s2(n):null}function s2(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=s2(n);if(e!==null)return e;n=n.sibling}return null}var o2=cr.unstable_scheduleCallback,Ib=cr.unstable_cancelCallback,WD=cr.unstable_shouldYield,XD=cr.unstable_requestPaint,Rn=cr.unstable_now,jD=cr.unstable_getCurrentPriorityLevel,xS=cr.unstable_ImmediatePriority,a2=cr.unstable_UserBlockingPriority,sg=cr.unstable_NormalPriority,$D=cr.unstable_LowPriority,l2=cr.unstable_IdlePriority,i0=null,ks=null;function YD(n){if(ks&&typeof ks.onCommitFiberRoot=="function")try{ks.onCommitFiberRoot(i0,n,void 0,(n.current.flags&128)===128)}catch{}}var ss=Math.clz32?Math.clz32:ZD,qD=Math.log,KD=Math.LN2;function ZD(n){return n>>>=0,n===0?32:31-(qD(n)/KD|0)|0}var up=64,cp=4194304;function qh(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function og(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,r=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~r;a!==0?i=qh(a):(s&=o,s!==0&&(i=qh(s)))}else o=t&~r,o!==0?i=qh(o):s!==0&&(i=qh(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-ss(e),r=1<<t,i|=n[t],e&=~r;return i}function QD(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function JD(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,r=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-ss(s),a=1<<o,l=r[o];l===-1?(!(a&t)||a&i)&&(r[o]=QD(a,e)):l<=e&&(n.expiredLanes|=a),s&=~a}}function mx(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function u2(){var n=up;return up<<=1,!(up&4194240)&&(up=64),n}function tv(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function rf(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-ss(e),n[e]=t}function eN(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-ss(t),s=1<<r;e[r]=0,i[r]=-1,n[r]=-1,t&=~s}}function SS(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-ss(t),r=1<<i;r&e|n[i]&e&&(n[i]|=e),t&=~r}}var $t=0;function c2(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var h2,ES,d2,f2,p2,gx=!1,hp=[],ya=null,xa=null,Sa=null,Id=new Map,Ld=new Map,ca=[],tN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lb(n,e){switch(n){case"focusin":case"focusout":ya=null;break;case"dragenter":case"dragleave":xa=null;break;case"mouseover":case"mouseout":Sa=null;break;case"pointerover":case"pointerout":Id.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ld.delete(e.pointerId)}}function Mh(n,e,t,i,r,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=of(e),e!==null&&ES(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function nN(n,e,t,i,r){switch(e){case"focusin":return ya=Mh(ya,n,e,t,i,r),!0;case"dragenter":return xa=Mh(xa,n,e,t,i,r),!0;case"mouseover":return Sa=Mh(Sa,n,e,t,i,r),!0;case"pointerover":var s=r.pointerId;return Id.set(s,Mh(Id.get(s)||null,n,e,t,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Ld.set(s,Mh(Ld.get(s)||null,n,e,t,i,r)),!0}return!1}function m2(n){var e=Sl(n.target);if(e!==null){var t=Kl(e);if(t!==null){if(e=t.tag,e===13){if(e=i2(t),e!==null){n.blockedOn=e,p2(n.priority,function(){d2(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Lm(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=_x(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);hx=i,t.target.dispatchEvent(i),hx=null}else return e=of(t),e!==null&&ES(e),n.blockedOn=t,!1;e.shift()}return!0}function Db(n,e,t){Lm(n)&&t.delete(e)}function iN(){gx=!1,ya!==null&&Lm(ya)&&(ya=null),xa!==null&&Lm(xa)&&(xa=null),Sa!==null&&Lm(Sa)&&(Sa=null),Id.forEach(Db),Ld.forEach(Db)}function Ch(n,e){n.blockedOn===e&&(n.blockedOn=null,gx||(gx=!0,cr.unstable_scheduleCallback(cr.unstable_NormalPriority,iN)))}function Dd(n){function e(r){return Ch(r,n)}if(0<hp.length){Ch(hp[0],n);for(var t=1;t<hp.length;t++){var i=hp[t];i.blockedOn===n&&(i.blockedOn=null)}}for(ya!==null&&Ch(ya,n),xa!==null&&Ch(xa,n),Sa!==null&&Ch(Sa,n),Id.forEach(e),Ld.forEach(e),t=0;t<ca.length;t++)i=ca[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<ca.length&&(t=ca[0],t.blockedOn===null);)m2(t),t.blockedOn===null&&ca.shift()}var mc=Oo.ReactCurrentBatchConfig,ag=!0;function rN(n,e,t,i){var r=$t,s=mc.transition;mc.transition=null;try{$t=1,TS(n,e,t,i)}finally{$t=r,mc.transition=s}}function sN(n,e,t,i){var r=$t,s=mc.transition;mc.transition=null;try{$t=4,TS(n,e,t,i)}finally{$t=r,mc.transition=s}}function TS(n,e,t,i){if(ag){var r=_x(n,e,t,i);if(r===null)hv(n,e,i,lg,t),Lb(n,i);else if(nN(r,n,e,t,i))i.stopPropagation();else if(Lb(n,i),e&4&&-1<tN.indexOf(n)){for(;r!==null;){var s=of(r);if(s!==null&&h2(s),s=_x(n,e,t,i),s===null&&hv(n,e,i,lg,t),s===r)break;r=s}r!==null&&i.stopPropagation()}else hv(n,e,i,null,t)}}var lg=null;function _x(n,e,t,i){if(lg=null,n=yS(i),n=Sl(n),n!==null)if(e=Kl(n),e===null)n=null;else if(t=e.tag,t===13){if(n=i2(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return lg=n,null}function g2(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jD()){case xS:return 1;case a2:return 4;case sg:case $D:return 16;case l2:return 536870912;default:return 16}default:return 16}}var fa=null,bS=null,Dm=null;function _2(){if(Dm)return Dm;var n,e=bS,t=e.length,i,r="value"in fa?fa.value:fa.textContent,s=r.length;for(n=0;n<t&&e[n]===r[n];n++);var o=t-n;for(i=1;i<=o&&e[t-i]===r[s-i];i++);return Dm=r.slice(n,1<i?1-i:void 0)}function Nm(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function dp(){return!0}function Nb(){return!1}function fr(n){function e(t,i,r,s,o){this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?dp:Nb,this.isPropagationStopped=Nb,this}return yn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=dp)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=dp)},persist:function(){},isPersistent:dp}),e}var Kc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wS=fr(Kc),sf=yn({},Kc,{view:0,detail:0}),oN=fr(sf),nv,iv,Rh,r0=yn({},sf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:AS,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Rh&&(Rh&&n.type==="mousemove"?(nv=n.screenX-Rh.screenX,iv=n.screenY-Rh.screenY):iv=nv=0,Rh=n),nv)},movementY:function(n){return"movementY"in n?n.movementY:iv}}),Ub=fr(r0),aN=yn({},r0,{dataTransfer:0}),lN=fr(aN),uN=yn({},sf,{relatedTarget:0}),rv=fr(uN),cN=yn({},Kc,{animationName:0,elapsedTime:0,pseudoElement:0}),hN=fr(cN),dN=yn({},Kc,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),fN=fr(dN),pN=yn({},Kc,{data:0}),Fb=fr(pN),mN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_N={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vN(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=_N[n])?!!e[n]:!1}function AS(){return vN}var yN=yn({},sf,{key:function(n){if(n.key){var e=mN[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Nm(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?gN[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:AS,charCode:function(n){return n.type==="keypress"?Nm(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Nm(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),xN=fr(yN),SN=yn({},r0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ob=fr(SN),EN=yn({},sf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:AS}),TN=fr(EN),bN=yn({},Kc,{propertyName:0,elapsedTime:0,pseudoElement:0}),wN=fr(bN),AN=yn({},r0,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),MN=fr(AN),CN=[9,13,27,32],MS=Po&&"CompositionEvent"in window,cd=null;Po&&"documentMode"in document&&(cd=document.documentMode);var RN=Po&&"TextEvent"in window&&!cd,v2=Po&&(!MS||cd&&8<cd&&11>=cd),Bb=String.fromCharCode(32),kb=!1;function y2(n,e){switch(n){case"keyup":return CN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function x2(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Qu=!1;function PN(n,e){switch(n){case"compositionend":return x2(e);case"keypress":return e.which!==32?null:(kb=!0,Bb);case"textInput":return n=e.data,n===Bb&&kb?null:n;default:return null}}function IN(n,e){if(Qu)return n==="compositionend"||!MS&&y2(n,e)?(n=_2(),Dm=bS=fa=null,Qu=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return v2&&e.locale!=="ko"?null:e.data;default:return null}}var LN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zb(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!LN[n.type]:e==="textarea"}function S2(n,e,t,i){QR(i),e=ug(e,"onChange"),0<e.length&&(t=new wS("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var hd=null,Nd=null;function DN(n){L2(n,0)}function s0(n){var e=tc(n);if(XR(e))return n}function NN(n,e){if(n==="change")return e}var E2=!1;if(Po){var sv;if(Po){var ov="oninput"in document;if(!ov){var Gb=document.createElement("div");Gb.setAttribute("oninput","return;"),ov=typeof Gb.oninput=="function"}sv=ov}else sv=!1;E2=sv&&(!document.documentMode||9<document.documentMode)}function Hb(){hd&&(hd.detachEvent("onpropertychange",T2),Nd=hd=null)}function T2(n){if(n.propertyName==="value"&&s0(Nd)){var e=[];S2(e,Nd,n,yS(n)),n2(DN,e)}}function UN(n,e,t){n==="focusin"?(Hb(),hd=e,Nd=t,hd.attachEvent("onpropertychange",T2)):n==="focusout"&&Hb()}function FN(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return s0(Nd)}function ON(n,e){if(n==="click")return s0(e)}function BN(n,e){if(n==="input"||n==="change")return s0(e)}function kN(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var cs=typeof Object.is=="function"?Object.is:kN;function Ud(n,e){if(cs(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var r=t[i];if(!Jy.call(e,r)||!cs(n[r],e[r]))return!1}return!0}function Vb(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Wb(n,e){var t=Vb(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Vb(t)}}function b2(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?b2(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function w2(){for(var n=window,e=ng();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=ng(n.document)}return e}function CS(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function zN(n){var e=w2(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&b2(t.ownerDocument.documentElement,t)){if(i!==null&&CS(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!n.extend&&s>i&&(r=i,i=s,s=r),r=Wb(t,s);var o=Wb(t,i);r&&o&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),s>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var GN=Po&&"documentMode"in document&&11>=document.documentMode,Ju=null,vx=null,dd=null,yx=!1;function Xb(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;yx||Ju==null||Ju!==ng(i)||(i=Ju,"selectionStart"in i&&CS(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),dd&&Ud(dd,i)||(dd=i,i=ug(vx,"onSelect"),0<i.length&&(e=new wS("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=Ju)))}function fp(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var ec={animationend:fp("Animation","AnimationEnd"),animationiteration:fp("Animation","AnimationIteration"),animationstart:fp("Animation","AnimationStart"),transitionend:fp("Transition","TransitionEnd")},av={},A2={};Po&&(A2=document.createElement("div").style,"AnimationEvent"in window||(delete ec.animationend.animation,delete ec.animationiteration.animation,delete ec.animationstart.animation),"TransitionEvent"in window||delete ec.transitionend.transition);function o0(n){if(av[n])return av[n];if(!ec[n])return n;var e=ec[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in A2)return av[n]=e[t];return n}var M2=o0("animationend"),C2=o0("animationiteration"),R2=o0("animationstart"),P2=o0("transitionend"),I2=new Map,jb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oa(n,e){I2.set(n,e),ql(e,[n])}for(var lv=0;lv<jb.length;lv++){var uv=jb[lv],HN=uv.toLowerCase(),VN=uv[0].toUpperCase()+uv.slice(1);Oa(HN,"on"+VN)}Oa(M2,"onAnimationEnd");Oa(C2,"onAnimationIteration");Oa(R2,"onAnimationStart");Oa("dblclick","onDoubleClick");Oa("focusin","onFocus");Oa("focusout","onBlur");Oa(P2,"onTransitionEnd");Cc("onMouseEnter",["mouseout","mouseover"]);Cc("onMouseLeave",["mouseout","mouseover"]);Cc("onPointerEnter",["pointerout","pointerover"]);Cc("onPointerLeave",["pointerout","pointerover"]);ql("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ql("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ql("onBeforeInput",["compositionend","keypress","textInput","paste"]);ql("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ql("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ql("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WN=new Set("cancel close invalid load scroll toggle".split(" ").concat(Kh));function $b(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,HD(i,e,void 0,n),n.currentTarget=null}function L2(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;$b(r,a,u),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;$b(r,a,u),s=l}}}if(rg)throw n=px,rg=!1,px=null,n}function tn(n,e){var t=e[bx];t===void 0&&(t=e[bx]=new Set);var i=n+"__bubble";t.has(i)||(D2(e,n,2,!1),t.add(i))}function cv(n,e,t){var i=0;e&&(i|=4),D2(t,n,i,e)}var pp="_reactListening"+Math.random().toString(36).slice(2);function Fd(n){if(!n[pp]){n[pp]=!0,zR.forEach(function(t){t!=="selectionchange"&&(WN.has(t)||cv(t,!1,n),cv(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[pp]||(e[pp]=!0,cv("selectionchange",!1,e))}}function D2(n,e,t,i){switch(g2(e)){case 1:var r=rN;break;case 4:r=sN;break;default:r=TS}t=r.bind(null,e,t,n),r=void 0,!fx||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function hv(n,e,t,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Sl(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}n2(function(){var u=s,d=yS(t),f=[];e:{var p=I2.get(n);if(p!==void 0){var m=wS,v=n;switch(n){case"keypress":if(Nm(t)===0)break e;case"keydown":case"keyup":m=xN;break;case"focusin":v="focus",m=rv;break;case"focusout":v="blur",m=rv;break;case"beforeblur":case"afterblur":m=rv;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Ub;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=lN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=TN;break;case M2:case C2:case R2:m=hN;break;case P2:m=wN;break;case"scroll":m=oN;break;case"wheel":m=MN;break;case"copy":case"cut":case"paste":m=fN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Ob}var x=(e&4)!==0,y=!x&&n==="scroll",g=x?p!==null?p+"Capture":null:p;x=[];for(var T=u,S;T!==null;){S=T;var w=S.stateNode;if(S.tag===5&&w!==null&&(S=w,g!==null&&(w=Pd(T,g),w!=null&&x.push(Od(T,w,S)))),y)break;T=T.return}0<x.length&&(p=new m(p,v,null,t,d),f.push({event:p,listeners:x}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",p&&t!==hx&&(v=t.relatedTarget||t.fromElement)&&(Sl(v)||v[Io]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(v=t.relatedTarget||t.toElement,m=u,v=v?Sl(v):null,v!==null&&(y=Kl(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=u),m!==v)){if(x=Ub,w="onMouseLeave",g="onMouseEnter",T="mouse",(n==="pointerout"||n==="pointerover")&&(x=Ob,w="onPointerLeave",g="onPointerEnter",T="pointer"),y=m==null?p:tc(m),S=v==null?p:tc(v),p=new x(w,T+"leave",m,t,d),p.target=y,p.relatedTarget=S,w=null,Sl(d)===u&&(x=new x(g,T+"enter",v,t,d),x.target=S,x.relatedTarget=y,w=x),y=w,m&&v)t:{for(x=m,g=v,T=0,S=x;S;S=vu(S))T++;for(S=0,w=g;w;w=vu(w))S++;for(;0<T-S;)x=vu(x),T--;for(;0<S-T;)g=vu(g),S--;for(;T--;){if(x===g||g!==null&&x===g.alternate)break t;x=vu(x),g=vu(g)}x=null}else x=null;m!==null&&Yb(f,p,m,x,!1),v!==null&&y!==null&&Yb(f,y,v,x,!0)}}e:{if(p=u?tc(u):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var M=NN;else if(zb(p))if(E2)M=BN;else{M=FN;var R=UN}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(M=ON);if(M&&(M=M(n,u))){S2(f,M,t,d);break e}R&&R(n,p,u),n==="focusout"&&(R=p._wrapperState)&&R.controlled&&p.type==="number"&&ox(p,"number",p.value)}switch(R=u?tc(u):window,n){case"focusin":(zb(R)||R.contentEditable==="true")&&(Ju=R,vx=u,dd=null);break;case"focusout":dd=vx=Ju=null;break;case"mousedown":yx=!0;break;case"contextmenu":case"mouseup":case"dragend":yx=!1,Xb(f,t,d);break;case"selectionchange":if(GN)break;case"keydown":case"keyup":Xb(f,t,d)}var P;if(MS)e:{switch(n){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Qu?y2(n,t)&&(N="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(N="onCompositionStart");N&&(v2&&t.locale!=="ko"&&(Qu||N!=="onCompositionStart"?N==="onCompositionEnd"&&Qu&&(P=_2()):(fa=d,bS="value"in fa?fa.value:fa.textContent,Qu=!0)),R=ug(u,N),0<R.length&&(N=new Fb(N,n,null,t,d),f.push({event:N,listeners:R}),P?N.data=P:(P=x2(t),P!==null&&(N.data=P)))),(P=RN?PN(n,t):IN(n,t))&&(u=ug(u,"onBeforeInput"),0<u.length&&(d=new Fb("onBeforeInput","beforeinput",null,t,d),f.push({event:d,listeners:u}),d.data=P))}L2(f,e)})}function Od(n,e,t){return{instance:n,listener:e,currentTarget:t}}function ug(n,e){for(var t=e+"Capture",i=[];n!==null;){var r=n,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Pd(n,t),s!=null&&i.unshift(Od(n,s,r)),s=Pd(n,e),s!=null&&i.push(Od(n,s,r))),n=n.return}return i}function vu(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Yb(n,e,t,i,r){for(var s=e._reactName,o=[];t!==null&&t!==i;){var a=t,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,r?(l=Pd(t,s),l!=null&&o.unshift(Od(t,l,a))):r||(l=Pd(t,s),l!=null&&o.push(Od(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var XN=/\r\n?/g,jN=/\u0000|\uFFFD/g;function qb(n){return(typeof n=="string"?n:""+n).replace(XN,`
`).replace(jN,"")}function mp(n,e,t){if(e=qb(e),qb(n)!==e&&t)throw Error(xe(425))}function cg(){}var xx=null,Sx=null;function Ex(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Tx=typeof setTimeout=="function"?setTimeout:void 0,$N=typeof clearTimeout=="function"?clearTimeout:void 0,Kb=typeof Promise=="function"?Promise:void 0,YN=typeof queueMicrotask=="function"?queueMicrotask:typeof Kb<"u"?function(n){return Kb.resolve(null).then(n).catch(qN)}:Tx;function qN(n){setTimeout(function(){throw n})}function dv(n,e){var t=e,i=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(i===0){n.removeChild(r),Dd(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=r}while(t);Dd(e)}function Ea(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function Zb(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Zc=Math.random().toString(36).slice(2),Ns="__reactFiber$"+Zc,Bd="__reactProps$"+Zc,Io="__reactContainer$"+Zc,bx="__reactEvents$"+Zc,KN="__reactListeners$"+Zc,ZN="__reactHandles$"+Zc;function Sl(n){var e=n[Ns];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Io]||t[Ns]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=Zb(n);n!==null;){if(t=n[Ns])return t;n=Zb(n)}return e}n=t,t=n.parentNode}return null}function of(n){return n=n[Ns]||n[Io],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function tc(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(xe(33))}function a0(n){return n[Bd]||null}var wx=[],nc=-1;function Ba(n){return{current:n}}function on(n){0>nc||(n.current=wx[nc],wx[nc]=null,nc--)}function Qt(n,e){nc++,wx[nc]=n.current,n.current=e}var La={},Ai=Ba(La),$i=Ba(!1),Bl=La;function Rc(n,e){var t=n.type.contextTypes;if(!t)return La;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in t)r[s]=e[s];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function Yi(n){return n=n.childContextTypes,n!=null}function hg(){on($i),on(Ai)}function Qb(n,e,t){if(Ai.current!==La)throw Error(xe(168));Qt(Ai,e),Qt($i,t)}function N2(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(xe(108,UD(n)||"Unknown",r));return yn({},t,i)}function dg(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||La,Bl=Ai.current,Qt(Ai,n),Qt($i,$i.current),!0}function Jb(n,e,t){var i=n.stateNode;if(!i)throw Error(xe(169));t?(n=N2(n,e,Bl),i.__reactInternalMemoizedMergedChildContext=n,on($i),on(Ai),Qt(Ai,n)):on($i),Qt($i,t)}var go=null,l0=!1,fv=!1;function U2(n){go===null?go=[n]:go.push(n)}function QN(n){l0=!0,U2(n)}function ka(){if(!fv&&go!==null){fv=!0;var n=0,e=$t;try{var t=go;for($t=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}go=null,l0=!1}catch(r){throw go!==null&&(go=go.slice(n+1)),o2(xS,ka),r}finally{$t=e,fv=!1}}return null}var ic=[],rc=0,fg=null,pg=0,Cr=[],Rr=0,kl=null,yo=1,xo="";function ol(n,e){ic[rc++]=pg,ic[rc++]=fg,fg=n,pg=e}function F2(n,e,t){Cr[Rr++]=yo,Cr[Rr++]=xo,Cr[Rr++]=kl,kl=n;var i=yo;n=xo;var r=32-ss(i)-1;i&=~(1<<r),t+=1;var s=32-ss(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,yo=1<<32-ss(e)+r|t<<r|i,xo=s+n}else yo=1<<s|t<<r|i,xo=n}function RS(n){n.return!==null&&(ol(n,1),F2(n,1,0))}function PS(n){for(;n===fg;)fg=ic[--rc],ic[rc]=null,pg=ic[--rc],ic[rc]=null;for(;n===kl;)kl=Cr[--Rr],Cr[Rr]=null,xo=Cr[--Rr],Cr[Rr]=null,yo=Cr[--Rr],Cr[Rr]=null}var lr=null,ar=null,cn=!1,es=null;function O2(n,e){var t=Dr(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function ew(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,lr=n,ar=Ea(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,lr=n,ar=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=kl!==null?{id:yo,overflow:xo}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Dr(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,lr=n,ar=null,!0):!1;default:return!1}}function Ax(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Mx(n){if(cn){var e=ar;if(e){var t=e;if(!ew(n,e)){if(Ax(n))throw Error(xe(418));e=Ea(t.nextSibling);var i=lr;e&&ew(n,e)?O2(i,t):(n.flags=n.flags&-4097|2,cn=!1,lr=n)}}else{if(Ax(n))throw Error(xe(418));n.flags=n.flags&-4097|2,cn=!1,lr=n}}}function tw(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;lr=n}function gp(n){if(n!==lr)return!1;if(!cn)return tw(n),cn=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Ex(n.type,n.memoizedProps)),e&&(e=ar)){if(Ax(n))throw B2(),Error(xe(418));for(;e;)O2(n,e),e=Ea(e.nextSibling)}if(tw(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(xe(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){ar=Ea(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}ar=null}}else ar=lr?Ea(n.stateNode.nextSibling):null;return!0}function B2(){for(var n=ar;n;)n=Ea(n.nextSibling)}function Pc(){ar=lr=null,cn=!1}function IS(n){es===null?es=[n]:es.push(n)}var JN=Oo.ReactCurrentBatchConfig;function Qr(n,e){if(n&&n.defaultProps){e=yn({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var mg=Ba(null),gg=null,sc=null,LS=null;function DS(){LS=sc=gg=null}function NS(n){var e=mg.current;on(mg),n._currentValue=e}function Cx(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function gc(n,e){gg=n,LS=sc=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Xi=!0),n.firstContext=null)}function Br(n){var e=n._currentValue;if(LS!==n)if(n={context:n,memoizedValue:e,next:null},sc===null){if(gg===null)throw Error(xe(308));sc=n,gg.dependencies={lanes:0,firstContext:n}}else sc=sc.next=n;return e}var El=null;function US(n){El===null?El=[n]:El.push(n)}function k2(n,e,t,i){var r=e.interleaved;return r===null?(t.next=t,US(e)):(t.next=r.next,r.next=t),e.interleaved=t,Lo(n,i)}function Lo(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var oa=!1;function FS(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function z2(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ao(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Ta(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,kt&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Lo(n,t)}return r=i.interleaved,r===null?(e.next=e,US(i)):(e.next=r.next,r.next=e),i.interleaved=e,Lo(n,t)}function Um(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,SS(n,t)}}function nw(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var r=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?r=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?r=s=e:s=s.next=e}else r=s=e;t={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function _g(n,e,t,i){var r=n.updateQueue;oa=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var d=n.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(s!==null){var f=r.baseState;o=0,d=u=l=null,a=s;do{var p=a.lane,m=a.eventTime;if((i&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var v=n,x=a;switch(p=e,m=t,x.tag){case 1:if(v=x.payload,typeof v=="function"){f=v.call(m,f,p);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,p=typeof v=="function"?v.call(m,f,p):v,p==null)break e;f=yn({},f,p);break e;case 2:oa=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,p=r.effects,p===null?r.effects=[a]:p.push(a))}else m={eventTime:m,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=m,l=f):d=d.next=m,o|=p;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;p=a,a=p.next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}while(1);if(d===null&&(l=f),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=d,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Gl|=o,n.lanes=o,n.memoizedState=f}}function iw(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],r=i.callback;if(r!==null){if(i.callback=null,i=t,typeof r!="function")throw Error(xe(191,r));r.call(i)}}}var G2=new kR.Component().refs;function Rx(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:yn({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var u0={isMounted:function(n){return(n=n._reactInternals)?Kl(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=Ui(),r=wa(n),s=Ao(i,r);s.payload=e,t!=null&&(s.callback=t),e=Ta(n,s,r),e!==null&&(os(e,n,r,i),Um(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=Ui(),r=wa(n),s=Ao(i,r);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Ta(n,s,r),e!==null&&(os(e,n,r,i),Um(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Ui(),i=wa(n),r=Ao(t,i);r.tag=2,e!=null&&(r.callback=e),e=Ta(n,r,i),e!==null&&(os(e,n,i,t),Um(e,n,i))}};function rw(n,e,t,i,r,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!Ud(t,i)||!Ud(r,s):!0}function H2(n,e,t){var i=!1,r=La,s=e.contextType;return typeof s=="object"&&s!==null?s=Br(s):(r=Yi(e)?Bl:Ai.current,i=e.contextTypes,s=(i=i!=null)?Rc(n,r):La),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=u0,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=s),e}function sw(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&u0.enqueueReplaceState(e,e.state,null)}function Px(n,e,t,i){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs=G2,FS(n);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Br(s):(s=Yi(e)?Bl:Ai.current,r.context=Rc(n,s)),r.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Rx(n,e,s,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&u0.enqueueReplaceState(r,r.state,null),_g(n,t,r,i),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function Ph(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(xe(309));var i=t.stateNode}if(!i)throw Error(xe(147,n));var r=i,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;a===G2&&(a=r.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(xe(284));if(!t._owner)throw Error(xe(290,n))}return n}function _p(n,e){throw n=Object.prototype.toString.call(e),Error(xe(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function ow(n){var e=n._init;return e(n._payload)}function V2(n){function e(g,T){if(n){var S=g.deletions;S===null?(g.deletions=[T],g.flags|=16):S.push(T)}}function t(g,T){if(!n)return null;for(;T!==null;)e(g,T),T=T.sibling;return null}function i(g,T){for(g=new Map;T!==null;)T.key!==null?g.set(T.key,T):g.set(T.index,T),T=T.sibling;return g}function r(g,T){return g=Aa(g,T),g.index=0,g.sibling=null,g}function s(g,T,S){return g.index=S,n?(S=g.alternate,S!==null?(S=S.index,S<T?(g.flags|=2,T):S):(g.flags|=2,T)):(g.flags|=1048576,T)}function o(g){return n&&g.alternate===null&&(g.flags|=2),g}function a(g,T,S,w){return T===null||T.tag!==6?(T=xv(S,g.mode,w),T.return=g,T):(T=r(T,S),T.return=g,T)}function l(g,T,S,w){var M=S.type;return M===Zu?d(g,T,S.props.children,w,S.key):T!==null&&(T.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===sa&&ow(M)===T.type)?(w=r(T,S.props),w.ref=Ph(g,T,S),w.return=g,w):(w=Gm(S.type,S.key,S.props,null,g.mode,w),w.ref=Ph(g,T,S),w.return=g,w)}function u(g,T,S,w){return T===null||T.tag!==4||T.stateNode.containerInfo!==S.containerInfo||T.stateNode.implementation!==S.implementation?(T=Sv(S,g.mode,w),T.return=g,T):(T=r(T,S.children||[]),T.return=g,T)}function d(g,T,S,w,M){return T===null||T.tag!==7?(T=Rl(S,g.mode,w,M),T.return=g,T):(T=r(T,S),T.return=g,T)}function f(g,T,S){if(typeof T=="string"&&T!==""||typeof T=="number")return T=xv(""+T,g.mode,S),T.return=g,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case op:return S=Gm(T.type,T.key,T.props,null,g.mode,S),S.ref=Ph(g,null,T),S.return=g,S;case Ku:return T=Sv(T,g.mode,S),T.return=g,T;case sa:var w=T._init;return f(g,w(T._payload),S)}if(Yh(T)||wh(T))return T=Rl(T,g.mode,S,null),T.return=g,T;_p(g,T)}return null}function p(g,T,S,w){var M=T!==null?T.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return M!==null?null:a(g,T,""+S,w);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case op:return S.key===M?l(g,T,S,w):null;case Ku:return S.key===M?u(g,T,S,w):null;case sa:return M=S._init,p(g,T,M(S._payload),w)}if(Yh(S)||wh(S))return M!==null?null:d(g,T,S,w,null);_p(g,S)}return null}function m(g,T,S,w,M){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(S)||null,a(T,g,""+w,M);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case op:return g=g.get(w.key===null?S:w.key)||null,l(T,g,w,M);case Ku:return g=g.get(w.key===null?S:w.key)||null,u(T,g,w,M);case sa:var R=w._init;return m(g,T,S,R(w._payload),M)}if(Yh(w)||wh(w))return g=g.get(S)||null,d(T,g,w,M,null);_p(T,w)}return null}function v(g,T,S,w){for(var M=null,R=null,P=T,N=T=0,C=null;P!==null&&N<S.length;N++){P.index>N?(C=P,P=null):C=P.sibling;var L=p(g,P,S[N],w);if(L===null){P===null&&(P=C);break}n&&P&&L.alternate===null&&e(g,P),T=s(L,T,N),R===null?M=L:R.sibling=L,R=L,P=C}if(N===S.length)return t(g,P),cn&&ol(g,N),M;if(P===null){for(;N<S.length;N++)P=f(g,S[N],w),P!==null&&(T=s(P,T,N),R===null?M=P:R.sibling=P,R=P);return cn&&ol(g,N),M}for(P=i(g,P);N<S.length;N++)C=m(P,g,N,S[N],w),C!==null&&(n&&C.alternate!==null&&P.delete(C.key===null?N:C.key),T=s(C,T,N),R===null?M=C:R.sibling=C,R=C);return n&&P.forEach(function(Q){return e(g,Q)}),cn&&ol(g,N),M}function x(g,T,S,w){var M=wh(S);if(typeof M!="function")throw Error(xe(150));if(S=M.call(S),S==null)throw Error(xe(151));for(var R=M=null,P=T,N=T=0,C=null,L=S.next();P!==null&&!L.done;N++,L=S.next()){P.index>N?(C=P,P=null):C=P.sibling;var Q=p(g,P,L.value,w);if(Q===null){P===null&&(P=C);break}n&&P&&Q.alternate===null&&e(g,P),T=s(Q,T,N),R===null?M=Q:R.sibling=Q,R=Q,P=C}if(L.done)return t(g,P),cn&&ol(g,N),M;if(P===null){for(;!L.done;N++,L=S.next())L=f(g,L.value,w),L!==null&&(T=s(L,T,N),R===null?M=L:R.sibling=L,R=L);return cn&&ol(g,N),M}for(P=i(g,P);!L.done;N++,L=S.next())L=m(P,g,N,L.value,w),L!==null&&(n&&L.alternate!==null&&P.delete(L.key===null?N:L.key),T=s(L,T,N),R===null?M=L:R.sibling=L,R=L);return n&&P.forEach(function(W){return e(g,W)}),cn&&ol(g,N),M}function y(g,T,S,w){if(typeof S=="object"&&S!==null&&S.type===Zu&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case op:e:{for(var M=S.key,R=T;R!==null;){if(R.key===M){if(M=S.type,M===Zu){if(R.tag===7){t(g,R.sibling),T=r(R,S.props.children),T.return=g,g=T;break e}}else if(R.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===sa&&ow(M)===R.type){t(g,R.sibling),T=r(R,S.props),T.ref=Ph(g,R,S),T.return=g,g=T;break e}t(g,R);break}else e(g,R);R=R.sibling}S.type===Zu?(T=Rl(S.props.children,g.mode,w,S.key),T.return=g,g=T):(w=Gm(S.type,S.key,S.props,null,g.mode,w),w.ref=Ph(g,T,S),w.return=g,g=w)}return o(g);case Ku:e:{for(R=S.key;T!==null;){if(T.key===R)if(T.tag===4&&T.stateNode.containerInfo===S.containerInfo&&T.stateNode.implementation===S.implementation){t(g,T.sibling),T=r(T,S.children||[]),T.return=g,g=T;break e}else{t(g,T);break}else e(g,T);T=T.sibling}T=Sv(S,g.mode,w),T.return=g,g=T}return o(g);case sa:return R=S._init,y(g,T,R(S._payload),w)}if(Yh(S))return v(g,T,S,w);if(wh(S))return x(g,T,S,w);_p(g,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,T!==null&&T.tag===6?(t(g,T.sibling),T=r(T,S),T.return=g,g=T):(t(g,T),T=xv(S,g.mode,w),T.return=g,g=T),o(g)):t(g,T)}return y}var Ic=V2(!0),W2=V2(!1),af={},zs=Ba(af),kd=Ba(af),zd=Ba(af);function Tl(n){if(n===af)throw Error(xe(174));return n}function OS(n,e){switch(Qt(zd,e),Qt(kd,n),Qt(zs,af),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lx(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=lx(e,n)}on(zs),Qt(zs,e)}function Lc(){on(zs),on(kd),on(zd)}function X2(n){Tl(zd.current);var e=Tl(zs.current),t=lx(e,n.type);e!==t&&(Qt(kd,n),Qt(zs,t))}function BS(n){kd.current===n&&(on(zs),on(kd))}var mn=Ba(0);function vg(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var pv=[];function kS(){for(var n=0;n<pv.length;n++)pv[n]._workInProgressVersionPrimary=null;pv.length=0}var Fm=Oo.ReactCurrentDispatcher,mv=Oo.ReactCurrentBatchConfig,zl=0,_n=null,kn=null,Jn=null,yg=!1,fd=!1,Gd=0,eU=0;function yi(){throw Error(xe(321))}function zS(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!cs(n[t],e[t]))return!1;return!0}function GS(n,e,t,i,r,s){if(zl=s,_n=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Fm.current=n===null||n.memoizedState===null?rU:sU,n=t(i,r),fd){s=0;do{if(fd=!1,Gd=0,25<=s)throw Error(xe(301));s+=1,Jn=kn=null,e.updateQueue=null,Fm.current=oU,n=t(i,r)}while(fd)}if(Fm.current=xg,e=kn!==null&&kn.next!==null,zl=0,Jn=kn=_n=null,yg=!1,e)throw Error(xe(300));return n}function HS(){var n=Gd!==0;return Gd=0,n}function Ps(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jn===null?_n.memoizedState=Jn=n:Jn=Jn.next=n,Jn}function kr(){if(kn===null){var n=_n.alternate;n=n!==null?n.memoizedState:null}else n=kn.next;var e=Jn===null?_n.memoizedState:Jn.next;if(e!==null)Jn=e,kn=n;else{if(n===null)throw Error(xe(310));kn=n,n={memoizedState:kn.memoizedState,baseState:kn.baseState,baseQueue:kn.baseQueue,queue:kn.queue,next:null},Jn===null?_n.memoizedState=Jn=n:Jn=Jn.next=n}return Jn}function Hd(n,e){return typeof e=="function"?e(n):e}function gv(n){var e=kr(),t=e.queue;if(t===null)throw Error(xe(311));t.lastRenderedReducer=n;var i=kn,r=i.baseQueue,s=t.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,t.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,u=s;do{var d=u.lane;if((zl&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:n(i,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=f,o=i):l=l.next=f,_n.lanes|=d,Gl|=d}u=u.next}while(u!==null&&u!==s);l===null?o=i:l.next=a,cs(i,e.memoizedState)||(Xi=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,t.lastRenderedState=i}if(n=t.interleaved,n!==null){r=n;do s=r.lane,_n.lanes|=s,Gl|=s,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function _v(n){var e=kr(),t=e.queue;if(t===null)throw Error(xe(311));t.lastRenderedReducer=n;var i=t.dispatch,r=t.pending,s=e.memoizedState;if(r!==null){t.pending=null;var o=r=r.next;do s=n(s,o.action),o=o.next;while(o!==r);cs(s,e.memoizedState)||(Xi=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,i]}function j2(){}function $2(n,e){var t=_n,i=kr(),r=e(),s=!cs(i.memoizedState,r);if(s&&(i.memoizedState=r,Xi=!0),i=i.queue,VS(K2.bind(null,t,i,n),[n]),i.getSnapshot!==e||s||Jn!==null&&Jn.memoizedState.tag&1){if(t.flags|=2048,Vd(9,q2.bind(null,t,i,r,e),void 0,null),ii===null)throw Error(xe(349));zl&30||Y2(t,e,r)}return r}function Y2(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=_n.updateQueue,e===null?(e={lastEffect:null,stores:null},_n.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function q2(n,e,t,i){e.value=t,e.getSnapshot=i,Z2(e)&&Q2(n)}function K2(n,e,t){return t(function(){Z2(e)&&Q2(n)})}function Z2(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!cs(n,t)}catch{return!0}}function Q2(n){var e=Lo(n,1);e!==null&&os(e,n,1,-1)}function aw(n){var e=Ps();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hd,lastRenderedState:n},e.queue=n,n=n.dispatch=iU.bind(null,_n,n),[e.memoizedState,n]}function Vd(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=_n.updateQueue,e===null?(e={lastEffect:null,stores:null},_n.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function J2(){return kr().memoizedState}function Om(n,e,t,i){var r=Ps();_n.flags|=n,r.memoizedState=Vd(1|e,t,void 0,i===void 0?null:i)}function c0(n,e,t,i){var r=kr();i=i===void 0?null:i;var s=void 0;if(kn!==null){var o=kn.memoizedState;if(s=o.destroy,i!==null&&zS(i,o.deps)){r.memoizedState=Vd(e,t,s,i);return}}_n.flags|=n,r.memoizedState=Vd(1|e,t,s,i)}function lw(n,e){return Om(8390656,8,n,e)}function VS(n,e){return c0(2048,8,n,e)}function eP(n,e){return c0(4,2,n,e)}function tP(n,e){return c0(4,4,n,e)}function nP(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function iP(n,e,t){return t=t!=null?t.concat([n]):null,c0(4,4,nP.bind(null,e,n),t)}function WS(){}function rP(n,e){var t=kr();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&zS(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function sP(n,e){var t=kr();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&zS(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function oP(n,e,t){return zl&21?(cs(t,e)||(t=u2(),_n.lanes|=t,Gl|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Xi=!0),n.memoizedState=t)}function tU(n,e){var t=$t;$t=t!==0&&4>t?t:4,n(!0);var i=mv.transition;mv.transition={};try{n(!1),e()}finally{$t=t,mv.transition=i}}function aP(){return kr().memoizedState}function nU(n,e,t){var i=wa(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},lP(n))uP(e,t);else if(t=k2(n,e,t,i),t!==null){var r=Ui();os(t,n,i,r),cP(t,e,i)}}function iU(n,e,t){var i=wa(n),r={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(lP(n))uP(e,r);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(r.hasEagerState=!0,r.eagerState=a,cs(a,o)){var l=e.interleaved;l===null?(r.next=r,US(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}t=k2(n,e,r,i),t!==null&&(r=Ui(),os(t,n,i,r),cP(t,e,i))}}function lP(n){var e=n.alternate;return n===_n||e!==null&&e===_n}function uP(n,e){fd=yg=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function cP(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,SS(n,t)}}var xg={readContext:Br,useCallback:yi,useContext:yi,useEffect:yi,useImperativeHandle:yi,useInsertionEffect:yi,useLayoutEffect:yi,useMemo:yi,useReducer:yi,useRef:yi,useState:yi,useDebugValue:yi,useDeferredValue:yi,useTransition:yi,useMutableSource:yi,useSyncExternalStore:yi,useId:yi,unstable_isNewReconciler:!1},rU={readContext:Br,useCallback:function(n,e){return Ps().memoizedState=[n,e===void 0?null:e],n},useContext:Br,useEffect:lw,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Om(4194308,4,nP.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Om(4194308,4,n,e)},useInsertionEffect:function(n,e){return Om(4,2,n,e)},useMemo:function(n,e){var t=Ps();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=Ps();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=nU.bind(null,_n,n),[i.memoizedState,n]},useRef:function(n){var e=Ps();return n={current:n},e.memoizedState=n},useState:aw,useDebugValue:WS,useDeferredValue:function(n){return Ps().memoizedState=n},useTransition:function(){var n=aw(!1),e=n[0];return n=tU.bind(null,n[1]),Ps().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=_n,r=Ps();if(cn){if(t===void 0)throw Error(xe(407));t=t()}else{if(t=e(),ii===null)throw Error(xe(349));zl&30||Y2(i,e,t)}r.memoizedState=t;var s={value:t,getSnapshot:e};return r.queue=s,lw(K2.bind(null,i,s,n),[n]),i.flags|=2048,Vd(9,q2.bind(null,i,s,t,e),void 0,null),t},useId:function(){var n=Ps(),e=ii.identifierPrefix;if(cn){var t=xo,i=yo;t=(i&~(1<<32-ss(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=Gd++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=eU++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},sU={readContext:Br,useCallback:rP,useContext:Br,useEffect:VS,useImperativeHandle:iP,useInsertionEffect:eP,useLayoutEffect:tP,useMemo:sP,useReducer:gv,useRef:J2,useState:function(){return gv(Hd)},useDebugValue:WS,useDeferredValue:function(n){var e=kr();return oP(e,kn.memoizedState,n)},useTransition:function(){var n=gv(Hd)[0],e=kr().memoizedState;return[n,e]},useMutableSource:j2,useSyncExternalStore:$2,useId:aP,unstable_isNewReconciler:!1},oU={readContext:Br,useCallback:rP,useContext:Br,useEffect:VS,useImperativeHandle:iP,useInsertionEffect:eP,useLayoutEffect:tP,useMemo:sP,useReducer:_v,useRef:J2,useState:function(){return _v(Hd)},useDebugValue:WS,useDeferredValue:function(n){var e=kr();return kn===null?e.memoizedState=n:oP(e,kn.memoizedState,n)},useTransition:function(){var n=_v(Hd)[0],e=kr().memoizedState;return[n,e]},useMutableSource:j2,useSyncExternalStore:$2,useId:aP,unstable_isNewReconciler:!1};function Dc(n,e){try{var t="",i=e;do t+=ND(i),i=i.return;while(i);var r=t}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:r,digest:null}}function vv(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Ix(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var aU=typeof WeakMap=="function"?WeakMap:Map;function hP(n,e,t){t=Ao(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){Eg||(Eg=!0,Gx=i),Ix(n,e)},t}function dP(n,e,t){t=Ao(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;t.payload=function(){return i(r)},t.callback=function(){Ix(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){Ix(n,e),typeof i!="function"&&(ba===null?ba=new Set([this]):ba.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function uw(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new aU;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(t)||(r.add(t),n=SU.bind(null,n,e,t),e.then(n,n))}function cw(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function hw(n,e,t,i,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Ao(-1,1),e.tag=2,Ta(t,e,1))),t.lanes|=1),n)}var lU=Oo.ReactCurrentOwner,Xi=!1;function Li(n,e,t,i){e.child=n===null?W2(e,null,t,i):Ic(e,n.child,t,i)}function dw(n,e,t,i,r){t=t.render;var s=e.ref;return gc(e,r),i=GS(n,e,t,i,s,r),t=HS(),n!==null&&!Xi?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Do(n,e,r)):(cn&&t&&RS(e),e.flags|=1,Li(n,e,i,r),e.child)}function fw(n,e,t,i,r){if(n===null){var s=t.type;return typeof s=="function"&&!QS(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,fP(n,e,s,i,r)):(n=Gm(t.type,null,i,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&r)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:Ud,t(o,i)&&n.ref===e.ref)return Do(n,e,r)}return e.flags|=1,n=Aa(s,i),n.ref=e.ref,n.return=e,e.child=n}function fP(n,e,t,i,r){if(n!==null){var s=n.memoizedProps;if(Ud(s,i)&&n.ref===e.ref)if(Xi=!1,e.pendingProps=i=s,(n.lanes&r)!==0)n.flags&131072&&(Xi=!0);else return e.lanes=n.lanes,Do(n,e,r)}return Lx(n,e,t,i,r)}function pP(n,e,t){var i=e.pendingProps,r=i.children,s=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qt(ac,or),or|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Qt(ac,or),or|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:t,Qt(ac,or),or|=i}else s!==null?(i=s.baseLanes|t,e.memoizedState=null):i=t,Qt(ac,or),or|=i;return Li(n,e,r,t),e.child}function mP(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Lx(n,e,t,i,r){var s=Yi(t)?Bl:Ai.current;return s=Rc(e,s),gc(e,r),t=GS(n,e,t,i,s,r),i=HS(),n!==null&&!Xi?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Do(n,e,r)):(cn&&i&&RS(e),e.flags|=1,Li(n,e,t,r),e.child)}function pw(n,e,t,i,r){if(Yi(t)){var s=!0;dg(e)}else s=!1;if(gc(e,r),e.stateNode===null)Bm(n,e),H2(e,t,i),Px(e,t,i,r),i=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Br(u):(u=Yi(t)?Bl:Ai.current,u=Rc(e,u));var d=t.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&sw(e,o,i,u),oa=!1;var p=e.memoizedState;o.state=p,_g(e,i,o,r),l=e.memoizedState,a!==i||p!==l||$i.current||oa?(typeof d=="function"&&(Rx(e,t,d,i),l=e.memoizedState),(a=oa||rw(e,t,a,i,p,l,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,z2(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:Qr(e.type,a),o.props=u,f=e.pendingProps,p=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Br(l):(l=Yi(t)?Bl:Ai.current,l=Rc(e,l));var m=t.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||p!==l)&&sw(e,o,i,l),oa=!1,p=e.memoizedState,o.state=p,_g(e,i,o,r);var v=e.memoizedState;a!==f||p!==v||$i.current||oa?(typeof m=="function"&&(Rx(e,t,m,i),v=e.memoizedState),(u=oa||rw(e,t,u,i,p,v,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,v,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,v,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=v),o.props=i,o.state=v,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),i=!1)}return Dx(n,e,t,i,s,r)}function Dx(n,e,t,i,r,s){mP(n,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&Jb(e,t,!1),Do(n,e,s);i=e.stateNode,lU.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&o?(e.child=Ic(e,n.child,null,s),e.child=Ic(e,null,a,s)):Li(n,e,a,s),e.memoizedState=i.state,r&&Jb(e,t,!0),e.child}function gP(n){var e=n.stateNode;e.pendingContext?Qb(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Qb(n,e.context,!1),OS(n,e.containerInfo)}function mw(n,e,t,i,r){return Pc(),IS(r),e.flags|=256,Li(n,e,t,i),e.child}var Nx={dehydrated:null,treeContext:null,retryLane:0};function Ux(n){return{baseLanes:n,cachePool:null,transitions:null}}function _P(n,e,t){var i=e.pendingProps,r=mn.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),Qt(mn,r&1),n===null)return Mx(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,n=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=f0(o,i,0,null),n=Rl(n,i,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=Ux(t),e.memoizedState=Nx,n):XS(e,o));if(r=n.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return uU(n,e,o,i,a,r,t);if(s){s=i.fallback,o=e.mode,r=n.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=Aa(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Aa(a,s):(s=Rl(s,o,t,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=n.child.memoizedState,o=o===null?Ux(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=Nx,i}return s=n.child,n=s.sibling,i=Aa(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function XS(n,e){return e=f0({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function vp(n,e,t,i){return i!==null&&IS(i),Ic(e,n.child,null,t),n=XS(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function uU(n,e,t,i,r,s,o){if(t)return e.flags&256?(e.flags&=-257,i=vv(Error(xe(422))),vp(n,e,o,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=f0({mode:"visible",children:i.children},r,0,null),s=Rl(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&Ic(e,n.child,null,o),e.child.memoizedState=Ux(o),e.memoizedState=Nx,s);if(!(e.mode&1))return vp(n,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(xe(419)),i=vv(s,i,void 0),vp(n,e,o,i)}if(a=(o&n.childLanes)!==0,Xi||a){if(i=ii,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Lo(n,r),os(i,n,r,-1))}return ZS(),i=vv(Error(xe(421))),vp(n,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=EU.bind(null,n),r._reactRetry=e,null):(n=s.treeContext,ar=Ea(r.nextSibling),lr=e,cn=!0,es=null,n!==null&&(Cr[Rr++]=yo,Cr[Rr++]=xo,Cr[Rr++]=kl,yo=n.id,xo=n.overflow,kl=e),e=XS(e,i.children),e.flags|=4096,e)}function gw(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),Cx(n.return,e,t)}function yv(n,e,t,i,r){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=t,s.tailMode=r)}function vP(n,e,t){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(Li(n,e,i.children,t),i=mn.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&gw(n,t,e);else if(n.tag===19)gw(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(Qt(mn,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&vg(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),yv(e,!1,r,t,s);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&vg(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}yv(e,!0,t,null,s);break;case"together":yv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Bm(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Do(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Gl|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(xe(153));if(e.child!==null){for(n=e.child,t=Aa(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Aa(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function cU(n,e,t){switch(e.tag){case 3:gP(e),Pc();break;case 5:X2(e);break;case 1:Yi(e.type)&&dg(e);break;case 4:OS(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Qt(mg,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Qt(mn,mn.current&1),e.flags|=128,null):t&e.child.childLanes?_P(n,e,t):(Qt(mn,mn.current&1),n=Do(n,e,t),n!==null?n.sibling:null);Qt(mn,mn.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return vP(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Qt(mn,mn.current),i)break;return null;case 22:case 23:return e.lanes=0,pP(n,e,t)}return Do(n,e,t)}var yP,Fx,xP,SP;yP=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Fx=function(){};xP=function(n,e,t,i){var r=n.memoizedProps;if(r!==i){n=e.stateNode,Tl(zs.current);var s=null;switch(t){case"input":r=rx(n,r),i=rx(n,i),s=[];break;case"select":r=yn({},r,{value:void 0}),i=yn({},i,{value:void 0}),s=[];break;case"textarea":r=ax(n,r),i=ax(n,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=cg)}ux(t,i);var o;t=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Cd.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var l=i[u];if(a=r!=null?r[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Cd.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&tn("scroll",n),s||a===l||(s=[])):(s=s||[]).push(u,l))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};SP=function(n,e,t,i){t!==i&&(e.flags|=4)};function Ih(n,e){if(!cn)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function xi(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function hU(n,e,t){var i=e.pendingProps;switch(PS(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xi(e),null;case 1:return Yi(e.type)&&hg(),xi(e),null;case 3:return i=e.stateNode,Lc(),on($i),on(Ai),kS(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(gp(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,es!==null&&(Wx(es),es=null))),Fx(n,e),xi(e),null;case 5:BS(e);var r=Tl(zd.current);if(t=e.type,n!==null&&e.stateNode!=null)xP(n,e,t,i,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(xe(166));return xi(e),null}if(n=Tl(zs.current),gp(e)){i=e.stateNode,t=e.type;var s=e.memoizedProps;switch(i[Ns]=e,i[Bd]=s,n=(e.mode&1)!==0,t){case"dialog":tn("cancel",i),tn("close",i);break;case"iframe":case"object":case"embed":tn("load",i);break;case"video":case"audio":for(r=0;r<Kh.length;r++)tn(Kh[r],i);break;case"source":tn("error",i);break;case"img":case"image":case"link":tn("error",i),tn("load",i);break;case"details":tn("toggle",i);break;case"input":wb(i,s),tn("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},tn("invalid",i);break;case"textarea":Mb(i,s),tn("invalid",i)}ux(t,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&mp(i.textContent,a,n),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&mp(i.textContent,a,n),r=["children",""+a]):Cd.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&tn("scroll",i)}switch(t){case"input":ap(i),Ab(i,s,!0);break;case"textarea":ap(i),Cb(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=cg)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=YR(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=o.createElement(t,{is:i.is}):(n=o.createElement(t),t==="select"&&(o=n,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):n=o.createElementNS(n,t),n[Ns]=e,n[Bd]=i,yP(n,e,!1,!1),e.stateNode=n;e:{switch(o=cx(t,i),t){case"dialog":tn("cancel",n),tn("close",n),r=i;break;case"iframe":case"object":case"embed":tn("load",n),r=i;break;case"video":case"audio":for(r=0;r<Kh.length;r++)tn(Kh[r],n);r=i;break;case"source":tn("error",n),r=i;break;case"img":case"image":case"link":tn("error",n),tn("load",n),r=i;break;case"details":tn("toggle",n),r=i;break;case"input":wb(n,i),r=rx(n,i),tn("invalid",n);break;case"option":r=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},r=yn({},i,{value:void 0}),tn("invalid",n);break;case"textarea":Mb(n,i),r=ax(n,i),tn("invalid",n);break;default:r=i}ux(t,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?ZR(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&qR(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Rd(n,l):typeof l=="number"&&Rd(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Cd.hasOwnProperty(s)?l!=null&&s==="onScroll"&&tn("scroll",n):l!=null&&mS(n,s,l,o))}switch(t){case"input":ap(n),Ab(n,i,!1);break;case"textarea":ap(n),Cb(n);break;case"option":i.value!=null&&n.setAttribute("value",""+Ia(i.value));break;case"select":n.multiple=!!i.multiple,s=i.value,s!=null?dc(n,!!i.multiple,s,!1):i.defaultValue!=null&&dc(n,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=cg)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return xi(e),null;case 6:if(n&&e.stateNode!=null)SP(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(xe(166));if(t=Tl(zd.current),Tl(zs.current),gp(e)){if(i=e.stateNode,t=e.memoizedProps,i[Ns]=e,(s=i.nodeValue!==t)&&(n=lr,n!==null))switch(n.tag){case 3:mp(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&mp(i.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[Ns]=e,e.stateNode=i}return xi(e),null;case 13:if(on(mn),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(cn&&ar!==null&&e.mode&1&&!(e.flags&128))B2(),Pc(),e.flags|=98560,s=!1;else if(s=gp(e),i!==null&&i.dehydrated!==null){if(n===null){if(!s)throw Error(xe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(xe(317));s[Ns]=e}else Pc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;xi(e),s=!1}else es!==null&&(Wx(es),es=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||mn.current&1?zn===0&&(zn=3):ZS())),e.updateQueue!==null&&(e.flags|=4),xi(e),null);case 4:return Lc(),Fx(n,e),n===null&&Fd(e.stateNode.containerInfo),xi(e),null;case 10:return NS(e.type._context),xi(e),null;case 17:return Yi(e.type)&&hg(),xi(e),null;case 19:if(on(mn),s=e.memoizedState,s===null)return xi(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)Ih(s,!1);else{if(zn!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=vg(n),o!==null){for(e.flags|=128,Ih(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)s=t,n=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Qt(mn,mn.current&1|2),e.child}n=n.sibling}s.tail!==null&&Rn()>Nc&&(e.flags|=128,i=!0,Ih(s,!1),e.lanes=4194304)}else{if(!i)if(n=vg(o),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Ih(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!cn)return xi(e),null}else 2*Rn()-s.renderingStartTime>Nc&&t!==1073741824&&(e.flags|=128,i=!0,Ih(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Rn(),e.sibling=null,t=mn.current,Qt(mn,i?t&1|2:t&1),e):(xi(e),null);case 22:case 23:return KS(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?or&1073741824&&(xi(e),e.subtreeFlags&6&&(e.flags|=8192)):xi(e),null;case 24:return null;case 25:return null}throw Error(xe(156,e.tag))}function dU(n,e){switch(PS(e),e.tag){case 1:return Yi(e.type)&&hg(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Lc(),on($i),on(Ai),kS(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return BS(e),null;case 13:if(on(mn),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(xe(340));Pc()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return on(mn),null;case 4:return Lc(),null;case 10:return NS(e.type._context),null;case 22:case 23:return KS(),null;case 24:return null;default:return null}}var yp=!1,bi=!1,fU=typeof WeakSet=="function"?WeakSet:Set,He=null;function oc(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){En(n,e,i)}else t.current=null}function Ox(n,e,t){try{t()}catch(i){En(n,e,i)}}var _w=!1;function pU(n,e){if(xx=ag,n=w2(),CS(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,u=0,d=0,f=n,p=null;t:for(;;){for(var m;f!==t||r!==0&&f.nodeType!==3||(a=o+r),f!==s||i!==0&&f.nodeType!==3||(l=o+i),f.nodeType===3&&(o+=f.nodeValue.length),(m=f.firstChild)!==null;)p=f,f=m;for(;;){if(f===n)break t;if(p===t&&++u===r&&(a=o),p===s&&++d===i&&(l=o),(m=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=m}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Sx={focusedElem:n,selectionRange:t},ag=!1,He=e;He!==null;)if(e=He,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,He=n;else for(;He!==null;){e=He;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,y=v.memoizedState,g=e.stateNode,T=g.getSnapshotBeforeUpdate(e.elementType===e.type?x:Qr(e.type,x),y);g.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(xe(163))}}catch(w){En(e,e.return,w)}if(n=e.sibling,n!==null){n.return=e.return,He=n;break}He=e.return}return v=_w,_w=!1,v}function pd(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&n)===n){var s=r.destroy;r.destroy=void 0,s!==void 0&&Ox(e,t,s)}r=r.next}while(r!==i)}}function h0(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function Bx(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function EP(n){var e=n.alternate;e!==null&&(n.alternate=null,EP(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Ns],delete e[Bd],delete e[bx],delete e[KN],delete e[ZN])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function TP(n){return n.tag===5||n.tag===3||n.tag===4}function vw(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||TP(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function kx(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=cg));else if(i!==4&&(n=n.child,n!==null))for(kx(n,e,t),n=n.sibling;n!==null;)kx(n,e,t),n=n.sibling}function zx(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(zx(n,e,t),n=n.sibling;n!==null;)zx(n,e,t),n=n.sibling}var hi=null,Jr=!1;function qo(n,e,t){for(t=t.child;t!==null;)bP(n,e,t),t=t.sibling}function bP(n,e,t){if(ks&&typeof ks.onCommitFiberUnmount=="function")try{ks.onCommitFiberUnmount(i0,t)}catch{}switch(t.tag){case 5:bi||oc(t,e);case 6:var i=hi,r=Jr;hi=null,qo(n,e,t),hi=i,Jr=r,hi!==null&&(Jr?(n=hi,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):hi.removeChild(t.stateNode));break;case 18:hi!==null&&(Jr?(n=hi,t=t.stateNode,n.nodeType===8?dv(n.parentNode,t):n.nodeType===1&&dv(n,t),Dd(n)):dv(hi,t.stateNode));break;case 4:i=hi,r=Jr,hi=t.stateNode.containerInfo,Jr=!0,qo(n,e,t),hi=i,Jr=r;break;case 0:case 11:case 14:case 15:if(!bi&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Ox(t,e,o),r=r.next}while(r!==i)}qo(n,e,t);break;case 1:if(!bi&&(oc(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){En(t,e,a)}qo(n,e,t);break;case 21:qo(n,e,t);break;case 22:t.mode&1?(bi=(i=bi)||t.memoizedState!==null,qo(n,e,t),bi=i):qo(n,e,t);break;default:qo(n,e,t)}}function yw(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new fU),e.forEach(function(i){var r=TU.bind(null,n,i);t.has(i)||(t.add(i),i.then(r,r))})}}function Wr(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var r=t[i];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:hi=a.stateNode,Jr=!1;break e;case 3:hi=a.stateNode.containerInfo,Jr=!0;break e;case 4:hi=a.stateNode.containerInfo,Jr=!0;break e}a=a.return}if(hi===null)throw Error(xe(160));bP(s,o,r),hi=null,Jr=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){En(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)wP(e,n),e=e.sibling}function wP(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Wr(e,n),bs(n),i&4){try{pd(3,n,n.return),h0(3,n)}catch(x){En(n,n.return,x)}try{pd(5,n,n.return)}catch(x){En(n,n.return,x)}}break;case 1:Wr(e,n),bs(n),i&512&&t!==null&&oc(t,t.return);break;case 5:if(Wr(e,n),bs(n),i&512&&t!==null&&oc(t,t.return),n.flags&32){var r=n.stateNode;try{Rd(r,"")}catch(x){En(n,n.return,x)}}if(i&4&&(r=n.stateNode,r!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&jR(r,s),cx(a,o);var u=cx(a,s);for(o=0;o<l.length;o+=2){var d=l[o],f=l[o+1];d==="style"?ZR(r,f):d==="dangerouslySetInnerHTML"?qR(r,f):d==="children"?Rd(r,f):mS(r,d,f,u)}switch(a){case"input":sx(r,s);break;case"textarea":$R(r,s);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?dc(r,!!s.multiple,m,!1):p!==!!s.multiple&&(s.defaultValue!=null?dc(r,!!s.multiple,s.defaultValue,!0):dc(r,!!s.multiple,s.multiple?[]:"",!1))}r[Bd]=s}catch(x){En(n,n.return,x)}}break;case 6:if(Wr(e,n),bs(n),i&4){if(n.stateNode===null)throw Error(xe(162));r=n.stateNode,s=n.memoizedProps;try{r.nodeValue=s}catch(x){En(n,n.return,x)}}break;case 3:if(Wr(e,n),bs(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{Dd(e.containerInfo)}catch(x){En(n,n.return,x)}break;case 4:Wr(e,n),bs(n);break;case 13:Wr(e,n),bs(n),r=n.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(YS=Rn())),i&4&&yw(n);break;case 22:if(d=t!==null&&t.memoizedState!==null,n.mode&1?(bi=(u=bi)||d,Wr(e,n),bi=u):Wr(e,n),bs(n),i&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!d&&n.mode&1)for(He=n,d=n.child;d!==null;){for(f=He=d;He!==null;){switch(p=He,m=p.child,p.tag){case 0:case 11:case 14:case 15:pd(4,p,p.return);break;case 1:oc(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){i=p,t=p.return;try{e=i,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(x){En(i,t,x)}}break;case 5:oc(p,p.return);break;case 22:if(p.memoizedState!==null){Sw(f);continue}}m!==null?(m.return=p,He=m):Sw(f)}d=d.sibling}e:for(d=null,f=n;;){if(f.tag===5){if(d===null){d=f;try{r=f.stateNode,u?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=KR("display",o))}catch(x){En(n,n.return,x)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(x){En(n,n.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Wr(e,n),bs(n),i&4&&yw(n);break;case 21:break;default:Wr(e,n),bs(n)}}function bs(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(TP(t)){var i=t;break e}t=t.return}throw Error(xe(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Rd(r,""),i.flags&=-33);var s=vw(n);zx(n,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=vw(n);kx(n,a,o);break;default:throw Error(xe(161))}}catch(l){En(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function mU(n,e,t){He=n,AP(n)}function AP(n,e,t){for(var i=(n.mode&1)!==0;He!==null;){var r=He,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||yp;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||bi;a=yp;var u=bi;if(yp=o,(bi=l)&&!u)for(He=r;He!==null;)o=He,l=o.child,o.tag===22&&o.memoizedState!==null?Ew(r):l!==null?(l.return=o,He=l):Ew(r);for(;s!==null;)He=s,AP(s),s=s.sibling;He=r,yp=a,bi=u}xw(n)}else r.subtreeFlags&8772&&s!==null?(s.return=r,He=s):xw(n)}}function xw(n){for(;He!==null;){var e=He;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:bi||h0(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!bi)if(t===null)i.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:Qr(e.type,t.memoizedProps);i.componentDidUpdate(r,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&iw(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}iw(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Dd(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(xe(163))}bi||e.flags&512&&Bx(e)}catch(p){En(e,e.return,p)}}if(e===n){He=null;break}if(t=e.sibling,t!==null){t.return=e.return,He=t;break}He=e.return}}function Sw(n){for(;He!==null;){var e=He;if(e===n){He=null;break}var t=e.sibling;if(t!==null){t.return=e.return,He=t;break}He=e.return}}function Ew(n){for(;He!==null;){var e=He;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{h0(4,e)}catch(l){En(e,t,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){En(e,r,l)}}var s=e.return;try{Bx(e)}catch(l){En(e,s,l)}break;case 5:var o=e.return;try{Bx(e)}catch(l){En(e,o,l)}}}catch(l){En(e,e.return,l)}if(e===n){He=null;break}var a=e.sibling;if(a!==null){a.return=e.return,He=a;break}He=e.return}}var gU=Math.ceil,Sg=Oo.ReactCurrentDispatcher,jS=Oo.ReactCurrentOwner,Or=Oo.ReactCurrentBatchConfig,kt=0,ii=null,Nn=null,fi=0,or=0,ac=Ba(0),zn=0,Wd=null,Gl=0,d0=0,$S=0,md=null,Vi=null,YS=0,Nc=1/0,mo=null,Eg=!1,Gx=null,ba=null,xp=!1,pa=null,Tg=0,gd=0,Hx=null,km=-1,zm=0;function Ui(){return kt&6?Rn():km!==-1?km:km=Rn()}function wa(n){return n.mode&1?kt&2&&fi!==0?fi&-fi:JN.transition!==null?(zm===0&&(zm=u2()),zm):(n=$t,n!==0||(n=window.event,n=n===void 0?16:g2(n.type)),n):1}function os(n,e,t,i){if(50<gd)throw gd=0,Hx=null,Error(xe(185));rf(n,t,i),(!(kt&2)||n!==ii)&&(n===ii&&(!(kt&2)&&(d0|=t),zn===4&&ha(n,fi)),qi(n,i),t===1&&kt===0&&!(e.mode&1)&&(Nc=Rn()+500,l0&&ka()))}function qi(n,e){var t=n.callbackNode;JD(n,e);var i=og(n,n===ii?fi:0);if(i===0)t!==null&&Ib(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&Ib(t),e===1)n.tag===0?QN(Tw.bind(null,n)):U2(Tw.bind(null,n)),YN(function(){!(kt&6)&&ka()}),t=null;else{switch(c2(i)){case 1:t=xS;break;case 4:t=a2;break;case 16:t=sg;break;case 536870912:t=l2;break;default:t=sg}t=NP(t,MP.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function MP(n,e){if(km=-1,zm=0,kt&6)throw Error(xe(327));var t=n.callbackNode;if(_c()&&n.callbackNode!==t)return null;var i=og(n,n===ii?fi:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=bg(n,i);else{e=i;var r=kt;kt|=2;var s=RP();(ii!==n||fi!==e)&&(mo=null,Nc=Rn()+500,Cl(n,e));do try{yU();break}catch(a){CP(n,a)}while(1);DS(),Sg.current=s,kt=r,Nn!==null?e=0:(ii=null,fi=0,e=zn)}if(e!==0){if(e===2&&(r=mx(n),r!==0&&(i=r,e=Vx(n,r))),e===1)throw t=Wd,Cl(n,0),ha(n,i),qi(n,Rn()),t;if(e===6)ha(n,i);else{if(r=n.current.alternate,!(i&30)&&!_U(r)&&(e=bg(n,i),e===2&&(s=mx(n),s!==0&&(i=s,e=Vx(n,s))),e===1))throw t=Wd,Cl(n,0),ha(n,i),qi(n,Rn()),t;switch(n.finishedWork=r,n.finishedLanes=i,e){case 0:case 1:throw Error(xe(345));case 2:al(n,Vi,mo);break;case 3:if(ha(n,i),(i&130023424)===i&&(e=YS+500-Rn(),10<e)){if(og(n,0)!==0)break;if(r=n.suspendedLanes,(r&i)!==i){Ui(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=Tx(al.bind(null,n,Vi,mo),e);break}al(n,Vi,mo);break;case 4:if(ha(n,i),(i&4194240)===i)break;for(e=n.eventTimes,r=-1;0<i;){var o=31-ss(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=Rn()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*gU(i/1960))-i,10<i){n.timeoutHandle=Tx(al.bind(null,n,Vi,mo),i);break}al(n,Vi,mo);break;case 5:al(n,Vi,mo);break;default:throw Error(xe(329))}}}return qi(n,Rn()),n.callbackNode===t?MP.bind(null,n):null}function Vx(n,e){var t=md;return n.current.memoizedState.isDehydrated&&(Cl(n,e).flags|=256),n=bg(n,e),n!==2&&(e=Vi,Vi=t,e!==null&&Wx(e)),n}function Wx(n){Vi===null?Vi=n:Vi.push.apply(Vi,n)}function _U(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var r=t[i],s=r.getSnapshot;r=r.value;try{if(!cs(s(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ha(n,e){for(e&=~$S,e&=~d0,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-ss(e),i=1<<t;n[t]=-1,e&=~i}}function Tw(n){if(kt&6)throw Error(xe(327));_c();var e=og(n,0);if(!(e&1))return qi(n,Rn()),null;var t=bg(n,e);if(n.tag!==0&&t===2){var i=mx(n);i!==0&&(e=i,t=Vx(n,i))}if(t===1)throw t=Wd,Cl(n,0),ha(n,e),qi(n,Rn()),t;if(t===6)throw Error(xe(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,al(n,Vi,mo),qi(n,Rn()),null}function qS(n,e){var t=kt;kt|=1;try{return n(e)}finally{kt=t,kt===0&&(Nc=Rn()+500,l0&&ka())}}function Hl(n){pa!==null&&pa.tag===0&&!(kt&6)&&_c();var e=kt;kt|=1;var t=Or.transition,i=$t;try{if(Or.transition=null,$t=1,n)return n()}finally{$t=i,Or.transition=t,kt=e,!(kt&6)&&ka()}}function KS(){or=ac.current,on(ac)}function Cl(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,$N(t)),Nn!==null)for(t=Nn.return;t!==null;){var i=t;switch(PS(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&hg();break;case 3:Lc(),on($i),on(Ai),kS();break;case 5:BS(i);break;case 4:Lc();break;case 13:on(mn);break;case 19:on(mn);break;case 10:NS(i.type._context);break;case 22:case 23:KS()}t=t.return}if(ii=n,Nn=n=Aa(n.current,null),fi=or=e,zn=0,Wd=null,$S=d0=Gl=0,Vi=md=null,El!==null){for(e=0;e<El.length;e++)if(t=El[e],i=t.interleaved,i!==null){t.interleaved=null;var r=i.next,s=t.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}t.pending=i}El=null}return n}function CP(n,e){do{var t=Nn;try{if(DS(),Fm.current=xg,yg){for(var i=_n.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}yg=!1}if(zl=0,Jn=kn=_n=null,fd=!1,Gd=0,jS.current=null,t===null||t.return===null){zn=1,Wd=e,Nn=null;break}e:{var s=n,o=t.return,a=t,l=e;if(e=fi,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=cw(o);if(m!==null){m.flags&=-257,hw(m,o,a,s,e),m.mode&1&&uw(s,u,e),e=m,l=u;var v=e.updateQueue;if(v===null){var x=new Set;x.add(l),e.updateQueue=x}else v.add(l);break e}else{if(!(e&1)){uw(s,u,e),ZS();break e}l=Error(xe(426))}}else if(cn&&a.mode&1){var y=cw(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),hw(y,o,a,s,e),IS(Dc(l,a));break e}}s=l=Dc(l,a),zn!==4&&(zn=2),md===null?md=[s]:md.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=hP(s,l,e);nw(s,g);break e;case 1:a=l;var T=s.type,S=s.stateNode;if(!(s.flags&128)&&(typeof T.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(ba===null||!ba.has(S)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=dP(s,a,e);nw(s,w);break e}}s=s.return}while(s!==null)}IP(t)}catch(M){e=M,Nn===t&&t!==null&&(Nn=t=t.return);continue}break}while(1)}function RP(){var n=Sg.current;return Sg.current=xg,n===null?xg:n}function ZS(){(zn===0||zn===3||zn===2)&&(zn=4),ii===null||!(Gl&268435455)&&!(d0&268435455)||ha(ii,fi)}function bg(n,e){var t=kt;kt|=2;var i=RP();(ii!==n||fi!==e)&&(mo=null,Cl(n,e));do try{vU();break}catch(r){CP(n,r)}while(1);if(DS(),kt=t,Sg.current=i,Nn!==null)throw Error(xe(261));return ii=null,fi=0,zn}function vU(){for(;Nn!==null;)PP(Nn)}function yU(){for(;Nn!==null&&!WD();)PP(Nn)}function PP(n){var e=DP(n.alternate,n,or);n.memoizedProps=n.pendingProps,e===null?IP(n):Nn=e,jS.current=null}function IP(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=dU(t,e),t!==null){t.flags&=32767,Nn=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{zn=6,Nn=null;return}}else if(t=hU(t,e,or),t!==null){Nn=t;return}if(e=e.sibling,e!==null){Nn=e;return}Nn=e=n}while(e!==null);zn===0&&(zn=5)}function al(n,e,t){var i=$t,r=Or.transition;try{Or.transition=null,$t=1,xU(n,e,t,i)}finally{Or.transition=r,$t=i}return null}function xU(n,e,t,i){do _c();while(pa!==null);if(kt&6)throw Error(xe(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(xe(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(eN(n,s),n===ii&&(Nn=ii=null,fi=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||xp||(xp=!0,NP(sg,function(){return _c(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=Or.transition,Or.transition=null;var o=$t;$t=1;var a=kt;kt|=4,jS.current=null,pU(n,t),wP(t,n),zN(Sx),ag=!!xx,Sx=xx=null,n.current=t,mU(t),XD(),kt=a,$t=o,Or.transition=s}else n.current=t;if(xp&&(xp=!1,pa=n,Tg=r),s=n.pendingLanes,s===0&&(ba=null),YD(t.stateNode),qi(n,Rn()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],i(r.value,{componentStack:r.stack,digest:r.digest});if(Eg)throw Eg=!1,n=Gx,Gx=null,n;return Tg&1&&n.tag!==0&&_c(),s=n.pendingLanes,s&1?n===Hx?gd++:(gd=0,Hx=n):gd=0,ka(),null}function _c(){if(pa!==null){var n=c2(Tg),e=Or.transition,t=$t;try{if(Or.transition=null,$t=16>n?16:n,pa===null)var i=!1;else{if(n=pa,pa=null,Tg=0,kt&6)throw Error(xe(331));var r=kt;for(kt|=4,He=n.current;He!==null;){var s=He,o=s.child;if(He.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(He=u;He!==null;){var d=He;switch(d.tag){case 0:case 11:case 15:pd(8,d,s)}var f=d.child;if(f!==null)f.return=d,He=f;else for(;He!==null;){d=He;var p=d.sibling,m=d.return;if(EP(d),d===u){He=null;break}if(p!==null){p.return=m,He=p;break}He=m}}}var v=s.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var y=x.sibling;x.sibling=null,x=y}while(x!==null)}}He=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,He=o;else e:for(;He!==null;){if(s=He,s.flags&2048)switch(s.tag){case 0:case 11:case 15:pd(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,He=g;break e}He=s.return}}var T=n.current;for(He=T;He!==null;){o=He;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,He=S;else e:for(o=T;He!==null;){if(a=He,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:h0(9,a)}}catch(M){En(a,a.return,M)}if(a===o){He=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,He=w;break e}He=a.return}}if(kt=r,ka(),ks&&typeof ks.onPostCommitFiberRoot=="function")try{ks.onPostCommitFiberRoot(i0,n)}catch{}i=!0}return i}finally{$t=t,Or.transition=e}}return!1}function bw(n,e,t){e=Dc(t,e),e=hP(n,e,1),n=Ta(n,e,1),e=Ui(),n!==null&&(rf(n,1,e),qi(n,e))}function En(n,e,t){if(n.tag===3)bw(n,n,t);else for(;e!==null;){if(e.tag===3){bw(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ba===null||!ba.has(i))){n=Dc(t,n),n=dP(e,n,1),e=Ta(e,n,1),n=Ui(),e!==null&&(rf(e,1,n),qi(e,n));break}}e=e.return}}function SU(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=Ui(),n.pingedLanes|=n.suspendedLanes&t,ii===n&&(fi&t)===t&&(zn===4||zn===3&&(fi&130023424)===fi&&500>Rn()-YS?Cl(n,0):$S|=t),qi(n,e)}function LP(n,e){e===0&&(n.mode&1?(e=cp,cp<<=1,!(cp&130023424)&&(cp=4194304)):e=1);var t=Ui();n=Lo(n,e),n!==null&&(rf(n,e,t),qi(n,t))}function EU(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),LP(n,t)}function TU(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(xe(314))}i!==null&&i.delete(e),LP(n,t)}var DP;DP=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||$i.current)Xi=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Xi=!1,cU(n,e,t);Xi=!!(n.flags&131072)}else Xi=!1,cn&&e.flags&1048576&&F2(e,pg,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Bm(n,e),n=e.pendingProps;var r=Rc(e,Ai.current);gc(e,t),r=GS(null,e,i,n,r,t);var s=HS();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Yi(i)?(s=!0,dg(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,FS(e),r.updater=u0,e.stateNode=r,r._reactInternals=e,Px(e,i,n,t),e=Dx(null,e,i,!0,s,t)):(e.tag=0,cn&&s&&RS(e),Li(null,e,r,t),e=e.child),e;case 16:i=e.elementType;e:{switch(Bm(n,e),n=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=wU(i),n=Qr(i,n),r){case 0:e=Lx(null,e,i,n,t);break e;case 1:e=pw(null,e,i,n,t);break e;case 11:e=dw(null,e,i,n,t);break e;case 14:e=fw(null,e,i,Qr(i.type,n),t);break e}throw Error(xe(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Qr(i,r),Lx(n,e,i,r,t);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Qr(i,r),pw(n,e,i,r,t);case 3:e:{if(gP(e),n===null)throw Error(xe(387));i=e.pendingProps,s=e.memoizedState,r=s.element,z2(n,e),_g(e,i,null,t);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Dc(Error(xe(423)),e),e=mw(n,e,i,t,r);break e}else if(i!==r){r=Dc(Error(xe(424)),e),e=mw(n,e,i,t,r);break e}else for(ar=Ea(e.stateNode.containerInfo.firstChild),lr=e,cn=!0,es=null,t=W2(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Pc(),i===r){e=Do(n,e,t);break e}Li(n,e,i,t)}e=e.child}return e;case 5:return X2(e),n===null&&Mx(e),i=e.type,r=e.pendingProps,s=n!==null?n.memoizedProps:null,o=r.children,Ex(i,r)?o=null:s!==null&&Ex(i,s)&&(e.flags|=32),mP(n,e),Li(n,e,o,t),e.child;case 6:return n===null&&Mx(e),null;case 13:return _P(n,e,t);case 4:return OS(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=Ic(e,null,i,t):Li(n,e,i,t),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Qr(i,r),dw(n,e,i,r,t);case 7:return Li(n,e,e.pendingProps,t),e.child;case 8:return Li(n,e,e.pendingProps.children,t),e.child;case 12:return Li(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,Qt(mg,i._currentValue),i._currentValue=o,s!==null)if(cs(s.value,o)){if(s.children===r.children&&!$i.current){e=Do(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Ao(-1,t&-t),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),Cx(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(xe(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),Cx(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Li(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,gc(e,t),r=Br(r),i=i(r),e.flags|=1,Li(n,e,i,t),e.child;case 14:return i=e.type,r=Qr(i,e.pendingProps),r=Qr(i.type,r),fw(n,e,i,r,t);case 15:return fP(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Qr(i,r),Bm(n,e),e.tag=1,Yi(i)?(n=!0,dg(e)):n=!1,gc(e,t),H2(e,i,r),Px(e,i,r,t),Dx(null,e,i,!0,n,t);case 19:return vP(n,e,t);case 22:return pP(n,e,t)}throw Error(xe(156,e.tag))};function NP(n,e){return o2(n,e)}function bU(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dr(n,e,t,i){return new bU(n,e,t,i)}function QS(n){return n=n.prototype,!(!n||!n.isReactComponent)}function wU(n){if(typeof n=="function")return QS(n)?1:0;if(n!=null){if(n=n.$$typeof,n===_S)return 11;if(n===vS)return 14}return 2}function Aa(n,e){var t=n.alternate;return t===null?(t=Dr(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Gm(n,e,t,i,r,s){var o=2;if(i=n,typeof n=="function")QS(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Zu:return Rl(t.children,r,s,e);case gS:o=8,r|=8;break;case ex:return n=Dr(12,t,e,r|2),n.elementType=ex,n.lanes=s,n;case tx:return n=Dr(13,t,e,r),n.elementType=tx,n.lanes=s,n;case nx:return n=Dr(19,t,e,r),n.elementType=nx,n.lanes=s,n;case VR:return f0(t,r,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case GR:o=10;break e;case HR:o=9;break e;case _S:o=11;break e;case vS:o=14;break e;case sa:o=16,i=null;break e}throw Error(xe(130,n==null?n:typeof n,""))}return e=Dr(o,t,e,r),e.elementType=n,e.type=i,e.lanes=s,e}function Rl(n,e,t,i){return n=Dr(7,n,i,e),n.lanes=t,n}function f0(n,e,t,i){return n=Dr(22,n,i,e),n.elementType=VR,n.lanes=t,n.stateNode={isHidden:!1},n}function xv(n,e,t){return n=Dr(6,n,null,e),n.lanes=t,n}function Sv(n,e,t){return e=Dr(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function AU(n,e,t,i,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tv(0),this.expirationTimes=tv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tv(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function JS(n,e,t,i,r,s,o,a,l){return n=new AU(n,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Dr(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},FS(s),n}function MU(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ku,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function UP(n){if(!n)return La;n=n._reactInternals;e:{if(Kl(n)!==n||n.tag!==1)throw Error(xe(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Yi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(xe(171))}if(n.tag===1){var t=n.type;if(Yi(t))return N2(n,t,e)}return e}function FP(n,e,t,i,r,s,o,a,l){return n=JS(t,i,!0,n,r,s,o,a,l),n.context=UP(null),t=n.current,i=Ui(),r=wa(t),s=Ao(i,r),s.callback=e??null,Ta(t,s,r),n.current.lanes=r,rf(n,r,i),qi(n,i),n}function p0(n,e,t,i){var r=e.current,s=Ui(),o=wa(r);return t=UP(t),e.context===null?e.context=t:e.pendingContext=t,e=Ao(s,o),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=Ta(r,e,o),n!==null&&(os(n,r,o,s),Um(n,r,o)),o}function wg(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function ww(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function eE(n,e){ww(n,e),(n=n.alternate)&&ww(n,e)}function CU(){return null}var OP=typeof reportError=="function"?reportError:function(n){console.error(n)};function tE(n){this._internalRoot=n}m0.prototype.render=tE.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(xe(409));p0(n,e,null,null)};m0.prototype.unmount=tE.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Hl(function(){p0(null,n,null,null)}),e[Io]=null}};function m0(n){this._internalRoot=n}m0.prototype.unstable_scheduleHydration=function(n){if(n){var e=f2();n={blockedOn:null,target:n,priority:e};for(var t=0;t<ca.length&&e!==0&&e<ca[t].priority;t++);ca.splice(t,0,n),t===0&&m2(n)}};function nE(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function g0(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Aw(){}function RU(n,e,t,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var u=wg(o);s.call(u)}}var o=FP(e,i,n,0,null,!1,!1,"",Aw);return n._reactRootContainer=o,n[Io]=o.current,Fd(n.nodeType===8?n.parentNode:n),Hl(),o}for(;r=n.lastChild;)n.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var u=wg(l);a.call(u)}}var l=JS(n,0,!1,null,null,!1,!1,"",Aw);return n._reactRootContainer=l,n[Io]=l.current,Fd(n.nodeType===8?n.parentNode:n),Hl(function(){p0(e,l,t,i)}),l}function _0(n,e,t,i,r){var s=t._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=wg(o);a.call(l)}}p0(e,o,n,r)}else o=RU(t,e,n,r,i);return wg(o)}h2=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=qh(e.pendingLanes);t!==0&&(SS(e,t|1),qi(e,Rn()),!(kt&6)&&(Nc=Rn()+500,ka()))}break;case 13:Hl(function(){var i=Lo(n,1);if(i!==null){var r=Ui();os(i,n,1,r)}}),eE(n,1)}};ES=function(n){if(n.tag===13){var e=Lo(n,134217728);if(e!==null){var t=Ui();os(e,n,134217728,t)}eE(n,134217728)}};d2=function(n){if(n.tag===13){var e=wa(n),t=Lo(n,e);if(t!==null){var i=Ui();os(t,n,e,i)}eE(n,e)}};f2=function(){return $t};p2=function(n,e){var t=$t;try{return $t=n,e()}finally{$t=t}};dx=function(n,e,t){switch(e){case"input":if(sx(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var r=a0(i);if(!r)throw Error(xe(90));XR(i),sx(i,r)}}}break;case"textarea":$R(n,t);break;case"select":e=t.value,e!=null&&dc(n,!!t.multiple,e,!1)}};e2=qS;t2=Hl;var PU={usingClientEntryPoint:!1,Events:[of,tc,a0,QR,JR,qS]},Lh={findFiberByHostInstance:Sl,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},IU={bundleType:Lh.bundleType,version:Lh.version,rendererPackageName:Lh.rendererPackageName,rendererConfig:Lh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Oo.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=r2(n),n===null?null:n.stateNode},findFiberByHostInstance:Lh.findFiberByHostInstance||CU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sp.isDisabled&&Sp.supportsFiber)try{i0=Sp.inject(IU),ks=Sp}catch{}}dr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=PU;dr.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nE(e))throw Error(xe(200));return MU(n,e,null,t)};dr.createRoot=function(n,e){if(!nE(n))throw Error(xe(299));var t=!1,i="",r=OP;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=JS(n,1,!1,null,null,t,!1,i,r),n[Io]=e.current,Fd(n.nodeType===8?n.parentNode:n),new tE(e)};dr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(xe(188)):(n=Object.keys(n).join(","),Error(xe(268,n)));return n=r2(e),n=n===null?null:n.stateNode,n};dr.flushSync=function(n){return Hl(n)};dr.hydrate=function(n,e,t){if(!g0(e))throw Error(xe(200));return _0(null,n,e,!0,t)};dr.hydrateRoot=function(n,e,t){if(!nE(n))throw Error(xe(405));var i=t!=null&&t.hydratedSources||null,r=!1,s="",o=OP;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=FP(e,null,n,1,t??null,r,!1,s,o),n[Io]=e.current,Fd(n),i)for(n=0;n<i.length;n++)t=i[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new m0(e)};dr.render=function(n,e,t){if(!g0(e))throw Error(xe(200));return _0(null,n,e,!1,t)};dr.unmountComponentAtNode=function(n){if(!g0(n))throw Error(xe(40));return n._reactRootContainer?(Hl(function(){_0(null,null,n,!1,function(){n._reactRootContainer=null,n[Io]=null})}),!0):!1};dr.unstable_batchedUpdates=qS;dr.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!g0(t))throw Error(xe(200));if(n==null||n._reactInternals===void 0)throw Error(xe(38));return _0(n,e,t,!1,i)};dr.version="18.2.0-next-9e3b772b8-20220608";function BP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(BP)}catch(n){console.error(n)}}BP(),FR.exports=dr;var LU=FR.exports,Mw=LU;Qy.createRoot=Mw.createRoot,Qy.hydrateRoot=Mw.hydrateRoot;/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const iE="159",DU=0,Cw=1,NU=2,kP=1,UU=2,ho=3,No=0,Ki=1,Us=2,Ma=0,vc=1,Rw=2,Pw=3,Iw=4,FU=5,gl=100,OU=101,BU=102,Lw=103,Dw=104,kU=200,zU=201,GU=202,HU=203,Xx=204,jx=205,VU=206,WU=207,XU=208,jU=209,$U=210,YU=211,qU=212,KU=213,ZU=214,QU=0,JU=1,eF=2,Ag=3,tF=4,nF=5,iF=6,rF=7,zP=0,sF=1,oF=2,Ca=0,aF=1,lF=2,uF=3,cF=4,hF=5,Nw="attached",dF="detached",GP=300,Uc=301,Fc=302,$x=303,Yx=304,v0=306,Oc=1e3,Pr=1001,Mg=1002,ti=1003,qx=1004,Hm=1005,Wi=1006,HP=1007,Vl=1008,Ra=1009,fF=1010,pF=1011,rE=1012,VP=1013,ma=1014,So=1015,Xd=1016,WP=1017,XP=1018,Pl=1020,mF=1021,Ir=1023,gF=1024,_F=1025,Il=1026,Bc=1027,vF=1028,jP=1029,yF=1030,$P=1031,YP=1033,Ev=33776,Tv=33777,bv=33778,wv=33779,Uw=35840,Fw=35841,Ow=35842,Bw=35843,qP=36196,kw=37492,zw=37496,Gw=37808,Hw=37809,Vw=37810,Ww=37811,Xw=37812,jw=37813,$w=37814,Yw=37815,qw=37816,Kw=37817,Zw=37818,Qw=37819,Jw=37820,eA=37821,Av=36492,tA=36494,nA=36495,xF=36283,iA=36284,rA=36285,sA=36286,jd=2300,kc=2301,Mv=2302,oA=2400,aA=2401,lA=2402,SF=2500,EF=0,KP=1,Kx=2,ZP=3e3,Ll=3001,TF=3200,bF=3201,QP=0,wF=1,Lr="",Tn="srgb",mi="srgb-linear",sE="display-p3",y0="display-p3-linear",Cg="linear",rn="srgb",Rg="rec709",Pg="p3",yu=7680,uA=519,AF=512,MF=513,CF=514,JP=515,RF=516,PF=517,IF=518,LF=519,Zx=35044,cA="300 es",Qx=1035,Eo=2e3,Ig=2001;class Qc{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Si=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let hA=1234567;const _d=Math.PI/180,zc=180/Math.PI;function as(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Si[n&255]+Si[n>>8&255]+Si[n>>16&255]+Si[n>>24&255]+"-"+Si[e&255]+Si[e>>8&255]+"-"+Si[e>>16&15|64]+Si[e>>24&255]+"-"+Si[t&63|128]+Si[t>>8&255]+"-"+Si[t>>16&255]+Si[t>>24&255]+Si[i&255]+Si[i>>8&255]+Si[i>>16&255]+Si[i>>24&255]).toLowerCase()}function wi(n,e,t){return Math.max(e,Math.min(t,n))}function oE(n,e){return(n%e+e)%e}function DF(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function NF(n,e,t){return n!==e?(t-n)/(e-n):0}function vd(n,e,t){return(1-t)*n+t*e}function UF(n,e,t,i){return vd(n,e,1-Math.exp(-t*i))}function FF(n,e=1){return e-Math.abs(oE(n,e*2)-e)}function OF(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function BF(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function kF(n,e){return n+Math.floor(Math.random()*(e-n+1))}function zF(n,e){return n+Math.random()*(e-n)}function GF(n){return n*(.5-Math.random())}function HF(n){n!==void 0&&(hA=n);let e=hA+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function VF(n){return n*_d}function WF(n){return n*zc}function Jx(n){return(n&n-1)===0&&n!==0}function XF(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Lg(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function jF(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),u=s((e+i)/2),d=o((e+i)/2),f=s((e-i)/2),p=o((e-i)/2),m=s((i-e)/2),v=o((i-e)/2);switch(r){case"XYX":n.set(a*d,l*f,l*p,a*u);break;case"YZY":n.set(l*p,a*d,l*f,a*u);break;case"ZXZ":n.set(l*f,l*p,a*d,a*u);break;case"XZX":n.set(a*d,l*v,l*m,a*u);break;case"YXY":n.set(l*m,a*d,l*v,a*u);break;case"ZYZ":n.set(l*v,l*m,a*d,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Fs(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function qt(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const $F={DEG2RAD:_d,RAD2DEG:zc,generateUUID:as,clamp:wi,euclideanModulo:oE,mapLinear:DF,inverseLerp:NF,lerp:vd,damp:UF,pingpong:FF,smoothstep:OF,smootherstep:BF,randInt:kF,randFloat:zF,randFloatSpread:GF,seededRandom:HF,degToRad:VF,radToDeg:WF,isPowerOfTwo:Jx,ceilPowerOfTwo:XF,floorPowerOfTwo:Lg,setQuaternionFromProperEuler:jF,normalize:qt,denormalize:Fs};class Ut{constructor(e=0,t=0){Ut.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(wi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class At{constructor(e,t,i,r,s,o,a,l,u){At.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,u)}set(e,t,i,r,s,o,a,l,u){const d=this.elements;return d[0]=e,d[1]=r,d[2]=a,d[3]=t,d[4]=s,d[5]=l,d[6]=i,d[7]=o,d[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],u=i[1],d=i[4],f=i[7],p=i[2],m=i[5],v=i[8],x=r[0],y=r[3],g=r[6],T=r[1],S=r[4],w=r[7],M=r[2],R=r[5],P=r[8];return s[0]=o*x+a*T+l*M,s[3]=o*y+a*S+l*R,s[6]=o*g+a*w+l*P,s[1]=u*x+d*T+f*M,s[4]=u*y+d*S+f*R,s[7]=u*g+d*w+f*P,s[2]=p*x+m*T+v*M,s[5]=p*y+m*S+v*R,s[8]=p*g+m*w+v*P,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],d=e[8];return t*o*d-t*a*u-i*s*d+i*a*l+r*s*u-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],d=e[8],f=d*o-a*u,p=a*l-d*s,m=u*s-o*l,v=t*f+i*p+r*m;if(v===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/v;return e[0]=f*x,e[1]=(r*u-d*i)*x,e[2]=(a*i-r*o)*x,e[3]=p*x,e[4]=(d*t-r*l)*x,e[5]=(r*s-a*t)*x,e[6]=m*x,e[7]=(i*l-u*t)*x,e[8]=(o*t-i*s)*x,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),u=Math.sin(s);return this.set(i*l,i*u,-i*(l*o+u*a)+o+e,-r*u,r*l,-r*(-u*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(Cv.makeScale(e,t)),this}rotate(e){return this.premultiply(Cv.makeRotation(-e)),this}translate(e,t){return this.premultiply(Cv.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Cv=new At;function eI(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function $d(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function YF(){const n=$d("canvas");return n.style.display="block",n}const dA={};function yd(n){n in dA||(dA[n]=!0,console.warn(n))}const fA=new At().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),pA=new At().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Ep={[mi]:{transfer:Cg,primaries:Rg,toReference:n=>n,fromReference:n=>n},[Tn]:{transfer:rn,primaries:Rg,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[y0]:{transfer:Cg,primaries:Pg,toReference:n=>n.applyMatrix3(pA),fromReference:n=>n.applyMatrix3(fA)},[sE]:{transfer:rn,primaries:Pg,toReference:n=>n.convertSRGBToLinear().applyMatrix3(pA),fromReference:n=>n.applyMatrix3(fA).convertLinearToSRGB()}},qF=new Set([mi,y0]),Xt={enabled:!0,_workingColorSpace:mi,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!qF.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const i=Ep[e].toReference,r=Ep[t].fromReference;return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return Ep[n].primaries},getTransfer:function(n){return n===Lr?Cg:Ep[n].transfer}};function yc(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Rv(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let xu;class tI{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{xu===void 0&&(xu=$d("canvas")),xu.width=e.width,xu.height=e.height;const i=xu.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=xu}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=$d("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=yc(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(yc(t[i]/255)*255):t[i]=yc(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let KF=0;class nI{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:KF++}),this.uuid=as(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(Pv(r[o].image)):s.push(Pv(r[o]))}else s=Pv(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function Pv(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?tI.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let ZF=0,hr=class Vm extends Qc{constructor(e=Vm.DEFAULT_IMAGE,t=Vm.DEFAULT_MAPPING,i=Pr,r=Pr,s=Wi,o=Vl,a=Ir,l=Ra,u=Vm.DEFAULT_ANISOTROPY,d=Lr){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:ZF++}),this.uuid=as(),this.name="",this.source=new nI(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Ut(0,0),this.repeat=new Ut(1,1),this.center=new Ut(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new At,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof d=="string"?this.colorSpace=d:(yd("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=d===Ll?Tn:Lr),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==GP)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Oc:e.x=e.x-Math.floor(e.x);break;case Pr:e.x=e.x<0?0:1;break;case Mg:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Oc:e.y=e.y-Math.floor(e.y);break;case Pr:e.y=e.y<0?0:1;break;case Mg:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return yd("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Tn?Ll:ZP}set encoding(e){yd("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===Ll?Tn:Lr}};hr.DEFAULT_IMAGE=null;hr.DEFAULT_MAPPING=GP;hr.DEFAULT_ANISOTROPY=1;class Zt{constructor(e=0,t=0,i=0,r=1){Zt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,u=l[0],d=l[4],f=l[8],p=l[1],m=l[5],v=l[9],x=l[2],y=l[6],g=l[10];if(Math.abs(d-p)<.01&&Math.abs(f-x)<.01&&Math.abs(v-y)<.01){if(Math.abs(d+p)<.1&&Math.abs(f+x)<.1&&Math.abs(v+y)<.1&&Math.abs(u+m+g-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const S=(u+1)/2,w=(m+1)/2,M=(g+1)/2,R=(d+p)/4,P=(f+x)/4,N=(v+y)/4;return S>w&&S>M?S<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(S),r=R/i,s=P/i):w>M?w<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(w),i=R/r,s=N/r):M<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(M),i=P/s,r=N/s),this.set(i,r,s,t),this}let T=Math.sqrt((y-v)*(y-v)+(f-x)*(f-x)+(p-d)*(p-d));return Math.abs(T)<.001&&(T=1),this.x=(y-v)/T,this.y=(f-x)/T,this.z=(p-d)/T,this.w=Math.acos((u+m+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class QF extends Qc{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Zt(0,0,e,t),this.scissorTest=!1,this.viewport=new Zt(0,0,e,t);const r={width:e,height:t,depth:1};i.encoding!==void 0&&(yd("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Ll?Tn:Lr),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Wi,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new hr(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new nI(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Wl extends QF{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class iI extends hr{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=ti,this.minFilter=ti,this.wrapR=Pr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class JF extends hr{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=ti,this.minFilter=ti,this.wrapR=Pr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class za{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],u=i[r+1],d=i[r+2],f=i[r+3];const p=s[o+0],m=s[o+1],v=s[o+2],x=s[o+3];if(a===0){e[t+0]=l,e[t+1]=u,e[t+2]=d,e[t+3]=f;return}if(a===1){e[t+0]=p,e[t+1]=m,e[t+2]=v,e[t+3]=x;return}if(f!==x||l!==p||u!==m||d!==v){let y=1-a;const g=l*p+u*m+d*v+f*x,T=g>=0?1:-1,S=1-g*g;if(S>Number.EPSILON){const M=Math.sqrt(S),R=Math.atan2(M,g*T);y=Math.sin(y*R)/M,a=Math.sin(a*R)/M}const w=a*T;if(l=l*y+p*w,u=u*y+m*w,d=d*y+v*w,f=f*y+x*w,y===1-a){const M=1/Math.sqrt(l*l+u*u+d*d+f*f);l*=M,u*=M,d*=M,f*=M}}e[t]=l,e[t+1]=u,e[t+2]=d,e[t+3]=f}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],u=i[r+2],d=i[r+3],f=s[o],p=s[o+1],m=s[o+2],v=s[o+3];return e[t]=a*v+d*f+l*m-u*p,e[t+1]=l*v+d*p+u*f-a*m,e[t+2]=u*v+d*m+a*p-l*f,e[t+3]=d*v-a*f-l*p-u*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,u=a(i/2),d=a(r/2),f=a(s/2),p=l(i/2),m=l(r/2),v=l(s/2);switch(o){case"XYZ":this._x=p*d*f+u*m*v,this._y=u*m*f-p*d*v,this._z=u*d*v+p*m*f,this._w=u*d*f-p*m*v;break;case"YXZ":this._x=p*d*f+u*m*v,this._y=u*m*f-p*d*v,this._z=u*d*v-p*m*f,this._w=u*d*f+p*m*v;break;case"ZXY":this._x=p*d*f-u*m*v,this._y=u*m*f+p*d*v,this._z=u*d*v+p*m*f,this._w=u*d*f-p*m*v;break;case"ZYX":this._x=p*d*f-u*m*v,this._y=u*m*f+p*d*v,this._z=u*d*v-p*m*f,this._w=u*d*f+p*m*v;break;case"YZX":this._x=p*d*f+u*m*v,this._y=u*m*f+p*d*v,this._z=u*d*v-p*m*f,this._w=u*d*f-p*m*v;break;case"XZY":this._x=p*d*f-u*m*v,this._y=u*m*f-p*d*v,this._z=u*d*v+p*m*f,this._w=u*d*f+p*m*v;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],u=t[2],d=t[6],f=t[10],p=i+a+f;if(p>0){const m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(d-l)*m,this._y=(s-u)*m,this._z=(o-r)*m}else if(i>a&&i>f){const m=2*Math.sqrt(1+i-a-f);this._w=(d-l)/m,this._x=.25*m,this._y=(r+o)/m,this._z=(s+u)/m}else if(a>f){const m=2*Math.sqrt(1+a-i-f);this._w=(s-u)/m,this._x=(r+o)/m,this._y=.25*m,this._z=(l+d)/m}else{const m=2*Math.sqrt(1+f-i-a);this._w=(o-r)/m,this._x=(s+u)/m,this._y=(l+d)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(wi(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,u=t._z,d=t._w;return this._x=i*d+o*a+r*u-s*l,this._y=r*d+o*l+s*a-i*u,this._z=s*d+o*u+i*l-r*a,this._w=o*d-i*a-r*l-s*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-t;return this._w=m*o+t*this._w,this._x=m*i+t*this._x,this._y=m*r+t*this._y,this._z=m*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(l),d=Math.atan2(u,a),f=Math.sin((1-t)*d)/u,p=Math.sin(t*d)/u;return this._w=o*f+this._w*p,this._x=i*f+this._x*p,this._y=r*f+this._y*p,this._z=s*f+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Y{constructor(e=0,t=0,i=0){Y.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(mA.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(mA.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,u=2*(o*r-a*i),d=2*(a*t-s*r),f=2*(s*i-o*t);return this.x=t+l*u+o*f-a*d,this.y=i+l*d+a*u-s*f,this.z=r+l*f+s*d-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return Iv.copy(this).projectOnVector(e),this.sub(Iv)}reflect(e){return this.sub(Iv.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(wi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Iv=new Y,mA=new za;class Bo{constructor(e=new Y(1/0,1/0,1/0),t=new Y(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Xr.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Xr.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Xr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Xr):Xr.fromBufferAttribute(s,o),Xr.applyMatrix4(e.matrixWorld),this.expandByPoint(Xr);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Tp.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),Tp.copy(i.boundingBox)),Tp.applyMatrix4(e.matrixWorld),this.union(Tp)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Xr),Xr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Dh),bp.subVectors(this.max,Dh),Su.subVectors(e.a,Dh),Eu.subVectors(e.b,Dh),Tu.subVectors(e.c,Dh),Ko.subVectors(Eu,Su),Zo.subVectors(Tu,Eu),Qa.subVectors(Su,Tu);let t=[0,-Ko.z,Ko.y,0,-Zo.z,Zo.y,0,-Qa.z,Qa.y,Ko.z,0,-Ko.x,Zo.z,0,-Zo.x,Qa.z,0,-Qa.x,-Ko.y,Ko.x,0,-Zo.y,Zo.x,0,-Qa.y,Qa.x,0];return!Lv(t,Su,Eu,Tu,bp)||(t=[1,0,0,0,1,0,0,0,1],!Lv(t,Su,Eu,Tu,bp))?!1:(wp.crossVectors(Ko,Zo),t=[wp.x,wp.y,wp.z],Lv(t,Su,Eu,Tu,bp))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Xr).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Xr).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(io[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),io[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),io[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),io[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),io[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),io[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),io[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),io[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(io),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const io=[new Y,new Y,new Y,new Y,new Y,new Y,new Y,new Y],Xr=new Y,Tp=new Bo,Su=new Y,Eu=new Y,Tu=new Y,Ko=new Y,Zo=new Y,Qa=new Y,Dh=new Y,bp=new Y,wp=new Y,Ja=new Y;function Lv(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Ja.fromArray(n,s);const a=r.x*Math.abs(Ja.x)+r.y*Math.abs(Ja.y)+r.z*Math.abs(Ja.z),l=e.dot(Ja),u=t.dot(Ja),d=i.dot(Ja);if(Math.max(-Math.max(l,u,d),Math.min(l,u,d))>a)return!1}return!0}const eO=new Bo,Nh=new Y,Dv=new Y;class $s{constructor(e=new Y,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):eO.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Nh.subVectors(e,this.center);const t=Nh.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector(Nh,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Dv.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Nh.copy(e.center).add(Dv)),this.expandByPoint(Nh.copy(e.center).sub(Dv))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const ro=new Y,Nv=new Y,Ap=new Y,Qo=new Y,Uv=new Y,Mp=new Y,Fv=new Y;class x0{constructor(e=new Y,t=new Y(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ro)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ro.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ro.copy(this.origin).addScaledVector(this.direction,t),ro.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){Nv.copy(e).add(t).multiplyScalar(.5),Ap.copy(t).sub(e).normalize(),Qo.copy(this.origin).sub(Nv);const s=e.distanceTo(t)*.5,o=-this.direction.dot(Ap),a=Qo.dot(this.direction),l=-Qo.dot(Ap),u=Qo.lengthSq(),d=Math.abs(1-o*o);let f,p,m,v;if(d>0)if(f=o*l-a,p=o*a-l,v=s*d,f>=0)if(p>=-v)if(p<=v){const x=1/d;f*=x,p*=x,m=f*(f+o*p+2*a)+p*(o*f+p+2*l)+u}else p=s,f=Math.max(0,-(o*p+a)),m=-f*f+p*(p+2*l)+u;else p=-s,f=Math.max(0,-(o*p+a)),m=-f*f+p*(p+2*l)+u;else p<=-v?(f=Math.max(0,-(-o*s+a)),p=f>0?-s:Math.min(Math.max(-s,-l),s),m=-f*f+p*(p+2*l)+u):p<=v?(f=0,p=Math.min(Math.max(-s,-l),s),m=p*(p+2*l)+u):(f=Math.max(0,-(o*s+a)),p=f>0?s:Math.min(Math.max(-s,-l),s),m=-f*f+p*(p+2*l)+u);else p=o>0?-s:s,f=Math.max(0,-(o*p+a)),m=-f*f+p*(p+2*l)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,f),r&&r.copy(Nv).addScaledVector(Ap,p),m}intersectSphere(e,t){ro.subVectors(e.center,this.origin);const i=ro.dot(this.direction),r=ro.dot(ro)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const u=1/this.direction.x,d=1/this.direction.y,f=1/this.direction.z,p=this.origin;return u>=0?(i=(e.min.x-p.x)*u,r=(e.max.x-p.x)*u):(i=(e.max.x-p.x)*u,r=(e.min.x-p.x)*u),d>=0?(s=(e.min.y-p.y)*d,o=(e.max.y-p.y)*d):(s=(e.max.y-p.y)*d,o=(e.min.y-p.y)*d),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),f>=0?(a=(e.min.z-p.z)*f,l=(e.max.z-p.z)*f):(a=(e.max.z-p.z)*f,l=(e.min.z-p.z)*f),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,ro)!==null}intersectTriangle(e,t,i,r,s){Uv.subVectors(t,e),Mp.subVectors(i,e),Fv.crossVectors(Uv,Mp);let o=this.direction.dot(Fv),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Qo.subVectors(this.origin,e);const l=a*this.direction.dot(Mp.crossVectors(Qo,Mp));if(l<0)return null;const u=a*this.direction.dot(Uv.cross(Qo));if(u<0||l+u>o)return null;const d=-a*Qo.dot(Fv);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Mt{constructor(e,t,i,r,s,o,a,l,u,d,f,p,m,v,x,y){Mt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,u,d,f,p,m,v,x,y)}set(e,t,i,r,s,o,a,l,u,d,f,p,m,v,x,y){const g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=r,g[1]=s,g[5]=o,g[9]=a,g[13]=l,g[2]=u,g[6]=d,g[10]=f,g[14]=p,g[3]=m,g[7]=v,g[11]=x,g[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Mt().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/bu.setFromMatrixColumn(e,0).length(),s=1/bu.setFromMatrixColumn(e,1).length(),o=1/bu.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),u=Math.sin(r),d=Math.cos(s),f=Math.sin(s);if(e.order==="XYZ"){const p=o*d,m=o*f,v=a*d,x=a*f;t[0]=l*d,t[4]=-l*f,t[8]=u,t[1]=m+v*u,t[5]=p-x*u,t[9]=-a*l,t[2]=x-p*u,t[6]=v+m*u,t[10]=o*l}else if(e.order==="YXZ"){const p=l*d,m=l*f,v=u*d,x=u*f;t[0]=p+x*a,t[4]=v*a-m,t[8]=o*u,t[1]=o*f,t[5]=o*d,t[9]=-a,t[2]=m*a-v,t[6]=x+p*a,t[10]=o*l}else if(e.order==="ZXY"){const p=l*d,m=l*f,v=u*d,x=u*f;t[0]=p-x*a,t[4]=-o*f,t[8]=v+m*a,t[1]=m+v*a,t[5]=o*d,t[9]=x-p*a,t[2]=-o*u,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const p=o*d,m=o*f,v=a*d,x=a*f;t[0]=l*d,t[4]=v*u-m,t[8]=p*u+x,t[1]=l*f,t[5]=x*u+p,t[9]=m*u-v,t[2]=-u,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const p=o*l,m=o*u,v=a*l,x=a*u;t[0]=l*d,t[4]=x-p*f,t[8]=v*f+m,t[1]=f,t[5]=o*d,t[9]=-a*d,t[2]=-u*d,t[6]=m*f+v,t[10]=p-x*f}else if(e.order==="XZY"){const p=o*l,m=o*u,v=a*l,x=a*u;t[0]=l*d,t[4]=-f,t[8]=u*d,t[1]=p*f+x,t[5]=o*d,t[9]=m*f-v,t[2]=v*f-m,t[6]=a*d,t[10]=x*f+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(tO,e,nO)}lookAt(e,t,i){const r=this.elements;return nr.subVectors(e,t),nr.lengthSq()===0&&(nr.z=1),nr.normalize(),Jo.crossVectors(i,nr),Jo.lengthSq()===0&&(Math.abs(i.z)===1?nr.x+=1e-4:nr.z+=1e-4,nr.normalize(),Jo.crossVectors(i,nr)),Jo.normalize(),Cp.crossVectors(nr,Jo),r[0]=Jo.x,r[4]=Cp.x,r[8]=nr.x,r[1]=Jo.y,r[5]=Cp.y,r[9]=nr.y,r[2]=Jo.z,r[6]=Cp.z,r[10]=nr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],u=i[12],d=i[1],f=i[5],p=i[9],m=i[13],v=i[2],x=i[6],y=i[10],g=i[14],T=i[3],S=i[7],w=i[11],M=i[15],R=r[0],P=r[4],N=r[8],C=r[12],L=r[1],Q=r[5],W=r[9],z=r[13],F=r[2],X=r[6],Z=r[10],$=r[14],O=r[3],H=r[7],B=r[11],G=r[15];return s[0]=o*R+a*L+l*F+u*O,s[4]=o*P+a*Q+l*X+u*H,s[8]=o*N+a*W+l*Z+u*B,s[12]=o*C+a*z+l*$+u*G,s[1]=d*R+f*L+p*F+m*O,s[5]=d*P+f*Q+p*X+m*H,s[9]=d*N+f*W+p*Z+m*B,s[13]=d*C+f*z+p*$+m*G,s[2]=v*R+x*L+y*F+g*O,s[6]=v*P+x*Q+y*X+g*H,s[10]=v*N+x*W+y*Z+g*B,s[14]=v*C+x*z+y*$+g*G,s[3]=T*R+S*L+w*F+M*O,s[7]=T*P+S*Q+w*X+M*H,s[11]=T*N+S*W+w*Z+M*B,s[15]=T*C+S*z+w*$+M*G,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],u=e[13],d=e[2],f=e[6],p=e[10],m=e[14],v=e[3],x=e[7],y=e[11],g=e[15];return v*(+s*l*f-r*u*f-s*a*p+i*u*p+r*a*m-i*l*m)+x*(+t*l*m-t*u*p+s*o*p-r*o*m+r*u*d-s*l*d)+y*(+t*u*f-t*a*m-s*o*f+i*o*m+s*a*d-i*u*d)+g*(-r*a*d-t*l*f+t*a*p+r*o*f-i*o*p+i*l*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],d=e[8],f=e[9],p=e[10],m=e[11],v=e[12],x=e[13],y=e[14],g=e[15],T=f*y*u-x*p*u+x*l*m-a*y*m-f*l*g+a*p*g,S=v*p*u-d*y*u-v*l*m+o*y*m+d*l*g-o*p*g,w=d*x*u-v*f*u+v*a*m-o*x*m-d*a*g+o*f*g,M=v*f*l-d*x*l-v*a*p+o*x*p+d*a*y-o*f*y,R=t*T+i*S+r*w+s*M;if(R===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const P=1/R;return e[0]=T*P,e[1]=(x*p*s-f*y*s-x*r*m+i*y*m+f*r*g-i*p*g)*P,e[2]=(a*y*s-x*l*s+x*r*u-i*y*u-a*r*g+i*l*g)*P,e[3]=(f*l*s-a*p*s-f*r*u+i*p*u+a*r*m-i*l*m)*P,e[4]=S*P,e[5]=(d*y*s-v*p*s+v*r*m-t*y*m-d*r*g+t*p*g)*P,e[6]=(v*l*s-o*y*s-v*r*u+t*y*u+o*r*g-t*l*g)*P,e[7]=(o*p*s-d*l*s+d*r*u-t*p*u-o*r*m+t*l*m)*P,e[8]=w*P,e[9]=(v*f*s-d*x*s-v*i*m+t*x*m+d*i*g-t*f*g)*P,e[10]=(o*x*s-v*a*s+v*i*u-t*x*u-o*i*g+t*a*g)*P,e[11]=(d*a*s-o*f*s-d*i*u+t*f*u+o*i*m-t*a*m)*P,e[12]=M*P,e[13]=(d*x*r-v*f*r+v*i*p-t*x*p-d*i*y+t*f*y)*P,e[14]=(v*a*r-o*x*r-v*i*l+t*x*l+o*i*y-t*a*y)*P,e[15]=(o*f*r-d*a*r+d*i*l-t*f*l-o*i*p+t*a*p)*P,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,u=s*o,d=s*a;return this.set(u*o+i,u*a-r*l,u*l+r*a,0,u*a+r*l,d*a+i,d*l-r*o,0,u*l-r*a,d*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,u=s+s,d=o+o,f=a+a,p=s*u,m=s*d,v=s*f,x=o*d,y=o*f,g=a*f,T=l*u,S=l*d,w=l*f,M=i.x,R=i.y,P=i.z;return r[0]=(1-(x+g))*M,r[1]=(m+w)*M,r[2]=(v-S)*M,r[3]=0,r[4]=(m-w)*R,r[5]=(1-(p+g))*R,r[6]=(y+T)*R,r[7]=0,r[8]=(v+S)*P,r[9]=(y-T)*P,r[10]=(1-(p+x))*P,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=bu.set(r[0],r[1],r[2]).length();const o=bu.set(r[4],r[5],r[6]).length(),a=bu.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],jr.copy(this);const u=1/s,d=1/o,f=1/a;return jr.elements[0]*=u,jr.elements[1]*=u,jr.elements[2]*=u,jr.elements[4]*=d,jr.elements[5]*=d,jr.elements[6]*=d,jr.elements[8]*=f,jr.elements[9]*=f,jr.elements[10]*=f,t.setFromRotationMatrix(jr),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=Eo){const l=this.elements,u=2*s/(t-e),d=2*s/(i-r),f=(t+e)/(t-e),p=(i+r)/(i-r);let m,v;if(a===Eo)m=-(o+s)/(o-s),v=-2*o*s/(o-s);else if(a===Ig)m=-o/(o-s),v=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=d,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=v,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=Eo){const l=this.elements,u=1/(t-e),d=1/(i-r),f=1/(o-s),p=(t+e)*u,m=(i+r)*d;let v,x;if(a===Eo)v=(o+s)*f,x=-2*f;else if(a===Ig)v=s*f,x=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*d,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=x,l[14]=-v,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const bu=new Y,jr=new Mt,tO=new Y(0,0,0),nO=new Y(1,1,1),Jo=new Y,Cp=new Y,nr=new Y,gA=new Mt,_A=new za;class S0{constructor(e=0,t=0,i=0,r=S0.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],u=r[5],d=r[9],f=r[2],p=r[6],m=r[10];switch(t){case"XYZ":this._y=Math.asin(wi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-d,m),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(p,u),this._z=0);break;case"YXZ":this._x=Math.asin(-wi(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-f,s),this._z=0);break;case"ZXY":this._x=Math.asin(wi(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-f,m),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-wi(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(p,m),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(wi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-f,s)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-wi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(p,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-d,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return gA.makeRotationFromQuaternion(e),this.setFromRotationMatrix(gA,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return _A.setFromEuler(this),this.setFromQuaternion(_A,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}S0.DEFAULT_ORDER="XYZ";class rI{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let iO=0;const vA=new Y,wu=new za,so=new Mt,Rp=new Y,Uh=new Y,rO=new Y,sO=new za,yA=new Y(1,0,0),xA=new Y(0,1,0),SA=new Y(0,0,1),oO={type:"added"},aO={type:"removed"};class vn extends Qc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:iO++}),this.uuid=as(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=vn.DEFAULT_UP.clone();const e=new Y,t=new S0,i=new za,r=new Y(1,1,1);function s(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Mt},normalMatrix:{value:new At}}),this.matrix=new Mt,this.matrixWorld=new Mt,this.matrixAutoUpdate=vn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=vn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new rI,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return wu.setFromAxisAngle(e,t),this.quaternion.multiply(wu),this}rotateOnWorldAxis(e,t){return wu.setFromAxisAngle(e,t),this.quaternion.premultiply(wu),this}rotateX(e){return this.rotateOnAxis(yA,e)}rotateY(e){return this.rotateOnAxis(xA,e)}rotateZ(e){return this.rotateOnAxis(SA,e)}translateOnAxis(e,t){return vA.copy(e).applyQuaternion(this.quaternion),this.position.add(vA.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(yA,e)}translateY(e){return this.translateOnAxis(xA,e)}translateZ(e){return this.translateOnAxis(SA,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(so.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?Rp.copy(e):Rp.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),Uh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?so.lookAt(Uh,Rp,this.up):so.lookAt(Rp,Uh,this.up),this.quaternion.setFromRotationMatrix(so),r&&(so.extractRotation(r.matrixWorld),wu.setFromRotationMatrix(so),this.quaternion.premultiply(wu.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(oO)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(aO)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),so.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),so.multiply(e.parent.matrixWorld)),e.applyMatrix4(so),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Uh,e,rO),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Uh,sO,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++){const s=t[i];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),r.maxGeometryCount=this._maxGeometryCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,d=l.length;u<d;u++){const f=l[u];s(e.shapes,f)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),u=o(e.textures),d=o(e.images),f=o(e.shapes),p=o(e.skeletons),m=o(e.animations),v=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),u.length>0&&(i.textures=u),d.length>0&&(i.images=d),f.length>0&&(i.shapes=f),p.length>0&&(i.skeletons=p),m.length>0&&(i.animations=m),v.length>0&&(i.nodes=v)}return i.object=r,i;function o(a){const l=[];for(const u in a){const d=a[u];delete d.metadata,l.push(d)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}vn.DEFAULT_UP=new Y(0,1,0);vn.DEFAULT_MATRIX_AUTO_UPDATE=!0;vn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const $r=new Y,oo=new Y,Ov=new Y,ao=new Y,Au=new Y,Mu=new Y,EA=new Y,Bv=new Y,kv=new Y,zv=new Y;let Pp=!1;class ts{constructor(e=new Y,t=new Y,i=new Y){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),$r.subVectors(e,t),r.cross($r);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){$r.subVectors(r,t),oo.subVectors(i,t),Ov.subVectors(e,t);const o=$r.dot($r),a=$r.dot(oo),l=$r.dot(Ov),u=oo.dot(oo),d=oo.dot(Ov),f=o*u-a*a;if(f===0)return s.set(-2,-1,-1);const p=1/f,m=(u*l-a*d)*p,v=(o*d-a*l)*p;return s.set(1-m-v,v,m)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,ao),ao.x>=0&&ao.y>=0&&ao.x+ao.y<=1}static getUV(e,t,i,r,s,o,a,l){return Pp===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Pp=!0),this.getInterpolation(e,t,i,r,s,o,a,l)}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,ao),l.setScalar(0),l.addScaledVector(s,ao.x),l.addScaledVector(o,ao.y),l.addScaledVector(a,ao.z),l}static isFrontFacing(e,t,i,r){return $r.subVectors(i,t),oo.subVectors(e,t),$r.cross(oo).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return $r.subVectors(this.c,this.b),oo.subVectors(this.a,this.b),$r.cross(oo).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ts.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ts.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return Pp===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Pp=!0),ts.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return ts.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return ts.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ts.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Au.subVectors(r,i),Mu.subVectors(s,i),Bv.subVectors(e,i);const l=Au.dot(Bv),u=Mu.dot(Bv);if(l<=0&&u<=0)return t.copy(i);kv.subVectors(e,r);const d=Au.dot(kv),f=Mu.dot(kv);if(d>=0&&f<=d)return t.copy(r);const p=l*f-d*u;if(p<=0&&l>=0&&d<=0)return o=l/(l-d),t.copy(i).addScaledVector(Au,o);zv.subVectors(e,s);const m=Au.dot(zv),v=Mu.dot(zv);if(v>=0&&m<=v)return t.copy(s);const x=m*u-l*v;if(x<=0&&u>=0&&v<=0)return a=u/(u-v),t.copy(i).addScaledVector(Mu,a);const y=d*v-m*f;if(y<=0&&f-d>=0&&m-v>=0)return EA.subVectors(s,r),a=(f-d)/(f-d+(m-v)),t.copy(r).addScaledVector(EA,a);const g=1/(y+x+p);return o=x*g,a=p*g,t.copy(i).addScaledVector(Au,o).addScaledVector(Mu,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const sI={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ea={h:0,s:0,l:0},Ip={h:0,s:0,l:0};function Gv(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}let St=class{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Tn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Xt.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Xt.workingColorSpace){return this.r=e,this.g=t,this.b=i,Xt.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Xt.workingColorSpace){if(e=oE(e,1),t=wi(t,0,1),i=wi(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=Gv(o,s,e+1/3),this.g=Gv(o,s,e),this.b=Gv(o,s,e-1/3)}return Xt.toWorkingColorSpace(this,r),this}setStyle(e,t=Tn){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Tn){const i=sI[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=yc(e.r),this.g=yc(e.g),this.b=yc(e.b),this}copyLinearToSRGB(e){return this.r=Rv(e.r),this.g=Rv(e.g),this.b=Rv(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Tn){return Xt.fromWorkingColorSpace(Ei.copy(this),e),Math.round(wi(Ei.r*255,0,255))*65536+Math.round(wi(Ei.g*255,0,255))*256+Math.round(wi(Ei.b*255,0,255))}getHexString(e=Tn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Xt.workingColorSpace){Xt.fromWorkingColorSpace(Ei.copy(this),t);const i=Ei.r,r=Ei.g,s=Ei.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,u;const d=(a+o)/2;if(a===o)l=0,u=0;else{const f=o-a;switch(u=d<=.5?f/(o+a):f/(2-o-a),o){case i:l=(r-s)/f+(r<s?6:0);break;case r:l=(s-i)/f+2;break;case s:l=(i-r)/f+4;break}l/=6}return e.h=l,e.s=u,e.l=d,e}getRGB(e,t=Xt.workingColorSpace){return Xt.fromWorkingColorSpace(Ei.copy(this),t),e.r=Ei.r,e.g=Ei.g,e.b=Ei.b,e}getStyle(e=Tn){Xt.fromWorkingColorSpace(Ei.copy(this),e);const t=Ei.r,i=Ei.g,r=Ei.b;return e!==Tn?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,t,i){return this.getHSL(ea),this.setHSL(ea.h+e,ea.s+t,ea.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(ea),e.getHSL(Ip);const i=vd(ea.h,Ip.h,t),r=vd(ea.s,Ip.s,t),s=vd(ea.l,Ip.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Ei=new St;St.NAMES=sI;let lO=0;class Gs extends Qc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:lO++}),this.uuid=as(),this.name="",this.type="Material",this.blending=vc,this.side=No,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Xx,this.blendDst=jx,this.blendEquation=gl,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new St(0,0,0),this.blendAlpha=0,this.depthFunc=Ag,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=uA,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=yu,this.stencilZFail=yu,this.stencilZPass=yu,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==vc&&(i.blending=this.blending),this.side!==No&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==Xx&&(i.blendSrc=this.blendSrc),this.blendDst!==jx&&(i.blendDst=this.blendDst),this.blendEquation!==gl&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Ag&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==uA&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==yu&&(i.stencilFail=this.stencilFail),this.stencilZFail!==yu&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==yu&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class bl extends Gs{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new St(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=zP,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Ln=new Y,Lp=new Ut;class Fi{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=Zx,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=So,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn('THREE.BufferAttribute: "updateRange" is deprecated and removed in r169. Use "addUpdateRange()" instead.'),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)Lp.fromBufferAttribute(this,t),Lp.applyMatrix3(e),this.setXY(t,Lp.x,Lp.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)Ln.fromBufferAttribute(this,t),Ln.applyMatrix3(e),this.setXYZ(t,Ln.x,Ln.y,Ln.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Ln.fromBufferAttribute(this,t),Ln.applyMatrix4(e),this.setXYZ(t,Ln.x,Ln.y,Ln.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Ln.fromBufferAttribute(this,t),Ln.applyNormalMatrix(e),this.setXYZ(t,Ln.x,Ln.y,Ln.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Ln.fromBufferAttribute(this,t),Ln.transformDirection(e),this.setXYZ(t,Ln.x,Ln.y,Ln.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Fs(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=qt(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Fs(t,this.array)),t}setX(e,t){return this.normalized&&(t=qt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Fs(t,this.array)),t}setY(e,t){return this.normalized&&(t=qt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Fs(t,this.array)),t}setZ(e,t){return this.normalized&&(t=qt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Fs(t,this.array)),t}setW(e,t){return this.normalized&&(t=qt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=qt(t,this.array),i=qt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=qt(t,this.array),i=qt(i,this.array),r=qt(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=qt(t,this.array),i=qt(i,this.array),r=qt(r,this.array),s=qt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Zx&&(e.usage=this.usage),e}}class oI extends Fi{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class aI extends Fi{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Mo extends Fi{constructor(e,t,i){super(new Float32Array(e),t,i)}}let uO=0;const wr=new Mt,Hv=new vn,Cu=new Y,ir=new Bo,Fh=new Bo,Kn=new Y;class Ys extends Qc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:uO++}),this.uuid=as(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(eI(e)?aI:oI)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new At().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return wr.makeRotationFromQuaternion(e),this.applyMatrix4(wr),this}rotateX(e){return wr.makeRotationX(e),this.applyMatrix4(wr),this}rotateY(e){return wr.makeRotationY(e),this.applyMatrix4(wr),this}rotateZ(e){return wr.makeRotationZ(e),this.applyMatrix4(wr),this}translate(e,t,i){return wr.makeTranslation(e,t,i),this.applyMatrix4(wr),this}scale(e,t,i){return wr.makeScale(e,t,i),this.applyMatrix4(wr),this}lookAt(e){return Hv.lookAt(e),Hv.updateMatrix(),this.applyMatrix4(Hv.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Cu).negate(),this.translate(Cu.x,Cu.y,Cu.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Mo(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Bo);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Y(-1/0,-1/0,-1/0),new Y(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const s=t[i];ir.setFromBufferAttribute(s),this.morphTargetsRelative?(Kn.addVectors(this.boundingBox.min,ir.min),this.boundingBox.expandByPoint(Kn),Kn.addVectors(this.boundingBox.max,ir.max),this.boundingBox.expandByPoint(Kn)):(this.boundingBox.expandByPoint(ir.min),this.boundingBox.expandByPoint(ir.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new $s);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Y,1/0);return}if(e){const i=this.boundingSphere.center;if(ir.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];Fh.setFromBufferAttribute(a),this.morphTargetsRelative?(Kn.addVectors(ir.min,Fh.min),ir.expandByPoint(Kn),Kn.addVectors(ir.max,Fh.max),ir.expandByPoint(Kn)):(ir.expandByPoint(Fh.min),ir.expandByPoint(Fh.max))}ir.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Kn.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Kn));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let u=0,d=a.count;u<d;u++)Kn.fromBufferAttribute(a,u),l&&(Cu.fromBufferAttribute(e,u),Kn.add(Cu)),r=Math.max(r,i.distanceToSquared(Kn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Fi(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,u=[],d=[];for(let L=0;L<a;L++)u[L]=new Y,d[L]=new Y;const f=new Y,p=new Y,m=new Y,v=new Ut,x=new Ut,y=new Ut,g=new Y,T=new Y;function S(L,Q,W){f.fromArray(r,L*3),p.fromArray(r,Q*3),m.fromArray(r,W*3),v.fromArray(o,L*2),x.fromArray(o,Q*2),y.fromArray(o,W*2),p.sub(f),m.sub(f),x.sub(v),y.sub(v);const z=1/(x.x*y.y-y.x*x.y);isFinite(z)&&(g.copy(p).multiplyScalar(y.y).addScaledVector(m,-x.y).multiplyScalar(z),T.copy(m).multiplyScalar(x.x).addScaledVector(p,-y.x).multiplyScalar(z),u[L].add(g),u[Q].add(g),u[W].add(g),d[L].add(T),d[Q].add(T),d[W].add(T))}let w=this.groups;w.length===0&&(w=[{start:0,count:i.length}]);for(let L=0,Q=w.length;L<Q;++L){const W=w[L],z=W.start,F=W.count;for(let X=z,Z=z+F;X<Z;X+=3)S(i[X+0],i[X+1],i[X+2])}const M=new Y,R=new Y,P=new Y,N=new Y;function C(L){P.fromArray(s,L*3),N.copy(P);const Q=u[L];M.copy(Q),M.sub(P.multiplyScalar(P.dot(Q))).normalize(),R.crossVectors(N,Q);const z=R.dot(d[L])<0?-1:1;l[L*4]=M.x,l[L*4+1]=M.y,l[L*4+2]=M.z,l[L*4+3]=z}for(let L=0,Q=w.length;L<Q;++L){const W=w[L],z=W.start,F=W.count;for(let X=z,Z=z+F;X<Z;X+=3)C(i[X+0]),C(i[X+1]),C(i[X+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Fi(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let p=0,m=i.count;p<m;p++)i.setXYZ(p,0,0,0);const r=new Y,s=new Y,o=new Y,a=new Y,l=new Y,u=new Y,d=new Y,f=new Y;if(e)for(let p=0,m=e.count;p<m;p+=3){const v=e.getX(p+0),x=e.getX(p+1),y=e.getX(p+2);r.fromBufferAttribute(t,v),s.fromBufferAttribute(t,x),o.fromBufferAttribute(t,y),d.subVectors(o,s),f.subVectors(r,s),d.cross(f),a.fromBufferAttribute(i,v),l.fromBufferAttribute(i,x),u.fromBufferAttribute(i,y),a.add(d),l.add(d),u.add(d),i.setXYZ(v,a.x,a.y,a.z),i.setXYZ(x,l.x,l.y,l.z),i.setXYZ(y,u.x,u.y,u.z)}else for(let p=0,m=t.count;p<m;p+=3)r.fromBufferAttribute(t,p+0),s.fromBufferAttribute(t,p+1),o.fromBufferAttribute(t,p+2),d.subVectors(o,s),f.subVectors(r,s),d.cross(f),i.setXYZ(p+0,d.x,d.y,d.z),i.setXYZ(p+1,d.x,d.y,d.z),i.setXYZ(p+2,d.x,d.y,d.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Kn.fromBufferAttribute(e,t),Kn.normalize(),e.setXYZ(t,Kn.x,Kn.y,Kn.z)}toNonIndexed(){function e(a,l){const u=a.array,d=a.itemSize,f=a.normalized,p=new u.constructor(l.length*d);let m=0,v=0;for(let x=0,y=l.length;x<y;x++){a.isInterleavedBufferAttribute?m=l[x]*a.data.stride+a.offset:m=l[x]*d;for(let g=0;g<d;g++)p[v++]=u[m++]}return new Fi(p,d,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Ys,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],u=e(l,i);t.setAttribute(a,u)}const s=this.morphAttributes;for(const a in s){const l=[],u=s[a];for(let d=0,f=u.length;d<f;d++){const p=u[d],m=e(p,i);l.push(m)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const u=o[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i){const u=i[l];e.data.attributes[l]=u.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],d=[];for(let f=0,p=u.length;f<p;f++){const m=u[f];d.push(m.toJSON(e.data))}d.length>0&&(r[l]=d,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const r=e.attributes;for(const u in r){const d=r[u];this.setAttribute(u,d.clone(t))}const s=e.morphAttributes;for(const u in s){const d=[],f=s[u];for(let p=0,m=f.length;p<m;p++)d.push(f[p].clone(t));this.morphAttributes[u]=d}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,d=o.length;u<d;u++){const f=o[u];this.addGroup(f.start,f.count,f.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const TA=new Mt,el=new x0,Dp=new $s,bA=new Y,Ru=new Y,Pu=new Y,Iu=new Y,Vv=new Y,Np=new Y,Up=new Ut,Fp=new Ut,Op=new Ut,wA=new Y,AA=new Y,MA=new Y,Bp=new Y,kp=new Y;let Nr=class extends vn{constructor(e=new Ys,t=new bl){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){Np.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const d=a[l],f=s[l];d!==0&&(Vv.fromBufferAttribute(f,e),o?Np.addScaledVector(Vv,d):Np.addScaledVector(Vv.sub(t),d))}t.add(Np)}return t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Dp.copy(i.boundingSphere),Dp.applyMatrix4(s),el.copy(e.ray).recast(e.near),!(Dp.containsPoint(el.origin)===!1&&(el.intersectSphere(Dp,bA)===null||el.origin.distanceToSquared(bA)>(e.far-e.near)**2))&&(TA.copy(s).invert(),el.copy(e.ray).applyMatrix4(TA),!(i.boundingBox!==null&&el.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,el)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,u=s.attributes.uv,d=s.attributes.uv1,f=s.attributes.normal,p=s.groups,m=s.drawRange;if(a!==null)if(Array.isArray(o))for(let v=0,x=p.length;v<x;v++){const y=p[v],g=o[y.materialIndex],T=Math.max(y.start,m.start),S=Math.min(a.count,Math.min(y.start+y.count,m.start+m.count));for(let w=T,M=S;w<M;w+=3){const R=a.getX(w),P=a.getX(w+1),N=a.getX(w+2);r=zp(this,g,e,i,u,d,f,R,P,N),r&&(r.faceIndex=Math.floor(w/3),r.face.materialIndex=y.materialIndex,t.push(r))}}else{const v=Math.max(0,m.start),x=Math.min(a.count,m.start+m.count);for(let y=v,g=x;y<g;y+=3){const T=a.getX(y),S=a.getX(y+1),w=a.getX(y+2);r=zp(this,o,e,i,u,d,f,T,S,w),r&&(r.faceIndex=Math.floor(y/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let v=0,x=p.length;v<x;v++){const y=p[v],g=o[y.materialIndex],T=Math.max(y.start,m.start),S=Math.min(l.count,Math.min(y.start+y.count,m.start+m.count));for(let w=T,M=S;w<M;w+=3){const R=w,P=w+1,N=w+2;r=zp(this,g,e,i,u,d,f,R,P,N),r&&(r.faceIndex=Math.floor(w/3),r.face.materialIndex=y.materialIndex,t.push(r))}}else{const v=Math.max(0,m.start),x=Math.min(l.count,m.start+m.count);for(let y=v,g=x;y<g;y+=3){const T=y,S=y+1,w=y+2;r=zp(this,o,e,i,u,d,f,T,S,w),r&&(r.faceIndex=Math.floor(y/3),t.push(r))}}}};function cO(n,e,t,i,r,s,o,a){let l;if(e.side===Ki?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===No,a),l===null)return null;kp.copy(a),kp.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(kp);return u<t.near||u>t.far?null:{distance:u,point:kp.clone(),object:n}}function zp(n,e,t,i,r,s,o,a,l,u){n.getVertexPosition(a,Ru),n.getVertexPosition(l,Pu),n.getVertexPosition(u,Iu);const d=cO(n,e,t,i,Ru,Pu,Iu,Bp);if(d){r&&(Up.fromBufferAttribute(r,a),Fp.fromBufferAttribute(r,l),Op.fromBufferAttribute(r,u),d.uv=ts.getInterpolation(Bp,Ru,Pu,Iu,Up,Fp,Op,new Ut)),s&&(Up.fromBufferAttribute(s,a),Fp.fromBufferAttribute(s,l),Op.fromBufferAttribute(s,u),d.uv1=ts.getInterpolation(Bp,Ru,Pu,Iu,Up,Fp,Op,new Ut),d.uv2=d.uv1),o&&(wA.fromBufferAttribute(o,a),AA.fromBufferAttribute(o,l),MA.fromBufferAttribute(o,u),d.normal=ts.getInterpolation(Bp,Ru,Pu,Iu,wA,AA,MA,new Y),d.normal.dot(i.direction)>0&&d.normal.multiplyScalar(-1));const f={a,b:l,c:u,normal:new Y,materialIndex:0};ts.getNormal(Ru,Pu,Iu,f.normal),d.face=f}return d}class lf extends Ys{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],u=[],d=[],f=[];let p=0,m=0;v("z","y","x",-1,-1,i,t,e,o,s,0),v("z","y","x",1,-1,i,t,-e,o,s,1),v("x","z","y",1,1,e,i,t,r,o,2),v("x","z","y",1,-1,e,i,-t,r,o,3),v("x","y","z",1,-1,e,t,i,r,s,4),v("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new Mo(u,3)),this.setAttribute("normal",new Mo(d,3)),this.setAttribute("uv",new Mo(f,2));function v(x,y,g,T,S,w,M,R,P,N,C){const L=w/P,Q=M/N,W=w/2,z=M/2,F=R/2,X=P+1,Z=N+1;let $=0,O=0;const H=new Y;for(let B=0;B<Z;B++){const G=B*Q-z;for(let ne=0;ne<X;ne++){const ee=ne*L-W;H[x]=ee*T,H[y]=G*S,H[g]=F,u.push(H.x,H.y,H.z),H[x]=0,H[y]=0,H[g]=R>0?1:-1,d.push(H.x,H.y,H.z),f.push(ne/P),f.push(1-B/N),$+=1}}for(let B=0;B<N;B++)for(let G=0;G<P;G++){const ne=p+G+X*B,ee=p+G+X*(B+1),ie=p+(G+1)+X*(B+1),pe=p+(G+1)+X*B;l.push(ne,ee,pe),l.push(ee,ie,pe),O+=6}a.addGroup(m,O,C),m+=O,p+=$}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new lf(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Gc(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function Ii(n){const e={};for(let t=0;t<n.length;t++){const i=Gc(n[t]);for(const r in i)e[r]=i[r]}return e}function hO(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function lI(n){return n.getRenderTarget()===null?n.outputColorSpace:Xt.workingColorSpace}const dO={clone:Gc,merge:Ii};var fO=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,pO=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Xl extends Gs{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=fO,this.fragmentShader=pO,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Gc(e.uniforms),this.uniformsGroups=hO(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class uI extends vn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Mt,this.projectionMatrix=new Mt,this.projectionMatrixInverse=new Mt,this.coordinateSystem=Eo}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Di extends uI{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=zc*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(_d*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return zc*2*Math.atan(Math.tan(_d*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(_d*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,u=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/u,r*=o.width/l,i*=o.height/u}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Lu=-90,Du=1;class mO extends vn{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Di(Lu,Du,e,t);r.layers=this.layers,this.add(r);const s=new Di(Lu,Du,e,t);s.layers=this.layers,this.add(s);const o=new Di(Lu,Du,e,t);o.layers=this.layers,this.add(o);const a=new Di(Lu,Du,e,t);a.layers=this.layers,this.add(a);const l=new Di(Lu,Du,e,t);l.layers=this.layers,this.add(l);const u=new Di(Lu,Du,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const u of t)this.remove(u);if(e===Eo)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Ig)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,u,d]=this.children,f=e.getRenderTarget(),p=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),v=e.xr.enabled;e.xr.enabled=!1;const x=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,u),i.texture.generateMipmaps=x,e.setRenderTarget(i,5,r),e.render(t,d),e.setRenderTarget(f,p,m),e.xr.enabled=v,i.texture.needsPMREMUpdate=!0}}class cI extends hr{constructor(e,t,i,r,s,o,a,l,u,d){e=e!==void 0?e:[],t=t!==void 0?t:Uc,super(e,t,i,r,s,o,a,l,u,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class gO extends Wl{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];t.encoding!==void 0&&(yd("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Ll?Tn:Lr),this.texture=new cI(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Wi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new lf(5,5,5),s=new Xl({name:"CubemapFromEquirect",uniforms:Gc(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Ki,blending:Ma});s.uniforms.tEquirect.value=t;const o=new Nr(r,s),a=t.minFilter;return t.minFilter===Vl&&(t.minFilter=Wi),new mO(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const Wv=new Y,_O=new Y,vO=new At;class ll{constructor(e=new Y(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=Wv.subVectors(i,t).cross(_O.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(Wv),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||vO.getNormalMatrix(e),r=this.coplanarPoint(Wv).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const tl=new $s,Gp=new Y;class aE{constructor(e=new ll,t=new ll,i=new ll,r=new ll,s=new ll,o=new ll){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Eo){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],u=r[4],d=r[5],f=r[6],p=r[7],m=r[8],v=r[9],x=r[10],y=r[11],g=r[12],T=r[13],S=r[14],w=r[15];if(i[0].setComponents(l-s,p-u,y-m,w-g).normalize(),i[1].setComponents(l+s,p+u,y+m,w+g).normalize(),i[2].setComponents(l+o,p+d,y+v,w+T).normalize(),i[3].setComponents(l-o,p-d,y-v,w-T).normalize(),i[4].setComponents(l-a,p-f,y-x,w-S).normalize(),t===Eo)i[5].setComponents(l+a,p+f,y+x,w+S).normalize();else if(t===Ig)i[5].setComponents(a,f,x,S).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),tl.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),tl.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(tl)}intersectsSprite(e){return tl.center.set(0,0,0),tl.radius=.7071067811865476,tl.applyMatrix4(e.matrixWorld),this.intersectsSphere(tl)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Gp.x=r.normal.x>0?e.max.x:e.min.x,Gp.y=r.normal.y>0?e.max.y:e.min.y,Gp.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Gp)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function hI(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function yO(n,e){const t=e.isWebGL2,i=new WeakMap;function r(u,d){const f=u.array,p=u.usage,m=f.byteLength,v=n.createBuffer();n.bindBuffer(d,v),n.bufferData(d,f,p),u.onUploadCallback();let x;if(f instanceof Float32Array)x=n.FLOAT;else if(f instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(t)x=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else x=n.UNSIGNED_SHORT;else if(f instanceof Int16Array)x=n.SHORT;else if(f instanceof Uint32Array)x=n.UNSIGNED_INT;else if(f instanceof Int32Array)x=n.INT;else if(f instanceof Int8Array)x=n.BYTE;else if(f instanceof Uint8Array)x=n.UNSIGNED_BYTE;else if(f instanceof Uint8ClampedArray)x=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+f);return{buffer:v,type:x,bytesPerElement:f.BYTES_PER_ELEMENT,version:u.version,size:m}}function s(u,d,f){const p=d.array,m=d._updateRange,v=d.updateRanges;if(n.bindBuffer(f,u),m.count===-1&&v.length===0&&n.bufferSubData(f,0,p),v.length!==0){for(let x=0,y=v.length;x<y;x++){const g=v[x];t?n.bufferSubData(f,g.start*p.BYTES_PER_ELEMENT,p,g.start,g.count):n.bufferSubData(f,g.start*p.BYTES_PER_ELEMENT,p.subarray(g.start,g.start+g.count))}d.clearUpdateRanges()}m.count!==-1&&(t?n.bufferSubData(f,m.offset*p.BYTES_PER_ELEMENT,p,m.offset,m.count):n.bufferSubData(f,m.offset*p.BYTES_PER_ELEMENT,p.subarray(m.offset,m.offset+m.count)),m.count=-1),d.onUploadCallback()}function o(u){return u.isInterleavedBufferAttribute&&(u=u.data),i.get(u)}function a(u){u.isInterleavedBufferAttribute&&(u=u.data);const d=i.get(u);d&&(n.deleteBuffer(d.buffer),i.delete(u))}function l(u,d){if(u.isGLBufferAttribute){const p=i.get(u);(!p||p.version<u.version)&&i.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);const f=i.get(u);if(f===void 0)i.set(u,r(u,d));else if(f.version<u.version){if(f.size!==u.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(f.buffer,u,d),f.version=u.version}}return{get:o,remove:a,update:l}}let xO=class dI extends Ys{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),u=a+1,d=l+1,f=e/a,p=t/l,m=[],v=[],x=[],y=[];for(let g=0;g<d;g++){const T=g*p-o;for(let S=0;S<u;S++){const w=S*f-s;v.push(w,-T,0),x.push(0,0,1),y.push(S/a),y.push(1-g/l)}}for(let g=0;g<l;g++)for(let T=0;T<a;T++){const S=T+u*g,w=T+u*(g+1),M=T+1+u*(g+1),R=T+1+u*g;m.push(S,w,R),m.push(w,M,R)}this.setIndex(m),this.setAttribute("position",new Mo(v,3)),this.setAttribute("normal",new Mo(x,3)),this.setAttribute("uv",new Mo(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dI(e.width,e.height,e.widthSegments,e.heightSegments)}};var SO=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,EO=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,TO=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,bO=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,wO=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,AO=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,MO=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,CO=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,RO=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,PO=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,IO=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,LO=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,DO=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,NO=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,UO=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,FO=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,OO=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,BO=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,kO=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,zO=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,GO=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,HO=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,VO=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,WO=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,XO=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,jO=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,$O=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,YO=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,qO=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,KO=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,ZO="gl_FragColor = linearToOutputTexel( gl_FragColor );",QO=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,JO=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,eB=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,tB=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,nB=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,iB=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,rB=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,sB=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,oB=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,aB=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,lB=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,uB=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,cB=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,hB=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,dB=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,fB=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,pB=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,mB=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,gB=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,_B=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,vB=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,yB=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,xB=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,SB=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,EB=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,TB=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,bB=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,wB=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,AB=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,MB=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,CB=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,RB=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,PB=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,IB=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,LB=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,DB=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,NB=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,UB=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,FB=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,OB=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,BB=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,kB=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,zB=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,GB=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,HB=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,VB=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,WB=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,XB=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,jB=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,$B=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,YB=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,qB=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,KB=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,ZB=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,QB=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,JB=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,ek=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,tk=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,nk=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,ik=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,rk=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,sk=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,ok=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,ak=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,lk=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,uk=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,ck=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,hk=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,dk=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,fk=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,pk=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,mk=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,gk=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,_k=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,vk=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,yk=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const xk=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Sk=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Ek=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Tk=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,bk=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,wk=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Ak=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Mk=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Ck=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Rk=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Pk=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Ik=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Lk=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Dk=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Nk=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Uk=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Fk=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Ok=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Bk=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,kk=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zk=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Gk=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Hk=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Vk=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Wk=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Xk=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,jk=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,$k=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Yk=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,qk=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Kk=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Zk=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Qk=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Jk=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Tt={alphahash_fragment:SO,alphahash_pars_fragment:EO,alphamap_fragment:TO,alphamap_pars_fragment:bO,alphatest_fragment:wO,alphatest_pars_fragment:AO,aomap_fragment:MO,aomap_pars_fragment:CO,batching_pars_vertex:RO,batching_vertex:PO,begin_vertex:IO,beginnormal_vertex:LO,bsdfs:DO,iridescence_fragment:NO,bumpmap_pars_fragment:UO,clipping_planes_fragment:FO,clipping_planes_pars_fragment:OO,clipping_planes_pars_vertex:BO,clipping_planes_vertex:kO,color_fragment:zO,color_pars_fragment:GO,color_pars_vertex:HO,color_vertex:VO,common:WO,cube_uv_reflection_fragment:XO,defaultnormal_vertex:jO,displacementmap_pars_vertex:$O,displacementmap_vertex:YO,emissivemap_fragment:qO,emissivemap_pars_fragment:KO,colorspace_fragment:ZO,colorspace_pars_fragment:QO,envmap_fragment:JO,envmap_common_pars_fragment:eB,envmap_pars_fragment:tB,envmap_pars_vertex:nB,envmap_physical_pars_fragment:pB,envmap_vertex:iB,fog_vertex:rB,fog_pars_vertex:sB,fog_fragment:oB,fog_pars_fragment:aB,gradientmap_pars_fragment:lB,lightmap_fragment:uB,lightmap_pars_fragment:cB,lights_lambert_fragment:hB,lights_lambert_pars_fragment:dB,lights_pars_begin:fB,lights_toon_fragment:mB,lights_toon_pars_fragment:gB,lights_phong_fragment:_B,lights_phong_pars_fragment:vB,lights_physical_fragment:yB,lights_physical_pars_fragment:xB,lights_fragment_begin:SB,lights_fragment_maps:EB,lights_fragment_end:TB,logdepthbuf_fragment:bB,logdepthbuf_pars_fragment:wB,logdepthbuf_pars_vertex:AB,logdepthbuf_vertex:MB,map_fragment:CB,map_pars_fragment:RB,map_particle_fragment:PB,map_particle_pars_fragment:IB,metalnessmap_fragment:LB,metalnessmap_pars_fragment:DB,morphcolor_vertex:NB,morphnormal_vertex:UB,morphtarget_pars_vertex:FB,morphtarget_vertex:OB,normal_fragment_begin:BB,normal_fragment_maps:kB,normal_pars_fragment:zB,normal_pars_vertex:GB,normal_vertex:HB,normalmap_pars_fragment:VB,clearcoat_normal_fragment_begin:WB,clearcoat_normal_fragment_maps:XB,clearcoat_pars_fragment:jB,iridescence_pars_fragment:$B,opaque_fragment:YB,packing:qB,premultiplied_alpha_fragment:KB,project_vertex:ZB,dithering_fragment:QB,dithering_pars_fragment:JB,roughnessmap_fragment:ek,roughnessmap_pars_fragment:tk,shadowmap_pars_fragment:nk,shadowmap_pars_vertex:ik,shadowmap_vertex:rk,shadowmask_pars_fragment:sk,skinbase_vertex:ok,skinning_pars_vertex:ak,skinning_vertex:lk,skinnormal_vertex:uk,specularmap_fragment:ck,specularmap_pars_fragment:hk,tonemapping_fragment:dk,tonemapping_pars_fragment:fk,transmission_fragment:pk,transmission_pars_fragment:mk,uv_pars_fragment:gk,uv_pars_vertex:_k,uv_vertex:vk,worldpos_vertex:yk,background_vert:xk,background_frag:Sk,backgroundCube_vert:Ek,backgroundCube_frag:Tk,cube_vert:bk,cube_frag:wk,depth_vert:Ak,depth_frag:Mk,distanceRGBA_vert:Ck,distanceRGBA_frag:Rk,equirect_vert:Pk,equirect_frag:Ik,linedashed_vert:Lk,linedashed_frag:Dk,meshbasic_vert:Nk,meshbasic_frag:Uk,meshlambert_vert:Fk,meshlambert_frag:Ok,meshmatcap_vert:Bk,meshmatcap_frag:kk,meshnormal_vert:zk,meshnormal_frag:Gk,meshphong_vert:Hk,meshphong_frag:Vk,meshphysical_vert:Wk,meshphysical_frag:Xk,meshtoon_vert:jk,meshtoon_frag:$k,points_vert:Yk,points_frag:qk,shadow_vert:Kk,shadow_frag:Zk,sprite_vert:Qk,sprite_frag:Jk},Le={common:{diffuse:{value:new St(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new At},alphaMap:{value:null},alphaMapTransform:{value:new At},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new At}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new At}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new At}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new At},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new At},normalScale:{value:new Ut(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new At},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new At}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new At}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new At}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new St(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new St(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new At},alphaTest:{value:0},uvTransform:{value:new At}},sprite:{diffuse:{value:new St(16777215)},opacity:{value:1},center:{value:new Ut(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new At},alphaMap:{value:null},alphaMapTransform:{value:new At},alphaTest:{value:0}}},Is={basic:{uniforms:Ii([Le.common,Le.specularmap,Le.envmap,Le.aomap,Le.lightmap,Le.fog]),vertexShader:Tt.meshbasic_vert,fragmentShader:Tt.meshbasic_frag},lambert:{uniforms:Ii([Le.common,Le.specularmap,Le.envmap,Le.aomap,Le.lightmap,Le.emissivemap,Le.bumpmap,Le.normalmap,Le.displacementmap,Le.fog,Le.lights,{emissive:{value:new St(0)}}]),vertexShader:Tt.meshlambert_vert,fragmentShader:Tt.meshlambert_frag},phong:{uniforms:Ii([Le.common,Le.specularmap,Le.envmap,Le.aomap,Le.lightmap,Le.emissivemap,Le.bumpmap,Le.normalmap,Le.displacementmap,Le.fog,Le.lights,{emissive:{value:new St(0)},specular:{value:new St(1118481)},shininess:{value:30}}]),vertexShader:Tt.meshphong_vert,fragmentShader:Tt.meshphong_frag},standard:{uniforms:Ii([Le.common,Le.envmap,Le.aomap,Le.lightmap,Le.emissivemap,Le.bumpmap,Le.normalmap,Le.displacementmap,Le.roughnessmap,Le.metalnessmap,Le.fog,Le.lights,{emissive:{value:new St(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Tt.meshphysical_vert,fragmentShader:Tt.meshphysical_frag},toon:{uniforms:Ii([Le.common,Le.aomap,Le.lightmap,Le.emissivemap,Le.bumpmap,Le.normalmap,Le.displacementmap,Le.gradientmap,Le.fog,Le.lights,{emissive:{value:new St(0)}}]),vertexShader:Tt.meshtoon_vert,fragmentShader:Tt.meshtoon_frag},matcap:{uniforms:Ii([Le.common,Le.bumpmap,Le.normalmap,Le.displacementmap,Le.fog,{matcap:{value:null}}]),vertexShader:Tt.meshmatcap_vert,fragmentShader:Tt.meshmatcap_frag},points:{uniforms:Ii([Le.points,Le.fog]),vertexShader:Tt.points_vert,fragmentShader:Tt.points_frag},dashed:{uniforms:Ii([Le.common,Le.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Tt.linedashed_vert,fragmentShader:Tt.linedashed_frag},depth:{uniforms:Ii([Le.common,Le.displacementmap]),vertexShader:Tt.depth_vert,fragmentShader:Tt.depth_frag},normal:{uniforms:Ii([Le.common,Le.bumpmap,Le.normalmap,Le.displacementmap,{opacity:{value:1}}]),vertexShader:Tt.meshnormal_vert,fragmentShader:Tt.meshnormal_frag},sprite:{uniforms:Ii([Le.sprite,Le.fog]),vertexShader:Tt.sprite_vert,fragmentShader:Tt.sprite_frag},background:{uniforms:{uvTransform:{value:new At},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Tt.background_vert,fragmentShader:Tt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Tt.backgroundCube_vert,fragmentShader:Tt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Tt.cube_vert,fragmentShader:Tt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Tt.equirect_vert,fragmentShader:Tt.equirect_frag},distanceRGBA:{uniforms:Ii([Le.common,Le.displacementmap,{referencePosition:{value:new Y},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Tt.distanceRGBA_vert,fragmentShader:Tt.distanceRGBA_frag},shadow:{uniforms:Ii([Le.lights,Le.fog,{color:{value:new St(0)},opacity:{value:1}}]),vertexShader:Tt.shadow_vert,fragmentShader:Tt.shadow_frag}};Is.physical={uniforms:Ii([Is.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new At},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new At},clearcoatNormalScale:{value:new Ut(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new At},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new At},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new At},sheen:{value:0},sheenColor:{value:new St(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new At},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new At},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new At},transmissionSamplerSize:{value:new Ut},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new At},attenuationDistance:{value:0},attenuationColor:{value:new St(0)},specularColor:{value:new St(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new At},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new At},anisotropyVector:{value:new Ut},anisotropyMap:{value:null},anisotropyMapTransform:{value:new At}}]),vertexShader:Tt.meshphysical_vert,fragmentShader:Tt.meshphysical_frag};const Hp={r:0,b:0,g:0};function e4(n,e,t,i,r,s,o){const a=new St(0);let l=s===!0?0:1,u,d,f=null,p=0,m=null;function v(y,g){let T=!1,S=g.isScene===!0?g.background:null;S&&S.isTexture&&(S=(g.backgroundBlurriness>0?t:e).get(S)),S===null?x(a,l):S&&S.isColor&&(x(S,1),T=!0);const w=n.xr.getEnvironmentBlendMode();w==="additive"?i.buffers.color.setClear(0,0,0,1,o):w==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||T)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),S&&(S.isCubeTexture||S.mapping===v0)?(d===void 0&&(d=new Nr(new lf(1,1,1),new Xl({name:"BackgroundCubeMaterial",uniforms:Gc(Is.backgroundCube.uniforms),vertexShader:Is.backgroundCube.vertexShader,fragmentShader:Is.backgroundCube.fragmentShader,side:Ki,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(M,R,P){this.matrixWorld.copyPosition(P.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(d)),d.material.uniforms.envMap.value=S,d.material.uniforms.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=g.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,d.material.toneMapped=Xt.getTransfer(S.colorSpace)!==rn,(f!==S||p!==S.version||m!==n.toneMapping)&&(d.material.needsUpdate=!0,f=S,p=S.version,m=n.toneMapping),d.layers.enableAll(),y.unshift(d,d.geometry,d.material,0,0,null)):S&&S.isTexture&&(u===void 0&&(u=new Nr(new xO(2,2),new Xl({name:"BackgroundMaterial",uniforms:Gc(Is.background.uniforms),vertexShader:Is.background.vertexShader,fragmentShader:Is.background.fragmentShader,side:No,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(u)),u.material.uniforms.t2D.value=S,u.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,u.material.toneMapped=Xt.getTransfer(S.colorSpace)!==rn,S.matrixAutoUpdate===!0&&S.updateMatrix(),u.material.uniforms.uvTransform.value.copy(S.matrix),(f!==S||p!==S.version||m!==n.toneMapping)&&(u.material.needsUpdate=!0,f=S,p=S.version,m=n.toneMapping),u.layers.enableAll(),y.unshift(u,u.geometry,u.material,0,0,null))}function x(y,g){y.getRGB(Hp,lI(n)),i.buffers.color.setClear(Hp.r,Hp.g,Hp.b,g,o)}return{getClearColor:function(){return a},setClearColor:function(y,g=1){a.set(y),l=g,x(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(y){l=y,x(a,l)},render:v}}function t4(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},l=y(null);let u=l,d=!1;function f(F,X,Z,$,O){let H=!1;if(o){const B=x($,Z,X);u!==B&&(u=B,m(u.object)),H=g(F,$,Z,O),H&&T(F,$,Z,O)}else{const B=X.wireframe===!0;(u.geometry!==$.id||u.program!==Z.id||u.wireframe!==B)&&(u.geometry=$.id,u.program=Z.id,u.wireframe=B,H=!0)}O!==null&&t.update(O,n.ELEMENT_ARRAY_BUFFER),(H||d)&&(d=!1,N(F,X,Z,$),O!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(O).buffer))}function p(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function m(F){return i.isWebGL2?n.bindVertexArray(F):s.bindVertexArrayOES(F)}function v(F){return i.isWebGL2?n.deleteVertexArray(F):s.deleteVertexArrayOES(F)}function x(F,X,Z){const $=Z.wireframe===!0;let O=a[F.id];O===void 0&&(O={},a[F.id]=O);let H=O[X.id];H===void 0&&(H={},O[X.id]=H);let B=H[$];return B===void 0&&(B=y(p()),H[$]=B),B}function y(F){const X=[],Z=[],$=[];for(let O=0;O<r;O++)X[O]=0,Z[O]=0,$[O]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:X,enabledAttributes:Z,attributeDivisors:$,object:F,attributes:{},index:null}}function g(F,X,Z,$){const O=u.attributes,H=X.attributes;let B=0;const G=Z.getAttributes();for(const ne in G)if(G[ne].location>=0){const ie=O[ne];let pe=H[ne];if(pe===void 0&&(ne==="instanceMatrix"&&F.instanceMatrix&&(pe=F.instanceMatrix),ne==="instanceColor"&&F.instanceColor&&(pe=F.instanceColor)),ie===void 0||ie.attribute!==pe||pe&&ie.data!==pe.data)return!0;B++}return u.attributesNum!==B||u.index!==$}function T(F,X,Z,$){const O={},H=X.attributes;let B=0;const G=Z.getAttributes();for(const ne in G)if(G[ne].location>=0){let ie=H[ne];ie===void 0&&(ne==="instanceMatrix"&&F.instanceMatrix&&(ie=F.instanceMatrix),ne==="instanceColor"&&F.instanceColor&&(ie=F.instanceColor));const pe={};pe.attribute=ie,ie&&ie.data&&(pe.data=ie.data),O[ne]=pe,B++}u.attributes=O,u.attributesNum=B,u.index=$}function S(){const F=u.newAttributes;for(let X=0,Z=F.length;X<Z;X++)F[X]=0}function w(F){M(F,0)}function M(F,X){const Z=u.newAttributes,$=u.enabledAttributes,O=u.attributeDivisors;Z[F]=1,$[F]===0&&(n.enableVertexAttribArray(F),$[F]=1),O[F]!==X&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](F,X),O[F]=X)}function R(){const F=u.newAttributes,X=u.enabledAttributes;for(let Z=0,$=X.length;Z<$;Z++)X[Z]!==F[Z]&&(n.disableVertexAttribArray(Z),X[Z]=0)}function P(F,X,Z,$,O,H,B){B===!0?n.vertexAttribIPointer(F,X,Z,O,H):n.vertexAttribPointer(F,X,Z,$,O,H)}function N(F,X,Z,$){if(i.isWebGL2===!1&&(F.isInstancedMesh||$.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;S();const O=$.attributes,H=Z.getAttributes(),B=X.defaultAttributeValues;for(const G in H){const ne=H[G];if(ne.location>=0){let ee=O[G];if(ee===void 0&&(G==="instanceMatrix"&&F.instanceMatrix&&(ee=F.instanceMatrix),G==="instanceColor"&&F.instanceColor&&(ee=F.instanceColor)),ee!==void 0){const ie=ee.normalized,pe=ee.itemSize,ve=t.get(ee);if(ve===void 0)continue;const Me=ve.buffer,Ze=ve.type,Ye=ve.bytesPerElement,ze=i.isWebGL2===!0&&(Ze===n.INT||Ze===n.UNSIGNED_INT||ee.gpuType===VP);if(ee.isInterleavedBufferAttribute){const Ie=ee.data,q=Ie.stride,ct=ee.offset;if(Ie.isInstancedInterleavedBuffer){for(let Xe=0;Xe<ne.locationSize;Xe++)M(ne.location+Xe,Ie.meshPerAttribute);F.isInstancedMesh!==!0&&$._maxInstanceCount===void 0&&($._maxInstanceCount=Ie.meshPerAttribute*Ie.count)}else for(let Xe=0;Xe<ne.locationSize;Xe++)w(ne.location+Xe);n.bindBuffer(n.ARRAY_BUFFER,Me);for(let Xe=0;Xe<ne.locationSize;Xe++)P(ne.location+Xe,pe/ne.locationSize,Ze,ie,q*Ye,(ct+pe/ne.locationSize*Xe)*Ye,ze)}else{if(ee.isInstancedBufferAttribute){for(let Ie=0;Ie<ne.locationSize;Ie++)M(ne.location+Ie,ee.meshPerAttribute);F.isInstancedMesh!==!0&&$._maxInstanceCount===void 0&&($._maxInstanceCount=ee.meshPerAttribute*ee.count)}else for(let Ie=0;Ie<ne.locationSize;Ie++)w(ne.location+Ie);n.bindBuffer(n.ARRAY_BUFFER,Me);for(let Ie=0;Ie<ne.locationSize;Ie++)P(ne.location+Ie,pe/ne.locationSize,Ze,ie,pe*Ye,pe/ne.locationSize*Ie*Ye,ze)}}else if(B!==void 0){const ie=B[G];if(ie!==void 0)switch(ie.length){case 2:n.vertexAttrib2fv(ne.location,ie);break;case 3:n.vertexAttrib3fv(ne.location,ie);break;case 4:n.vertexAttrib4fv(ne.location,ie);break;default:n.vertexAttrib1fv(ne.location,ie)}}}}R()}function C(){W();for(const F in a){const X=a[F];for(const Z in X){const $=X[Z];for(const O in $)v($[O].object),delete $[O];delete X[Z]}delete a[F]}}function L(F){if(a[F.id]===void 0)return;const X=a[F.id];for(const Z in X){const $=X[Z];for(const O in $)v($[O].object),delete $[O];delete X[Z]}delete a[F.id]}function Q(F){for(const X in a){const Z=a[X];if(Z[F.id]===void 0)continue;const $=Z[F.id];for(const O in $)v($[O].object),delete $[O];delete Z[F.id]}}function W(){z(),d=!0,u!==l&&(u=l,m(u.object))}function z(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:f,reset:W,resetDefaultState:z,dispose:C,releaseStatesOfGeometry:L,releaseStatesOfProgram:Q,initAttributes:S,enableAttribute:w,disableUnusedAttributes:R}}function n4(n,e,t,i){const r=i.isWebGL2;let s;function o(d){s=d}function a(d,f){n.drawArrays(s,d,f),t.update(f,s,1)}function l(d,f,p){if(p===0)return;let m,v;if(r)m=n,v="drawArraysInstanced";else if(m=e.get("ANGLE_instanced_arrays"),v="drawArraysInstancedANGLE",m===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[v](s,d,f,p),t.update(f,s,p)}function u(d,f,p){if(p===0)return;const m=e.get("WEBGL_multi_draw");if(m===null)for(let v=0;v<p;v++)this.render(d[v],f[v]);else{m.multiDrawArraysWEBGL(s,d,0,f,0,p);let v=0;for(let x=0;x<p;x++)v+=f[x];t.update(v,s,1)}}this.setMode=o,this.render=a,this.renderInstances=l,this.renderMultiDraw=u}function i4(n,e,t){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const P=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(P.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(P){if(P==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";P="mediump"}return P==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let a=t.precision!==void 0?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const u=o||e.has("WEBGL_draw_buffers"),d=t.logarithmicDepthBuffer===!0,f=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=n.getParameter(n.MAX_TEXTURE_SIZE),v=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),x=n.getParameter(n.MAX_VERTEX_ATTRIBS),y=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),g=n.getParameter(n.MAX_VARYING_VECTORS),T=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),S=p>0,w=o||e.has("OES_texture_float"),M=S&&w,R=o?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:d,maxTextures:f,maxVertexTextures:p,maxTextureSize:m,maxCubemapSize:v,maxAttributes:x,maxVertexUniforms:y,maxVaryings:g,maxFragmentUniforms:T,vertexTextures:S,floatFragmentTextures:w,floatVertexTextures:M,maxSamples:R}}function r4(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new ll,a=new At,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(f,p){const m=f.length!==0||p||i!==0||r;return r=p,i=f.length,m},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(f,p){t=d(f,p,0)},this.setState=function(f,p,m){const v=f.clippingPlanes,x=f.clipIntersection,y=f.clipShadows,g=n.get(f);if(!r||v===null||v.length===0||s&&!y)s?d(null):u();else{const T=s?0:i,S=T*4;let w=g.clippingState||null;l.value=w,w=d(v,p,S,m);for(let M=0;M!==S;++M)w[M]=t[M];g.clippingState=w,this.numIntersection=x?this.numPlanes:0,this.numPlanes+=T}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function d(f,p,m,v){const x=f!==null?f.length:0;let y=null;if(x!==0){if(y=l.value,v!==!0||y===null){const g=m+x*4,T=p.matrixWorldInverse;a.getNormalMatrix(T),(y===null||y.length<g)&&(y=new Float32Array(g));for(let S=0,w=m;S!==x;++S,w+=4)o.copy(f[S]).applyMatrix4(T,a),o.normal.toArray(y,w),y[w+3]=o.constant}l.value=y,l.needsUpdate=!0}return e.numPlanes=x,e.numIntersection=0,y}}function s4(n){let e=new WeakMap;function t(o,a){return a===$x?o.mapping=Uc:a===Yx&&(o.mapping=Fc),o}function i(o){if(o&&o.isTexture){const a=o.mapping;if(a===$x||a===Yx)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const u=new gO(l.height/2);return u.fromEquirectangularTexture(n,o),e.set(o,u),o.addEventListener("dispose",r),t(u.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}class lE extends uI{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=d*this.view.offsetY,l=a-d*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const lc=4,CA=[.125,.215,.35,.446,.526,.582],_l=20,Xv=new lE,RA=new St;let jv=null,$v=0,Yv=0;const ul=(1+Math.sqrt(5))/2,Nu=1/ul,PA=[new Y(1,1,1),new Y(-1,1,1),new Y(1,1,-1),new Y(-1,1,-1),new Y(0,ul,Nu),new Y(0,ul,-Nu),new Y(Nu,0,ul),new Y(-Nu,0,ul),new Y(ul,Nu,0),new Y(-ul,Nu,0)];class IA{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){jv=this._renderer.getRenderTarget(),$v=this._renderer.getActiveCubeFace(),Yv=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=NA(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=DA(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(jv,$v,Yv),e.scissorTest=!1,Vp(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Uc||e.mapping===Fc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),jv=this._renderer.getRenderTarget(),$v=this._renderer.getActiveCubeFace(),Yv=this._renderer.getActiveMipmapLevel();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Wi,minFilter:Wi,generateMipmaps:!1,type:Xd,format:Ir,colorSpace:mi,depthBuffer:!1},r=LA(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=LA(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=o4(s)),this._blurMaterial=a4(s,e,t)}return r}_compileMaterial(e){const t=new Nr(this._lodPlanes[0],e);this._renderer.compile(t,Xv)}_sceneToCubeUV(e,t,i,r){const a=new Di(90,1,t,i),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],d=this._renderer,f=d.autoClear,p=d.toneMapping;d.getClearColor(RA),d.toneMapping=Ca,d.autoClear=!1;const m=new bl({name:"PMREM.Background",side:Ki,depthWrite:!1,depthTest:!1}),v=new Nr(new lf,m);let x=!1;const y=e.background;y?y.isColor&&(m.color.copy(y),e.background=null,x=!0):(m.color.copy(RA),x=!0);for(let g=0;g<6;g++){const T=g%3;T===0?(a.up.set(0,l[g],0),a.lookAt(u[g],0,0)):T===1?(a.up.set(0,0,l[g]),a.lookAt(0,u[g],0)):(a.up.set(0,l[g],0),a.lookAt(0,0,u[g]));const S=this._cubeSize;Vp(r,T*S,g>2?S:0,S,S),d.setRenderTarget(r),x&&d.render(v,a),d.render(e,a)}v.geometry.dispose(),v.material.dispose(),d.toneMapping=p,d.autoClear=f,e.background=y}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===Uc||e.mapping===Fc;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=NA()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=DA());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Nr(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;Vp(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,Xv)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=PA[(r-1)%PA.length];this._blur(e,r-1,r,s,o)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const d=3,f=new Nr(this._lodPlanes[r],u),p=u.uniforms,m=this._sizeLods[i]-1,v=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*_l-1),x=s/v,y=isFinite(s)?1+Math.floor(d*x):_l;y>_l&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${_l}`);const g=[];let T=0;for(let P=0;P<_l;++P){const N=P/x,C=Math.exp(-N*N/2);g.push(C),P===0?T+=C:P<y&&(T+=2*C)}for(let P=0;P<g.length;P++)g[P]=g[P]/T;p.envMap.value=e.texture,p.samples.value=y,p.weights.value=g,p.latitudinal.value=o==="latitudinal",a&&(p.poleAxis.value=a);const{_lodMax:S}=this;p.dTheta.value=v,p.mipInt.value=S-i;const w=this._sizeLods[r],M=3*w*(r>S-lc?r-S+lc:0),R=4*(this._cubeSize-w);Vp(t,M,R,3*w,2*w),l.setRenderTarget(t),l.render(f,Xv)}}function o4(n){const e=[],t=[],i=[];let r=n;const s=n-lc+1+CA.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-lc?l=CA[o-n+lc-1]:o===0&&(l=0),i.push(l);const u=1/(a-2),d=-u,f=1+u,p=[d,d,f,d,f,f,d,d,f,f,d,f],m=6,v=6,x=3,y=2,g=1,T=new Float32Array(x*v*m),S=new Float32Array(y*v*m),w=new Float32Array(g*v*m);for(let R=0;R<m;R++){const P=R%3*2/3-1,N=R>2?0:-1,C=[P,N,0,P+2/3,N,0,P+2/3,N+1,0,P,N,0,P+2/3,N+1,0,P,N+1,0];T.set(C,x*v*R),S.set(p,y*v*R);const L=[R,R,R,R,R,R];w.set(L,g*v*R)}const M=new Ys;M.setAttribute("position",new Fi(T,x)),M.setAttribute("uv",new Fi(S,y)),M.setAttribute("faceIndex",new Fi(w,g)),e.push(M),r>lc&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function LA(n,e,t){const i=new Wl(n,e,t);return i.texture.mapping=v0,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Vp(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function a4(n,e,t){const i=new Float32Array(_l),r=new Y(0,1,0);return new Xl({name:"SphericalGaussianBlur",defines:{n:_l,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:uE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ma,depthTest:!1,depthWrite:!1})}function DA(){return new Xl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:uE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ma,depthTest:!1,depthWrite:!1})}function NA(){return new Xl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:uE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ma,depthTest:!1,depthWrite:!1})}function uE(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function l4(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){const l=a.mapping,u=l===$x||l===Yx,d=l===Uc||l===Fc;if(u||d)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let f=e.get(a);return t===null&&(t=new IA(n)),f=u?t.fromEquirectangular(a,f):t.fromCubemap(a,f),e.set(a,f),f.texture}else{if(e.has(a))return e.get(a).texture;{const f=a.image;if(u&&f&&f.height>0||d&&f&&r(f)){t===null&&(t=new IA(n));const p=u?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,p),a.addEventListener("dispose",s),p.texture}else return null}}}return a}function r(a){let l=0;const u=6;for(let d=0;d<u;d++)a[d]!==void 0&&l++;return l===u}function s(a){const l=a.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function u4(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function c4(n,e,t,i){const r={},s=new WeakMap;function o(f){const p=f.target;p.index!==null&&e.remove(p.index);for(const v in p.attributes)e.remove(p.attributes[v]);for(const v in p.morphAttributes){const x=p.morphAttributes[v];for(let y=0,g=x.length;y<g;y++)e.remove(x[y])}p.removeEventListener("dispose",o),delete r[p.id];const m=s.get(p);m&&(e.remove(m),s.delete(p)),i.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,t.memory.geometries--}function a(f,p){return r[p.id]===!0||(p.addEventListener("dispose",o),r[p.id]=!0,t.memory.geometries++),p}function l(f){const p=f.attributes;for(const v in p)e.update(p[v],n.ARRAY_BUFFER);const m=f.morphAttributes;for(const v in m){const x=m[v];for(let y=0,g=x.length;y<g;y++)e.update(x[y],n.ARRAY_BUFFER)}}function u(f){const p=[],m=f.index,v=f.attributes.position;let x=0;if(m!==null){const T=m.array;x=m.version;for(let S=0,w=T.length;S<w;S+=3){const M=T[S+0],R=T[S+1],P=T[S+2];p.push(M,R,R,P,P,M)}}else if(v!==void 0){const T=v.array;x=v.version;for(let S=0,w=T.length/3-1;S<w;S+=3){const M=S+0,R=S+1,P=S+2;p.push(M,R,R,P,P,M)}}else return;const y=new(eI(p)?aI:oI)(p,1);y.version=x;const g=s.get(f);g&&e.remove(g),s.set(f,y)}function d(f){const p=s.get(f);if(p){const m=f.index;m!==null&&p.version<m.version&&u(f)}else u(f);return s.get(f)}return{get:a,update:l,getWireframeAttribute:d}}function h4(n,e,t,i){const r=i.isWebGL2;let s;function o(m){s=m}let a,l;function u(m){a=m.type,l=m.bytesPerElement}function d(m,v){n.drawElements(s,v,a,m*l),t.update(v,s,1)}function f(m,v,x){if(x===0)return;let y,g;if(r)y=n,g="drawElementsInstanced";else if(y=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",y===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}y[g](s,v,a,m*l,x),t.update(v,s,x)}function p(m,v,x){if(x===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let g=0;g<x;g++)this.render(m[g]/l,v[g]);else{y.multiDrawElementsWEBGL(s,v,0,a,m,0,x);let g=0;for(let T=0;T<x;T++)g+=v[T];t.update(g,s,1)}}this.setMode=o,this.setIndex=u,this.render=d,this.renderInstances=f,this.renderMultiDraw=p}function d4(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function f4(n,e){return n[0]-e[0]}function p4(n,e){return Math.abs(e[1])-Math.abs(n[1])}function m4(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new Zt,a=[];for(let u=0;u<8;u++)a[u]=[u,0];function l(u,d,f){const p=u.morphTargetInfluences;if(e.isWebGL2===!0){const v=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,x=v!==void 0?v.length:0;let y=s.get(d);if(y===void 0||y.count!==x){let X=function(){z.dispose(),s.delete(d),d.removeEventListener("dispose",X)};var m=X;y!==void 0&&y.texture.dispose();const S=d.morphAttributes.position!==void 0,w=d.morphAttributes.normal!==void 0,M=d.morphAttributes.color!==void 0,R=d.morphAttributes.position||[],P=d.morphAttributes.normal||[],N=d.morphAttributes.color||[];let C=0;S===!0&&(C=1),w===!0&&(C=2),M===!0&&(C=3);let L=d.attributes.position.count*C,Q=1;L>e.maxTextureSize&&(Q=Math.ceil(L/e.maxTextureSize),L=e.maxTextureSize);const W=new Float32Array(L*Q*4*x),z=new iI(W,L,Q,x);z.type=So,z.needsUpdate=!0;const F=C*4;for(let Z=0;Z<x;Z++){const $=R[Z],O=P[Z],H=N[Z],B=L*Q*4*Z;for(let G=0;G<$.count;G++){const ne=G*F;S===!0&&(o.fromBufferAttribute($,G),W[B+ne+0]=o.x,W[B+ne+1]=o.y,W[B+ne+2]=o.z,W[B+ne+3]=0),w===!0&&(o.fromBufferAttribute(O,G),W[B+ne+4]=o.x,W[B+ne+5]=o.y,W[B+ne+6]=o.z,W[B+ne+7]=0),M===!0&&(o.fromBufferAttribute(H,G),W[B+ne+8]=o.x,W[B+ne+9]=o.y,W[B+ne+10]=o.z,W[B+ne+11]=H.itemSize===4?o.w:1)}}y={count:x,texture:z,size:new Ut(L,Q)},s.set(d,y),d.addEventListener("dispose",X)}let g=0;for(let S=0;S<p.length;S++)g+=p[S];const T=d.morphTargetsRelative?1:1-g;f.getUniforms().setValue(n,"morphTargetBaseInfluence",T),f.getUniforms().setValue(n,"morphTargetInfluences",p),f.getUniforms().setValue(n,"morphTargetsTexture",y.texture,t),f.getUniforms().setValue(n,"morphTargetsTextureSize",y.size)}else{const v=p===void 0?0:p.length;let x=i[d.id];if(x===void 0||x.length!==v){x=[];for(let w=0;w<v;w++)x[w]=[w,0];i[d.id]=x}for(let w=0;w<v;w++){const M=x[w];M[0]=w,M[1]=p[w]}x.sort(p4);for(let w=0;w<8;w++)w<v&&x[w][1]?(a[w][0]=x[w][0],a[w][1]=x[w][1]):(a[w][0]=Number.MAX_SAFE_INTEGER,a[w][1]=0);a.sort(f4);const y=d.morphAttributes.position,g=d.morphAttributes.normal;let T=0;for(let w=0;w<8;w++){const M=a[w],R=M[0],P=M[1];R!==Number.MAX_SAFE_INTEGER&&P?(y&&d.getAttribute("morphTarget"+w)!==y[R]&&d.setAttribute("morphTarget"+w,y[R]),g&&d.getAttribute("morphNormal"+w)!==g[R]&&d.setAttribute("morphNormal"+w,g[R]),r[w]=P,T+=P):(y&&d.hasAttribute("morphTarget"+w)===!0&&d.deleteAttribute("morphTarget"+w),g&&d.hasAttribute("morphNormal"+w)===!0&&d.deleteAttribute("morphNormal"+w),r[w]=0)}const S=d.morphTargetsRelative?1:1-T;f.getUniforms().setValue(n,"morphTargetBaseInfluence",S),f.getUniforms().setValue(n,"morphTargetInfluences",r)}}return{update:l}}function g4(n,e,t,i){let r=new WeakMap;function s(l){const u=i.render.frame,d=l.geometry,f=e.get(l,d);if(r.get(f)!==u&&(e.update(f),r.set(f,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==u&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,u))),l.isSkinnedMesh){const p=l.skeleton;r.get(p)!==u&&(p.update(),r.set(p,u))}return f}function o(){r=new WeakMap}function a(l){const u=l.target;u.removeEventListener("dispose",a),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:s,dispose:o}}class fI extends hr{constructor(e,t,i,r,s,o,a,l,u,d){if(d=d!==void 0?d:Il,d!==Il&&d!==Bc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&d===Il&&(i=ma),i===void 0&&d===Bc&&(i=Pl),super(null,r,s,o,a,l,d,i,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:ti,this.minFilter=l!==void 0?l:ti,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const pI=new hr,mI=new fI(1,1);mI.compareFunction=JP;const gI=new iI,_I=new JF,vI=new cI,UA=[],FA=[],OA=new Float32Array(16),BA=new Float32Array(9),kA=new Float32Array(4);function Jc(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=UA[r];if(s===void 0&&(s=new Float32Array(r),UA[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Hn(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Vn(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function E0(n,e){let t=FA[e];t===void 0&&(t=new Int32Array(e),FA[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function _4(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function v4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Hn(t,e))return;n.uniform2fv(this.addr,e),Vn(t,e)}}function y4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Hn(t,e))return;n.uniform3fv(this.addr,e),Vn(t,e)}}function x4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Hn(t,e))return;n.uniform4fv(this.addr,e),Vn(t,e)}}function S4(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Hn(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Vn(t,e)}else{if(Hn(t,i))return;kA.set(i),n.uniformMatrix2fv(this.addr,!1,kA),Vn(t,i)}}function E4(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Hn(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Vn(t,e)}else{if(Hn(t,i))return;BA.set(i),n.uniformMatrix3fv(this.addr,!1,BA),Vn(t,i)}}function T4(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Hn(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Vn(t,e)}else{if(Hn(t,i))return;OA.set(i),n.uniformMatrix4fv(this.addr,!1,OA),Vn(t,i)}}function b4(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function w4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Hn(t,e))return;n.uniform2iv(this.addr,e),Vn(t,e)}}function A4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Hn(t,e))return;n.uniform3iv(this.addr,e),Vn(t,e)}}function M4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Hn(t,e))return;n.uniform4iv(this.addr,e),Vn(t,e)}}function C4(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function R4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Hn(t,e))return;n.uniform2uiv(this.addr,e),Vn(t,e)}}function P4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Hn(t,e))return;n.uniform3uiv(this.addr,e),Vn(t,e)}}function I4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Hn(t,e))return;n.uniform4uiv(this.addr,e),Vn(t,e)}}function L4(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r);const s=this.type===n.SAMPLER_2D_SHADOW?mI:pI;t.setTexture2D(e||s,r)}function D4(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||_I,r)}function N4(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||vI,r)}function U4(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||gI,r)}function F4(n){switch(n){case 5126:return _4;case 35664:return v4;case 35665:return y4;case 35666:return x4;case 35674:return S4;case 35675:return E4;case 35676:return T4;case 5124:case 35670:return b4;case 35667:case 35671:return w4;case 35668:case 35672:return A4;case 35669:case 35673:return M4;case 5125:return C4;case 36294:return R4;case 36295:return P4;case 36296:return I4;case 35678:case 36198:case 36298:case 36306:case 35682:return L4;case 35679:case 36299:case 36307:return D4;case 35680:case 36300:case 36308:case 36293:return N4;case 36289:case 36303:case 36311:case 36292:return U4}}function O4(n,e){n.uniform1fv(this.addr,e)}function B4(n,e){const t=Jc(e,this.size,2);n.uniform2fv(this.addr,t)}function k4(n,e){const t=Jc(e,this.size,3);n.uniform3fv(this.addr,t)}function z4(n,e){const t=Jc(e,this.size,4);n.uniform4fv(this.addr,t)}function G4(n,e){const t=Jc(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function H4(n,e){const t=Jc(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function V4(n,e){const t=Jc(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function W4(n,e){n.uniform1iv(this.addr,e)}function X4(n,e){n.uniform2iv(this.addr,e)}function j4(n,e){n.uniform3iv(this.addr,e)}function $4(n,e){n.uniform4iv(this.addr,e)}function Y4(n,e){n.uniform1uiv(this.addr,e)}function q4(n,e){n.uniform2uiv(this.addr,e)}function K4(n,e){n.uniform3uiv(this.addr,e)}function Z4(n,e){n.uniform4uiv(this.addr,e)}function Q4(n,e,t){const i=this.cache,r=e.length,s=E0(t,r);Hn(i,s)||(n.uniform1iv(this.addr,s),Vn(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||pI,s[o])}function J4(n,e,t){const i=this.cache,r=e.length,s=E0(t,r);Hn(i,s)||(n.uniform1iv(this.addr,s),Vn(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||_I,s[o])}function e5(n,e,t){const i=this.cache,r=e.length,s=E0(t,r);Hn(i,s)||(n.uniform1iv(this.addr,s),Vn(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||vI,s[o])}function t5(n,e,t){const i=this.cache,r=e.length,s=E0(t,r);Hn(i,s)||(n.uniform1iv(this.addr,s),Vn(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||gI,s[o])}function n5(n){switch(n){case 5126:return O4;case 35664:return B4;case 35665:return k4;case 35666:return z4;case 35674:return G4;case 35675:return H4;case 35676:return V4;case 5124:case 35670:return W4;case 35667:case 35671:return X4;case 35668:case 35672:return j4;case 35669:case 35673:return $4;case 5125:return Y4;case 36294:return q4;case 36295:return K4;case 36296:return Z4;case 35678:case 36198:case 36298:case 36306:case 35682:return Q4;case 35679:case 36299:case 36307:return J4;case 35680:case 36300:case 36308:case 36293:return e5;case 36289:case 36303:case 36311:case 36292:return t5}}class i5{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=F4(t.type)}}class r5{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=n5(t.type)}}class s5{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const qv=/(\w+)(\])?(\[|\.)?/g;function zA(n,e){n.seq.push(e),n.map[e.id]=e}function o5(n,e,t){const i=n.name,r=i.length;for(qv.lastIndex=0;;){const s=qv.exec(i),o=qv.lastIndex;let a=s[1];const l=s[2]==="]",u=s[3];if(l&&(a=a|0),u===void 0||u==="["&&o+2===r){zA(t,u===void 0?new i5(a,n,e):new r5(a,n,e));break}else{let f=t.map[a];f===void 0&&(f=new s5(a),zA(t,f)),t=f}}}class Wm{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);o5(s,o,this)}}setValue(e,t,i,r){const s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function GA(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const a5=37297;let l5=0;function u5(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join(`
`)}function c5(n){const e=Xt.getPrimaries(Xt.workingColorSpace),t=Xt.getPrimaries(n);let i;switch(e===t?i="":e===Pg&&t===Rg?i="LinearDisplayP3ToLinearSRGB":e===Rg&&t===Pg&&(i="LinearSRGBToLinearDisplayP3"),n){case mi:case y0:return[i,"LinearTransferOETF"];case Tn:case sE:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}function HA(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+u5(n.getShaderSource(e),o)}else return r}function h5(n,e){const t=c5(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function d5(n,e){let t;switch(e){case aF:t="Linear";break;case lF:t="Reinhard";break;case uF:t="OptimizedCineon";break;case cF:t="ACESFilmic";break;case hF:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function f5(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Zh).join(`
`)}function p5(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function m5(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function Zh(n){return n!==""}function VA(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function WA(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const g5=/^[ \t]*#include +<([\w\d./]+)>/gm;function e1(n){return n.replace(g5,v5)}const _5=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function v5(n,e){let t=Tt[e];if(t===void 0){const i=_5.get(e);if(i!==void 0)t=Tt[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return e1(t)}const y5=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function XA(n){return n.replace(y5,x5)}function x5(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function jA(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function S5(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===kP?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===UU?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===ho&&(e="SHADOWMAP_TYPE_VSM"),e}function E5(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Uc:case Fc:e="ENVMAP_TYPE_CUBE";break;case v0:e="ENVMAP_TYPE_CUBE_UV";break}return e}function T5(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Fc:e="ENVMAP_MODE_REFRACTION";break}return e}function b5(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case zP:e="ENVMAP_BLENDING_MULTIPLY";break;case sF:e="ENVMAP_BLENDING_MIX";break;case oF:e="ENVMAP_BLENDING_ADD";break}return e}function w5(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function A5(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=S5(t),u=E5(t),d=T5(t),f=b5(t),p=w5(t),m=t.isWebGL2?"":f5(t),v=p5(s),x=r.createProgram();let y,g,T=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(y=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v].filter(Zh).join(`
`),y.length>0&&(y+=`
`),g=[m,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v].filter(Zh).join(`
`),g.length>0&&(g+=`
`)):(y=[jA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v,t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Zh).join(`
`),g=[m,jA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",t.envMap?"#define "+f:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Ca?"#define TONE_MAPPING":"",t.toneMapping!==Ca?Tt.tonemapping_pars_fragment:"",t.toneMapping!==Ca?d5("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Tt.colorspace_pars_fragment,h5("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Zh).join(`
`)),o=e1(o),o=VA(o,t),o=WA(o,t),a=e1(a),a=VA(a,t),a=WA(a,t),o=XA(o),a=XA(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(T=`#version 300 es
`,y=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,g=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===cA?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===cA?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+g);const S=T+y+o,w=T+g+a,M=GA(r,r.VERTEX_SHADER,S),R=GA(r,r.FRAGMENT_SHADER,w);r.attachShader(x,M),r.attachShader(x,R),t.index0AttributeName!==void 0?r.bindAttribLocation(x,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(x,0,"position"),r.linkProgram(x);function P(Q){if(n.debug.checkShaderErrors){const W=r.getProgramInfoLog(x).trim(),z=r.getShaderInfoLog(M).trim(),F=r.getShaderInfoLog(R).trim();let X=!0,Z=!0;if(r.getProgramParameter(x,r.LINK_STATUS)===!1)if(X=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,x,M,R);else{const $=HA(r,M,"vertex"),O=HA(r,R,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(x,r.VALIDATE_STATUS)+`

Program Info Log: `+W+`
`+$+`
`+O)}else W!==""?console.warn("THREE.WebGLProgram: Program Info Log:",W):(z===""||F==="")&&(Z=!1);Z&&(Q.diagnostics={runnable:X,programLog:W,vertexShader:{log:z,prefix:y},fragmentShader:{log:F,prefix:g}})}r.deleteShader(M),r.deleteShader(R),N=new Wm(r,x),C=m5(r,x)}let N;this.getUniforms=function(){return N===void 0&&P(this),N};let C;this.getAttributes=function(){return C===void 0&&P(this),C};let L=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return L===!1&&(L=r.getProgramParameter(x,a5)),L},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(x),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=l5++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=M,this.fragmentShader=R,this}let M5=0;class C5{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new R5(e),t.set(e,i)),i}}class R5{constructor(e){this.id=M5++,this.code=e,this.usedTimes=0}}function P5(n,e,t,i,r,s,o){const a=new rI,l=new C5,u=[],d=r.isWebGL2,f=r.logarithmicDepthBuffer,p=r.vertexTextures;let m=r.precision;const v={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function x(C){return C===0?"uv":`uv${C}`}function y(C,L,Q,W,z){const F=W.fog,X=z.geometry,Z=C.isMeshStandardMaterial?W.environment:null,$=(C.isMeshStandardMaterial?t:e).get(C.envMap||Z),O=$&&$.mapping===v0?$.image.height:null,H=v[C.type];C.precision!==null&&(m=r.getMaxPrecision(C.precision),m!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",m,"instead."));const B=X.morphAttributes.position||X.morphAttributes.normal||X.morphAttributes.color,G=B!==void 0?B.length:0;let ne=0;X.morphAttributes.position!==void 0&&(ne=1),X.morphAttributes.normal!==void 0&&(ne=2),X.morphAttributes.color!==void 0&&(ne=3);let ee,ie,pe,ve;if(H){const Wn=Is[H];ee=Wn.vertexShader,ie=Wn.fragmentShader}else ee=C.vertexShader,ie=C.fragmentShader,l.update(C),pe=l.getVertexShaderID(C),ve=l.getFragmentShaderID(C);const Me=n.getRenderTarget(),Ze=z.isInstancedMesh===!0,Ye=z.isBatchedMesh===!0,ze=!!C.map,Ie=!!C.matcap,q=!!$,ct=!!C.aoMap,Xe=!!C.lightMap,st=!!C.bumpMap,nt=!!C.normalMap,Kt=!!C.displacementMap,gt=!!C.emissiveMap,xt=!!C.metalnessMap,Ft=!!C.roughnessMap,Un=C.anisotropy>0,Fn=C.clearcoat>0,k=C.iridescence>0,I=C.sheen>0,re=C.transmission>0,we=Un&&!!C.anisotropyMap,ye=Fn&&!!C.clearcoatMap,Ae=Fn&&!!C.clearcoatNormalMap,Qe=Fn&&!!C.clearcoatRoughnessMap,Re=k&&!!C.iridescenceMap,Oe=k&&!!C.iridescenceThicknessMap,ft=I&&!!C.sheenColorMap,Bt=I&&!!C.sheenRoughnessMap,be=!!C.specularMap,Ht=!!C.specularColorMap,yt=!!C.specularIntensityMap,ht=re&&!!C.transmissionMap,it=re&&!!C.thicknessMap,Ve=!!C.gradientMap,wt=!!C.alphaMap,j=C.alphaTest>0,Be=!!C.alphaHash,Te=!!C.extensions,ce=!!X.attributes.uv1,Ce=!!X.attributes.uv2,at=!!X.attributes.uv3;let Ct=Ca;return C.toneMapped&&(Me===null||Me.isXRRenderTarget===!0)&&(Ct=n.toneMapping),{isWebGL2:d,shaderID:H,shaderType:C.type,shaderName:C.name,vertexShader:ee,fragmentShader:ie,defines:C.defines,customVertexShaderID:pe,customFragmentShaderID:ve,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:m,batching:Ye,instancing:Ze,instancingColor:Ze&&z.instanceColor!==null,supportsVertexTextures:p,outputColorSpace:Me===null?n.outputColorSpace:Me.isXRRenderTarget===!0?Me.texture.colorSpace:mi,map:ze,matcap:Ie,envMap:q,envMapMode:q&&$.mapping,envMapCubeUVHeight:O,aoMap:ct,lightMap:Xe,bumpMap:st,normalMap:nt,displacementMap:p&&Kt,emissiveMap:gt,normalMapObjectSpace:nt&&C.normalMapType===wF,normalMapTangentSpace:nt&&C.normalMapType===QP,metalnessMap:xt,roughnessMap:Ft,anisotropy:Un,anisotropyMap:we,clearcoat:Fn,clearcoatMap:ye,clearcoatNormalMap:Ae,clearcoatRoughnessMap:Qe,iridescence:k,iridescenceMap:Re,iridescenceThicknessMap:Oe,sheen:I,sheenColorMap:ft,sheenRoughnessMap:Bt,specularMap:be,specularColorMap:Ht,specularIntensityMap:yt,transmission:re,transmissionMap:ht,thicknessMap:it,gradientMap:Ve,opaque:C.transparent===!1&&C.blending===vc,alphaMap:wt,alphaTest:j,alphaHash:Be,combine:C.combine,mapUv:ze&&x(C.map.channel),aoMapUv:ct&&x(C.aoMap.channel),lightMapUv:Xe&&x(C.lightMap.channel),bumpMapUv:st&&x(C.bumpMap.channel),normalMapUv:nt&&x(C.normalMap.channel),displacementMapUv:Kt&&x(C.displacementMap.channel),emissiveMapUv:gt&&x(C.emissiveMap.channel),metalnessMapUv:xt&&x(C.metalnessMap.channel),roughnessMapUv:Ft&&x(C.roughnessMap.channel),anisotropyMapUv:we&&x(C.anisotropyMap.channel),clearcoatMapUv:ye&&x(C.clearcoatMap.channel),clearcoatNormalMapUv:Ae&&x(C.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Qe&&x(C.clearcoatRoughnessMap.channel),iridescenceMapUv:Re&&x(C.iridescenceMap.channel),iridescenceThicknessMapUv:Oe&&x(C.iridescenceThicknessMap.channel),sheenColorMapUv:ft&&x(C.sheenColorMap.channel),sheenRoughnessMapUv:Bt&&x(C.sheenRoughnessMap.channel),specularMapUv:be&&x(C.specularMap.channel),specularColorMapUv:Ht&&x(C.specularColorMap.channel),specularIntensityMapUv:yt&&x(C.specularIntensityMap.channel),transmissionMapUv:ht&&x(C.transmissionMap.channel),thicknessMapUv:it&&x(C.thicknessMap.channel),alphaMapUv:wt&&x(C.alphaMap.channel),vertexTangents:!!X.attributes.tangent&&(nt||Un),vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!X.attributes.color&&X.attributes.color.itemSize===4,vertexUv1s:ce,vertexUv2s:Ce,vertexUv3s:at,pointsUvs:z.isPoints===!0&&!!X.attributes.uv&&(ze||wt),fog:!!F,useFog:C.fog===!0,fogExp2:F&&F.isFogExp2,flatShading:C.flatShading===!0,sizeAttenuation:C.sizeAttenuation===!0,logarithmicDepthBuffer:f,skinning:z.isSkinnedMesh===!0,morphTargets:X.morphAttributes.position!==void 0,morphNormals:X.morphAttributes.normal!==void 0,morphColors:X.morphAttributes.color!==void 0,morphTargetsCount:G,morphTextureStride:ne,numDirLights:L.directional.length,numPointLights:L.point.length,numSpotLights:L.spot.length,numSpotLightMaps:L.spotLightMap.length,numRectAreaLights:L.rectArea.length,numHemiLights:L.hemi.length,numDirLightShadows:L.directionalShadowMap.length,numPointLightShadows:L.pointShadowMap.length,numSpotLightShadows:L.spotShadowMap.length,numSpotLightShadowsWithMaps:L.numSpotLightShadowsWithMaps,numLightProbes:L.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:n.shadowMap.enabled&&Q.length>0,shadowMapType:n.shadowMap.type,toneMapping:Ct,useLegacyLights:n._useLegacyLights,decodeVideoTexture:ze&&C.map.isVideoTexture===!0&&Xt.getTransfer(C.map.colorSpace)===rn,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===Us,flipSided:C.side===Ki,useDepthPacking:C.depthPacking>=0,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionDerivatives:Te&&C.extensions.derivatives===!0,extensionFragDepth:Te&&C.extensions.fragDepth===!0,extensionDrawBuffers:Te&&C.extensions.drawBuffers===!0,extensionShaderTextureLOD:Te&&C.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:d||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:C.customProgramCacheKey()}}function g(C){const L=[];if(C.shaderID?L.push(C.shaderID):(L.push(C.customVertexShaderID),L.push(C.customFragmentShaderID)),C.defines!==void 0)for(const Q in C.defines)L.push(Q),L.push(C.defines[Q]);return C.isRawShaderMaterial===!1&&(T(L,C),S(L,C),L.push(n.outputColorSpace)),L.push(C.customProgramCacheKey),L.join()}function T(C,L){C.push(L.precision),C.push(L.outputColorSpace),C.push(L.envMapMode),C.push(L.envMapCubeUVHeight),C.push(L.mapUv),C.push(L.alphaMapUv),C.push(L.lightMapUv),C.push(L.aoMapUv),C.push(L.bumpMapUv),C.push(L.normalMapUv),C.push(L.displacementMapUv),C.push(L.emissiveMapUv),C.push(L.metalnessMapUv),C.push(L.roughnessMapUv),C.push(L.anisotropyMapUv),C.push(L.clearcoatMapUv),C.push(L.clearcoatNormalMapUv),C.push(L.clearcoatRoughnessMapUv),C.push(L.iridescenceMapUv),C.push(L.iridescenceThicknessMapUv),C.push(L.sheenColorMapUv),C.push(L.sheenRoughnessMapUv),C.push(L.specularMapUv),C.push(L.specularColorMapUv),C.push(L.specularIntensityMapUv),C.push(L.transmissionMapUv),C.push(L.thicknessMapUv),C.push(L.combine),C.push(L.fogExp2),C.push(L.sizeAttenuation),C.push(L.morphTargetsCount),C.push(L.morphAttributeCount),C.push(L.numDirLights),C.push(L.numPointLights),C.push(L.numSpotLights),C.push(L.numSpotLightMaps),C.push(L.numHemiLights),C.push(L.numRectAreaLights),C.push(L.numDirLightShadows),C.push(L.numPointLightShadows),C.push(L.numSpotLightShadows),C.push(L.numSpotLightShadowsWithMaps),C.push(L.numLightProbes),C.push(L.shadowMapType),C.push(L.toneMapping),C.push(L.numClippingPlanes),C.push(L.numClipIntersection),C.push(L.depthPacking)}function S(C,L){a.disableAll(),L.isWebGL2&&a.enable(0),L.supportsVertexTextures&&a.enable(1),L.instancing&&a.enable(2),L.instancingColor&&a.enable(3),L.matcap&&a.enable(4),L.envMap&&a.enable(5),L.normalMapObjectSpace&&a.enable(6),L.normalMapTangentSpace&&a.enable(7),L.clearcoat&&a.enable(8),L.iridescence&&a.enable(9),L.alphaTest&&a.enable(10),L.vertexColors&&a.enable(11),L.vertexAlphas&&a.enable(12),L.vertexUv1s&&a.enable(13),L.vertexUv2s&&a.enable(14),L.vertexUv3s&&a.enable(15),L.vertexTangents&&a.enable(16),L.anisotropy&&a.enable(17),L.alphaHash&&a.enable(18),L.batching&&a.enable(19),C.push(a.mask),a.disableAll(),L.fog&&a.enable(0),L.useFog&&a.enable(1),L.flatShading&&a.enable(2),L.logarithmicDepthBuffer&&a.enable(3),L.skinning&&a.enable(4),L.morphTargets&&a.enable(5),L.morphNormals&&a.enable(6),L.morphColors&&a.enable(7),L.premultipliedAlpha&&a.enable(8),L.shadowMapEnabled&&a.enable(9),L.useLegacyLights&&a.enable(10),L.doubleSided&&a.enable(11),L.flipSided&&a.enable(12),L.useDepthPacking&&a.enable(13),L.dithering&&a.enable(14),L.transmission&&a.enable(15),L.sheen&&a.enable(16),L.opaque&&a.enable(17),L.pointsUvs&&a.enable(18),L.decodeVideoTexture&&a.enable(19),C.push(a.mask)}function w(C){const L=v[C.type];let Q;if(L){const W=Is[L];Q=dO.clone(W.uniforms)}else Q=C.uniforms;return Q}function M(C,L){let Q;for(let W=0,z=u.length;W<z;W++){const F=u[W];if(F.cacheKey===L){Q=F,++Q.usedTimes;break}}return Q===void 0&&(Q=new A5(n,L,C,s),u.push(Q)),Q}function R(C){if(--C.usedTimes===0){const L=u.indexOf(C);u[L]=u[u.length-1],u.pop(),C.destroy()}}function P(C){l.remove(C)}function N(){l.dispose()}return{getParameters:y,getProgramCacheKey:g,getUniforms:w,acquireProgram:M,releaseProgram:R,releaseShaderCache:P,programs:u,dispose:N}}function I5(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function i(s,o,a){n.get(s)[o]=a}function r(){n=new WeakMap}return{get:e,remove:t,update:i,dispose:r}}function L5(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function $A(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function YA(){const n=[];let e=0;const t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function o(f,p,m,v,x,y){let g=n[e];return g===void 0?(g={id:f.id,object:f,geometry:p,material:m,groupOrder:v,renderOrder:f.renderOrder,z:x,group:y},n[e]=g):(g.id=f.id,g.object=f,g.geometry=p,g.material=m,g.groupOrder=v,g.renderOrder=f.renderOrder,g.z=x,g.group=y),e++,g}function a(f,p,m,v,x,y){const g=o(f,p,m,v,x,y);m.transmission>0?i.push(g):m.transparent===!0?r.push(g):t.push(g)}function l(f,p,m,v,x,y){const g=o(f,p,m,v,x,y);m.transmission>0?i.unshift(g):m.transparent===!0?r.unshift(g):t.unshift(g)}function u(f,p){t.length>1&&t.sort(f||L5),i.length>1&&i.sort(p||$A),r.length>1&&r.sort(p||$A)}function d(){for(let f=e,p=n.length;f<p;f++){const m=n[f];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:d,sort:u}}function D5(){let n=new WeakMap;function e(i,r){const s=n.get(i);let o;return s===void 0?(o=new YA,n.set(i,[o])):r>=s.length?(o=new YA,s.push(o)):o=s[r],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function N5(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Y,color:new St};break;case"SpotLight":t={position:new Y,direction:new Y,color:new St,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Y,color:new St,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Y,skyColor:new St,groundColor:new St};break;case"RectAreaLight":t={color:new St,position:new Y,halfWidth:new Y,halfHeight:new Y};break}return n[e.id]=t,t}}}function U5(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ut};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ut};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ut,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let F5=0;function O5(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function B5(n,e){const t=new N5,i=U5(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let d=0;d<9;d++)r.probe.push(new Y);const s=new Y,o=new Mt,a=new Mt;function l(d,f){let p=0,m=0,v=0;for(let W=0;W<9;W++)r.probe[W].set(0,0,0);let x=0,y=0,g=0,T=0,S=0,w=0,M=0,R=0,P=0,N=0,C=0;d.sort(O5);const L=f===!0?Math.PI:1;for(let W=0,z=d.length;W<z;W++){const F=d[W],X=F.color,Z=F.intensity,$=F.distance,O=F.shadow&&F.shadow.map?F.shadow.map.texture:null;if(F.isAmbientLight)p+=X.r*Z*L,m+=X.g*Z*L,v+=X.b*Z*L;else if(F.isLightProbe){for(let H=0;H<9;H++)r.probe[H].addScaledVector(F.sh.coefficients[H],Z);C++}else if(F.isDirectionalLight){const H=t.get(F);if(H.color.copy(F.color).multiplyScalar(F.intensity*L),F.castShadow){const B=F.shadow,G=i.get(F);G.shadowBias=B.bias,G.shadowNormalBias=B.normalBias,G.shadowRadius=B.radius,G.shadowMapSize=B.mapSize,r.directionalShadow[x]=G,r.directionalShadowMap[x]=O,r.directionalShadowMatrix[x]=F.shadow.matrix,w++}r.directional[x]=H,x++}else if(F.isSpotLight){const H=t.get(F);H.position.setFromMatrixPosition(F.matrixWorld),H.color.copy(X).multiplyScalar(Z*L),H.distance=$,H.coneCos=Math.cos(F.angle),H.penumbraCos=Math.cos(F.angle*(1-F.penumbra)),H.decay=F.decay,r.spot[g]=H;const B=F.shadow;if(F.map&&(r.spotLightMap[P]=F.map,P++,B.updateMatrices(F),F.castShadow&&N++),r.spotLightMatrix[g]=B.matrix,F.castShadow){const G=i.get(F);G.shadowBias=B.bias,G.shadowNormalBias=B.normalBias,G.shadowRadius=B.radius,G.shadowMapSize=B.mapSize,r.spotShadow[g]=G,r.spotShadowMap[g]=O,R++}g++}else if(F.isRectAreaLight){const H=t.get(F);H.color.copy(X).multiplyScalar(Z),H.halfWidth.set(F.width*.5,0,0),H.halfHeight.set(0,F.height*.5,0),r.rectArea[T]=H,T++}else if(F.isPointLight){const H=t.get(F);if(H.color.copy(F.color).multiplyScalar(F.intensity*L),H.distance=F.distance,H.decay=F.decay,F.castShadow){const B=F.shadow,G=i.get(F);G.shadowBias=B.bias,G.shadowNormalBias=B.normalBias,G.shadowRadius=B.radius,G.shadowMapSize=B.mapSize,G.shadowCameraNear=B.camera.near,G.shadowCameraFar=B.camera.far,r.pointShadow[y]=G,r.pointShadowMap[y]=O,r.pointShadowMatrix[y]=F.shadow.matrix,M++}r.point[y]=H,y++}else if(F.isHemisphereLight){const H=t.get(F);H.skyColor.copy(F.color).multiplyScalar(Z*L),H.groundColor.copy(F.groundColor).multiplyScalar(Z*L),r.hemi[S]=H,S++}}T>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=Le.LTC_FLOAT_1,r.rectAreaLTC2=Le.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=Le.LTC_HALF_1,r.rectAreaLTC2=Le.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=p,r.ambient[1]=m,r.ambient[2]=v;const Q=r.hash;(Q.directionalLength!==x||Q.pointLength!==y||Q.spotLength!==g||Q.rectAreaLength!==T||Q.hemiLength!==S||Q.numDirectionalShadows!==w||Q.numPointShadows!==M||Q.numSpotShadows!==R||Q.numSpotMaps!==P||Q.numLightProbes!==C)&&(r.directional.length=x,r.spot.length=g,r.rectArea.length=T,r.point.length=y,r.hemi.length=S,r.directionalShadow.length=w,r.directionalShadowMap.length=w,r.pointShadow.length=M,r.pointShadowMap.length=M,r.spotShadow.length=R,r.spotShadowMap.length=R,r.directionalShadowMatrix.length=w,r.pointShadowMatrix.length=M,r.spotLightMatrix.length=R+P-N,r.spotLightMap.length=P,r.numSpotLightShadowsWithMaps=N,r.numLightProbes=C,Q.directionalLength=x,Q.pointLength=y,Q.spotLength=g,Q.rectAreaLength=T,Q.hemiLength=S,Q.numDirectionalShadows=w,Q.numPointShadows=M,Q.numSpotShadows=R,Q.numSpotMaps=P,Q.numLightProbes=C,r.version=F5++)}function u(d,f){let p=0,m=0,v=0,x=0,y=0;const g=f.matrixWorldInverse;for(let T=0,S=d.length;T<S;T++){const w=d[T];if(w.isDirectionalLight){const M=r.directional[p];M.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(g),p++}else if(w.isSpotLight){const M=r.spot[v];M.position.setFromMatrixPosition(w.matrixWorld),M.position.applyMatrix4(g),M.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(g),v++}else if(w.isRectAreaLight){const M=r.rectArea[x];M.position.setFromMatrixPosition(w.matrixWorld),M.position.applyMatrix4(g),a.identity(),o.copy(w.matrixWorld),o.premultiply(g),a.extractRotation(o),M.halfWidth.set(w.width*.5,0,0),M.halfHeight.set(0,w.height*.5,0),M.halfWidth.applyMatrix4(a),M.halfHeight.applyMatrix4(a),x++}else if(w.isPointLight){const M=r.point[m];M.position.setFromMatrixPosition(w.matrixWorld),M.position.applyMatrix4(g),m++}else if(w.isHemisphereLight){const M=r.hemi[y];M.direction.setFromMatrixPosition(w.matrixWorld),M.direction.transformDirection(g),y++}}}return{setup:l,setupView:u,state:r}}function qA(n,e){const t=new B5(n,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(f){i.push(f)}function a(f){r.push(f)}function l(f){t.setup(i,f)}function u(f){t.setupView(i,f)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:l,setupLightsView:u,pushLight:o,pushShadow:a}}function k5(n,e){let t=new WeakMap;function i(s,o=0){const a=t.get(s);let l;return a===void 0?(l=new qA(n,e),t.set(s,[l])):o>=a.length?(l=new qA(n,e),a.push(l)):l=a[o],l}function r(){t=new WeakMap}return{get:i,dispose:r}}class z5 extends Gs{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=TF,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class G5 extends Gs{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const H5=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,V5=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function W5(n,e,t){let i=new aE;const r=new Ut,s=new Ut,o=new Zt,a=new z5({depthPacking:bF}),l=new G5,u={},d=t.maxTextureSize,f={[No]:Ki,[Ki]:No,[Us]:Us},p=new Xl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ut},radius:{value:4}},vertexShader:H5,fragmentShader:V5}),m=p.clone();m.defines.HORIZONTAL_PASS=1;const v=new Ys;v.setAttribute("position",new Fi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const x=new Nr(v,p),y=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=kP;let g=this.type;this.render=function(M,R,P){if(y.enabled===!1||y.autoUpdate===!1&&y.needsUpdate===!1||M.length===0)return;const N=n.getRenderTarget(),C=n.getActiveCubeFace(),L=n.getActiveMipmapLevel(),Q=n.state;Q.setBlending(Ma),Q.buffers.color.setClear(1,1,1,1),Q.buffers.depth.setTest(!0),Q.setScissorTest(!1);const W=g!==ho&&this.type===ho,z=g===ho&&this.type!==ho;for(let F=0,X=M.length;F<X;F++){const Z=M[F],$=Z.shadow;if($===void 0){console.warn("THREE.WebGLShadowMap:",Z,"has no shadow.");continue}if($.autoUpdate===!1&&$.needsUpdate===!1)continue;r.copy($.mapSize);const O=$.getFrameExtents();if(r.multiply(O),s.copy($.mapSize),(r.x>d||r.y>d)&&(r.x>d&&(s.x=Math.floor(d/O.x),r.x=s.x*O.x,$.mapSize.x=s.x),r.y>d&&(s.y=Math.floor(d/O.y),r.y=s.y*O.y,$.mapSize.y=s.y)),$.map===null||W===!0||z===!0){const B=this.type!==ho?{minFilter:ti,magFilter:ti}:{};$.map!==null&&$.map.dispose(),$.map=new Wl(r.x,r.y,B),$.map.texture.name=Z.name+".shadowMap",$.camera.updateProjectionMatrix()}n.setRenderTarget($.map),n.clear();const H=$.getViewportCount();for(let B=0;B<H;B++){const G=$.getViewport(B);o.set(s.x*G.x,s.y*G.y,s.x*G.z,s.y*G.w),Q.viewport(o),$.updateMatrices(Z,B),i=$.getFrustum(),w(R,P,$.camera,Z,this.type)}$.isPointLightShadow!==!0&&this.type===ho&&T($,P),$.needsUpdate=!1}g=this.type,y.needsUpdate=!1,n.setRenderTarget(N,C,L)};function T(M,R){const P=e.update(x);p.defines.VSM_SAMPLES!==M.blurSamples&&(p.defines.VSM_SAMPLES=M.blurSamples,m.defines.VSM_SAMPLES=M.blurSamples,p.needsUpdate=!0,m.needsUpdate=!0),M.mapPass===null&&(M.mapPass=new Wl(r.x,r.y)),p.uniforms.shadow_pass.value=M.map.texture,p.uniforms.resolution.value=M.mapSize,p.uniforms.radius.value=M.radius,n.setRenderTarget(M.mapPass),n.clear(),n.renderBufferDirect(R,null,P,p,x,null),m.uniforms.shadow_pass.value=M.mapPass.texture,m.uniforms.resolution.value=M.mapSize,m.uniforms.radius.value=M.radius,n.setRenderTarget(M.map),n.clear(),n.renderBufferDirect(R,null,P,m,x,null)}function S(M,R,P,N){let C=null;const L=P.isPointLight===!0?M.customDistanceMaterial:M.customDepthMaterial;if(L!==void 0)C=L;else if(C=P.isPointLight===!0?l:a,n.localClippingEnabled&&R.clipShadows===!0&&Array.isArray(R.clippingPlanes)&&R.clippingPlanes.length!==0||R.displacementMap&&R.displacementScale!==0||R.alphaMap&&R.alphaTest>0||R.map&&R.alphaTest>0){const Q=C.uuid,W=R.uuid;let z=u[Q];z===void 0&&(z={},u[Q]=z);let F=z[W];F===void 0&&(F=C.clone(),z[W]=F),C=F}if(C.visible=R.visible,C.wireframe=R.wireframe,N===ho?C.side=R.shadowSide!==null?R.shadowSide:R.side:C.side=R.shadowSide!==null?R.shadowSide:f[R.side],C.alphaMap=R.alphaMap,C.alphaTest=R.alphaTest,C.map=R.map,C.clipShadows=R.clipShadows,C.clippingPlanes=R.clippingPlanes,C.clipIntersection=R.clipIntersection,C.displacementMap=R.displacementMap,C.displacementScale=R.displacementScale,C.displacementBias=R.displacementBias,C.wireframeLinewidth=R.wireframeLinewidth,C.linewidth=R.linewidth,P.isPointLight===!0&&C.isMeshDistanceMaterial===!0){const Q=n.properties.get(C);Q.light=P}return C}function w(M,R,P,N,C){if(M.visible===!1)return;if(M.layers.test(R.layers)&&(M.isMesh||M.isLine||M.isPoints)&&(M.castShadow||M.receiveShadow&&C===ho)&&(!M.frustumCulled||i.intersectsObject(M))){M.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,M.matrixWorld);const W=e.update(M),z=M.material;if(Array.isArray(z)){const F=W.groups;for(let X=0,Z=F.length;X<Z;X++){const $=F[X],O=z[$.materialIndex];if(O&&O.visible){const H=S(M,O,N,C);M.onBeforeShadow(n,M,R,P,W,H,$),n.renderBufferDirect(P,null,W,H,M,$),M.onAfterShadow(n,M,R,P,W,H,$)}}}else if(z.visible){const F=S(M,z,N,C);M.onBeforeShadow(n,M,R,P,W,F,null),n.renderBufferDirect(P,null,W,F,M,null),M.onAfterShadow(n,M,R,P,W,F,null)}}const Q=M.children;for(let W=0,z=Q.length;W<z;W++)w(Q[W],R,P,N,C)}}function X5(n,e,t){const i=t.isWebGL2;function r(){let j=!1;const Be=new Zt;let Te=null;const ce=new Zt(0,0,0,0);return{setMask:function(Ce){Te!==Ce&&!j&&(n.colorMask(Ce,Ce,Ce,Ce),Te=Ce)},setLocked:function(Ce){j=Ce},setClear:function(Ce,at,Ct,wn,Wn){Wn===!0&&(Ce*=wn,at*=wn,Ct*=wn),Be.set(Ce,at,Ct,wn),ce.equals(Be)===!1&&(n.clearColor(Ce,at,Ct,wn),ce.copy(Be))},reset:function(){j=!1,Te=null,ce.set(-1,0,0,0)}}}function s(){let j=!1,Be=null,Te=null,ce=null;return{setTest:function(Ce){Ce?Ye(n.DEPTH_TEST):ze(n.DEPTH_TEST)},setMask:function(Ce){Be!==Ce&&!j&&(n.depthMask(Ce),Be=Ce)},setFunc:function(Ce){if(Te!==Ce){switch(Ce){case QU:n.depthFunc(n.NEVER);break;case JU:n.depthFunc(n.ALWAYS);break;case eF:n.depthFunc(n.LESS);break;case Ag:n.depthFunc(n.LEQUAL);break;case tF:n.depthFunc(n.EQUAL);break;case nF:n.depthFunc(n.GEQUAL);break;case iF:n.depthFunc(n.GREATER);break;case rF:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Te=Ce}},setLocked:function(Ce){j=Ce},setClear:function(Ce){ce!==Ce&&(n.clearDepth(Ce),ce=Ce)},reset:function(){j=!1,Be=null,Te=null,ce=null}}}function o(){let j=!1,Be=null,Te=null,ce=null,Ce=null,at=null,Ct=null,wn=null,Wn=null;return{setTest:function(Yt){j||(Yt?Ye(n.STENCIL_TEST):ze(n.STENCIL_TEST))},setMask:function(Yt){Be!==Yt&&!j&&(n.stencilMask(Yt),Be=Yt)},setFunc:function(Yt,ri,pr){(Te!==Yt||ce!==ri||Ce!==pr)&&(n.stencilFunc(Yt,ri,pr),Te=Yt,ce=ri,Ce=pr)},setOp:function(Yt,ri,pr){(at!==Yt||Ct!==ri||wn!==pr)&&(n.stencilOp(Yt,ri,pr),at=Yt,Ct=ri,wn=pr)},setLocked:function(Yt){j=Yt},setClear:function(Yt){Wn!==Yt&&(n.clearStencil(Yt),Wn=Yt)},reset:function(){j=!1,Be=null,Te=null,ce=null,Ce=null,at=null,Ct=null,wn=null,Wn=null}}}const a=new r,l=new s,u=new o,d=new WeakMap,f=new WeakMap;let p={},m={},v=new WeakMap,x=[],y=null,g=!1,T=null,S=null,w=null,M=null,R=null,P=null,N=null,C=new St(0,0,0),L=0,Q=!1,W=null,z=null,F=null,X=null,Z=null;const $=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let O=!1,H=0;const B=n.getParameter(n.VERSION);B.indexOf("WebGL")!==-1?(H=parseFloat(/^WebGL (\d)/.exec(B)[1]),O=H>=1):B.indexOf("OpenGL ES")!==-1&&(H=parseFloat(/^OpenGL ES (\d)/.exec(B)[1]),O=H>=2);let G=null,ne={};const ee=n.getParameter(n.SCISSOR_BOX),ie=n.getParameter(n.VIEWPORT),pe=new Zt().fromArray(ee),ve=new Zt().fromArray(ie);function Me(j,Be,Te,ce){const Ce=new Uint8Array(4),at=n.createTexture();n.bindTexture(j,at),n.texParameteri(j,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(j,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Ct=0;Ct<Te;Ct++)i&&(j===n.TEXTURE_3D||j===n.TEXTURE_2D_ARRAY)?n.texImage3D(Be,0,n.RGBA,1,1,ce,0,n.RGBA,n.UNSIGNED_BYTE,Ce):n.texImage2D(Be+Ct,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Ce);return at}const Ze={};Ze[n.TEXTURE_2D]=Me(n.TEXTURE_2D,n.TEXTURE_2D,1),Ze[n.TEXTURE_CUBE_MAP]=Me(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Ze[n.TEXTURE_2D_ARRAY]=Me(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Ze[n.TEXTURE_3D]=Me(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),u.setClear(0),Ye(n.DEPTH_TEST),l.setFunc(Ag),gt(!1),xt(Cw),Ye(n.CULL_FACE),nt(Ma);function Ye(j){p[j]!==!0&&(n.enable(j),p[j]=!0)}function ze(j){p[j]!==!1&&(n.disable(j),p[j]=!1)}function Ie(j,Be){return m[j]!==Be?(n.bindFramebuffer(j,Be),m[j]=Be,i&&(j===n.DRAW_FRAMEBUFFER&&(m[n.FRAMEBUFFER]=Be),j===n.FRAMEBUFFER&&(m[n.DRAW_FRAMEBUFFER]=Be)),!0):!1}function q(j,Be){let Te=x,ce=!1;if(j)if(Te=v.get(Be),Te===void 0&&(Te=[],v.set(Be,Te)),j.isWebGLMultipleRenderTargets){const Ce=j.texture;if(Te.length!==Ce.length||Te[0]!==n.COLOR_ATTACHMENT0){for(let at=0,Ct=Ce.length;at<Ct;at++)Te[at]=n.COLOR_ATTACHMENT0+at;Te.length=Ce.length,ce=!0}}else Te[0]!==n.COLOR_ATTACHMENT0&&(Te[0]=n.COLOR_ATTACHMENT0,ce=!0);else Te[0]!==n.BACK&&(Te[0]=n.BACK,ce=!0);ce&&(t.isWebGL2?n.drawBuffers(Te):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Te))}function ct(j){return y!==j?(n.useProgram(j),y=j,!0):!1}const Xe={[gl]:n.FUNC_ADD,[OU]:n.FUNC_SUBTRACT,[BU]:n.FUNC_REVERSE_SUBTRACT};if(i)Xe[Lw]=n.MIN,Xe[Dw]=n.MAX;else{const j=e.get("EXT_blend_minmax");j!==null&&(Xe[Lw]=j.MIN_EXT,Xe[Dw]=j.MAX_EXT)}const st={[kU]:n.ZERO,[zU]:n.ONE,[GU]:n.SRC_COLOR,[Xx]:n.SRC_ALPHA,[$U]:n.SRC_ALPHA_SATURATE,[XU]:n.DST_COLOR,[VU]:n.DST_ALPHA,[HU]:n.ONE_MINUS_SRC_COLOR,[jx]:n.ONE_MINUS_SRC_ALPHA,[jU]:n.ONE_MINUS_DST_COLOR,[WU]:n.ONE_MINUS_DST_ALPHA,[YU]:n.CONSTANT_COLOR,[qU]:n.ONE_MINUS_CONSTANT_COLOR,[KU]:n.CONSTANT_ALPHA,[ZU]:n.ONE_MINUS_CONSTANT_ALPHA};function nt(j,Be,Te,ce,Ce,at,Ct,wn,Wn,Yt){if(j===Ma){g===!0&&(ze(n.BLEND),g=!1);return}if(g===!1&&(Ye(n.BLEND),g=!0),j!==FU){if(j!==T||Yt!==Q){if((S!==gl||R!==gl)&&(n.blendEquation(n.FUNC_ADD),S=gl,R=gl),Yt)switch(j){case vc:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Rw:n.blendFunc(n.ONE,n.ONE);break;case Pw:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case Iw:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",j);break}else switch(j){case vc:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Rw:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case Pw:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case Iw:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",j);break}w=null,M=null,P=null,N=null,C.set(0,0,0),L=0,T=j,Q=Yt}return}Ce=Ce||Be,at=at||Te,Ct=Ct||ce,(Be!==S||Ce!==R)&&(n.blendEquationSeparate(Xe[Be],Xe[Ce]),S=Be,R=Ce),(Te!==w||ce!==M||at!==P||Ct!==N)&&(n.blendFuncSeparate(st[Te],st[ce],st[at],st[Ct]),w=Te,M=ce,P=at,N=Ct),(wn.equals(C)===!1||Wn!==L)&&(n.blendColor(wn.r,wn.g,wn.b,Wn),C.copy(wn),L=Wn),T=j,Q=!1}function Kt(j,Be){j.side===Us?ze(n.CULL_FACE):Ye(n.CULL_FACE);let Te=j.side===Ki;Be&&(Te=!Te),gt(Te),j.blending===vc&&j.transparent===!1?nt(Ma):nt(j.blending,j.blendEquation,j.blendSrc,j.blendDst,j.blendEquationAlpha,j.blendSrcAlpha,j.blendDstAlpha,j.blendColor,j.blendAlpha,j.premultipliedAlpha),l.setFunc(j.depthFunc),l.setTest(j.depthTest),l.setMask(j.depthWrite),a.setMask(j.colorWrite);const ce=j.stencilWrite;u.setTest(ce),ce&&(u.setMask(j.stencilWriteMask),u.setFunc(j.stencilFunc,j.stencilRef,j.stencilFuncMask),u.setOp(j.stencilFail,j.stencilZFail,j.stencilZPass)),Un(j.polygonOffset,j.polygonOffsetFactor,j.polygonOffsetUnits),j.alphaToCoverage===!0?Ye(n.SAMPLE_ALPHA_TO_COVERAGE):ze(n.SAMPLE_ALPHA_TO_COVERAGE)}function gt(j){W!==j&&(j?n.frontFace(n.CW):n.frontFace(n.CCW),W=j)}function xt(j){j!==DU?(Ye(n.CULL_FACE),j!==z&&(j===Cw?n.cullFace(n.BACK):j===NU?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):ze(n.CULL_FACE),z=j}function Ft(j){j!==F&&(O&&n.lineWidth(j),F=j)}function Un(j,Be,Te){j?(Ye(n.POLYGON_OFFSET_FILL),(X!==Be||Z!==Te)&&(n.polygonOffset(Be,Te),X=Be,Z=Te)):ze(n.POLYGON_OFFSET_FILL)}function Fn(j){j?Ye(n.SCISSOR_TEST):ze(n.SCISSOR_TEST)}function k(j){j===void 0&&(j=n.TEXTURE0+$-1),G!==j&&(n.activeTexture(j),G=j)}function I(j,Be,Te){Te===void 0&&(G===null?Te=n.TEXTURE0+$-1:Te=G);let ce=ne[Te];ce===void 0&&(ce={type:void 0,texture:void 0},ne[Te]=ce),(ce.type!==j||ce.texture!==Be)&&(G!==Te&&(n.activeTexture(Te),G=Te),n.bindTexture(j,Be||Ze[j]),ce.type=j,ce.texture=Be)}function re(){const j=ne[G];j!==void 0&&j.type!==void 0&&(n.bindTexture(j.type,null),j.type=void 0,j.texture=void 0)}function we(){try{n.compressedTexImage2D.apply(n,arguments)}catch(j){console.error("THREE.WebGLState:",j)}}function ye(){try{n.compressedTexImage3D.apply(n,arguments)}catch(j){console.error("THREE.WebGLState:",j)}}function Ae(){try{n.texSubImage2D.apply(n,arguments)}catch(j){console.error("THREE.WebGLState:",j)}}function Qe(){try{n.texSubImage3D.apply(n,arguments)}catch(j){console.error("THREE.WebGLState:",j)}}function Re(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(j){console.error("THREE.WebGLState:",j)}}function Oe(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(j){console.error("THREE.WebGLState:",j)}}function ft(){try{n.texStorage2D.apply(n,arguments)}catch(j){console.error("THREE.WebGLState:",j)}}function Bt(){try{n.texStorage3D.apply(n,arguments)}catch(j){console.error("THREE.WebGLState:",j)}}function be(){try{n.texImage2D.apply(n,arguments)}catch(j){console.error("THREE.WebGLState:",j)}}function Ht(){try{n.texImage3D.apply(n,arguments)}catch(j){console.error("THREE.WebGLState:",j)}}function yt(j){pe.equals(j)===!1&&(n.scissor(j.x,j.y,j.z,j.w),pe.copy(j))}function ht(j){ve.equals(j)===!1&&(n.viewport(j.x,j.y,j.z,j.w),ve.copy(j))}function it(j,Be){let Te=f.get(Be);Te===void 0&&(Te=new WeakMap,f.set(Be,Te));let ce=Te.get(j);ce===void 0&&(ce=n.getUniformBlockIndex(Be,j.name),Te.set(j,ce))}function Ve(j,Be){const ce=f.get(Be).get(j);d.get(Be)!==ce&&(n.uniformBlockBinding(Be,ce,j.__bindingPointIndex),d.set(Be,ce))}function wt(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),i===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),p={},G=null,ne={},m={},v=new WeakMap,x=[],y=null,g=!1,T=null,S=null,w=null,M=null,R=null,P=null,N=null,C=new St(0,0,0),L=0,Q=!1,W=null,z=null,F=null,X=null,Z=null,pe.set(0,0,n.canvas.width,n.canvas.height),ve.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),u.reset()}return{buffers:{color:a,depth:l,stencil:u},enable:Ye,disable:ze,bindFramebuffer:Ie,drawBuffers:q,useProgram:ct,setBlending:nt,setMaterial:Kt,setFlipSided:gt,setCullFace:xt,setLineWidth:Ft,setPolygonOffset:Un,setScissorTest:Fn,activeTexture:k,bindTexture:I,unbindTexture:re,compressedTexImage2D:we,compressedTexImage3D:ye,texImage2D:be,texImage3D:Ht,updateUBOMapping:it,uniformBlockBinding:Ve,texStorage2D:ft,texStorage3D:Bt,texSubImage2D:Ae,texSubImage3D:Qe,compressedTexSubImage2D:Re,compressedTexSubImage3D:Oe,scissor:yt,viewport:ht,reset:wt}}function j5(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,u=r.maxCubemapSize,d=r.maxTextureSize,f=r.maxSamples,p=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,m=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),v=new WeakMap;let x;const y=new WeakMap;let g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function T(k,I){return g?new OffscreenCanvas(k,I):$d("canvas")}function S(k,I,re,we){let ye=1;if((k.width>we||k.height>we)&&(ye=we/Math.max(k.width,k.height)),ye<1||I===!0)if(typeof HTMLImageElement<"u"&&k instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&k instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&k instanceof ImageBitmap){const Ae=I?Lg:Math.floor,Qe=Ae(ye*k.width),Re=Ae(ye*k.height);x===void 0&&(x=T(Qe,Re));const Oe=re?T(Qe,Re):x;return Oe.width=Qe,Oe.height=Re,Oe.getContext("2d").drawImage(k,0,0,Qe,Re),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+k.width+"x"+k.height+") to ("+Qe+"x"+Re+")."),Oe}else return"data"in k&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+k.width+"x"+k.height+")."),k;return k}function w(k){return Jx(k.width)&&Jx(k.height)}function M(k){return a?!1:k.wrapS!==Pr||k.wrapT!==Pr||k.minFilter!==ti&&k.minFilter!==Wi}function R(k,I){return k.generateMipmaps&&I&&k.minFilter!==ti&&k.minFilter!==Wi}function P(k){n.generateMipmap(k)}function N(k,I,re,we,ye=!1){if(a===!1)return I;if(k!==null){if(n[k]!==void 0)return n[k];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+k+"'")}let Ae=I;if(I===n.RED&&(re===n.FLOAT&&(Ae=n.R32F),re===n.HALF_FLOAT&&(Ae=n.R16F),re===n.UNSIGNED_BYTE&&(Ae=n.R8)),I===n.RED_INTEGER&&(re===n.UNSIGNED_BYTE&&(Ae=n.R8UI),re===n.UNSIGNED_SHORT&&(Ae=n.R16UI),re===n.UNSIGNED_INT&&(Ae=n.R32UI),re===n.BYTE&&(Ae=n.R8I),re===n.SHORT&&(Ae=n.R16I),re===n.INT&&(Ae=n.R32I)),I===n.RG&&(re===n.FLOAT&&(Ae=n.RG32F),re===n.HALF_FLOAT&&(Ae=n.RG16F),re===n.UNSIGNED_BYTE&&(Ae=n.RG8)),I===n.RGBA){const Qe=ye?Cg:Xt.getTransfer(we);re===n.FLOAT&&(Ae=n.RGBA32F),re===n.HALF_FLOAT&&(Ae=n.RGBA16F),re===n.UNSIGNED_BYTE&&(Ae=Qe===rn?n.SRGB8_ALPHA8:n.RGBA8),re===n.UNSIGNED_SHORT_4_4_4_4&&(Ae=n.RGBA4),re===n.UNSIGNED_SHORT_5_5_5_1&&(Ae=n.RGB5_A1)}return(Ae===n.R16F||Ae===n.R32F||Ae===n.RG16F||Ae===n.RG32F||Ae===n.RGBA16F||Ae===n.RGBA32F)&&e.get("EXT_color_buffer_float"),Ae}function C(k,I,re){return R(k,re)===!0||k.isFramebufferTexture&&k.minFilter!==ti&&k.minFilter!==Wi?Math.log2(Math.max(I.width,I.height))+1:k.mipmaps!==void 0&&k.mipmaps.length>0?k.mipmaps.length:k.isCompressedTexture&&Array.isArray(k.image)?I.mipmaps.length:1}function L(k){return k===ti||k===qx||k===Hm?n.NEAREST:n.LINEAR}function Q(k){const I=k.target;I.removeEventListener("dispose",Q),z(I),I.isVideoTexture&&v.delete(I)}function W(k){const I=k.target;I.removeEventListener("dispose",W),X(I)}function z(k){const I=i.get(k);if(I.__webglInit===void 0)return;const re=k.source,we=y.get(re);if(we){const ye=we[I.__cacheKey];ye.usedTimes--,ye.usedTimes===0&&F(k),Object.keys(we).length===0&&y.delete(re)}i.remove(k)}function F(k){const I=i.get(k);n.deleteTexture(I.__webglTexture);const re=k.source,we=y.get(re);delete we[I.__cacheKey],o.memory.textures--}function X(k){const I=k.texture,re=i.get(k),we=i.get(I);if(we.__webglTexture!==void 0&&(n.deleteTexture(we.__webglTexture),o.memory.textures--),k.depthTexture&&k.depthTexture.dispose(),k.isWebGLCubeRenderTarget)for(let ye=0;ye<6;ye++){if(Array.isArray(re.__webglFramebuffer[ye]))for(let Ae=0;Ae<re.__webglFramebuffer[ye].length;Ae++)n.deleteFramebuffer(re.__webglFramebuffer[ye][Ae]);else n.deleteFramebuffer(re.__webglFramebuffer[ye]);re.__webglDepthbuffer&&n.deleteRenderbuffer(re.__webglDepthbuffer[ye])}else{if(Array.isArray(re.__webglFramebuffer))for(let ye=0;ye<re.__webglFramebuffer.length;ye++)n.deleteFramebuffer(re.__webglFramebuffer[ye]);else n.deleteFramebuffer(re.__webglFramebuffer);if(re.__webglDepthbuffer&&n.deleteRenderbuffer(re.__webglDepthbuffer),re.__webglMultisampledFramebuffer&&n.deleteFramebuffer(re.__webglMultisampledFramebuffer),re.__webglColorRenderbuffer)for(let ye=0;ye<re.__webglColorRenderbuffer.length;ye++)re.__webglColorRenderbuffer[ye]&&n.deleteRenderbuffer(re.__webglColorRenderbuffer[ye]);re.__webglDepthRenderbuffer&&n.deleteRenderbuffer(re.__webglDepthRenderbuffer)}if(k.isWebGLMultipleRenderTargets)for(let ye=0,Ae=I.length;ye<Ae;ye++){const Qe=i.get(I[ye]);Qe.__webglTexture&&(n.deleteTexture(Qe.__webglTexture),o.memory.textures--),i.remove(I[ye])}i.remove(I),i.remove(k)}let Z=0;function $(){Z=0}function O(){const k=Z;return k>=l&&console.warn("THREE.WebGLTextures: Trying to use "+k+" texture units while this GPU supports only "+l),Z+=1,k}function H(k){const I=[];return I.push(k.wrapS),I.push(k.wrapT),I.push(k.wrapR||0),I.push(k.magFilter),I.push(k.minFilter),I.push(k.anisotropy),I.push(k.internalFormat),I.push(k.format),I.push(k.type),I.push(k.generateMipmaps),I.push(k.premultiplyAlpha),I.push(k.flipY),I.push(k.unpackAlignment),I.push(k.colorSpace),I.join()}function B(k,I){const re=i.get(k);if(k.isVideoTexture&&Un(k),k.isRenderTargetTexture===!1&&k.version>0&&re.__version!==k.version){const we=k.image;if(we===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(we.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ye(re,k,I);return}}t.bindTexture(n.TEXTURE_2D,re.__webglTexture,n.TEXTURE0+I)}function G(k,I){const re=i.get(k);if(k.version>0&&re.__version!==k.version){Ye(re,k,I);return}t.bindTexture(n.TEXTURE_2D_ARRAY,re.__webglTexture,n.TEXTURE0+I)}function ne(k,I){const re=i.get(k);if(k.version>0&&re.__version!==k.version){Ye(re,k,I);return}t.bindTexture(n.TEXTURE_3D,re.__webglTexture,n.TEXTURE0+I)}function ee(k,I){const re=i.get(k);if(k.version>0&&re.__version!==k.version){ze(re,k,I);return}t.bindTexture(n.TEXTURE_CUBE_MAP,re.__webglTexture,n.TEXTURE0+I)}const ie={[Oc]:n.REPEAT,[Pr]:n.CLAMP_TO_EDGE,[Mg]:n.MIRRORED_REPEAT},pe={[ti]:n.NEAREST,[qx]:n.NEAREST_MIPMAP_NEAREST,[Hm]:n.NEAREST_MIPMAP_LINEAR,[Wi]:n.LINEAR,[HP]:n.LINEAR_MIPMAP_NEAREST,[Vl]:n.LINEAR_MIPMAP_LINEAR},ve={[AF]:n.NEVER,[LF]:n.ALWAYS,[MF]:n.LESS,[JP]:n.LEQUAL,[CF]:n.EQUAL,[IF]:n.GEQUAL,[RF]:n.GREATER,[PF]:n.NOTEQUAL};function Me(k,I,re){if(re?(n.texParameteri(k,n.TEXTURE_WRAP_S,ie[I.wrapS]),n.texParameteri(k,n.TEXTURE_WRAP_T,ie[I.wrapT]),(k===n.TEXTURE_3D||k===n.TEXTURE_2D_ARRAY)&&n.texParameteri(k,n.TEXTURE_WRAP_R,ie[I.wrapR]),n.texParameteri(k,n.TEXTURE_MAG_FILTER,pe[I.magFilter]),n.texParameteri(k,n.TEXTURE_MIN_FILTER,pe[I.minFilter])):(n.texParameteri(k,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(k,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(k===n.TEXTURE_3D||k===n.TEXTURE_2D_ARRAY)&&n.texParameteri(k,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(I.wrapS!==Pr||I.wrapT!==Pr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(k,n.TEXTURE_MAG_FILTER,L(I.magFilter)),n.texParameteri(k,n.TEXTURE_MIN_FILTER,L(I.minFilter)),I.minFilter!==ti&&I.minFilter!==Wi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),I.compareFunction&&(n.texParameteri(k,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(k,n.TEXTURE_COMPARE_FUNC,ve[I.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const we=e.get("EXT_texture_filter_anisotropic");if(I.magFilter===ti||I.minFilter!==Hm&&I.minFilter!==Vl||I.type===So&&e.has("OES_texture_float_linear")===!1||a===!1&&I.type===Xd&&e.has("OES_texture_half_float_linear")===!1)return;(I.anisotropy>1||i.get(I).__currentAnisotropy)&&(n.texParameterf(k,we.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(I.anisotropy,r.getMaxAnisotropy())),i.get(I).__currentAnisotropy=I.anisotropy)}}function Ze(k,I){let re=!1;k.__webglInit===void 0&&(k.__webglInit=!0,I.addEventListener("dispose",Q));const we=I.source;let ye=y.get(we);ye===void 0&&(ye={},y.set(we,ye));const Ae=H(I);if(Ae!==k.__cacheKey){ye[Ae]===void 0&&(ye[Ae]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,re=!0),ye[Ae].usedTimes++;const Qe=ye[k.__cacheKey];Qe!==void 0&&(ye[k.__cacheKey].usedTimes--,Qe.usedTimes===0&&F(I)),k.__cacheKey=Ae,k.__webglTexture=ye[Ae].texture}return re}function Ye(k,I,re){let we=n.TEXTURE_2D;(I.isDataArrayTexture||I.isCompressedArrayTexture)&&(we=n.TEXTURE_2D_ARRAY),I.isData3DTexture&&(we=n.TEXTURE_3D);const ye=Ze(k,I),Ae=I.source;t.bindTexture(we,k.__webglTexture,n.TEXTURE0+re);const Qe=i.get(Ae);if(Ae.version!==Qe.__version||ye===!0){t.activeTexture(n.TEXTURE0+re);const Re=Xt.getPrimaries(Xt.workingColorSpace),Oe=I.colorSpace===Lr?null:Xt.getPrimaries(I.colorSpace),ft=I.colorSpace===Lr||Re===Oe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,I.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,I.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,I.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,ft);const Bt=M(I)&&w(I.image)===!1;let be=S(I.image,Bt,!1,d);be=Fn(I,be);const Ht=w(be)||a,yt=s.convert(I.format,I.colorSpace);let ht=s.convert(I.type),it=N(I.internalFormat,yt,ht,I.colorSpace,I.isVideoTexture);Me(we,I,Ht);let Ve;const wt=I.mipmaps,j=a&&I.isVideoTexture!==!0&&it!==qP,Be=Qe.__version===void 0||ye===!0,Te=C(I,be,Ht);if(I.isDepthTexture)it=n.DEPTH_COMPONENT,a?I.type===So?it=n.DEPTH_COMPONENT32F:I.type===ma?it=n.DEPTH_COMPONENT24:I.type===Pl?it=n.DEPTH24_STENCIL8:it=n.DEPTH_COMPONENT16:I.type===So&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),I.format===Il&&it===n.DEPTH_COMPONENT&&I.type!==rE&&I.type!==ma&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),I.type=ma,ht=s.convert(I.type)),I.format===Bc&&it===n.DEPTH_COMPONENT&&(it=n.DEPTH_STENCIL,I.type!==Pl&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),I.type=Pl,ht=s.convert(I.type))),Be&&(j?t.texStorage2D(n.TEXTURE_2D,1,it,be.width,be.height):t.texImage2D(n.TEXTURE_2D,0,it,be.width,be.height,0,yt,ht,null));else if(I.isDataTexture)if(wt.length>0&&Ht){j&&Be&&t.texStorage2D(n.TEXTURE_2D,Te,it,wt[0].width,wt[0].height);for(let ce=0,Ce=wt.length;ce<Ce;ce++)Ve=wt[ce],j?t.texSubImage2D(n.TEXTURE_2D,ce,0,0,Ve.width,Ve.height,yt,ht,Ve.data):t.texImage2D(n.TEXTURE_2D,ce,it,Ve.width,Ve.height,0,yt,ht,Ve.data);I.generateMipmaps=!1}else j?(Be&&t.texStorage2D(n.TEXTURE_2D,Te,it,be.width,be.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,be.width,be.height,yt,ht,be.data)):t.texImage2D(n.TEXTURE_2D,0,it,be.width,be.height,0,yt,ht,be.data);else if(I.isCompressedTexture)if(I.isCompressedArrayTexture){j&&Be&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Te,it,wt[0].width,wt[0].height,be.depth);for(let ce=0,Ce=wt.length;ce<Ce;ce++)Ve=wt[ce],I.format!==Ir?yt!==null?j?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,ce,0,0,0,Ve.width,Ve.height,be.depth,yt,Ve.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,ce,it,Ve.width,Ve.height,be.depth,0,Ve.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):j?t.texSubImage3D(n.TEXTURE_2D_ARRAY,ce,0,0,0,Ve.width,Ve.height,be.depth,yt,ht,Ve.data):t.texImage3D(n.TEXTURE_2D_ARRAY,ce,it,Ve.width,Ve.height,be.depth,0,yt,ht,Ve.data)}else{j&&Be&&t.texStorage2D(n.TEXTURE_2D,Te,it,wt[0].width,wt[0].height);for(let ce=0,Ce=wt.length;ce<Ce;ce++)Ve=wt[ce],I.format!==Ir?yt!==null?j?t.compressedTexSubImage2D(n.TEXTURE_2D,ce,0,0,Ve.width,Ve.height,yt,Ve.data):t.compressedTexImage2D(n.TEXTURE_2D,ce,it,Ve.width,Ve.height,0,Ve.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):j?t.texSubImage2D(n.TEXTURE_2D,ce,0,0,Ve.width,Ve.height,yt,ht,Ve.data):t.texImage2D(n.TEXTURE_2D,ce,it,Ve.width,Ve.height,0,yt,ht,Ve.data)}else if(I.isDataArrayTexture)j?(Be&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Te,it,be.width,be.height,be.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,be.width,be.height,be.depth,yt,ht,be.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,it,be.width,be.height,be.depth,0,yt,ht,be.data);else if(I.isData3DTexture)j?(Be&&t.texStorage3D(n.TEXTURE_3D,Te,it,be.width,be.height,be.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,be.width,be.height,be.depth,yt,ht,be.data)):t.texImage3D(n.TEXTURE_3D,0,it,be.width,be.height,be.depth,0,yt,ht,be.data);else if(I.isFramebufferTexture){if(Be)if(j)t.texStorage2D(n.TEXTURE_2D,Te,it,be.width,be.height);else{let ce=be.width,Ce=be.height;for(let at=0;at<Te;at++)t.texImage2D(n.TEXTURE_2D,at,it,ce,Ce,0,yt,ht,null),ce>>=1,Ce>>=1}}else if(wt.length>0&&Ht){j&&Be&&t.texStorage2D(n.TEXTURE_2D,Te,it,wt[0].width,wt[0].height);for(let ce=0,Ce=wt.length;ce<Ce;ce++)Ve=wt[ce],j?t.texSubImage2D(n.TEXTURE_2D,ce,0,0,yt,ht,Ve):t.texImage2D(n.TEXTURE_2D,ce,it,yt,ht,Ve);I.generateMipmaps=!1}else j?(Be&&t.texStorage2D(n.TEXTURE_2D,Te,it,be.width,be.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,yt,ht,be)):t.texImage2D(n.TEXTURE_2D,0,it,yt,ht,be);R(I,Ht)&&P(we),Qe.__version=Ae.version,I.onUpdate&&I.onUpdate(I)}k.__version=I.version}function ze(k,I,re){if(I.image.length!==6)return;const we=Ze(k,I),ye=I.source;t.bindTexture(n.TEXTURE_CUBE_MAP,k.__webglTexture,n.TEXTURE0+re);const Ae=i.get(ye);if(ye.version!==Ae.__version||we===!0){t.activeTexture(n.TEXTURE0+re);const Qe=Xt.getPrimaries(Xt.workingColorSpace),Re=I.colorSpace===Lr?null:Xt.getPrimaries(I.colorSpace),Oe=I.colorSpace===Lr||Qe===Re?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,I.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,I.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,I.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Oe);const ft=I.isCompressedTexture||I.image[0].isCompressedTexture,Bt=I.image[0]&&I.image[0].isDataTexture,be=[];for(let ce=0;ce<6;ce++)!ft&&!Bt?be[ce]=S(I.image[ce],!1,!0,u):be[ce]=Bt?I.image[ce].image:I.image[ce],be[ce]=Fn(I,be[ce]);const Ht=be[0],yt=w(Ht)||a,ht=s.convert(I.format,I.colorSpace),it=s.convert(I.type),Ve=N(I.internalFormat,ht,it,I.colorSpace),wt=a&&I.isVideoTexture!==!0,j=Ae.__version===void 0||we===!0;let Be=C(I,Ht,yt);Me(n.TEXTURE_CUBE_MAP,I,yt);let Te;if(ft){wt&&j&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Be,Ve,Ht.width,Ht.height);for(let ce=0;ce<6;ce++){Te=be[ce].mipmaps;for(let Ce=0;Ce<Te.length;Ce++){const at=Te[Ce];I.format!==Ir?ht!==null?wt?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ce,Ce,0,0,at.width,at.height,ht,at.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ce,Ce,Ve,at.width,at.height,0,at.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):wt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ce,Ce,0,0,at.width,at.height,ht,it,at.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ce,Ce,Ve,at.width,at.height,0,ht,it,at.data)}}}else{Te=I.mipmaps,wt&&j&&(Te.length>0&&Be++,t.texStorage2D(n.TEXTURE_CUBE_MAP,Be,Ve,be[0].width,be[0].height));for(let ce=0;ce<6;ce++)if(Bt){wt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ce,0,0,0,be[ce].width,be[ce].height,ht,it,be[ce].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ce,0,Ve,be[ce].width,be[ce].height,0,ht,it,be[ce].data);for(let Ce=0;Ce<Te.length;Ce++){const Ct=Te[Ce].image[ce].image;wt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ce,Ce+1,0,0,Ct.width,Ct.height,ht,it,Ct.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ce,Ce+1,Ve,Ct.width,Ct.height,0,ht,it,Ct.data)}}else{wt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ce,0,0,0,ht,it,be[ce]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ce,0,Ve,ht,it,be[ce]);for(let Ce=0;Ce<Te.length;Ce++){const at=Te[Ce];wt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ce,Ce+1,0,0,ht,it,at.image[ce]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ce,Ce+1,Ve,ht,it,at.image[ce])}}}R(I,yt)&&P(n.TEXTURE_CUBE_MAP),Ae.__version=ye.version,I.onUpdate&&I.onUpdate(I)}k.__version=I.version}function Ie(k,I,re,we,ye,Ae){const Qe=s.convert(re.format,re.colorSpace),Re=s.convert(re.type),Oe=N(re.internalFormat,Qe,Re,re.colorSpace);if(!i.get(I).__hasExternalTextures){const Bt=Math.max(1,I.width>>Ae),be=Math.max(1,I.height>>Ae);ye===n.TEXTURE_3D||ye===n.TEXTURE_2D_ARRAY?t.texImage3D(ye,Ae,Oe,Bt,be,I.depth,0,Qe,Re,null):t.texImage2D(ye,Ae,Oe,Bt,be,0,Qe,Re,null)}t.bindFramebuffer(n.FRAMEBUFFER,k),Ft(I)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,we,ye,i.get(re).__webglTexture,0,xt(I)):(ye===n.TEXTURE_2D||ye>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&ye<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,we,ye,i.get(re).__webglTexture,Ae),t.bindFramebuffer(n.FRAMEBUFFER,null)}function q(k,I,re){if(n.bindRenderbuffer(n.RENDERBUFFER,k),I.depthBuffer&&!I.stencilBuffer){let we=a===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(re||Ft(I)){const ye=I.depthTexture;ye&&ye.isDepthTexture&&(ye.type===So?we=n.DEPTH_COMPONENT32F:ye.type===ma&&(we=n.DEPTH_COMPONENT24));const Ae=xt(I);Ft(I)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ae,we,I.width,I.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,Ae,we,I.width,I.height)}else n.renderbufferStorage(n.RENDERBUFFER,we,I.width,I.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,k)}else if(I.depthBuffer&&I.stencilBuffer){const we=xt(I);re&&Ft(I)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,we,n.DEPTH24_STENCIL8,I.width,I.height):Ft(I)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,we,n.DEPTH24_STENCIL8,I.width,I.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,I.width,I.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,k)}else{const we=I.isWebGLMultipleRenderTargets===!0?I.texture:[I.texture];for(let ye=0;ye<we.length;ye++){const Ae=we[ye],Qe=s.convert(Ae.format,Ae.colorSpace),Re=s.convert(Ae.type),Oe=N(Ae.internalFormat,Qe,Re,Ae.colorSpace),ft=xt(I);re&&Ft(I)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,ft,Oe,I.width,I.height):Ft(I)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ft,Oe,I.width,I.height):n.renderbufferStorage(n.RENDERBUFFER,Oe,I.width,I.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function ct(k,I){if(I&&I.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,k),!(I.depthTexture&&I.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(I.depthTexture).__webglTexture||I.depthTexture.image.width!==I.width||I.depthTexture.image.height!==I.height)&&(I.depthTexture.image.width=I.width,I.depthTexture.image.height=I.height,I.depthTexture.needsUpdate=!0),B(I.depthTexture,0);const we=i.get(I.depthTexture).__webglTexture,ye=xt(I);if(I.depthTexture.format===Il)Ft(I)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,we,0,ye):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,we,0);else if(I.depthTexture.format===Bc)Ft(I)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,we,0,ye):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,we,0);else throw new Error("Unknown depthTexture format")}function Xe(k){const I=i.get(k),re=k.isWebGLCubeRenderTarget===!0;if(k.depthTexture&&!I.__autoAllocateDepthBuffer){if(re)throw new Error("target.depthTexture not supported in Cube render targets");ct(I.__webglFramebuffer,k)}else if(re){I.__webglDepthbuffer=[];for(let we=0;we<6;we++)t.bindFramebuffer(n.FRAMEBUFFER,I.__webglFramebuffer[we]),I.__webglDepthbuffer[we]=n.createRenderbuffer(),q(I.__webglDepthbuffer[we],k,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,I.__webglFramebuffer),I.__webglDepthbuffer=n.createRenderbuffer(),q(I.__webglDepthbuffer,k,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function st(k,I,re){const we=i.get(k);I!==void 0&&Ie(we.__webglFramebuffer,k,k.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),re!==void 0&&Xe(k)}function nt(k){const I=k.texture,re=i.get(k),we=i.get(I);k.addEventListener("dispose",W),k.isWebGLMultipleRenderTargets!==!0&&(we.__webglTexture===void 0&&(we.__webglTexture=n.createTexture()),we.__version=I.version,o.memory.textures++);const ye=k.isWebGLCubeRenderTarget===!0,Ae=k.isWebGLMultipleRenderTargets===!0,Qe=w(k)||a;if(ye){re.__webglFramebuffer=[];for(let Re=0;Re<6;Re++)if(a&&I.mipmaps&&I.mipmaps.length>0){re.__webglFramebuffer[Re]=[];for(let Oe=0;Oe<I.mipmaps.length;Oe++)re.__webglFramebuffer[Re][Oe]=n.createFramebuffer()}else re.__webglFramebuffer[Re]=n.createFramebuffer()}else{if(a&&I.mipmaps&&I.mipmaps.length>0){re.__webglFramebuffer=[];for(let Re=0;Re<I.mipmaps.length;Re++)re.__webglFramebuffer[Re]=n.createFramebuffer()}else re.__webglFramebuffer=n.createFramebuffer();if(Ae)if(r.drawBuffers){const Re=k.texture;for(let Oe=0,ft=Re.length;Oe<ft;Oe++){const Bt=i.get(Re[Oe]);Bt.__webglTexture===void 0&&(Bt.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&k.samples>0&&Ft(k)===!1){const Re=Ae?I:[I];re.__webglMultisampledFramebuffer=n.createFramebuffer(),re.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,re.__webglMultisampledFramebuffer);for(let Oe=0;Oe<Re.length;Oe++){const ft=Re[Oe];re.__webglColorRenderbuffer[Oe]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,re.__webglColorRenderbuffer[Oe]);const Bt=s.convert(ft.format,ft.colorSpace),be=s.convert(ft.type),Ht=N(ft.internalFormat,Bt,be,ft.colorSpace,k.isXRRenderTarget===!0),yt=xt(k);n.renderbufferStorageMultisample(n.RENDERBUFFER,yt,Ht,k.width,k.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Oe,n.RENDERBUFFER,re.__webglColorRenderbuffer[Oe])}n.bindRenderbuffer(n.RENDERBUFFER,null),k.depthBuffer&&(re.__webglDepthRenderbuffer=n.createRenderbuffer(),q(re.__webglDepthRenderbuffer,k,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ye){t.bindTexture(n.TEXTURE_CUBE_MAP,we.__webglTexture),Me(n.TEXTURE_CUBE_MAP,I,Qe);for(let Re=0;Re<6;Re++)if(a&&I.mipmaps&&I.mipmaps.length>0)for(let Oe=0;Oe<I.mipmaps.length;Oe++)Ie(re.__webglFramebuffer[Re][Oe],k,I,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Oe);else Ie(re.__webglFramebuffer[Re],k,I,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Re,0);R(I,Qe)&&P(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ae){const Re=k.texture;for(let Oe=0,ft=Re.length;Oe<ft;Oe++){const Bt=Re[Oe],be=i.get(Bt);t.bindTexture(n.TEXTURE_2D,be.__webglTexture),Me(n.TEXTURE_2D,Bt,Qe),Ie(re.__webglFramebuffer,k,Bt,n.COLOR_ATTACHMENT0+Oe,n.TEXTURE_2D,0),R(Bt,Qe)&&P(n.TEXTURE_2D)}t.unbindTexture()}else{let Re=n.TEXTURE_2D;if((k.isWebGL3DRenderTarget||k.isWebGLArrayRenderTarget)&&(a?Re=k.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Re,we.__webglTexture),Me(Re,I,Qe),a&&I.mipmaps&&I.mipmaps.length>0)for(let Oe=0;Oe<I.mipmaps.length;Oe++)Ie(re.__webglFramebuffer[Oe],k,I,n.COLOR_ATTACHMENT0,Re,Oe);else Ie(re.__webglFramebuffer,k,I,n.COLOR_ATTACHMENT0,Re,0);R(I,Qe)&&P(Re),t.unbindTexture()}k.depthBuffer&&Xe(k)}function Kt(k){const I=w(k)||a,re=k.isWebGLMultipleRenderTargets===!0?k.texture:[k.texture];for(let we=0,ye=re.length;we<ye;we++){const Ae=re[we];if(R(Ae,I)){const Qe=k.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Re=i.get(Ae).__webglTexture;t.bindTexture(Qe,Re),P(Qe),t.unbindTexture()}}}function gt(k){if(a&&k.samples>0&&Ft(k)===!1){const I=k.isWebGLMultipleRenderTargets?k.texture:[k.texture],re=k.width,we=k.height;let ye=n.COLOR_BUFFER_BIT;const Ae=[],Qe=k.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Re=i.get(k),Oe=k.isWebGLMultipleRenderTargets===!0;if(Oe)for(let ft=0;ft<I.length;ft++)t.bindFramebuffer(n.FRAMEBUFFER,Re.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ft,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Re.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+ft,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Re.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Re.__webglFramebuffer);for(let ft=0;ft<I.length;ft++){Ae.push(n.COLOR_ATTACHMENT0+ft),k.depthBuffer&&Ae.push(Qe);const Bt=Re.__ignoreDepthValues!==void 0?Re.__ignoreDepthValues:!1;if(Bt===!1&&(k.depthBuffer&&(ye|=n.DEPTH_BUFFER_BIT),k.stencilBuffer&&(ye|=n.STENCIL_BUFFER_BIT)),Oe&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Re.__webglColorRenderbuffer[ft]),Bt===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Qe]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Qe])),Oe){const be=i.get(I[ft]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,be,0)}n.blitFramebuffer(0,0,re,we,0,0,re,we,ye,n.NEAREST),m&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,Ae)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Oe)for(let ft=0;ft<I.length;ft++){t.bindFramebuffer(n.FRAMEBUFFER,Re.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ft,n.RENDERBUFFER,Re.__webglColorRenderbuffer[ft]);const Bt=i.get(I[ft]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Re.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+ft,n.TEXTURE_2D,Bt,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Re.__webglMultisampledFramebuffer)}}function xt(k){return Math.min(f,k.samples)}function Ft(k){const I=i.get(k);return a&&k.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&I.__useRenderToTexture!==!1}function Un(k){const I=o.render.frame;v.get(k)!==I&&(v.set(k,I),k.update())}function Fn(k,I){const re=k.colorSpace,we=k.format,ye=k.type;return k.isCompressedTexture===!0||k.isVideoTexture===!0||k.format===Qx||re!==mi&&re!==Lr&&(Xt.getTransfer(re)===rn?a===!1?e.has("EXT_sRGB")===!0&&we===Ir?(k.format=Qx,k.minFilter=Wi,k.generateMipmaps=!1):I=tI.sRGBToLinear(I):(we!==Ir||ye!==Ra)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",re)),I}this.allocateTextureUnit=O,this.resetTextureUnits=$,this.setTexture2D=B,this.setTexture2DArray=G,this.setTexture3D=ne,this.setTextureCube=ee,this.rebindTextures=st,this.setupRenderTarget=nt,this.updateRenderTargetMipmap=Kt,this.updateMultisampleRenderTarget=gt,this.setupDepthRenderbuffer=Xe,this.setupFrameBufferTexture=Ie,this.useMultisampledRTT=Ft}function $5(n,e,t){const i=t.isWebGL2;function r(s,o=Lr){let a;const l=Xt.getTransfer(o);if(s===Ra)return n.UNSIGNED_BYTE;if(s===WP)return n.UNSIGNED_SHORT_4_4_4_4;if(s===XP)return n.UNSIGNED_SHORT_5_5_5_1;if(s===fF)return n.BYTE;if(s===pF)return n.SHORT;if(s===rE)return n.UNSIGNED_SHORT;if(s===VP)return n.INT;if(s===ma)return n.UNSIGNED_INT;if(s===So)return n.FLOAT;if(s===Xd)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===mF)return n.ALPHA;if(s===Ir)return n.RGBA;if(s===gF)return n.LUMINANCE;if(s===_F)return n.LUMINANCE_ALPHA;if(s===Il)return n.DEPTH_COMPONENT;if(s===Bc)return n.DEPTH_STENCIL;if(s===Qx)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===vF)return n.RED;if(s===jP)return n.RED_INTEGER;if(s===yF)return n.RG;if(s===$P)return n.RG_INTEGER;if(s===YP)return n.RGBA_INTEGER;if(s===Ev||s===Tv||s===bv||s===wv)if(l===rn)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===Ev)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===Tv)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===bv)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===wv)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===Ev)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===Tv)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===bv)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===wv)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===Uw||s===Fw||s===Ow||s===Bw)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===Uw)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===Fw)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===Ow)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===Bw)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===qP)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===kw||s===zw)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===kw)return l===rn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===zw)return l===rn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===Gw||s===Hw||s===Vw||s===Ww||s===Xw||s===jw||s===$w||s===Yw||s===qw||s===Kw||s===Zw||s===Qw||s===Jw||s===eA)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===Gw)return l===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===Hw)return l===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===Vw)return l===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===Ww)return l===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===Xw)return l===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===jw)return l===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===$w)return l===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===Yw)return l===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===qw)return l===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===Kw)return l===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===Zw)return l===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===Qw)return l===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===Jw)return l===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===eA)return l===rn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===Av||s===tA||s===nA)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===Av)return l===rn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===tA)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===nA)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===xF||s===iA||s===rA||s===sA)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===Av)return a.COMPRESSED_RED_RGTC1_EXT;if(s===iA)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===rA)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===sA)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Pl?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:r}}class Y5 extends Di{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class wl extends vn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const q5={type:"move"};class Kv{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new wl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new wl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Y,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Y),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new wl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Y,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Y),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const x of e.hand.values()){const y=t.getJointPose(x,i),g=this._getHandJoint(u,x);y!==null&&(g.matrix.fromArray(y.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,g.jointRadius=y.radius),g.visible=y!==null}const d=u.joints["index-finger-tip"],f=u.joints["thumb-tip"],p=d.position.distanceTo(f.position),m=.02,v=.005;u.inputState.pinching&&p>m+v?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&p<=m-v&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(q5)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new wl;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class K5 extends Qc{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,u=null,d=null,f=null,p=null,m=null,v=null;const x=t.getContextAttributes();let y=null,g=null;const T=[],S=[],w=new Ut;let M=null;const R=new Di;R.layers.enable(1),R.viewport=new Zt;const P=new Di;P.layers.enable(2),P.viewport=new Zt;const N=[R,P],C=new Y5;C.layers.enable(1),C.layers.enable(2);let L=null,Q=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ee){let ie=T[ee];return ie===void 0&&(ie=new Kv,T[ee]=ie),ie.getTargetRaySpace()},this.getControllerGrip=function(ee){let ie=T[ee];return ie===void 0&&(ie=new Kv,T[ee]=ie),ie.getGripSpace()},this.getHand=function(ee){let ie=T[ee];return ie===void 0&&(ie=new Kv,T[ee]=ie),ie.getHandSpace()};function W(ee){const ie=S.indexOf(ee.inputSource);if(ie===-1)return;const pe=T[ie];pe!==void 0&&(pe.update(ee.inputSource,ee.frame,u||o),pe.dispatchEvent({type:ee.type,data:ee.inputSource}))}function z(){r.removeEventListener("select",W),r.removeEventListener("selectstart",W),r.removeEventListener("selectend",W),r.removeEventListener("squeeze",W),r.removeEventListener("squeezestart",W),r.removeEventListener("squeezeend",W),r.removeEventListener("end",z),r.removeEventListener("inputsourceschange",F);for(let ee=0;ee<T.length;ee++){const ie=S[ee];ie!==null&&(S[ee]=null,T[ee].disconnect(ie))}L=null,Q=null,e.setRenderTarget(y),m=null,p=null,f=null,r=null,g=null,ne.stop(),i.isPresenting=!1,e.setPixelRatio(M),e.setSize(w.width,w.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ee){s=ee,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ee){a=ee,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(ee){u=ee},this.getBaseLayer=function(){return p!==null?p:m},this.getBinding=function(){return f},this.getFrame=function(){return v},this.getSession=function(){return r},this.setSession=async function(ee){if(r=ee,r!==null){if(y=e.getRenderTarget(),r.addEventListener("select",W),r.addEventListener("selectstart",W),r.addEventListener("selectend",W),r.addEventListener("squeeze",W),r.addEventListener("squeezestart",W),r.addEventListener("squeezeend",W),r.addEventListener("end",z),r.addEventListener("inputsourceschange",F),x.xrCompatible!==!0&&await t.makeXRCompatible(),M=e.getPixelRatio(),e.getSize(w),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const ie={antialias:r.renderState.layers===void 0?x.antialias:!0,alpha:!0,depth:x.depth,stencil:x.stencil,framebufferScaleFactor:s};m=new XRWebGLLayer(r,t,ie),r.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),g=new Wl(m.framebufferWidth,m.framebufferHeight,{format:Ir,type:Ra,colorSpace:e.outputColorSpace,stencilBuffer:x.stencil})}else{let ie=null,pe=null,ve=null;x.depth&&(ve=x.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ie=x.stencil?Bc:Il,pe=x.stencil?Pl:ma);const Me={colorFormat:t.RGBA8,depthFormat:ve,scaleFactor:s};f=new XRWebGLBinding(r,t),p=f.createProjectionLayer(Me),r.updateRenderState({layers:[p]}),e.setPixelRatio(1),e.setSize(p.textureWidth,p.textureHeight,!1),g=new Wl(p.textureWidth,p.textureHeight,{format:Ir,type:Ra,depthTexture:new fI(p.textureWidth,p.textureHeight,pe,void 0,void 0,void 0,void 0,void 0,void 0,ie),stencilBuffer:x.stencil,colorSpace:e.outputColorSpace,samples:x.antialias?4:0});const Ze=e.properties.get(g);Ze.__ignoreDepthValues=p.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await r.requestReferenceSpace(a),ne.setContext(r),ne.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function F(ee){for(let ie=0;ie<ee.removed.length;ie++){const pe=ee.removed[ie],ve=S.indexOf(pe);ve>=0&&(S[ve]=null,T[ve].disconnect(pe))}for(let ie=0;ie<ee.added.length;ie++){const pe=ee.added[ie];let ve=S.indexOf(pe);if(ve===-1){for(let Ze=0;Ze<T.length;Ze++)if(Ze>=S.length){S.push(pe),ve=Ze;break}else if(S[Ze]===null){S[Ze]=pe,ve=Ze;break}if(ve===-1)break}const Me=T[ve];Me&&Me.connect(pe)}}const X=new Y,Z=new Y;function $(ee,ie,pe){X.setFromMatrixPosition(ie.matrixWorld),Z.setFromMatrixPosition(pe.matrixWorld);const ve=X.distanceTo(Z),Me=ie.projectionMatrix.elements,Ze=pe.projectionMatrix.elements,Ye=Me[14]/(Me[10]-1),ze=Me[14]/(Me[10]+1),Ie=(Me[9]+1)/Me[5],q=(Me[9]-1)/Me[5],ct=(Me[8]-1)/Me[0],Xe=(Ze[8]+1)/Ze[0],st=Ye*ct,nt=Ye*Xe,Kt=ve/(-ct+Xe),gt=Kt*-ct;ie.matrixWorld.decompose(ee.position,ee.quaternion,ee.scale),ee.translateX(gt),ee.translateZ(Kt),ee.matrixWorld.compose(ee.position,ee.quaternion,ee.scale),ee.matrixWorldInverse.copy(ee.matrixWorld).invert();const xt=Ye+Kt,Ft=ze+Kt,Un=st-gt,Fn=nt+(ve-gt),k=Ie*ze/Ft*xt,I=q*ze/Ft*xt;ee.projectionMatrix.makePerspective(Un,Fn,k,I,xt,Ft),ee.projectionMatrixInverse.copy(ee.projectionMatrix).invert()}function O(ee,ie){ie===null?ee.matrixWorld.copy(ee.matrix):ee.matrixWorld.multiplyMatrices(ie.matrixWorld,ee.matrix),ee.matrixWorldInverse.copy(ee.matrixWorld).invert()}this.updateCamera=function(ee){if(r===null)return;C.near=P.near=R.near=ee.near,C.far=P.far=R.far=ee.far,(L!==C.near||Q!==C.far)&&(r.updateRenderState({depthNear:C.near,depthFar:C.far}),L=C.near,Q=C.far);const ie=ee.parent,pe=C.cameras;O(C,ie);for(let ve=0;ve<pe.length;ve++)O(pe[ve],ie);pe.length===2?$(C,R,P):C.projectionMatrix.copy(R.projectionMatrix),H(ee,C,ie)};function H(ee,ie,pe){pe===null?ee.matrix.copy(ie.matrixWorld):(ee.matrix.copy(pe.matrixWorld),ee.matrix.invert(),ee.matrix.multiply(ie.matrixWorld)),ee.matrix.decompose(ee.position,ee.quaternion,ee.scale),ee.updateMatrixWorld(!0),ee.projectionMatrix.copy(ie.projectionMatrix),ee.projectionMatrixInverse.copy(ie.projectionMatrixInverse),ee.isPerspectiveCamera&&(ee.fov=zc*2*Math.atan(1/ee.projectionMatrix.elements[5]),ee.zoom=1)}this.getCamera=function(){return C},this.getFoveation=function(){if(!(p===null&&m===null))return l},this.setFoveation=function(ee){l=ee,p!==null&&(p.fixedFoveation=ee),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=ee)};let B=null;function G(ee,ie){if(d=ie.getViewerPose(u||o),v=ie,d!==null){const pe=d.views;m!==null&&(e.setRenderTargetFramebuffer(g,m.framebuffer),e.setRenderTarget(g));let ve=!1;pe.length!==C.cameras.length&&(C.cameras.length=0,ve=!0);for(let Me=0;Me<pe.length;Me++){const Ze=pe[Me];let Ye=null;if(m!==null)Ye=m.getViewport(Ze);else{const Ie=f.getViewSubImage(p,Ze);Ye=Ie.viewport,Me===0&&(e.setRenderTargetTextures(g,Ie.colorTexture,p.ignoreDepthValues?void 0:Ie.depthStencilTexture),e.setRenderTarget(g))}let ze=N[Me];ze===void 0&&(ze=new Di,ze.layers.enable(Me),ze.viewport=new Zt,N[Me]=ze),ze.matrix.fromArray(Ze.transform.matrix),ze.matrix.decompose(ze.position,ze.quaternion,ze.scale),ze.projectionMatrix.fromArray(Ze.projectionMatrix),ze.projectionMatrixInverse.copy(ze.projectionMatrix).invert(),ze.viewport.set(Ye.x,Ye.y,Ye.width,Ye.height),Me===0&&(C.matrix.copy(ze.matrix),C.matrix.decompose(C.position,C.quaternion,C.scale)),ve===!0&&C.cameras.push(ze)}}for(let pe=0;pe<T.length;pe++){const ve=S[pe],Me=T[pe];ve!==null&&Me!==void 0&&Me.update(ve,ie,u||o)}B&&B(ee,ie),ie.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:ie}),v=null}const ne=new hI;ne.setAnimationLoop(G),this.setAnimationLoop=function(ee){B=ee},this.dispose=function(){}}}function Z5(n,e){function t(y,g){y.matrixAutoUpdate===!0&&y.updateMatrix(),g.value.copy(y.matrix)}function i(y,g){g.color.getRGB(y.fogColor.value,lI(n)),g.isFog?(y.fogNear.value=g.near,y.fogFar.value=g.far):g.isFogExp2&&(y.fogDensity.value=g.density)}function r(y,g,T,S,w){g.isMeshBasicMaterial||g.isMeshLambertMaterial?s(y,g):g.isMeshToonMaterial?(s(y,g),f(y,g)):g.isMeshPhongMaterial?(s(y,g),d(y,g)):g.isMeshStandardMaterial?(s(y,g),p(y,g),g.isMeshPhysicalMaterial&&m(y,g,w)):g.isMeshMatcapMaterial?(s(y,g),v(y,g)):g.isMeshDepthMaterial?s(y,g):g.isMeshDistanceMaterial?(s(y,g),x(y,g)):g.isMeshNormalMaterial?s(y,g):g.isLineBasicMaterial?(o(y,g),g.isLineDashedMaterial&&a(y,g)):g.isPointsMaterial?l(y,g,T,S):g.isSpriteMaterial?u(y,g):g.isShadowMaterial?(y.color.value.copy(g.color),y.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function s(y,g){y.opacity.value=g.opacity,g.color&&y.diffuse.value.copy(g.color),g.emissive&&y.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(y.map.value=g.map,t(g.map,y.mapTransform)),g.alphaMap&&(y.alphaMap.value=g.alphaMap,t(g.alphaMap,y.alphaMapTransform)),g.bumpMap&&(y.bumpMap.value=g.bumpMap,t(g.bumpMap,y.bumpMapTransform),y.bumpScale.value=g.bumpScale,g.side===Ki&&(y.bumpScale.value*=-1)),g.normalMap&&(y.normalMap.value=g.normalMap,t(g.normalMap,y.normalMapTransform),y.normalScale.value.copy(g.normalScale),g.side===Ki&&y.normalScale.value.negate()),g.displacementMap&&(y.displacementMap.value=g.displacementMap,t(g.displacementMap,y.displacementMapTransform),y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias),g.emissiveMap&&(y.emissiveMap.value=g.emissiveMap,t(g.emissiveMap,y.emissiveMapTransform)),g.specularMap&&(y.specularMap.value=g.specularMap,t(g.specularMap,y.specularMapTransform)),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest);const T=e.get(g).envMap;if(T&&(y.envMap.value=T,y.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=g.reflectivity,y.ior.value=g.ior,y.refractionRatio.value=g.refractionRatio),g.lightMap){y.lightMap.value=g.lightMap;const S=n._useLegacyLights===!0?Math.PI:1;y.lightMapIntensity.value=g.lightMapIntensity*S,t(g.lightMap,y.lightMapTransform)}g.aoMap&&(y.aoMap.value=g.aoMap,y.aoMapIntensity.value=g.aoMapIntensity,t(g.aoMap,y.aoMapTransform))}function o(y,g){y.diffuse.value.copy(g.color),y.opacity.value=g.opacity,g.map&&(y.map.value=g.map,t(g.map,y.mapTransform))}function a(y,g){y.dashSize.value=g.dashSize,y.totalSize.value=g.dashSize+g.gapSize,y.scale.value=g.scale}function l(y,g,T,S){y.diffuse.value.copy(g.color),y.opacity.value=g.opacity,y.size.value=g.size*T,y.scale.value=S*.5,g.map&&(y.map.value=g.map,t(g.map,y.uvTransform)),g.alphaMap&&(y.alphaMap.value=g.alphaMap,t(g.alphaMap,y.alphaMapTransform)),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest)}function u(y,g){y.diffuse.value.copy(g.color),y.opacity.value=g.opacity,y.rotation.value=g.rotation,g.map&&(y.map.value=g.map,t(g.map,y.mapTransform)),g.alphaMap&&(y.alphaMap.value=g.alphaMap,t(g.alphaMap,y.alphaMapTransform)),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest)}function d(y,g){y.specular.value.copy(g.specular),y.shininess.value=Math.max(g.shininess,1e-4)}function f(y,g){g.gradientMap&&(y.gradientMap.value=g.gradientMap)}function p(y,g){y.metalness.value=g.metalness,g.metalnessMap&&(y.metalnessMap.value=g.metalnessMap,t(g.metalnessMap,y.metalnessMapTransform)),y.roughness.value=g.roughness,g.roughnessMap&&(y.roughnessMap.value=g.roughnessMap,t(g.roughnessMap,y.roughnessMapTransform)),e.get(g).envMap&&(y.envMapIntensity.value=g.envMapIntensity)}function m(y,g,T){y.ior.value=g.ior,g.sheen>0&&(y.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),y.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(y.sheenColorMap.value=g.sheenColorMap,t(g.sheenColorMap,y.sheenColorMapTransform)),g.sheenRoughnessMap&&(y.sheenRoughnessMap.value=g.sheenRoughnessMap,t(g.sheenRoughnessMap,y.sheenRoughnessMapTransform))),g.clearcoat>0&&(y.clearcoat.value=g.clearcoat,y.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(y.clearcoatMap.value=g.clearcoatMap,t(g.clearcoatMap,y.clearcoatMapTransform)),g.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap,t(g.clearcoatRoughnessMap,y.clearcoatRoughnessMapTransform)),g.clearcoatNormalMap&&(y.clearcoatNormalMap.value=g.clearcoatNormalMap,t(g.clearcoatNormalMap,y.clearcoatNormalMapTransform),y.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),g.side===Ki&&y.clearcoatNormalScale.value.negate())),g.iridescence>0&&(y.iridescence.value=g.iridescence,y.iridescenceIOR.value=g.iridescenceIOR,y.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(y.iridescenceMap.value=g.iridescenceMap,t(g.iridescenceMap,y.iridescenceMapTransform)),g.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=g.iridescenceThicknessMap,t(g.iridescenceThicknessMap,y.iridescenceThicknessMapTransform))),g.transmission>0&&(y.transmission.value=g.transmission,y.transmissionSamplerMap.value=T.texture,y.transmissionSamplerSize.value.set(T.width,T.height),g.transmissionMap&&(y.transmissionMap.value=g.transmissionMap,t(g.transmissionMap,y.transmissionMapTransform)),y.thickness.value=g.thickness,g.thicknessMap&&(y.thicknessMap.value=g.thicknessMap,t(g.thicknessMap,y.thicknessMapTransform)),y.attenuationDistance.value=g.attenuationDistance,y.attenuationColor.value.copy(g.attenuationColor)),g.anisotropy>0&&(y.anisotropyVector.value.set(g.anisotropy*Math.cos(g.anisotropyRotation),g.anisotropy*Math.sin(g.anisotropyRotation)),g.anisotropyMap&&(y.anisotropyMap.value=g.anisotropyMap,t(g.anisotropyMap,y.anisotropyMapTransform))),y.specularIntensity.value=g.specularIntensity,y.specularColor.value.copy(g.specularColor),g.specularColorMap&&(y.specularColorMap.value=g.specularColorMap,t(g.specularColorMap,y.specularColorMapTransform)),g.specularIntensityMap&&(y.specularIntensityMap.value=g.specularIntensityMap,t(g.specularIntensityMap,y.specularIntensityMapTransform))}function v(y,g){g.matcap&&(y.matcap.value=g.matcap)}function x(y,g){const T=e.get(g).light;y.referencePosition.value.setFromMatrixPosition(T.matrixWorld),y.nearDistance.value=T.shadow.camera.near,y.farDistance.value=T.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function Q5(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(T,S){const w=S.program;i.uniformBlockBinding(T,w)}function u(T,S){let w=r[T.id];w===void 0&&(v(T),w=d(T),r[T.id]=w,T.addEventListener("dispose",y));const M=S.program;i.updateUBOMapping(T,M);const R=e.render.frame;s[T.id]!==R&&(p(T),s[T.id]=R)}function d(T){const S=f();T.__bindingPointIndex=S;const w=n.createBuffer(),M=T.__size,R=T.usage;return n.bindBuffer(n.UNIFORM_BUFFER,w),n.bufferData(n.UNIFORM_BUFFER,M,R),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,S,w),w}function f(){for(let T=0;T<a;T++)if(o.indexOf(T)===-1)return o.push(T),T;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function p(T){const S=r[T.id],w=T.uniforms,M=T.__cache;n.bindBuffer(n.UNIFORM_BUFFER,S);for(let R=0,P=w.length;R<P;R++){const N=w[R];if(m(N,R,M)===!0){const C=N.__offset,L=Array.isArray(N.value)?N.value:[N.value];let Q=0;for(let W=0;W<L.length;W++){const z=L[W],F=x(z);typeof z=="number"?(N.__data[0]=z,n.bufferSubData(n.UNIFORM_BUFFER,C+Q,N.__data)):z.isMatrix3?(N.__data[0]=z.elements[0],N.__data[1]=z.elements[1],N.__data[2]=z.elements[2],N.__data[3]=z.elements[0],N.__data[4]=z.elements[3],N.__data[5]=z.elements[4],N.__data[6]=z.elements[5],N.__data[7]=z.elements[0],N.__data[8]=z.elements[6],N.__data[9]=z.elements[7],N.__data[10]=z.elements[8],N.__data[11]=z.elements[0]):(z.toArray(N.__data,Q),Q+=F.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,C,N.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function m(T,S,w){const M=T.value;if(w[S]===void 0){if(typeof M=="number")w[S]=M;else{const R=Array.isArray(M)?M:[M],P=[];for(let N=0;N<R.length;N++)P.push(R[N].clone());w[S]=P}return!0}else if(typeof M=="number"){if(w[S]!==M)return w[S]=M,!0}else{const R=Array.isArray(w[S])?w[S]:[w[S]],P=Array.isArray(M)?M:[M];for(let N=0;N<R.length;N++){const C=R[N];if(C.equals(P[N])===!1)return C.copy(P[N]),!0}}return!1}function v(T){const S=T.uniforms;let w=0;const M=16;let R=0;for(let P=0,N=S.length;P<N;P++){const C=S[P],L={boundary:0,storage:0},Q=Array.isArray(C.value)?C.value:[C.value];for(let W=0,z=Q.length;W<z;W++){const F=Q[W],X=x(F);L.boundary+=X.boundary,L.storage+=X.storage}if(C.__data=new Float32Array(L.storage/Float32Array.BYTES_PER_ELEMENT),C.__offset=w,P>0){R=w%M;const W=M-R;R!==0&&W-L.boundary<0&&(w+=M-R,C.__offset=w)}w+=L.storage}return R=w%M,R>0&&(w+=M-R),T.__size=w,T.__cache={},this}function x(T){const S={boundary:0,storage:0};return typeof T=="number"?(S.boundary=4,S.storage=4):T.isVector2?(S.boundary=8,S.storage=8):T.isVector3||T.isColor?(S.boundary=16,S.storage=12):T.isVector4?(S.boundary=16,S.storage=16):T.isMatrix3?(S.boundary=48,S.storage=48):T.isMatrix4?(S.boundary=64,S.storage=64):T.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",T),S}function y(T){const S=T.target;S.removeEventListener("dispose",y);const w=o.indexOf(S.__bindingPointIndex);o.splice(w,1),n.deleteBuffer(r[S.id]),delete r[S.id],delete s[S.id]}function g(){for(const T in r)n.deleteBuffer(r[T]);o=[],r={},s={}}return{bind:l,update:u,dispose:g}}class yI{constructor(e={}){const{canvas:t=YF(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:f=!1}=e;this.isWebGLRenderer=!0;let p;i!==null?p=i.getContextAttributes().alpha:p=o;const m=new Uint32Array(4),v=new Int32Array(4);let x=null,y=null;const g=[],T=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Tn,this._useLegacyLights=!1,this.toneMapping=Ca,this.toneMappingExposure=1;const S=this;let w=!1,M=0,R=0,P=null,N=-1,C=null;const L=new Zt,Q=new Zt;let W=null;const z=new St(0);let F=0,X=t.width,Z=t.height,$=1,O=null,H=null;const B=new Zt(0,0,X,Z),G=new Zt(0,0,X,Z);let ne=!1;const ee=new aE;let ie=!1,pe=!1,ve=null;const Me=new Mt,Ze=new Ut,Ye=new Y,ze={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ie(){return P===null?$:1}let q=i;function ct(D,J){for(let oe=0;oe<D.length;oe++){const ae=D[oe],se=t.getContext(ae,J);if(se!==null)return se}return null}try{const D={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:d,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${iE}`),t.addEventListener("webglcontextlost",wt,!1),t.addEventListener("webglcontextrestored",j,!1),t.addEventListener("webglcontextcreationerror",Be,!1),q===null){const J=["webgl2","webgl","experimental-webgl"];if(S.isWebGL1Renderer===!0&&J.shift(),q=ct(J,D),q===null)throw ct(J)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&q instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),q.getShaderPrecisionFormat===void 0&&(q.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(D){throw console.error("THREE.WebGLRenderer: "+D.message),D}let Xe,st,nt,Kt,gt,xt,Ft,Un,Fn,k,I,re,we,ye,Ae,Qe,Re,Oe,ft,Bt,be,Ht,yt,ht;function it(){Xe=new u4(q),st=new i4(q,Xe,e),Xe.init(st),Ht=new $5(q,Xe,st),nt=new X5(q,Xe,st),Kt=new d4(q),gt=new I5,xt=new j5(q,Xe,nt,gt,st,Ht,Kt),Ft=new s4(S),Un=new l4(S),Fn=new yO(q,st),yt=new t4(q,Xe,Fn,st),k=new c4(q,Fn,Kt,yt),I=new g4(q,k,Fn,Kt),ft=new m4(q,st,xt),Qe=new r4(gt),re=new P5(S,Ft,Un,Xe,st,yt,Qe),we=new Z5(S,gt),ye=new D5,Ae=new k5(Xe,st),Oe=new e4(S,Ft,Un,nt,I,p,l),Re=new W5(S,I,st),ht=new Q5(q,Kt,st,nt),Bt=new n4(q,Xe,Kt,st),be=new h4(q,Xe,Kt,st),Kt.programs=re.programs,S.capabilities=st,S.extensions=Xe,S.properties=gt,S.renderLists=ye,S.shadowMap=Re,S.state=nt,S.info=Kt}it();const Ve=new K5(S,q);this.xr=Ve,this.getContext=function(){return q},this.getContextAttributes=function(){return q.getContextAttributes()},this.forceContextLoss=function(){const D=Xe.get("WEBGL_lose_context");D&&D.loseContext()},this.forceContextRestore=function(){const D=Xe.get("WEBGL_lose_context");D&&D.restoreContext()},this.getPixelRatio=function(){return $},this.setPixelRatio=function(D){D!==void 0&&($=D,this.setSize(X,Z,!1))},this.getSize=function(D){return D.set(X,Z)},this.setSize=function(D,J,oe=!0){if(Ve.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}X=D,Z=J,t.width=Math.floor(D*$),t.height=Math.floor(J*$),oe===!0&&(t.style.width=D+"px",t.style.height=J+"px"),this.setViewport(0,0,D,J)},this.getDrawingBufferSize=function(D){return D.set(X*$,Z*$).floor()},this.setDrawingBufferSize=function(D,J,oe){X=D,Z=J,$=oe,t.width=Math.floor(D*oe),t.height=Math.floor(J*oe),this.setViewport(0,0,D,J)},this.getCurrentViewport=function(D){return D.copy(L)},this.getViewport=function(D){return D.copy(B)},this.setViewport=function(D,J,oe,ae){D.isVector4?B.set(D.x,D.y,D.z,D.w):B.set(D,J,oe,ae),nt.viewport(L.copy(B).multiplyScalar($).floor())},this.getScissor=function(D){return D.copy(G)},this.setScissor=function(D,J,oe,ae){D.isVector4?G.set(D.x,D.y,D.z,D.w):G.set(D,J,oe,ae),nt.scissor(Q.copy(G).multiplyScalar($).floor())},this.getScissorTest=function(){return ne},this.setScissorTest=function(D){nt.setScissorTest(ne=D)},this.setOpaqueSort=function(D){O=D},this.setTransparentSort=function(D){H=D},this.getClearColor=function(D){return D.copy(Oe.getClearColor())},this.setClearColor=function(){Oe.setClearColor.apply(Oe,arguments)},this.getClearAlpha=function(){return Oe.getClearAlpha()},this.setClearAlpha=function(){Oe.setClearAlpha.apply(Oe,arguments)},this.clear=function(D=!0,J=!0,oe=!0){let ae=0;if(D){let se=!1;if(P!==null){const ke=P.texture.format;se=ke===YP||ke===$P||ke===jP}if(se){const ke=P.texture.type,Je=ke===Ra||ke===ma||ke===rE||ke===Pl||ke===WP||ke===XP,ot=Oe.getClearColor(),pt=Oe.getClearAlpha(),_t=ot.r,mt=ot.g,vt=ot.b;Je?(m[0]=_t,m[1]=mt,m[2]=vt,m[3]=pt,q.clearBufferuiv(q.COLOR,0,m)):(v[0]=_t,v[1]=mt,v[2]=vt,v[3]=pt,q.clearBufferiv(q.COLOR,0,v))}else ae|=q.COLOR_BUFFER_BIT}J&&(ae|=q.DEPTH_BUFFER_BIT),oe&&(ae|=q.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),q.clear(ae)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",wt,!1),t.removeEventListener("webglcontextrestored",j,!1),t.removeEventListener("webglcontextcreationerror",Be,!1),ye.dispose(),Ae.dispose(),gt.dispose(),Ft.dispose(),Un.dispose(),I.dispose(),yt.dispose(),ht.dispose(),re.dispose(),Ve.dispose(),Ve.removeEventListener("sessionstart",Wn),Ve.removeEventListener("sessionend",Yt),ve&&(ve.dispose(),ve=null),ri.stop()};function wt(D){D.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),w=!0}function j(){console.log("THREE.WebGLRenderer: Context Restored."),w=!1;const D=Kt.autoReset,J=Re.enabled,oe=Re.autoUpdate,ae=Re.needsUpdate,se=Re.type;it(),Kt.autoReset=D,Re.enabled=J,Re.autoUpdate=oe,Re.needsUpdate=ae,Re.type=se}function Be(D){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",D.statusMessage)}function Te(D){const J=D.target;J.removeEventListener("dispose",Te),ce(J)}function ce(D){Ce(D),gt.remove(D)}function Ce(D){const J=gt.get(D).programs;J!==void 0&&(J.forEach(function(oe){re.releaseProgram(oe)}),D.isShaderMaterial&&re.releaseShaderCache(D))}this.renderBufferDirect=function(D,J,oe,ae,se,ke){J===null&&(J=ze);const Je=se.isMesh&&se.matrixWorld.determinant()<0,ot=k0(D,J,oe,ae,se);nt.setMaterial(ae,Je);let pt=oe.index,_t=1;if(ae.wireframe===!0){if(pt=k.getWireframeAttribute(oe),pt===void 0)return;_t=2}const mt=oe.drawRange,vt=oe.attributes.position;let dn=mt.start*_t,si=(mt.start+mt.count)*_t;ke!==null&&(dn=Math.max(dn,ke.start*_t),si=Math.min(si,(ke.start+ke.count)*_t)),pt!==null?(dn=Math.max(dn,0),si=Math.min(si,pt.count)):vt!=null&&(dn=Math.max(dn,0),si=Math.min(si,vt.count));const en=si-dn;if(en<0||en===1/0)return;yt.setup(se,ae,ot,oe,pt);let Xn,dt=Bt;if(pt!==null&&(Xn=Fn.get(pt),dt=be,dt.setIndex(Xn)),se.isMesh)ae.wireframe===!0?(nt.setLineWidth(ae.wireframeLinewidth*Ie()),dt.setMode(q.LINES)):dt.setMode(q.TRIANGLES);else if(se.isLine){let We=ae.linewidth;We===void 0&&(We=1),nt.setLineWidth(We*Ie()),se.isLineSegments?dt.setMode(q.LINES):se.isLineLoop?dt.setMode(q.LINE_LOOP):dt.setMode(q.LINE_STRIP)}else se.isPoints?dt.setMode(q.POINTS):se.isSprite&&dt.setMode(q.TRIANGLES);if(se.isBatchedMesh)dt.renderMultiDraw(se._multiDrawStarts,se._multiDrawCounts,se._multiDrawCount);else if(se.isInstancedMesh)dt.renderInstances(dn,en,se.count);else if(oe.isInstancedBufferGeometry){const We=oe._maxInstanceCount!==void 0?oe._maxInstanceCount:1/0,mr=Math.min(oe.instanceCount,We);dt.renderInstances(dn,en,mr)}else dt.render(dn,en)};function at(D,J,oe){D.transparent===!0&&D.side===Us&&D.forceSinglePass===!1?(D.side=Ki,D.needsUpdate=!0,Qs(D,J,oe),D.side=No,D.needsUpdate=!0,Qs(D,J,oe),D.side=Us):Qs(D,J,oe)}this.compile=function(D,J,oe=null){oe===null&&(oe=D),y=Ae.get(oe),y.init(),T.push(y),oe.traverseVisible(function(se){se.isLight&&se.layers.test(J.layers)&&(y.pushLight(se),se.castShadow&&y.pushShadow(se))}),D!==oe&&D.traverseVisible(function(se){se.isLight&&se.layers.test(J.layers)&&(y.pushLight(se),se.castShadow&&y.pushShadow(se))}),y.setupLights(S._useLegacyLights);const ae=new Set;return D.traverse(function(se){const ke=se.material;if(ke)if(Array.isArray(ke))for(let Je=0;Je<ke.length;Je++){const ot=ke[Je];at(ot,oe,se),ae.add(ot)}else at(ke,oe,se),ae.add(ke)}),T.pop(),y=null,ae},this.compileAsync=function(D,J,oe=null){const ae=this.compile(D,J,oe);return new Promise(se=>{function ke(){if(ae.forEach(function(Je){gt.get(Je).currentProgram.isReady()&&ae.delete(Je)}),ae.size===0){se(D);return}setTimeout(ke,10)}Xe.get("KHR_parallel_shader_compile")!==null?ke():setTimeout(ke,10)})};let Ct=null;function wn(D){Ct&&Ct(D)}function Wn(){ri.stop()}function Yt(){ri.start()}const ri=new hI;ri.setAnimationLoop(wn),typeof self<"u"&&ri.setContext(self),this.setAnimationLoop=function(D){Ct=D,Ve.setAnimationLoop(D),D===null?ri.stop():ri.start()},Ve.addEventListener("sessionstart",Wn),Ve.addEventListener("sessionend",Yt),this.render=function(D,J){if(J!==void 0&&J.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(w===!0)return;D.matrixWorldAutoUpdate===!0&&D.updateMatrixWorld(),J.parent===null&&J.matrixWorldAutoUpdate===!0&&J.updateMatrixWorld(),Ve.enabled===!0&&Ve.isPresenting===!0&&(Ve.cameraAutoUpdate===!0&&Ve.updateCamera(J),J=Ve.getCamera()),D.isScene===!0&&D.onBeforeRender(S,D,J,P),y=Ae.get(D,T.length),y.init(),T.push(y),Me.multiplyMatrices(J.projectionMatrix,J.matrixWorldInverse),ee.setFromProjectionMatrix(Me),pe=this.localClippingEnabled,ie=Qe.init(this.clippingPlanes,pe),x=ye.get(D,g.length),x.init(),g.push(x),pr(D,J,0,S.sortObjects),x.finish(),S.sortObjects===!0&&x.sort(O,H),this.info.render.frame++,ie===!0&&Qe.beginShadows();const oe=y.state.shadowsArray;if(Re.render(oe,D,J),ie===!0&&Qe.endShadows(),this.info.autoReset===!0&&this.info.reset(),Oe.render(x,D),y.setupLights(S._useLegacyLights),J.isArrayCamera){const ae=J.cameras;for(let se=0,ke=ae.length;se<ke;se++){const Je=ae[se];sh(x,D,Je,Je.viewport)}}else sh(x,D,J);P!==null&&(xt.updateMultisampleRenderTarget(P),xt.updateRenderTargetMipmap(P)),D.isScene===!0&&D.onAfterRender(S,D,J),yt.resetDefaultState(),N=-1,C=null,T.pop(),T.length>0?y=T[T.length-1]:y=null,g.pop(),g.length>0?x=g[g.length-1]:x=null};function pr(D,J,oe,ae){if(D.visible===!1)return;if(D.layers.test(J.layers)){if(D.isGroup)oe=D.renderOrder;else if(D.isLOD)D.autoUpdate===!0&&D.update(J);else if(D.isLight)y.pushLight(D),D.castShadow&&y.pushShadow(D);else if(D.isSprite){if(!D.frustumCulled||ee.intersectsSprite(D)){ae&&Ye.setFromMatrixPosition(D.matrixWorld).applyMatrix4(Me);const Je=I.update(D),ot=D.material;ot.visible&&x.push(D,Je,ot,oe,Ye.z,null)}}else if((D.isMesh||D.isLine||D.isPoints)&&(!D.frustumCulled||ee.intersectsObject(D))){const Je=I.update(D),ot=D.material;if(ae&&(D.boundingSphere!==void 0?(D.boundingSphere===null&&D.computeBoundingSphere(),Ye.copy(D.boundingSphere.center)):(Je.boundingSphere===null&&Je.computeBoundingSphere(),Ye.copy(Je.boundingSphere.center)),Ye.applyMatrix4(D.matrixWorld).applyMatrix4(Me)),Array.isArray(ot)){const pt=Je.groups;for(let _t=0,mt=pt.length;_t<mt;_t++){const vt=pt[_t],dn=ot[vt.materialIndex];dn&&dn.visible&&x.push(D,Je,dn,oe,Ye.z,vt)}}else ot.visible&&x.push(D,Je,ot,oe,Ye.z,null)}}const ke=D.children;for(let Je=0,ot=ke.length;Je<ot;Je++)pr(ke[Je],J,oe,ae)}function sh(D,J,oe,ae){const se=D.opaque,ke=D.transmissive,Je=D.transparent;y.setupLightsView(oe),ie===!0&&Qe.setGlobalState(S.clippingPlanes,oe),ke.length>0&&oh(se,ke,J,oe),ae&&nt.viewport(L.copy(ae)),se.length>0&&nu(se,J,oe),ke.length>0&&nu(ke,J,oe),Je.length>0&&nu(Je,J,oe),nt.buffers.depth.setTest(!0),nt.buffers.depth.setMask(!0),nt.buffers.color.setMask(!0),nt.setPolygonOffset(!1)}function oh(D,J,oe,ae){if((oe.isScene===!0?oe.overrideMaterial:null)!==null)return;const ke=st.isWebGL2;ve===null&&(ve=new Wl(1,1,{generateMipmaps:!0,type:Xe.has("EXT_color_buffer_half_float")?Xd:Ra,minFilter:Vl,samples:ke?4:0})),S.getDrawingBufferSize(Ze),ke?ve.setSize(Ze.x,Ze.y):ve.setSize(Lg(Ze.x),Lg(Ze.y));const Je=S.getRenderTarget();S.setRenderTarget(ve),S.getClearColor(z),F=S.getClearAlpha(),F<1&&S.setClearColor(16777215,.5),S.clear();const ot=S.toneMapping;S.toneMapping=Ca,nu(D,oe,ae),xt.updateMultisampleRenderTarget(ve),xt.updateRenderTargetMipmap(ve);let pt=!1;for(let _t=0,mt=J.length;_t<mt;_t++){const vt=J[_t],dn=vt.object,si=vt.geometry,en=vt.material,Xn=vt.group;if(en.side===Us&&dn.layers.test(ae.layers)){const dt=en.side;en.side=Ki,en.needsUpdate=!0,pf(dn,oe,ae,si,en,Xn),en.side=dt,en.needsUpdate=!0,pt=!0}}pt===!0&&(xt.updateMultisampleRenderTarget(ve),xt.updateRenderTargetMipmap(ve)),S.setRenderTarget(Je),S.setClearColor(z,F),S.toneMapping=ot}function nu(D,J,oe){const ae=J.isScene===!0?J.overrideMaterial:null;for(let se=0,ke=D.length;se<ke;se++){const Je=D[se],ot=Je.object,pt=Je.geometry,_t=ae===null?Je.material:ae,mt=Je.group;ot.layers.test(oe.layers)&&pf(ot,J,oe,pt,_t,mt)}}function pf(D,J,oe,ae,se,ke){D.onBeforeRender(S,J,oe,ae,se,ke),D.modelViewMatrix.multiplyMatrices(oe.matrixWorldInverse,D.matrixWorld),D.normalMatrix.getNormalMatrix(D.modelViewMatrix),se.onBeforeRender(S,J,oe,ae,D,ke),se.transparent===!0&&se.side===Us&&se.forceSinglePass===!1?(se.side=Ki,se.needsUpdate=!0,S.renderBufferDirect(oe,J,ae,se,D,ke),se.side=No,se.needsUpdate=!0,S.renderBufferDirect(oe,J,ae,se,D,ke),se.side=Us):S.renderBufferDirect(oe,J,ae,se,D,ke),D.onAfterRender(S,J,oe,ae,se,ke)}function Qs(D,J,oe){J.isScene!==!0&&(J=ze);const ae=gt.get(D),se=y.state.lights,ke=y.state.shadowsArray,Je=se.state.version,ot=re.getParameters(D,se.state,ke,J,oe),pt=re.getProgramCacheKey(ot);let _t=ae.programs;ae.environment=D.isMeshStandardMaterial?J.environment:null,ae.fog=J.fog,ae.envMap=(D.isMeshStandardMaterial?Un:Ft).get(D.envMap||ae.environment),_t===void 0&&(D.addEventListener("dispose",Te),_t=new Map,ae.programs=_t);let mt=_t.get(pt);if(mt!==void 0){if(ae.currentProgram===mt&&ae.lightsStateVersion===Je)return gf(D,ot),mt}else ot.uniforms=re.getUniforms(D),D.onBuild(oe,ot,S),D.onBeforeCompile(ot,S),mt=re.acquireProgram(ot,pt),_t.set(pt,mt),ae.uniforms=ot.uniforms;const vt=ae.uniforms;return(!D.isShaderMaterial&&!D.isRawShaderMaterial||D.clipping===!0)&&(vt.clippingPlanes=Qe.uniform),gf(D,ot),ae.needsLights=G0(D),ae.lightsStateVersion=Je,ae.needsLights&&(vt.ambientLightColor.value=se.state.ambient,vt.lightProbe.value=se.state.probe,vt.directionalLights.value=se.state.directional,vt.directionalLightShadows.value=se.state.directionalShadow,vt.spotLights.value=se.state.spot,vt.spotLightShadows.value=se.state.spotShadow,vt.rectAreaLights.value=se.state.rectArea,vt.ltc_1.value=se.state.rectAreaLTC1,vt.ltc_2.value=se.state.rectAreaLTC2,vt.pointLights.value=se.state.point,vt.pointLightShadows.value=se.state.pointShadow,vt.hemisphereLights.value=se.state.hemi,vt.directionalShadowMap.value=se.state.directionalShadowMap,vt.directionalShadowMatrix.value=se.state.directionalShadowMatrix,vt.spotShadowMap.value=se.state.spotShadowMap,vt.spotLightMatrix.value=se.state.spotLightMatrix,vt.spotLightMap.value=se.state.spotLightMap,vt.pointShadowMap.value=se.state.pointShadowMap,vt.pointShadowMatrix.value=se.state.pointShadowMatrix),ae.currentProgram=mt,ae.uniformsList=null,mt}function mf(D){if(D.uniformsList===null){const J=D.currentProgram.getUniforms();D.uniformsList=Wm.seqWithValue(J.seq,D.uniforms)}return D.uniformsList}function gf(D,J){const oe=gt.get(D);oe.outputColorSpace=J.outputColorSpace,oe.batching=J.batching,oe.instancing=J.instancing,oe.instancingColor=J.instancingColor,oe.skinning=J.skinning,oe.morphTargets=J.morphTargets,oe.morphNormals=J.morphNormals,oe.morphColors=J.morphColors,oe.morphTargetsCount=J.morphTargetsCount,oe.numClippingPlanes=J.numClippingPlanes,oe.numIntersection=J.numClipIntersection,oe.vertexAlphas=J.vertexAlphas,oe.vertexTangents=J.vertexTangents,oe.toneMapping=J.toneMapping}function k0(D,J,oe,ae,se){J.isScene!==!0&&(J=ze),xt.resetTextureUnits();const ke=J.fog,Je=ae.isMeshStandardMaterial?J.environment:null,ot=P===null?S.outputColorSpace:P.isXRRenderTarget===!0?P.texture.colorSpace:mi,pt=(ae.isMeshStandardMaterial?Un:Ft).get(ae.envMap||Je),_t=ae.vertexColors===!0&&!!oe.attributes.color&&oe.attributes.color.itemSize===4,mt=!!oe.attributes.tangent&&(!!ae.normalMap||ae.anisotropy>0),vt=!!oe.morphAttributes.position,dn=!!oe.morphAttributes.normal,si=!!oe.morphAttributes.color;let en=Ca;ae.toneMapped&&(P===null||P.isXRRenderTarget===!0)&&(en=S.toneMapping);const Xn=oe.morphAttributes.position||oe.morphAttributes.normal||oe.morphAttributes.color,dt=Xn!==void 0?Xn.length:0,We=gt.get(ae),mr=y.state.lights;if(ie===!0&&(pe===!0||D!==C)){const ai=D===C&&ae.id===N;Qe.setState(ae,D,ai)}let bt=!1;ae.version===We.__version?(We.needsLights&&We.lightsStateVersion!==mr.state.version||We.outputColorSpace!==ot||se.isBatchedMesh&&We.batching===!1||!se.isBatchedMesh&&We.batching===!0||se.isInstancedMesh&&We.instancing===!1||!se.isInstancedMesh&&We.instancing===!0||se.isSkinnedMesh&&We.skinning===!1||!se.isSkinnedMesh&&We.skinning===!0||se.isInstancedMesh&&We.instancingColor===!0&&se.instanceColor===null||se.isInstancedMesh&&We.instancingColor===!1&&se.instanceColor!==null||We.envMap!==pt||ae.fog===!0&&We.fog!==ke||We.numClippingPlanes!==void 0&&(We.numClippingPlanes!==Qe.numPlanes||We.numIntersection!==Qe.numIntersection)||We.vertexAlphas!==_t||We.vertexTangents!==mt||We.morphTargets!==vt||We.morphNormals!==dn||We.morphColors!==si||We.toneMapping!==en||st.isWebGL2===!0&&We.morphTargetsCount!==dt)&&(bt=!0):(bt=!0,We.__version=ae.version);let xn=We.currentProgram;bt===!0&&(xn=Qs(ae,J,se));let ds=!1,gr=!1,oi=!1;const Pn=xn.getUniforms(),fs=We.uniforms;if(nt.useProgram(xn.program)&&(ds=!0,gr=!0,oi=!0),ae.id!==N&&(N=ae.id,gr=!0),ds||C!==D){Pn.setValue(q,"projectionMatrix",D.projectionMatrix),Pn.setValue(q,"viewMatrix",D.matrixWorldInverse);const ai=Pn.map.cameraPosition;ai!==void 0&&ai.setValue(q,Ye.setFromMatrixPosition(D.matrixWorld)),st.logarithmicDepthBuffer&&Pn.setValue(q,"logDepthBufFC",2/(Math.log(D.far+1)/Math.LN2)),(ae.isMeshPhongMaterial||ae.isMeshToonMaterial||ae.isMeshLambertMaterial||ae.isMeshBasicMaterial||ae.isMeshStandardMaterial||ae.isShaderMaterial)&&Pn.setValue(q,"isOrthographic",D.isOrthographicCamera===!0),C!==D&&(C=D,gr=!0,oi=!0)}if(se.isSkinnedMesh){Pn.setOptional(q,se,"bindMatrix"),Pn.setOptional(q,se,"bindMatrixInverse");const ai=se.skeleton;ai&&(st.floatVertexTextures?(ai.boneTexture===null&&ai.computeBoneTexture(),Pn.setValue(q,"boneTexture",ai.boneTexture,xt)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}se.isBatchedMesh&&(Pn.setOptional(q,se,"batchingTexture"),Pn.setValue(q,"batchingTexture",se._matricesTexture,xt));const iu=oe.morphAttributes;if((iu.position!==void 0||iu.normal!==void 0||iu.color!==void 0&&st.isWebGL2===!0)&&ft.update(se,oe,xn),(gr||We.receiveShadow!==se.receiveShadow)&&(We.receiveShadow=se.receiveShadow,Pn.setValue(q,"receiveShadow",se.receiveShadow)),ae.isMeshGouraudMaterial&&ae.envMap!==null&&(fs.envMap.value=pt,fs.flipEnvMap.value=pt.isCubeTexture&&pt.isRenderTargetTexture===!1?-1:1),gr&&(Pn.setValue(q,"toneMappingExposure",S.toneMappingExposure),We.needsLights&&z0(fs,oi),ke&&ae.fog===!0&&we.refreshFogUniforms(fs,ke),we.refreshMaterialUniforms(fs,ae,$,Z,ve),Wm.upload(q,mf(We),fs,xt)),ae.isShaderMaterial&&ae.uniformsNeedUpdate===!0&&(Wm.upload(q,mf(We),fs,xt),ae.uniformsNeedUpdate=!1),ae.isSpriteMaterial&&Pn.setValue(q,"center",se.center),Pn.setValue(q,"modelViewMatrix",se.modelViewMatrix),Pn.setValue(q,"normalMatrix",se.normalMatrix),Pn.setValue(q,"modelMatrix",se.matrixWorld),ae.isShaderMaterial||ae.isRawShaderMaterial){const ai=ae.uniformsGroups;for(let ru=0,Qi=ai.length;ru<Qi;ru++)if(st.isWebGL2){const _f=ai[ru];ht.update(_f,xn),ht.bind(_f,xn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return xn}function z0(D,J){D.ambientLightColor.needsUpdate=J,D.lightProbe.needsUpdate=J,D.directionalLights.needsUpdate=J,D.directionalLightShadows.needsUpdate=J,D.pointLights.needsUpdate=J,D.pointLightShadows.needsUpdate=J,D.spotLights.needsUpdate=J,D.spotLightShadows.needsUpdate=J,D.rectAreaLights.needsUpdate=J,D.hemisphereLights.needsUpdate=J}function G0(D){return D.isMeshLambertMaterial||D.isMeshToonMaterial||D.isMeshPhongMaterial||D.isMeshStandardMaterial||D.isShadowMaterial||D.isShaderMaterial&&D.lights===!0}this.getActiveCubeFace=function(){return M},this.getActiveMipmapLevel=function(){return R},this.getRenderTarget=function(){return P},this.setRenderTargetTextures=function(D,J,oe){gt.get(D.texture).__webglTexture=J,gt.get(D.depthTexture).__webglTexture=oe;const ae=gt.get(D);ae.__hasExternalTextures=!0,ae.__hasExternalTextures&&(ae.__autoAllocateDepthBuffer=oe===void 0,ae.__autoAllocateDepthBuffer||Xe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ae.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(D,J){const oe=gt.get(D);oe.__webglFramebuffer=J,oe.__useDefaultFramebuffer=J===void 0},this.setRenderTarget=function(D,J=0,oe=0){P=D,M=J,R=oe;let ae=!0,se=null,ke=!1,Je=!1;if(D){const pt=gt.get(D);pt.__useDefaultFramebuffer!==void 0?(nt.bindFramebuffer(q.FRAMEBUFFER,null),ae=!1):pt.__webglFramebuffer===void 0?xt.setupRenderTarget(D):pt.__hasExternalTextures&&xt.rebindTextures(D,gt.get(D.texture).__webglTexture,gt.get(D.depthTexture).__webglTexture);const _t=D.texture;(_t.isData3DTexture||_t.isDataArrayTexture||_t.isCompressedArrayTexture)&&(Je=!0);const mt=gt.get(D).__webglFramebuffer;D.isWebGLCubeRenderTarget?(Array.isArray(mt[J])?se=mt[J][oe]:se=mt[J],ke=!0):st.isWebGL2&&D.samples>0&&xt.useMultisampledRTT(D)===!1?se=gt.get(D).__webglMultisampledFramebuffer:Array.isArray(mt)?se=mt[oe]:se=mt,L.copy(D.viewport),Q.copy(D.scissor),W=D.scissorTest}else L.copy(B).multiplyScalar($).floor(),Q.copy(G).multiplyScalar($).floor(),W=ne;if(nt.bindFramebuffer(q.FRAMEBUFFER,se)&&st.drawBuffers&&ae&&nt.drawBuffers(D,se),nt.viewport(L),nt.scissor(Q),nt.setScissorTest(W),ke){const pt=gt.get(D.texture);q.framebufferTexture2D(q.FRAMEBUFFER,q.COLOR_ATTACHMENT0,q.TEXTURE_CUBE_MAP_POSITIVE_X+J,pt.__webglTexture,oe)}else if(Je){const pt=gt.get(D.texture),_t=J||0;q.framebufferTextureLayer(q.FRAMEBUFFER,q.COLOR_ATTACHMENT0,pt.__webglTexture,oe||0,_t)}N=-1},this.readRenderTargetPixels=function(D,J,oe,ae,se,ke,Je){if(!(D&&D.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ot=gt.get(D).__webglFramebuffer;if(D.isWebGLCubeRenderTarget&&Je!==void 0&&(ot=ot[Je]),ot){nt.bindFramebuffer(q.FRAMEBUFFER,ot);try{const pt=D.texture,_t=pt.format,mt=pt.type;if(_t!==Ir&&Ht.convert(_t)!==q.getParameter(q.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const vt=mt===Xd&&(Xe.has("EXT_color_buffer_half_float")||st.isWebGL2&&Xe.has("EXT_color_buffer_float"));if(mt!==Ra&&Ht.convert(mt)!==q.getParameter(q.IMPLEMENTATION_COLOR_READ_TYPE)&&!(mt===So&&(st.isWebGL2||Xe.has("OES_texture_float")||Xe.has("WEBGL_color_buffer_float")))&&!vt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}J>=0&&J<=D.width-ae&&oe>=0&&oe<=D.height-se&&q.readPixels(J,oe,ae,se,Ht.convert(_t),Ht.convert(mt),ke)}finally{const pt=P!==null?gt.get(P).__webglFramebuffer:null;nt.bindFramebuffer(q.FRAMEBUFFER,pt)}}},this.copyFramebufferToTexture=function(D,J,oe=0){const ae=Math.pow(2,-oe),se=Math.floor(J.image.width*ae),ke=Math.floor(J.image.height*ae);xt.setTexture2D(J,0),q.copyTexSubImage2D(q.TEXTURE_2D,oe,0,0,D.x,D.y,se,ke),nt.unbindTexture()},this.copyTextureToTexture=function(D,J,oe,ae=0){const se=J.image.width,ke=J.image.height,Je=Ht.convert(oe.format),ot=Ht.convert(oe.type);xt.setTexture2D(oe,0),q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,oe.flipY),q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,oe.premultiplyAlpha),q.pixelStorei(q.UNPACK_ALIGNMENT,oe.unpackAlignment),J.isDataTexture?q.texSubImage2D(q.TEXTURE_2D,ae,D.x,D.y,se,ke,Je,ot,J.image.data):J.isCompressedTexture?q.compressedTexSubImage2D(q.TEXTURE_2D,ae,D.x,D.y,J.mipmaps[0].width,J.mipmaps[0].height,Je,J.mipmaps[0].data):q.texSubImage2D(q.TEXTURE_2D,ae,D.x,D.y,Je,ot,J.image),ae===0&&oe.generateMipmaps&&q.generateMipmap(q.TEXTURE_2D),nt.unbindTexture()},this.copyTextureToTexture3D=function(D,J,oe,ae,se=0){if(S.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const ke=D.max.x-D.min.x+1,Je=D.max.y-D.min.y+1,ot=D.max.z-D.min.z+1,pt=Ht.convert(ae.format),_t=Ht.convert(ae.type);let mt;if(ae.isData3DTexture)xt.setTexture3D(ae,0),mt=q.TEXTURE_3D;else if(ae.isDataArrayTexture)xt.setTexture2DArray(ae,0),mt=q.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,ae.flipY),q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ae.premultiplyAlpha),q.pixelStorei(q.UNPACK_ALIGNMENT,ae.unpackAlignment);const vt=q.getParameter(q.UNPACK_ROW_LENGTH),dn=q.getParameter(q.UNPACK_IMAGE_HEIGHT),si=q.getParameter(q.UNPACK_SKIP_PIXELS),en=q.getParameter(q.UNPACK_SKIP_ROWS),Xn=q.getParameter(q.UNPACK_SKIP_IMAGES),dt=oe.isCompressedTexture?oe.mipmaps[0]:oe.image;q.pixelStorei(q.UNPACK_ROW_LENGTH,dt.width),q.pixelStorei(q.UNPACK_IMAGE_HEIGHT,dt.height),q.pixelStorei(q.UNPACK_SKIP_PIXELS,D.min.x),q.pixelStorei(q.UNPACK_SKIP_ROWS,D.min.y),q.pixelStorei(q.UNPACK_SKIP_IMAGES,D.min.z),oe.isDataTexture||oe.isData3DTexture?q.texSubImage3D(mt,se,J.x,J.y,J.z,ke,Je,ot,pt,_t,dt.data):oe.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),q.compressedTexSubImage3D(mt,se,J.x,J.y,J.z,ke,Je,ot,pt,dt.data)):q.texSubImage3D(mt,se,J.x,J.y,J.z,ke,Je,ot,pt,_t,dt),q.pixelStorei(q.UNPACK_ROW_LENGTH,vt),q.pixelStorei(q.UNPACK_IMAGE_HEIGHT,dn),q.pixelStorei(q.UNPACK_SKIP_PIXELS,si),q.pixelStorei(q.UNPACK_SKIP_ROWS,en),q.pixelStorei(q.UNPACK_SKIP_IMAGES,Xn),se===0&&ae.generateMipmaps&&q.generateMipmap(mt),nt.unbindTexture()},this.initTexture=function(D){D.isCubeTexture?xt.setTextureCube(D,0):D.isData3DTexture?xt.setTexture3D(D,0):D.isDataArrayTexture||D.isCompressedArrayTexture?xt.setTexture2DArray(D,0):xt.setTexture2D(D,0),nt.unbindTexture()},this.resetState=function(){M=0,R=0,P=null,nt.reset(),yt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Eo}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===sE?"display-p3":"srgb",t.unpackColorSpace=Xt.workingColorSpace===y0?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Tn?Ll:ZP}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Ll?Tn:mi}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class J5 extends yI{}J5.prototype.isWebGL1Renderer=!0;let e8=class extends vn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}};class t8{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Zx,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=as()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn('THREE.InterleavedBuffer: "updateRange" is deprecated and removed in r169. Use "addUpdateRange()" instead.'),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=as()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=as()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Pi=new Y;class cE{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Pi.fromBufferAttribute(this,t),Pi.applyMatrix4(e),this.setXYZ(t,Pi.x,Pi.y,Pi.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Pi.fromBufferAttribute(this,t),Pi.applyNormalMatrix(e),this.setXYZ(t,Pi.x,Pi.y,Pi.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Pi.fromBufferAttribute(this,t),Pi.transformDirection(e),this.setXYZ(t,Pi.x,Pi.y,Pi.z);return this}setX(e,t){return this.normalized&&(t=qt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=qt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=qt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=qt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Fs(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Fs(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Fs(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Fs(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=qt(t,this.array),i=qt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=qt(t,this.array),i=qt(i,this.array),r=qt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=qt(t,this.array),i=qt(i,this.array),r=qt(r,this.array),s=qt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Fi(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new cE(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const KA=new Y,ZA=new Zt,QA=new Zt,n8=new Y,JA=new Mt,Wp=new Y,Zv=new $s,eM=new Mt,Qv=new x0;class i8 extends Nr{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Nw,this.bindMatrix=new Mt,this.bindMatrixInverse=new Mt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Bo),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,Wp),this.boundingBox.expandByPoint(Wp)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new $s),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,Wp),this.boundingSphere.expandByPoint(Wp)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Zv.copy(this.boundingSphere),Zv.applyMatrix4(r),e.ray.intersectsSphere(Zv)!==!1&&(eM.copy(r).invert(),Qv.copy(e.ray).applyMatrix4(eM),!(this.boundingBox!==null&&Qv.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,Qv)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Zt,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===Nw?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===dF?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;ZA.fromBufferAttribute(r.attributes.skinIndex,e),QA.fromBufferAttribute(r.attributes.skinWeight,e),KA.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=QA.getComponent(s);if(o!==0){const a=ZA.getComponent(s);JA.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(n8.copy(KA).applyMatrix4(JA),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class xI extends vn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class r8 extends hr{constructor(e=null,t=1,i=1,r,s,o,a,l,u=ti,d=ti,f,p){super(null,o,a,l,u,d,r,s,f,p),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const tM=new Mt,s8=new Mt;class hE{constructor(e=[],t=[]){this.uuid=as(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Mt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Mt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:s8;tM.multiplyMatrices(a,t[s]),tM.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new hE(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new r8(t,e,e,Ir,So);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new xI),this.bones.push(o),this.boneInverses.push(new Mt().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const o=t[r];e.bones.push(o.uuid);const a=i[r];e.boneInverses.push(a.toArray())}return e}}class t1 extends Fi{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Uu=new Mt,nM=new Mt,Xp=[],iM=new Bo,o8=new Mt,Oh=new Nr,Bh=new $s;class a8 extends Nr{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new t1(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,o8)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Bo),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Uu),iM.copy(e.boundingBox).applyMatrix4(Uu),this.boundingBox.union(iM)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new $s),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Uu),Bh.copy(e.boundingSphere).applyMatrix4(Uu),this.boundingSphere.union(Bh)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(Oh.geometry=this.geometry,Oh.material=this.material,Oh.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Bh.copy(this.boundingSphere),Bh.applyMatrix4(i),e.ray.intersectsSphere(Bh)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,Uu),nM.multiplyMatrices(i,Uu),Oh.matrixWorld=nM,Oh.raycast(e,Xp);for(let o=0,a=Xp.length;o<a;o++){const l=Xp[o];l.instanceId=s,l.object=this,t.push(l)}Xp.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new t1(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class SI extends Gs{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new St(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const rM=new Y,sM=new Y,oM=new Mt,Jv=new x0,jp=new $s;class dE extends vn{constructor(e=new Ys,t=new SI){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)rM.fromBufferAttribute(t,r-1),sM.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=rM.distanceTo(sM);e.setAttribute("lineDistance",new Mo(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),jp.copy(i.boundingSphere),jp.applyMatrix4(r),jp.radius+=s,e.ray.intersectsSphere(jp)===!1)return;oM.copy(r).invert(),Jv.copy(e.ray).applyMatrix4(oM);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=new Y,d=new Y,f=new Y,p=new Y,m=this.isLineSegments?2:1,v=i.index,y=i.attributes.position;if(v!==null){const g=Math.max(0,o.start),T=Math.min(v.count,o.start+o.count);for(let S=g,w=T-1;S<w;S+=m){const M=v.getX(S),R=v.getX(S+1);if(u.fromBufferAttribute(y,M),d.fromBufferAttribute(y,R),Jv.distanceSqToSegment(u,d,p,f)>l)continue;p.applyMatrix4(this.matrixWorld);const N=e.ray.origin.distanceTo(p);N<e.near||N>e.far||t.push({distance:N,point:f.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}else{const g=Math.max(0,o.start),T=Math.min(y.count,o.start+o.count);for(let S=g,w=T-1;S<w;S+=m){if(u.fromBufferAttribute(y,S),d.fromBufferAttribute(y,S+1),Jv.distanceSqToSegment(u,d,p,f)>l)continue;p.applyMatrix4(this.matrixWorld);const R=e.ray.origin.distanceTo(p);R<e.near||R>e.far||t.push({distance:R,point:f.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const aM=new Y,lM=new Y;class l8 extends dE{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)aM.fromBufferAttribute(t,r),lM.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+aM.distanceTo(lM);e.setAttribute("lineDistance",new Mo(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class u8 extends dE{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class EI extends Gs{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new St(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const uM=new Mt,n1=new x0,$p=new $s,Yp=new Y;class c8 extends vn{constructor(e=new Ys,t=new EI){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),$p.copy(i.boundingSphere),$p.applyMatrix4(r),$p.radius+=s,e.ray.intersectsSphere($p)===!1)return;uM.copy(r).invert(),n1.copy(e.ray).applyMatrix4(uM);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=i.index,f=i.attributes.position;if(u!==null){const p=Math.max(0,o.start),m=Math.min(u.count,o.start+o.count);for(let v=p,x=m;v<x;v++){const y=u.getX(v);Yp.fromBufferAttribute(f,y),cM(Yp,y,l,r,e,t,this)}}else{const p=Math.max(0,o.start),m=Math.min(f.count,o.start+o.count);for(let v=p,x=m;v<x;v++)Yp.fromBufferAttribute(f,v),cM(Yp,v,l,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function cM(n,e,t,i,r,s,o){const a=n1.distanceSqToPoint(n);if(a<t){const l=new Y;n1.closestPointToPoint(n,l),l.applyMatrix4(i);const u=r.ray.origin.distanceTo(l);if(u<r.near||u>r.far)return;s.push({distance:u,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class fE extends Gs{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new St(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=QP,this.normalScale=new Ut(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ko extends fE{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ut(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return wi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new St(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new St(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new St(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}function qp(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function h8(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function d8(n){function e(r,s){return n[r]-n[s]}const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(e),i}function hM(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r}function TI(n,e,t,i){let r=1,s=n[0];for(;s!==void 0&&s[i]===void 0;)s=n[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),t.push(o)),s=n[r++];while(s!==void 0)}class uf{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class f8 extends uf{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:oA,endingEnd:oA}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case aA:s=e,a=2*t-i;break;case lA:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(l===void 0)switch(this.getSettings_().endingEnd){case aA:o=e,l=2*i-t;break;case lA:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const u=(i-t)*.5,d=this.valueSize;this._weightPrev=u/(t-a),this._weightNext=u/(l-i),this._offsetPrev=s*d,this._offsetNext=o*d}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,d=this._offsetPrev,f=this._offsetNext,p=this._weightPrev,m=this._weightNext,v=(i-t)/(r-t),x=v*v,y=x*v,g=-p*y+2*p*x-p*v,T=(1+p)*y+(-1.5-2*p)*x+(-.5+p)*v+1,S=(-1-m)*y+(1.5+m)*x+.5*v,w=m*y-m*x;for(let M=0;M!==a;++M)s[M]=g*o[d+M]+T*o[u+M]+S*o[l+M]+w*o[f+M];return s}}class p8 extends uf{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,d=(i-t)/(r-t),f=1-d;for(let p=0;p!==a;++p)s[p]=o[u+p]*f+o[l+p]*d;return s}}class m8 extends uf{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class qs{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=qp(t,this.TimeBufferType),this.values=qp(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:qp(e.times,Array),values:qp(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new m8(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new p8(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new f8(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case jd:t=this.InterpolantFactoryMethodDiscrete;break;case kc:t=this.InterpolantFactoryMethodLinear;break;case Mv:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return jd;case this.InterpolantFactoryMethodLinear:return kc;case this.InterpolantFactoryMethodSmooth:return Mv}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&h8(r))for(let a=0,l=r.length;a!==l;++a){const u=r[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===Mv,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const u=e[a],d=e[a+1];if(u!==d&&(a!==1||u!==e[0]))if(r)l=!0;else{const f=a*i,p=f-i,m=f+i;for(let v=0;v!==i;++v){const x=t[f+v];if(x!==t[p+v]||x!==t[m+v]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const f=a*i,p=o*i;for(let m=0;m!==i;++m)t[p+m]=t[f+m]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,u=0;u!==i;++u)t[l+u]=t[a+u];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}qs.prototype.TimeBufferType=Float32Array;qs.prototype.ValueBufferType=Float32Array;qs.prototype.DefaultInterpolation=kc;class eh extends qs{}eh.prototype.ValueTypeName="bool";eh.prototype.ValueBufferType=Array;eh.prototype.DefaultInterpolation=jd;eh.prototype.InterpolantFactoryMethodLinear=void 0;eh.prototype.InterpolantFactoryMethodSmooth=void 0;class bI extends qs{}bI.prototype.ValueTypeName="color";class Hc extends qs{}Hc.prototype.ValueTypeName="number";class g8 extends uf{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let u=e*a;for(let d=u+a;u!==d;u+=4)za.slerpFlat(s,0,o,u-a,o,u,l);return s}}class jl extends qs{InterpolantFactoryMethodLinear(e){return new g8(this.times,this.values,this.getValueSize(),e)}}jl.prototype.ValueTypeName="quaternion";jl.prototype.DefaultInterpolation=kc;jl.prototype.InterpolantFactoryMethodSmooth=void 0;class th extends qs{}th.prototype.ValueTypeName="string";th.prototype.ValueBufferType=Array;th.prototype.DefaultInterpolation=jd;th.prototype.InterpolantFactoryMethodLinear=void 0;th.prototype.InterpolantFactoryMethodSmooth=void 0;class Vc extends qs{}Vc.prototype.ValueTypeName="vector";class _8{constructor(e,t=-1,i,r=SF){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=as(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(y8(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(qs.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],u=[];l.push((a+s-1)%s,a,(a+1)%s),u.push(0,1,0);const d=d8(l);l=hM(l,1,d),u=hM(u,1,d),!r&&l[0]===0&&(l.push(s),u.push(u[0])),o.push(new Hc(".morphTargetInfluences["+t[a].name+"]",l,u).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const u=e[a],d=u.name.match(s);if(d&&d.length>1){const f=d[1];let p=r[f];p||(r[f]=p=[]),p.push(u)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(f,p,m,v,x){if(m.length!==0){const y=[],g=[];TI(m,y,g,v),y.length!==0&&x.push(new f(p,y,g))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const u=e.hierarchy||[];for(let f=0;f<u.length;f++){const p=u[f].keys;if(!(!p||p.length===0))if(p[0].morphTargets){const m={};let v;for(v=0;v<p.length;v++)if(p[v].morphTargets)for(let x=0;x<p[v].morphTargets.length;x++)m[p[v].morphTargets[x]]=-1;for(const x in m){const y=[],g=[];for(let T=0;T!==p[v].morphTargets.length;++T){const S=p[v];y.push(S.time),g.push(S.morphTarget===x?1:0)}r.push(new Hc(".morphTargetInfluence["+x+"]",y,g))}l=m.length*o}else{const m=".bones["+t[f].name+"]";i(Vc,m+".position",p,"pos",r),i(jl,m+".quaternion",p,"rot",r),i(Vc,m+".scale",p,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function v8(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Hc;case"vector":case"vector2":case"vector3":case"vector4":return Vc;case"color":return bI;case"quaternion":return jl;case"bool":case"boolean":return eh;case"string":return th}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function y8(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=v8(n.type);if(n.times===void 0){const t=[],i=[];TI(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Wc={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class x8{constructor(e,t,i){const r=this;let s=!1,o=0,a=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(d){a++,s===!1&&r.onStart!==void 0&&r.onStart(d,o,a),s=!0},this.itemEnd=function(d){o++,r.onProgress!==void 0&&r.onProgress(d,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(d){r.onError!==void 0&&r.onError(d)},this.resolveURL=function(d){return l?l(d):d},this.setURLModifier=function(d){return l=d,this},this.addHandler=function(d,f){return u.push(d,f),this},this.removeHandler=function(d){const f=u.indexOf(d);return f!==-1&&u.splice(f,2),this},this.getHandler=function(d){for(let f=0,p=u.length;f<p;f+=2){const m=u[f],v=u[f+1];if(m.global&&(m.lastIndex=0),m.test(d))return v}return null}}}const S8=new x8;let nh=class{constructor(e){this.manager=e!==void 0?e:S8,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};nh.DEFAULT_MATERIAL_NAME="__DEFAULT";const lo={};class E8 extends Error{constructor(e,t){super(e),this.response=t}}class wI extends nh{constructor(e){super(e)}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Wc.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(lo[e]!==void 0){lo[e].push({onLoad:t,onProgress:i,onError:r});return}lo[e]=[],lo[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const d=lo[e],f=u.body.getReader(),p=u.headers.get("Content-Length")||u.headers.get("X-File-Size"),m=p?parseInt(p):0,v=m!==0;let x=0;const y=new ReadableStream({start(g){T();function T(){f.read().then(({done:S,value:w})=>{if(S)g.close();else{x+=w.byteLength;const M=new ProgressEvent("progress",{lengthComputable:v,loaded:x,total:m});for(let R=0,P=d.length;R<P;R++){const N=d[R];N.onProgress&&N.onProgress(M)}g.enqueue(w),T()}})}}});return new Response(y)}else throw new E8(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(d=>new DOMParser().parseFromString(d,a));case"json":return u.json();default:if(a===void 0)return u.text();{const f=/charset="?([^;"\s]*)"?/i.exec(a),p=f&&f[1]?f[1].toLowerCase():void 0,m=new TextDecoder(p);return u.arrayBuffer().then(v=>m.decode(v))}}}).then(u=>{Wc.add(e,u);const d=lo[e];delete lo[e];for(let f=0,p=d.length;f<p;f++){const m=d[f];m.onLoad&&m.onLoad(u)}}).catch(u=>{const d=lo[e];if(d===void 0)throw this.manager.itemError(e),u;delete lo[e];for(let f=0,p=d.length;f<p;f++){const m=d[f];m.onError&&m.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class T8 extends nh{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Wc.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=$d("img");function l(){d(),Wc.add(e,this),t&&t(this),s.manager.itemEnd(e)}function u(f){d(),r&&r(f),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class b8 extends nh{constructor(e){super(e)}load(e,t,i,r){const s=new hr,o=new T8(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},i,r),s}}class pE extends vn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new St(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}const ey=new Mt,dM=new Y,fM=new Y;class mE{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ut(512,512),this.map=null,this.mapPass=null,this.matrix=new Mt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new aE,this._frameExtents=new Ut(1,1),this._viewportCount=1,this._viewports=[new Zt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;dM.setFromMatrixPosition(e.matrixWorld),t.position.copy(dM),fM.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(fM),t.updateMatrixWorld(),ey.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ey),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(ey)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class w8 extends mE{constructor(){super(new Di(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=zc*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class A8 extends pE{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(vn.DEFAULT_UP),this.updateMatrix(),this.target=new vn,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new w8}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const pM=new Mt,kh=new Y,ty=new Y;class M8 extends mE{constructor(){super(new Di(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ut(4,2),this._viewportCount=6,this._viewports=[new Zt(2,1,1,1),new Zt(0,1,1,1),new Zt(3,1,1,1),new Zt(1,1,1,1),new Zt(3,0,1,1),new Zt(1,0,1,1)],this._cubeDirections=[new Y(1,0,0),new Y(-1,0,0),new Y(0,0,1),new Y(0,0,-1),new Y(0,1,0),new Y(0,-1,0)],this._cubeUps=[new Y(0,1,0),new Y(0,1,0),new Y(0,1,0),new Y(0,1,0),new Y(0,0,1),new Y(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),kh.setFromMatrixPosition(e.matrixWorld),i.position.copy(kh),ty.copy(i.position),ty.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(ty),i.updateMatrixWorld(),r.makeTranslation(-kh.x,-kh.y,-kh.z),pM.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(pM)}}class AI extends pE{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new M8}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class C8 extends mE{constructor(){super(new lE(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class R8 extends pE{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(vn.DEFAULT_UP),this.updateMatrix(),this.target=new vn,this.shadow=new C8}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class xd{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class P8 extends nh{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Wc.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){Wc.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}const gE="\\[\\]\\.:\\/",I8=new RegExp("["+gE+"]","g"),_E="[^"+gE+"]",L8="[^"+gE.replace("\\.","")+"]",D8=/((?:WC+[\/:])*)/.source.replace("WC",_E),N8=/(WCOD+)?/.source.replace("WCOD",L8),U8=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_E),F8=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_E),O8=new RegExp("^"+D8+N8+U8+F8+"$"),B8=["material","materials","bones","map"];class k8{constructor(e,t,i){const r=i||jt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class jt{constructor(e,t,i){this.path=t,this.parsedPath=i||jt.parseTrackName(t),this.node=jt.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new jt.Composite(e,t,i):new jt(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(I8,"")}static parseTrackName(e){const t=O8.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);B8.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const l=i(a.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=jt.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let u=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let d=0;d<e.length;d++)if(e[d].name===u){u=d;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const o=e[r];if(o===void 0){const u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}jt.Composite=k8;jt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};jt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};jt.prototype.GetterByBindingType=[jt.prototype._getValue_direct,jt.prototype._getValue_array,jt.prototype._getValue_arrayElement,jt.prototype._getValue_toArray];jt.prototype.SetterByBindingTypeAndVersioning=[[jt.prototype._setValue_direct,jt.prototype._setValue_direct_setNeedsUpdate,jt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[jt.prototype._setValue_array,jt.prototype._setValue_array_setNeedsUpdate,jt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[jt.prototype._setValue_arrayElement,jt.prototype._setValue_arrayElement_setNeedsUpdate,jt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[jt.prototype._setValue_fromArray,jt.prototype._setValue_fromArray_setNeedsUpdate,jt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:iE}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=iE);function mM(n,e){if(e===EF)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===Kx||e===KP){let t=n.getIndex();if(t===null){const o=[],a=n.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const i=t.count-2,r=[];if(e===Kx)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class z8 extends nh{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new X8(t)}),this.register(function(t){return new e6(t)}),this.register(function(t){return new t6(t)}),this.register(function(t){return new n6(t)}),this.register(function(t){return new $8(t)}),this.register(function(t){return new Y8(t)}),this.register(function(t){return new q8(t)}),this.register(function(t){return new K8(t)}),this.register(function(t){return new W8(t)}),this.register(function(t){return new Z8(t)}),this.register(function(t){return new j8(t)}),this.register(function(t){return new J8(t)}),this.register(function(t){return new Q8(t)}),this.register(function(t){return new H8(t)}),this.register(function(t){return new i6(t)}),this.register(function(t){return new r6(t)})}load(e,t,i,r){const s=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const u=xd.extractUrlBase(e);o=xd.resolveURL(u,this.path)}else o=xd.extractUrlBase(e);this.manager.itemStart(e);const a=function(u){r?r(u):console.error(u),s.manager.itemError(e),s.manager.itemEnd(e)},l=new wI(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(u){try{s.parse(u,o,function(d){t(d),s.manager.itemEnd(e)},a)}catch(d){a(d)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={},l=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===MI){try{o[It.KHR_BINARY_GLTF]=new s6(e)}catch(f){r&&r(f);return}s=JSON.parse(o[It.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const u=new v6(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let d=0;d<this.pluginCallbacks.length;d++){const f=this.pluginCallbacks[d](u);f.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[f.name]=f,o[f.name]=!0}if(s.extensionsUsed)for(let d=0;d<s.extensionsUsed.length;++d){const f=s.extensionsUsed[d],p=s.extensionsRequired||[];switch(f){case It.KHR_MATERIALS_UNLIT:o[f]=new V8;break;case It.KHR_DRACO_MESH_COMPRESSION:o[f]=new o6(s,this.dracoLoader);break;case It.KHR_TEXTURE_TRANSFORM:o[f]=new a6;break;case It.KHR_MESH_QUANTIZATION:o[f]=new l6;break;default:p.indexOf(f)>=0&&a[f]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}u.setExtensions(o),u.setPlugins(a),u.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function G8(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const It={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class H8{constructor(e){this.parser=e,this.name=It.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let u;const d=new St(16777215);l.color!==void 0&&d.setRGB(l.color[0],l.color[1],l.color[2],mi);const f=l.range!==void 0?l.range:0;switch(l.type){case"directional":u=new R8(d),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new AI(d),u.distance=f;break;case"spot":u=new A8(d),u.distance=f,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,u.angle=l.spot.outerConeAngle,u.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return u.position.set(0,0,0),u.decay=2,aa(u,l),l.intensity!==void 0&&(u.intensity=l.intensity),u.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(u),t.cache.add(i,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return i._getNodeRef(t.cache,a,l)})}}class V8{constructor(){this.name=It.KHR_MATERIALS_UNLIT}getMaterialType(){return bl}extendParams(e,t,i){const r=[];e.color=new St(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],mi),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(i.assignTexture(e,"map",s.baseColorTexture,Tn))}return Promise.all(r)}}class W8{constructor(e){this.parser=e,this.name=It.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class X8{constructor(e){this.parser=e,this.name=It.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:ko}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Ut(a,a)}return Promise.all(s)}}class j8{constructor(e){this.parser=e,this.name=It.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:ko}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class $8{constructor(e){this.parser=e,this.name=It.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:ko}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new St(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];if(o.sheenColorFactor!==void 0){const a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],mi)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Tn)),o.sheenRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class Y8{constructor(e){this.parser=e,this.name=It.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:ko}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class q8{constructor(e){this.parser=e,this.name=It.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:ko}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new St().setRGB(a[0],a[1],a[2],mi),Promise.all(s)}}class K8{constructor(e){this.parser=e,this.name=It.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:ko}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class Z8{constructor(e){this.parser=e,this.name=It.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:ko}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new St().setRGB(a[0],a[1],a[2],mi),o.specularColorTexture!==void 0&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,Tn)),Promise.all(s)}}class Q8{constructor(e){this.parser=e,this.name=It.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:ko}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&s.push(i.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}}class J8{constructor(e){this.parser=e,this.name=It.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:ko}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class e6{constructor(e){this.parser=e,this.name=It.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class t6{constructor(e){this.parser=e,this.name=It.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const u=i.options.manager.getHandler(a.uri);u!==null&&(l=u)}return this.detectSupport().then(function(u){if(u)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class n6{constructor(e){this.parser=e,this.name=It.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const u=i.options.manager.getHandler(a.uri);u!==null&&(l=u)}return this.detectSupport().then(function(u){if(u)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class i6{constructor(e){this.name=It.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=r.byteOffset||0,u=r.byteLength||0,d=r.count,f=r.byteStride,p=new Uint8Array(a,l,u);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(d,f,p,r.mode,r.filter).then(function(m){return m.buffer}):o.ready.then(function(){const m=new ArrayBuffer(d*f);return o.decodeGltfBuffer(new Uint8Array(m),d,f,p,r.mode,r.filter),m})})}else return null}}class r6{constructor(e){this.name=It.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const r=t.meshes[i.mesh];for(const u of r.primitives)if(u.mode!==Ar.TRIANGLES&&u.mode!==Ar.TRIANGLE_STRIP&&u.mode!==Ar.TRIANGLE_FAN&&u.mode!==void 0)return null;const o=i.extensions[this.name].attributes,a=[],l={};for(const u in o)a.push(this.parser.getDependency("accessor",o[u]).then(d=>(l[u]=d,l[u])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(u=>{const d=u.pop(),f=d.isGroup?d.children:[d],p=u[0].count,m=[];for(const v of f){const x=new Mt,y=new Y,g=new za,T=new Y(1,1,1),S=new a8(v.geometry,v.material,p);for(let w=0;w<p;w++)l.TRANSLATION&&y.fromBufferAttribute(l.TRANSLATION,w),l.ROTATION&&g.fromBufferAttribute(l.ROTATION,w),l.SCALE&&T.fromBufferAttribute(l.SCALE,w),S.setMatrixAt(w,x.compose(y,g,T));for(const w in l)if(w==="_COLOR_0"){const M=l[w];S.instanceColor=new t1(M.array,M.itemSize,M.normalized)}else w!=="TRANSLATION"&&w!=="ROTATION"&&w!=="SCALE"&&v.geometry.setAttribute(w,l[w]);vn.prototype.copy.call(S,v),this.parser.assignFinalMaterial(S),m.push(S)}return d.isGroup?(d.clear(),d.add(...m),d):m[0]}))}}const MI="glTF",zh=12,gM={JSON:1313821514,BIN:5130562};class s6{constructor(e){this.name=It.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,zh),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==MI)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-zh,s=new DataView(e,zh);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const l=s.getUint32(o,!0);if(o+=4,l===gM.JSON){const u=new Uint8Array(e,zh+o,a);this.content=i.decode(u)}else if(l===gM.BIN){const u=zh+o;this.body=e.slice(u,u+a)}o+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class o6{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=It.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},u={};for(const d in o){const f=i1[d]||d.toLowerCase();a[f]=o[d]}for(const d in e.attributes){const f=i1[d]||d.toLowerCase();if(o[d]!==void 0){const p=i.accessors[e.attributes[d]],m=xc[p.componentType];u[f]=m.name,l[f]=p.normalized===!0}}return t.getDependency("bufferView",s).then(function(d){return new Promise(function(f){r.decodeDracoFile(d,function(p){for(const m in p.attributes){const v=p.attributes[m],x=l[m];x!==void 0&&(v.normalized=x)}f(p)},a,u)})})}}class a6{constructor(){this.name=It.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class l6{constructor(){this.name=It.KHR_MESH_QUANTIZATION}}class CI extends uf{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,u=a*3,d=r-t,f=(i-t)/d,p=f*f,m=p*f,v=e*u,x=v-u,y=-2*m+3*p,g=m-p,T=1-y,S=g-p+f;for(let w=0;w!==a;w++){const M=o[x+w+a],R=o[x+w+l]*d,P=o[v+w+a],N=o[v+w]*d;s[w]=T*M+S*R+y*P+g*N}return s}}const u6=new za;class c6 extends CI{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return u6.fromArray(s).normalize().toArray(s),s}}const Ar={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},xc={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},_M={9728:ti,9729:Wi,9984:qx,9985:HP,9986:Hm,9987:Vl},vM={33071:Pr,33648:Mg,10497:Oc},ny={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},i1={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ta={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},h6={CUBICSPLINE:void 0,LINEAR:kc,STEP:jd},iy={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function d6(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new fE({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:No})),n.DefaultMaterial}function nl(n,e,t){for(const i in t.extensions)n[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function aa(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function f6(n,e,t){let i=!1,r=!1,s=!1;for(let u=0,d=e.length;u<d;u++){const f=e[u];if(f.POSITION!==void 0&&(i=!0),f.NORMAL!==void 0&&(r=!0),f.COLOR_0!==void 0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let u=0,d=e.length;u<d;u++){const f=e[u];if(i){const p=f.POSITION!==void 0?t.getDependency("accessor",f.POSITION):n.attributes.position;o.push(p)}if(r){const p=f.NORMAL!==void 0?t.getDependency("accessor",f.NORMAL):n.attributes.normal;a.push(p)}if(s){const p=f.COLOR_0!==void 0?t.getDependency("accessor",f.COLOR_0):n.attributes.color;l.push(p)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(u){const d=u[0],f=u[1],p=u[2];return i&&(n.morphAttributes.position=d),r&&(n.morphAttributes.normal=f),s&&(n.morphAttributes.color=p),n.morphTargetsRelative=!0,n})}function p6(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function m6(n){let e;const t=n.extensions&&n.extensions[It.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+ry(t.attributes):e=n.indices+":"+ry(n.attributes)+":"+n.mode,n.targets!==void 0)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+ry(n.targets[i]);return e}function ry(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function r1(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function g6(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const _6=new Mt;class v6{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new G8,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||r&&s<98?this.textureLoader=new b8(this.options.manager):this.textureLoader=new P8(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new wI(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};return nl(s,a,r),aa(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(i[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[u,d]of o.children.entries())s(d,a.children[u])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[It.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(xd.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const r=t.byteLength||0,s=t.byteOffset||0;return i.slice(s,s+r)})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const o=ny[r.type],a=xc[r.componentType],l=r.normalized===!0,u=new a(r.count*o);return Promise.resolve(new Fi(u,o,l))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=ny[r.type],u=xc[r.componentType],d=u.BYTES_PER_ELEMENT,f=d*l,p=r.byteOffset||0,m=r.bufferView!==void 0?i.bufferViews[r.bufferView].byteStride:void 0,v=r.normalized===!0;let x,y;if(m&&m!==f){const g=Math.floor(p/m),T="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+g+":"+r.count;let S=t.cache.get(T);S||(x=new u(a,g*m,r.count*m/d),S=new t8(x,m/d),t.cache.add(T,S)),y=new cE(S,l,p%m/d,v)}else a===null?x=new u(r.count*l):x=new u(a,p,r.count*l),y=new Fi(x,l,v);if(r.sparse!==void 0){const g=ny.SCALAR,T=xc[r.sparse.indices.componentType],S=r.sparse.indices.byteOffset||0,w=r.sparse.values.byteOffset||0,M=new T(o[1],S,r.sparse.count*g),R=new u(o[2],w,r.sparse.count*l);a!==null&&(y=new Fi(y.array.slice(),y.itemSize,y.normalized));for(let P=0,N=M.length;P<N;P++){const C=M[P];if(y.setX(C,R[P*l]),l>=2&&y.setY(C,R[P*l+1]),l>=3&&y.setZ(C,R[P*l+2]),l>=4&&y.setW(C,R[P*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return y})}loadTexture(e){const t=this.json,i=this.options,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=i.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const u=this.loadImageSource(t,i).then(function(d){d.flipY=!1,d.name=o.name||a.name||"",d.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(d.name=a.uri);const p=(s.samplers||{})[o.sampler]||{};return d.magFilter=_M[p.magFilter]||Wi,d.minFilter=_M[p.minFilter]||Vl,d.wrapS=vM[p.wrapS]||Oc,d.wrapT=vM[p.wrapT]||Oc,r.associations.set(d,{textures:e}),d}).catch(function(){return null});return this.textureCache[l]=u,u}loadImageSource(e,t){const i=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(f=>f.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",u=!1;if(o.bufferView!==void 0)l=i.getDependency("bufferView",o.bufferView).then(function(f){u=!0;const p=new Blob([f],{type:o.mimeType});return l=a.createObjectURL(p),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const d=Promise.resolve(l).then(function(f){return new Promise(function(p,m){let v=p;t.isImageBitmapLoader===!0&&(v=function(x){const y=new hr(x);y.needsUpdate=!0,p(y)}),t.load(xd.resolveURL(f,s.path),v,void 0,m)})}).then(function(f){return u===!0&&a.revokeObjectURL(l),f.userData.mimeType=o.mimeType||g6(o.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),f});return this.sourceCache[e]=d,d}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(o=o.clone(),o.channel=i.texCoord),s.extensions[It.KHR_TEXTURE_TRANSFORM]){const a=i.extensions!==void 0?i.extensions[It.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[It.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return r!==void 0&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new EI,Gs.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new SI,Gs.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return fE}loadMaterial(e){const t=this,i=this.json,r=this.extensions,s=i.materials[e];let o;const a={},l=s.extensions||{},u=[];if(l[It.KHR_MATERIALS_UNLIT]){const f=r[It.KHR_MATERIALS_UNLIT];o=f.getMaterialType(),u.push(f.extendParams(a,s,t))}else{const f=s.pbrMetallicRoughness||{};if(a.color=new St(1,1,1),a.opacity=1,Array.isArray(f.baseColorFactor)){const p=f.baseColorFactor;a.color.setRGB(p[0],p[1],p[2],mi),a.opacity=p[3]}f.baseColorTexture!==void 0&&u.push(t.assignTexture(a,"map",f.baseColorTexture,Tn)),a.metalness=f.metallicFactor!==void 0?f.metallicFactor:1,a.roughness=f.roughnessFactor!==void 0?f.roughnessFactor:1,f.metallicRoughnessTexture!==void 0&&(u.push(t.assignTexture(a,"metalnessMap",f.metallicRoughnessTexture)),u.push(t.assignTexture(a,"roughnessMap",f.metallicRoughnessTexture))),o=this._invokeOne(function(p){return p.getMaterialType&&p.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(p){return p.extendMaterialParams&&p.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=Us);const d=s.alphaMode||iy.OPAQUE;if(d===iy.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,d===iy.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==bl&&(u.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Ut(1,1),s.normalTexture.scale!==void 0)){const f=s.normalTexture.scale;a.normalScale.set(f,f)}if(s.occlusionTexture!==void 0&&o!==bl&&(u.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==bl){const f=s.emissiveFactor;a.emissive=new St().setRGB(f[0],f[1],f[2],mi)}return s.emissiveTexture!==void 0&&o!==bl&&u.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,Tn)),Promise.all(u).then(function(){const f=new o(a);return s.name&&(f.name=s.name),aa(f,s),t.associations.set(f,{materials:e}),s.extensions&&nl(r,f,s),f})}createUniqueName(e){const t=jt.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[It.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return yM(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const u=e[a],d=m6(u),f=r[d];if(f)o.push(f.promise);else{let p;u.extensions&&u.extensions[It.KHR_DRACO_MESH_COMPRESSION]?p=s(u):p=yM(new Ys,u,t),r[d]={primitive:u,promise:p},o.push(p)}}return Promise.all(o)}loadMesh(e){const t=this,i=this.json,r=this.extensions,s=i.meshes[e],o=s.primitives,a=[];for(let l=0,u=o.length;l<u;l++){const d=o[l].material===void 0?d6(this.cache):this.getDependency("material",o[l].material);a.push(d)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const u=l.slice(0,l.length-1),d=l[l.length-1],f=[];for(let m=0,v=d.length;m<v;m++){const x=d[m],y=o[m];let g;const T=u[m];if(y.mode===Ar.TRIANGLES||y.mode===Ar.TRIANGLE_STRIP||y.mode===Ar.TRIANGLE_FAN||y.mode===void 0)g=s.isSkinnedMesh===!0?new i8(x,T):new Nr(x,T),g.isSkinnedMesh===!0&&g.normalizeSkinWeights(),y.mode===Ar.TRIANGLE_STRIP?g.geometry=mM(g.geometry,KP):y.mode===Ar.TRIANGLE_FAN&&(g.geometry=mM(g.geometry,Kx));else if(y.mode===Ar.LINES)g=new l8(x,T);else if(y.mode===Ar.LINE_STRIP)g=new dE(x,T);else if(y.mode===Ar.LINE_LOOP)g=new u8(x,T);else if(y.mode===Ar.POINTS)g=new c8(x,T);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+y.mode);Object.keys(g.geometry.morphAttributes).length>0&&p6(g,s),g.name=t.createUniqueName(s.name||"mesh_"+e),aa(g,s),y.extensions&&nl(r,g,y),t.assignFinalMaterial(g),f.push(g)}for(let m=0,v=f.length;m<v;m++)t.associations.set(f[m],{meshes:e,primitives:m});if(f.length===1)return s.extensions&&nl(r,f[0],s),f[0];const p=new wl;s.extensions&&nl(r,p,s),t.associations.set(p,{meshes:e});for(let m=0,v=f.length;m<v;m++)p.add(f[m]);return p})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new Di($F.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):i.type==="orthographic"&&(t=new lE(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),aa(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let u=0,d=o.length;u<d;u++){const f=o[u];if(f){a.push(f);const p=new Mt;s!==null&&p.fromArray(s.array,u*16),l.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[u])}return new hE(a,l)})}loadAnimation(e){const t=this.json,i=this,r=t.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],l=[],u=[],d=[];for(let f=0,p=r.channels.length;f<p;f++){const m=r.channels[f],v=r.samplers[m.sampler],x=m.target,y=x.node,g=r.parameters!==void 0?r.parameters[v.input]:v.input,T=r.parameters!==void 0?r.parameters[v.output]:v.output;x.node!==void 0&&(o.push(this.getDependency("node",y)),a.push(this.getDependency("accessor",g)),l.push(this.getDependency("accessor",T)),u.push(v),d.push(x))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(u),Promise.all(d)]).then(function(f){const p=f[0],m=f[1],v=f[2],x=f[3],y=f[4],g=[];for(let T=0,S=p.length;T<S;T++){const w=p[T],M=m[T],R=v[T],P=x[T],N=y[T];if(w===void 0)continue;w.updateMatrix&&w.updateMatrix();const C=i._createAnimationTracks(w,M,R,P,N);if(C)for(let L=0;L<C.length;L++)g.push(C[L])}return new _8(s,void 0,g)})}createNodeMesh(e){const t=this.json,i=this,r=t.nodes[e];return r.mesh===void 0?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,u=r.weights.length;l<u;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const t=this.json,i=this,r=t.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let u=0,d=a.length;u<d;u++)o.push(i.getDependency("node",a[u]));const l=r.skin===void 0?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(u){const d=u[0],f=u[1],p=u[2];p!==null&&d.traverse(function(m){m.isSkinnedMesh&&m.bind(p,_6)});for(let m=0,v=f.length;m<v;m++)d.add(f[m]);return d})}_loadNodeShallow(e){const t=this.json,i=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(u){return u.createNodeMesh&&u.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(u){return r._getNodeRef(r.cameraCache,s.camera,u)})),r._invokeAll(function(u){return u.createNodeAttachment&&u.createNodeAttachment(e)}).forEach(function(u){a.push(u)}),this.nodeCache[e]=Promise.all(a).then(function(u){let d;if(s.isBone===!0?d=new xI:u.length>1?d=new wl:u.length===1?d=u[0]:d=new vn,d!==u[0])for(let f=0,p=u.length;f<p;f++)d.add(u[f]);if(s.name&&(d.userData.name=s.name,d.name=o),aa(d,s),s.extensions&&nl(i,d,s),s.matrix!==void 0){const f=new Mt;f.fromArray(s.matrix),d.applyMatrix4(f)}else s.translation!==void 0&&d.position.fromArray(s.translation),s.rotation!==void 0&&d.quaternion.fromArray(s.rotation),s.scale!==void 0&&d.scale.fromArray(s.scale);return r.associations.has(d)||r.associations.set(d,{}),r.associations.get(d).nodes=e,d}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new wl;i.name&&(s.name=r.createUniqueName(i.name)),aa(s,i),i.extensions&&nl(t,s,i);const o=i.nodes||[],a=[];for(let l=0,u=o.length;l<u;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let d=0,f=l.length;d<f;d++)s.add(l[d]);const u=d=>{const f=new Map;for(const[p,m]of r.associations)(p instanceof Gs||p instanceof hr)&&f.set(p,m);return d.traverse(p=>{const m=r.associations.get(p);m!=null&&f.set(p,m)}),f};return r.associations=u(s),s})}_createAnimationTracks(e,t,i,r,s){const o=[],a=e.name?e.name:e.uuid,l=[];ta[s.path]===ta.weights?e.traverse(function(p){p.morphTargetInfluences&&l.push(p.name?p.name:p.uuid)}):l.push(a);let u;switch(ta[s.path]){case ta.weights:u=Hc;break;case ta.rotation:u=jl;break;case ta.position:case ta.scale:u=Vc;break;default:switch(i.itemSize){case 1:u=Hc;break;case 2:case 3:default:u=Vc;break}break}const d=r.interpolation!==void 0?h6[r.interpolation]:kc,f=this._getArrayFromAccessor(i);for(let p=0,m=l.length;p<m;p++){const v=new u(l[p]+"."+ta[s.path],t.array,f,d);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(v),o.push(v)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=r1(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){const r=this instanceof jl?c6:CI;return new r(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function y6(n,e,t){const i=e.attributes,r=new Bo;if(i.POSITION!==void 0){const a=t.json.accessors[i.POSITION],l=a.min,u=a.max;if(l!==void 0&&u!==void 0){if(r.set(new Y(l[0],l[1],l[2]),new Y(u[0],u[1],u[2])),a.normalized){const d=r1(xc[a.componentType]);r.min.multiplyScalar(d),r.max.multiplyScalar(d)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new Y,l=new Y;for(let u=0,d=s.length;u<d;u++){const f=s[u];if(f.POSITION!==void 0){const p=t.json.accessors[f.POSITION],m=p.min,v=p.max;if(m!==void 0&&v!==void 0){if(l.setX(Math.max(Math.abs(m[0]),Math.abs(v[0]))),l.setY(Math.max(Math.abs(m[1]),Math.abs(v[1]))),l.setZ(Math.max(Math.abs(m[2]),Math.abs(v[2]))),p.normalized){const x=r1(xc[p.componentType]);l.multiplyScalar(x)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new $s;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}function yM(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in i){const a=i1[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(e.indices!==void 0&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return Xt.workingColorSpace!==mi&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Xt.workingColorSpace}" not supported.`),aa(n,e),y6(n,e,t),Promise.all(r).then(function(){return e.targets!==void 0?f6(n,e.targets,t):n})}const x6="/website-frontend/assets/computer-d55a0294.glb",S6=({setInScene:n})=>{const e=ge.useRef(null);var t=.8,i=.005;let r=50;const[s,o]=ge.useState(window.innerWidth),[a,l]=ge.useState(window.innerHeight);var u=xM(s);const[d,f]=ge.useState(u.scaleX),[p,m]=ge.useState(u.scaleY);var v=!1,x=!1;let y;const g=()=>{e.current&&(clearTimeout(y),y=setTimeout(()=>{o(window.innerWidth),l(window.innerHeight),u=xM(window.innerWidth),f(u.scaleX),m(u.scaleY)},1e3))};let T=!1,S=0,w=18;const M=`Hack the Burgh
2024
Press any key to begin...`;var R=document.getElementById("scene-begin-text"),P=document.getElementById("scene-logo-text");let N,C;const L=()=>{console.log("start typing"),R=document.getElementById("scene-begin-text"),P=document.getElementById("scene-logo-text"),P&&R?(clearTimeout(N),N=setTimeout(()=>{console.log("start typing timeout"),clearTimeout(C),P.innerHTML="",R.innerHTML="",Q()},1500)):setTimeout(L,500)},Q=()=>{v=!0,P&&R&&S<M.length?(S>w?R.innerHTML+=M.charAt(S):P.innerHTML+=M.charAt(S),S++,C=setTimeout(Q,r)):S==M.length&&(v=!1,x=!0,R==null||R.classList.add("active"))},W=()=>{R&&v==!1&&(R.style.opacity="0",R.style.animation="none"),v=!0,P&&w>-1?(P.innerHTML=P.innerHTML.slice(0,-1),w--):(v=!1,x=!1)};ge.useEffect(()=>{window.addEventListener("resize",g)},[]),ge.useEffect(()=>{z()},[s,a]);const z=()=>{if(e.current){const F=new e8,X=new Di(75,s/a,.1,1e3);X.position.setZ(t);const Z=new yI({canvas:e.current});Z.setPixelRatio(window.devicePixelRatio),Z.setSize(s,a);const $=new AI(16777215,1);$.position.set(0,.3,1),F.add($),Z.setClearColor(0,0);const O=()=>{v||(T=!0)};window.addEventListener("keypress",O),window.addEventListener("click",O),e.current.addEventListener("click",O),new z8().load(x6,G=>{G.scene.position.set(0,p*-.3,0),G.scene.scale.set(d,p,1),F.add(G.scene)},()=>{});const B=async()=>{t>.4&&X.position.setZ(t-=i),T?v||x?(W(),setTimeout(()=>{requestAnimationFrame(B),Z.render(F,X)},50)):($.intensity>.1&&($.intensity-=.5),Z.setClearColor(0,0),t>.15?X.position.setZ(t-=.005):(window.removeEventListener("keypress",O),n(!1)),requestAnimationFrame(B),Z.render(F,X)):(requestAnimationFrame(B),Z.render(F,X))};B(),L()}};return sn(ad,{children:[me("div",{className:"scene-background"}),sn("div",{className:"scene-logo",id:"scene-logo",children:[me("pre",{className:"scene-logo-text",id:"scene-logo-text"}),me("pre",{className:"scene-begin-text",id:"scene-begin-text"})]}),me("canvas",{ref:e}),";"]})},xM=(n,e)=>{let t=1.3,i=1;return n>1500||n>1200?(i=1.5,t=1.2):n>1e3?(i=1.3,t=1):n>600?(i=1.15,t=.9):n>450?(i=1,t=.7):(i=.9,t=.7),{scaleX:i,scaleY:t}},E6=()=>sn("svg",{viewBox:"419.4903 176.0819 43.4844 54.5078",xmlns:"http://www.w3.org/2000/svg",children:[me("defs",{children:me("clipPath",{id:"2be4ed1237",children:me("path",{d:"M 165.742188 154.476562 L 209.242188 154.476562 L 209.242188 209 L 165.742188 209 Z M 165.742188 154.476562 ","clip-rule":"nonzero"})})}),me("g",{"clip-path":"url(#2be4ed1237)",transform:"matrix(1, 0, 0, 1, 253.7442474365234, 21.60138702392578)",children:me("path",{fill:"#a6d0dd",d:"M 183.453125 187.34375 C 183.410156 187.308594 183.371094 187.277344 183.328125 187.246094 C 183.183594 187.425781 183.035156 187.609375 182.886719 187.789062 C 182.933594 187.824219 182.980469 187.863281 183.023438 187.898438 C 183.167969 187.710938 183.308594 187.527344 183.453125 187.34375 Z M 197.625 174.351562 C 197.578125 174.3125 197.535156 174.269531 197.488281 174.230469 C 197.351562 174.378906 197.210938 174.53125 197.070312 174.679688 C 197.117188 174.722656 197.160156 174.765625 197.207031 174.808594 C 197.347656 174.65625 197.484375 174.503906 197.625 174.351562 Z M 196.257812 176.023438 C 196.210938 175.984375 196.160156 175.941406 196.109375 175.898438 C 195.964844 176.070312 195.820312 176.242188 195.675781 176.414062 C 195.726562 176.457031 195.777344 176.5 195.832031 176.542969 C 195.972656 176.371094 196.117188 176.199219 196.257812 176.023438 Z M 195.132812 177.382812 C 195.070312 177.320312 195.007812 177.257812 194.941406 177.195312 C 194.757812 177.429688 194.570312 177.664062 194.382812 177.898438 C 194.4375 177.941406 194.488281 177.984375 194.539062 178.03125 C 194.738281 177.816406 194.9375 177.601562 195.132812 177.382812 Z M 177.597656 164.375 C 177.671875 164.359375 177.742188 164.339844 177.816406 164.324219 C 177.773438 164.132812 177.726562 163.945312 177.683594 163.757812 C 177.613281 163.773438 177.546875 163.789062 177.476562 163.804688 C 177.515625 163.996094 177.558594 164.183594 177.597656 164.375 Z M 180.632812 190.894531 C 181.238281 190.65625 181.613281 190.300781 181.546875 189.386719 C 181.140625 190.054688 180.886719 190.472656 180.632812 190.894531 Z M 197.890625 165.992188 C 197.953125 166.046875 198.019531 166.101562 198.082031 166.152344 C 198.4375 165.671875 198.789062 165.191406 199.144531 164.707031 C 199.046875 164.640625 198.945312 164.574219 198.84375 164.507812 C 198.527344 165.003906 198.207031 165.496094 197.890625 165.992188 Z M 181.023438 187.976562 C 180.9375 187.929688 180.851562 187.878906 180.765625 187.832031 C 180.160156 188.472656 179.652344 189.175781 179.496094 190.105469 C 180.003906 189.394531 180.511719 188.6875 181.023438 187.976562 Z M 183.917969 168.371094 C 184.441406 170.902344 185.152344 173.335938 186.777344 175.40625 C 185.824219 173.058594 184.871094 170.714844 183.917969 168.371094 Z M 190.574219 192.582031 C 190.675781 192.53125 190.777344 192.484375 190.882812 192.433594 C 190.097656 190.570312 189.316406 188.707031 188.53125 186.828125 C 187.742188 187.1875 187.925781 187.734375 188.125 188.121094 C 188.902344 189.625 189.75 191.097656 190.574219 192.582031 Z M 182.742188 181.351562 C 182.804688 180.0625 181.957031 179.195312 181.554688 178.175781 C 181.136719 177.109375 180.605469 176.089844 180.125 175.046875 C 179.625 173.964844 179.121094 172.886719 178.625 171.800781 C 178.179688 170.816406 177.746094 169.828125 177.304688 168.84375 C 177.714844 171.875 181.539062 180.4375 182.742188 181.351562 Z M 193.402344 192.652344 C 193.367188 192.425781 193.386719 192.167969 193.285156 191.96875 C 192.21875 189.839844 191.136719 187.722656 190.046875 185.601562 C 189.988281 185.480469 189.863281 185.394531 189.769531 185.292969 C 189.683594 185.339844 189.601562 185.390625 189.515625 185.4375 C 189.730469 185.894531 189.933594 186.355469 190.160156 186.808594 C 190.414062 187.3125 190.683594 187.816406 190.960938 188.308594 C 191.78125 189.75 192.613281 191.183594 193.4375 192.621094 C 194.148438 194.667969 195.304688 196.46875 196.496094 198.253906 C 195.914062 196.871094 195.222656 195.546875 194.488281 194.242188 C 194.175781 193.6875 193.765625 193.183594 193.402344 192.652344 Z M 203.441406 165.882812 C 203.75 165.648438 204.054688 165.414062 204.363281 165.179688 C 204.273438 165.101562 204.179688 165.019531 204.089844 164.941406 C 203.882812 165.265625 203.675781 165.589844 203.472656 165.914062 C 202.925781 166.457031 202.378906 167 201.832031 167.542969 C 202.570312 167.164062 203.300781 166.773438 203.441406 165.882812 Z M 191.402344 177.066406 C 191.886719 176.632812 192.414062 176.242188 192.839844 175.761719 C 196.464844 171.691406 200.046875 167.582031 203.695312 163.527344 C 204.878906 162.214844 206.199219 161.03125 207.484375 159.816406 C 207.808594 159.515625 208.234375 159.328125 208.601562 159.097656 C 209.214844 159.714844 208.875 160.097656 208.539062 160.4375 C 207.929688 161.046875 207.285156 161.621094 206.671875 162.222656 C 206.3125 162.574219 205.980469 162.949219 205.714844 163.398438 C 206.941406 163.117188 207.417969 161.511719 209.230469 161.605469 C 202.609375 168.820312 196.839844 176.332031 190.75 183.808594 C 192.394531 187.09375 194.011719 190.335938 195.636719 193.574219 C 196.28125 194.855469 197.078125 196.074219 197.589844 197.402344 C 198.285156 199.214844 198.773438 201.109375 199.351562 202.964844 C 198.65625 203.175781 198.65625 203.175781 197.101562 201.210938 C 196.871094 201.769531 196.726562 202.582031 195.875 201.828125 C 195.890625 203.144531 197.140625 204.042969 196.746094 205.6875 C 195.980469 205.003906 195.433594 204.511719 194.886719 204.019531 C 194.820312 204.066406 194.753906 204.113281 194.6875 204.160156 C 194.828125 204.671875 194.964844 205.183594 195.167969 205.933594 C 194.75 205.757812 194.429688 205.726562 194.335938 205.5625 C 194.097656 205.15625 193.945312 204.695312 193.785156 204.246094 C 192.148438 199.617188 189.613281 195.445312 187.164062 191.230469 C 186.855469 190.699219 186.542969 190.167969 186.121094 189.4375 C 185.683594 190.011719 185.320312 190.480469 184.964844 190.953125 C 182.023438 194.894531 179.09375 198.847656 176.128906 202.773438 C 174.71875 204.644531 173.246094 206.464844 171.777344 208.292969 C 171.558594 208.566406 171.214844 208.738281 170.886719 208.988281 C 170.113281 208.007812 171.289062 207.488281 171.25 206.558594 C 170.210938 207.222656 169.996094 208.910156 168.308594 208.625 C 168.621094 207.992188 168.882812 207.460938 169.160156 206.902344 C 168.621094 206.878906 168.140625 206.859375 167.585938 206.832031 C 167.117188 207.164062 167 208.167969 165.746094 207.996094 C 166.261719 207.234375 166.652344 206.664062 167.039062 206.089844 C 167.375 205.601562 167.609375 205.195312 167.566406 204.464844 C 167.523438 203.65625 168.046875 202.738281 168.519531 201.988281 C 169.765625 200.015625 171.117188 198.101562 172.433594 196.167969 C 174.878906 192.585938 177.324219 189.007812 179.78125 185.433594 C 180.347656 184.605469 180.921875 183.777344 181.546875 182.996094 C 182.003906 182.429688 181.988281 181.9375 181.683594 181.296875 C 180.4375 178.664062 179.164062 176.039062 178.054688 173.347656 C 177.144531 171.148438 176.441406 168.863281 175.675781 166.605469 C 175.429688 165.890625 175.453125 165.1875 176.160156 164.710938 C 175.96875 164.023438 175.871094 163.34375 175.59375 162.75 C 175.058594 161.585938 175.328125 160.722656 176.378906 160.039062 C 177.335938 160 176.917969 161.003906 177.410156 161.421875 C 177.675781 161.359375 177.980469 161.285156 178.417969 161.175781 C 179.144531 163.273438 179.859375 165.351562 180.574219 167.421875 C 180.675781 167.394531 180.78125 167.367188 180.882812 167.339844 C 180.859375 167.089844 180.882812 166.824219 180.804688 166.59375 C 180.433594 165.457031 179.992188 164.34375 179.664062 163.199219 C 179.511719 162.675781 179.625 162.082031 179.503906 161.542969 C 179.304688 160.671875 179.042969 159.8125 178.742188 158.96875 C 178.554688 158.429688 178.25 157.933594 178.847656 157.269531 C 179.578125 158.027344 179.527344 159.039062 179.855469 159.875 C 180.203125 160.761719 180.472656 161.683594 180.78125 162.585938 C 181.085938 163.480469 181.402344 164.367188 181.976562 165.183594 C 181.757812 164.375 181.523438 163.570312 181.324219 162.757812 C 181.140625 161.996094 180.550781 161.207031 181.519531 160.242188 C 182.578125 162.796875 183.359375 165.273438 184.308594 167.683594 C 185.253906 170.078125 186.203125 172.46875 187.246094 175.105469 C 187.796875 174.476562 188.222656 174.042969 188.585938 173.566406 C 192.910156 167.894531 197.4375 162.390625 202.28125 157.160156 C 203.121094 156.257812 204.160156 155.539062 205.128906 154.765625 C 205.320312 154.613281 205.617188 154.597656 205.992188 154.480469 C 205.996094 155.882812 204.609375 156.371094 204.386719 157.488281 C 204.980469 158.1875 205.730469 158.433594 206.75 158.148438 C 206.664062 158.492188 206.675781 158.703125 206.574219 158.8125 C 205.285156 160.214844 203.933594 161.566406 202.683594 163.007812 C 201.242188 164.664062 199.871094 166.382812 198.492188 168.09375 C 196.207031 170.917969 193.9375 173.757812 191.671875 176.59375 C 191.558594 176.738281 191.511719 176.929688 191.4375 177.101562 C 191.234375 177.316406 191.027344 177.53125 190.824219 177.75 C 190.898438 177.800781 190.972656 177.855469 191.046875 177.910156 C 191.164062 177.628906 191.285156 177.347656 191.402344 177.066406 ","fill-opacity":"1","fill-rule":"nonzero"})})]}),T6=({page:n,setPage:e,setInScene:t})=>sn("nav",{children:[[{title:"Home",href:"/home"},{title:"Past Projects",href:"/past-projects"},{title:"Information",href:"/information"}].map((r,s)=>me("a",{onClick:()=>e(r.title),className:`link ${n==r.title?"active":""}`,children:r.title},s)),me("div",{className:"spacer"}),me("div",{onClick:()=>t(!0),className:"logo",children:me(E6,{})})]}),b6=n=>me("div",{className:"border",children:me("div",{className:"background",children:n.children})});var T0={exports:{}},Zl=(n=>(n[n.WEBGL_LEGACY=0]="WEBGL_LEGACY",n[n.WEBGL=1]="WEBGL",n[n.WEBGL2=2]="WEBGL2",n))(Zl||{}),RI=(n=>(n[n.UNKNOWN=0]="UNKNOWN",n[n.WEBGL=1]="WEBGL",n[n.CANVAS=2]="CANVAS",n))(RI||{}),s1=(n=>(n[n.COLOR=16384]="COLOR",n[n.DEPTH=256]="DEPTH",n[n.STENCIL=1024]="STENCIL",n))(s1||{}),rt=(n=>(n[n.NORMAL=0]="NORMAL",n[n.ADD=1]="ADD",n[n.MULTIPLY=2]="MULTIPLY",n[n.SCREEN=3]="SCREEN",n[n.OVERLAY=4]="OVERLAY",n[n.DARKEN=5]="DARKEN",n[n.LIGHTEN=6]="LIGHTEN",n[n.COLOR_DODGE=7]="COLOR_DODGE",n[n.COLOR_BURN=8]="COLOR_BURN",n[n.HARD_LIGHT=9]="HARD_LIGHT",n[n.SOFT_LIGHT=10]="SOFT_LIGHT",n[n.DIFFERENCE=11]="DIFFERENCE",n[n.EXCLUSION=12]="EXCLUSION",n[n.HUE=13]="HUE",n[n.SATURATION=14]="SATURATION",n[n.COLOR=15]="COLOR",n[n.LUMINOSITY=16]="LUMINOSITY",n[n.NORMAL_NPM=17]="NORMAL_NPM",n[n.ADD_NPM=18]="ADD_NPM",n[n.SCREEN_NPM=19]="SCREEN_NPM",n[n.NONE=20]="NONE",n[n.SRC_OVER=0]="SRC_OVER",n[n.SRC_IN=21]="SRC_IN",n[n.SRC_OUT=22]="SRC_OUT",n[n.SRC_ATOP=23]="SRC_ATOP",n[n.DST_OVER=24]="DST_OVER",n[n.DST_IN=25]="DST_IN",n[n.DST_OUT=26]="DST_OUT",n[n.DST_ATOP=27]="DST_ATOP",n[n.ERASE=26]="ERASE",n[n.SUBTRACT=28]="SUBTRACT",n[n.XOR=29]="XOR",n))(rt||{}),is=(n=>(n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN",n))(is||{}),Ee=(n=>(n[n.RGBA=6408]="RGBA",n[n.RGB=6407]="RGB",n[n.RG=33319]="RG",n[n.RED=6403]="RED",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.ALPHA=6406]="ALPHA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL",n))(Ee||{}),Sc=(n=>(n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",n))(Sc||{}),et=(n=>(n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.BYTE=5120]="BYTE",n[n.SHORT=5122]="SHORT",n[n.INT=5124]="INT",n[n.FLOAT=5126]="FLOAT",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.HALF_FLOAT=36193]="HALF_FLOAT",n))(et||{}),Ue=(n=>(n[n.FLOAT=0]="FLOAT",n[n.INT=1]="INT",n[n.UINT=2]="UINT",n))(Ue||{}),To=(n=>(n[n.NEAREST=0]="NEAREST",n[n.LINEAR=1]="LINEAR",n))(To||{}),Co=(n=>(n[n.CLAMP=33071]="CLAMP",n[n.REPEAT=10497]="REPEAT",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",n))(Co||{}),Ws=(n=>(n[n.OFF=0]="OFF",n[n.POW2=1]="POW2",n[n.ON=2]="ON",n[n.ON_MANUAL=3]="ON_MANUAL",n))(Ws||{}),ji=(n=>(n[n.NPM=0]="NPM",n[n.UNPACK=1]="UNPACK",n[n.PMA=2]="PMA",n[n.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",n[n.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",n[n.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",n))(ji||{}),Ls=(n=>(n[n.NO=0]="NO",n[n.YES=1]="YES",n[n.AUTO=2]="AUTO",n[n.BLEND=0]="BLEND",n[n.CLEAR=1]="CLEAR",n[n.BLIT=2]="BLIT",n))(Ls||{}),vE=(n=>(n[n.AUTO=0]="AUTO",n[n.MANUAL=1]="MANUAL",n))(vE||{}),Ur=(n=>(n.LOW="lowp",n.MEDIUM="mediump",n.HIGH="highp",n))(Ur||{}),Bn=(n=>(n[n.NONE=0]="NONE",n[n.SCISSOR=1]="SCISSOR",n[n.STENCIL=2]="STENCIL",n[n.SPRITE=3]="SPRITE",n[n.COLOR=4]="COLOR",n))(Bn||{}),Dn=(n=>(n[n.NONE=0]="NONE",n[n.LOW=2]="LOW",n[n.MEDIUM=4]="MEDIUM",n[n.HIGH=8]="HIGH",n))(Dn||{}),Hs=(n=>(n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",n))(Hs||{});const w6={createCanvas:(n,e)=>{const t=document.createElement("canvas");return t.width=n,t.height=e,t},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(n,e)=>fetch(n,e),parseXML:n=>new DOMParser().parseFromString(n,"text/xml")},Fe={ADAPTER:w6,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var sy=/iPhone/i,SM=/iPod/i,EM=/iPad/i,TM=/\biOS-universal(?:.+)Mac\b/i,oy=/\bAndroid(?:.+)Mobile\b/i,bM=/Android/i,Fu=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Kp=/Silk/i,uo=/Windows Phone/i,wM=/\bWindows(?:.+)ARM\b/i,AM=/BlackBerry/i,MM=/BB10/i,CM=/Opera Mini/i,RM=/\b(CriOS|Chrome)(?:.+)Mobile/i,PM=/Mobile(?:.+)Firefox\b/i,IM=function(n){return typeof n<"u"&&n.platform==="MacIntel"&&typeof n.maxTouchPoints=="number"&&n.maxTouchPoints>1&&typeof MSStream>"u"};function A6(n){return function(e){return e.test(n)}}function LM(n){var e={userAgent:"",platform:"",maxTouchPoints:0};!n&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof n=="string"?e.userAgent=n:n&&n.userAgent&&(e={userAgent:n.userAgent,platform:n.platform,maxTouchPoints:n.maxTouchPoints||0});var t=e.userAgent,i=t.split("[FBAN");typeof i[1]<"u"&&(t=i[0]),i=t.split("Twitter"),typeof i[1]<"u"&&(t=i[0]);var r=A6(t),s={apple:{phone:r(sy)&&!r(uo),ipod:r(SM),tablet:!r(sy)&&(r(EM)||IM(e))&&!r(uo),universal:r(TM),device:(r(sy)||r(SM)||r(EM)||r(TM)||IM(e))&&!r(uo)},amazon:{phone:r(Fu),tablet:!r(Fu)&&r(Kp),device:r(Fu)||r(Kp)},android:{phone:!r(uo)&&r(Fu)||!r(uo)&&r(oy),tablet:!r(uo)&&!r(Fu)&&!r(oy)&&(r(Kp)||r(bM)),device:!r(uo)&&(r(Fu)||r(Kp)||r(oy)||r(bM))||r(/\bokhttp\b/i)},windows:{phone:r(uo),tablet:r(wM),device:r(uo)||r(wM)},other:{blackberry:r(AM),blackberry10:r(MM),opera:r(CM),firefox:r(PM),chrome:r(RM),device:r(AM)||r(MM)||r(CM)||r(PM)||r(RM)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const M6=LM.default??LM,bo=M6(globalThis.navigator);Fe.RETINA_PREFIX=/@([0-9\.]+)x/;Fe.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var PI={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function r(l,u,d){this.fn=l,this.context=u,this.once=d||!1}function s(l,u,d,f,p){if(typeof d!="function")throw new TypeError("The listener must be a function");var m=new r(d,f||l,p),v=t?t+u:u;return l._events[v]?l._events[v].fn?l._events[v]=[l._events[v],m]:l._events[v].push(m):(l._events[v]=m,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new i:delete l._events[u]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)e.call(d,f)&&u.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},a.prototype.listeners=function(u){var d=t?t+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var p=0,m=f.length,v=new Array(m);p<m;p++)v[p]=f[p].fn;return v},a.prototype.listenerCount=function(u){var d=t?t+u:u,f=this._events[d];return f?f.fn?1:f.length:0},a.prototype.emit=function(u,d,f,p,m,v){var x=t?t+u:u;if(!this._events[x])return!1;var y=this._events[x],g=arguments.length,T,S;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),g){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,f),!0;case 4:return y.fn.call(y.context,d,f,p),!0;case 5:return y.fn.call(y.context,d,f,p,m),!0;case 6:return y.fn.call(y.context,d,f,p,m,v),!0}for(S=1,T=new Array(g-1);S<g;S++)T[S-1]=arguments[S];y.fn.apply(y.context,T)}else{var w=y.length,M;for(S=0;S<w;S++)switch(y[S].once&&this.removeListener(u,y[S].fn,void 0,!0),g){case 1:y[S].fn.call(y[S].context);break;case 2:y[S].fn.call(y[S].context,d);break;case 3:y[S].fn.call(y[S].context,d,f);break;case 4:y[S].fn.call(y[S].context,d,f,p);break;default:if(!T)for(M=1,T=new Array(g-1);M<g;M++)T[M-1]=arguments[M];y[S].fn.apply(y[S].context,T)}}return!0},a.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},a.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},a.prototype.removeListener=function(u,d,f,p){var m=t?t+u:u;if(!this._events[m])return this;if(!d)return o(this,m),this;var v=this._events[m];if(v.fn)v.fn===d&&(!p||v.once)&&(!f||v.context===f)&&o(this,m);else{for(var x=0,y=[],g=v.length;x<g;x++)(v[x].fn!==d||p&&!v[x].once||f&&v[x].context!==f)&&y.push(v[x]);y.length?this._events[m]=y.length===1?y[0]:y:o(this,m)}return this},a.prototype.removeAllListeners=function(u){var d;return u?(d=t?t+u:u,this._events[d]&&o(this,d)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,n.exports=a})(PI);var C6=PI.exports;const cf=t0(C6);var yE={exports:{}};yE.exports=b0;yE.exports.default=b0;function b0(n,e,t){t=t||2;var i=e&&e.length,r=i?e[0]*t:n.length,s=II(n,0,r,t,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,u,d,f,p,m;if(i&&(s=D6(n,e,s,t)),n.length>80*t){a=u=n[0],l=d=n[1];for(var v=t;v<r;v+=t)f=n[v],p=n[v+1],f<a&&(a=f),p<l&&(l=p),f>u&&(u=f),p>d&&(d=p);m=Math.max(u-a,d-l),m=m!==0?32767/m:0}return Yd(s,o,t,a,l,m,0),o}function II(n,e,t,i,r){var s,o;if(r===l1(n,e,t,i)>0)for(s=e;s<t;s+=i)o=DM(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=DM(s,n[s],n[s+1],o);return o&&w0(o,o.next)&&(Kd(o),o=o.next),o}function $l(n,e){if(!n)return n;e||(e=n);var t=n,i;do if(i=!1,!t.steiner&&(w0(t,t.next)||gn(t.prev,t,t.next)===0)){if(Kd(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Yd(n,e,t,i,r,s,o){if(n){!o&&s&&B6(n,i,r,s);for(var a=n,l,u;n.prev!==n.next;){if(l=n.prev,u=n.next,s?P6(n,i,r,s):R6(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(u.i/t|0),Kd(n),n=u.next,a=u.next;continue}if(n=u,n===a){o?o===1?(n=I6($l(n),e,t),Yd(n,e,t,i,r,s,2)):o===2&&L6(n,e,t,i,r,s):Yd($l(n),e,t,i,r,s,1);break}}}}function R6(n){var e=n.prev,t=n,i=n.next;if(gn(e,t,i)>=0)return!1;for(var r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,u=i.y,d=r<s?r<o?r:o:s<o?s:o,f=a<l?a<u?a:u:l<u?l:u,p=r>s?r>o?r:o:s>o?s:o,m=a>l?a>u?a:u:l>u?l:u,v=i.next;v!==e;){if(v.x>=d&&v.x<=p&&v.y>=f&&v.y<=m&&uc(r,a,s,l,o,u,v.x,v.y)&&gn(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function P6(n,e,t,i){var r=n.prev,s=n,o=n.next;if(gn(r,s,o)>=0)return!1;for(var a=r.x,l=s.x,u=o.x,d=r.y,f=s.y,p=o.y,m=a<l?a<u?a:u:l<u?l:u,v=d<f?d<p?d:p:f<p?f:p,x=a>l?a>u?a:u:l>u?l:u,y=d>f?d>p?d:p:f>p?f:p,g=o1(m,v,e,t,i),T=o1(x,y,e,t,i),S=n.prevZ,w=n.nextZ;S&&S.z>=g&&w&&w.z<=T;){if(S.x>=m&&S.x<=x&&S.y>=v&&S.y<=y&&S!==r&&S!==o&&uc(a,d,l,f,u,p,S.x,S.y)&&gn(S.prev,S,S.next)>=0||(S=S.prevZ,w.x>=m&&w.x<=x&&w.y>=v&&w.y<=y&&w!==r&&w!==o&&uc(a,d,l,f,u,p,w.x,w.y)&&gn(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;S&&S.z>=g;){if(S.x>=m&&S.x<=x&&S.y>=v&&S.y<=y&&S!==r&&S!==o&&uc(a,d,l,f,u,p,S.x,S.y)&&gn(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;w&&w.z<=T;){if(w.x>=m&&w.x<=x&&w.y>=v&&w.y<=y&&w!==r&&w!==o&&uc(a,d,l,f,u,p,w.x,w.y)&&gn(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function I6(n,e,t){var i=n;do{var r=i.prev,s=i.next.next;!w0(r,s)&&LI(r,i,i.next,s)&&qd(r,s)&&qd(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),Kd(i),Kd(i.next),i=n=s),i=i.next}while(i!==n);return $l(i)}function L6(n,e,t,i,r,s){var o=n;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&G6(o,a)){var l=DI(o,a);o=$l(o,o.next),l=$l(l,l.next),Yd(o,e,t,i,r,s,0),Yd(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function D6(n,e,t,i){var r=[],s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,u=II(n,a,l,i,!1),u===u.next&&(u.steiner=!0),r.push(z6(u));for(r.sort(N6),s=0;s<r.length;s++)t=U6(r[s],t);return t}function N6(n,e){return n.x-e.x}function U6(n,e){var t=F6(n,e);if(!t)return e;var i=DI(t,n);return $l(i,i.next),$l(t,t.next)}function F6(n,e){var t=e,i=n.x,r=n.y,s=-1/0,o;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){var a=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(a<=i&&a>s&&(s=a,o=t.x<t.next.x?t:t.next,a===i))return o}t=t.next}while(t!==e);if(!o)return null;var l=o,u=o.x,d=o.y,f=1/0,p;t=o;do i>=t.x&&t.x>=u&&i!==t.x&&uc(r<d?i:s,r,u,d,r<d?s:i,r,t.x,t.y)&&(p=Math.abs(r-t.y)/(i-t.x),qd(t,n)&&(p<f||p===f&&(t.x>o.x||t.x===o.x&&O6(o,t)))&&(o=t,f=p)),t=t.next;while(t!==l);return o}function O6(n,e){return gn(n.prev,n,e.prev)<0&&gn(e.next,n,n.next)<0}function B6(n,e,t,i){var r=n;do r.z===0&&(r.z=o1(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,k6(r)}function k6(n){var e,t,i,r,s,o,a,l,u=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<u&&(a++,i=i.nextZ,!!i);e++);for(l=u;a>0||l>0&&i;)a!==0&&(l===0||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,u*=2}while(o>1);return n}function o1(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function z6(n){var e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function uc(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function G6(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!H6(n,e)&&(qd(n,e)&&qd(e,n)&&V6(n,e)&&(gn(n.prev,n,e.prev)||gn(n,e.prev,e))||w0(n,e)&&gn(n.prev,n,n.next)>0&&gn(e.prev,e,e.next)>0)}function gn(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function w0(n,e){return n.x===e.x&&n.y===e.y}function LI(n,e,t,i){var r=Qp(gn(n,e,t)),s=Qp(gn(n,e,i)),o=Qp(gn(t,i,n)),a=Qp(gn(t,i,e));return!!(r!==s&&o!==a||r===0&&Zp(n,t,e)||s===0&&Zp(n,i,e)||o===0&&Zp(t,n,i)||a===0&&Zp(t,e,i))}function Zp(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Qp(n){return n>0?1:n<0?-1:0}function H6(n,e){var t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&LI(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function qd(n,e){return gn(n.prev,n,n.next)<0?gn(n,e,n.next)>=0&&gn(n,n.prev,e)>=0:gn(n,e,n.prev)<0||gn(n,n.next,e)<0}function V6(n,e){var t=n,i=!1,r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function DI(n,e){var t=new a1(n.i,n.x,n.y),i=new a1(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function DM(n,e,t,i){var r=new a1(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Kd(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function a1(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}b0.deviation=function(n,e,t,i){var r=e&&e.length,s=r?e[0]*t:n.length,o=Math.abs(l1(n,0,s,t));if(r)for(var a=0,l=e.length;a<l;a++){var u=e[a]*t,d=a<l-1?e[a+1]*t:n.length;o-=Math.abs(l1(n,u,d,t))}var f=0;for(a=0;a<i.length;a+=3){var p=i[a]*t,m=i[a+1]*t,v=i[a+2]*t;f+=Math.abs((n[p]-n[v])*(n[m+1]-n[p+1])-(n[p]-n[m])*(n[v+1]-n[p+1]))}return o===0&&f===0?0:Math.abs((f-o)/o)};function l1(n,e,t,i){for(var r=0,s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}b0.flatten=function(n){for(var e=n[0][0].length,t={vertices:[],holes:[],dimensions:e},i=0,r=0;r<n.length;r++){for(var s=0;s<n[r].length;s++)for(var o=0;o<e;o++)t.vertices.push(n[r][s][o]);r>0&&(i+=n[r-1].length,t.holes.push(i))}return t};var W6=yE.exports;const X6=t0(W6);var Dg={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */Dg.exports;(function(n,e){(function(t){var i=e&&!e.nodeType&&e,r=n&&!n.nodeType&&n,s=typeof Rm=="object"&&Rm;(s.global===s||s.window===s||s.self===s)&&(t=s);var o,a=2147483647,l=36,u=1,d=26,f=38,p=700,m=72,v=128,x="-",y=/^xn--/,g=/[^\x20-\x7E]/,T=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=l-u,M=Math.floor,R=String.fromCharCode,P;function N(B){throw new RangeError(S[B])}function C(B,G){for(var ne=B.length,ee=[];ne--;)ee[ne]=G(B[ne]);return ee}function L(B,G){var ne=B.split("@"),ee="";ne.length>1&&(ee=ne[0]+"@",B=ne[1]),B=B.replace(T,".");var ie=B.split("."),pe=C(ie,G).join(".");return ee+pe}function Q(B){for(var G=[],ne=0,ee=B.length,ie,pe;ne<ee;)ie=B.charCodeAt(ne++),ie>=55296&&ie<=56319&&ne<ee?(pe=B.charCodeAt(ne++),(pe&64512)==56320?G.push(((ie&1023)<<10)+(pe&1023)+65536):(G.push(ie),ne--)):G.push(ie);return G}function W(B){return C(B,function(G){var ne="";return G>65535&&(G-=65536,ne+=R(G>>>10&1023|55296),G=56320|G&1023),ne+=R(G),ne}).join("")}function z(B){return B-48<10?B-22:B-65<26?B-65:B-97<26?B-97:l}function F(B,G){return B+22+75*(B<26)-((G!=0)<<5)}function X(B,G,ne){var ee=0;for(B=ne?M(B/p):B>>1,B+=M(B/G);B>w*d>>1;ee+=l)B=M(B/w);return M(ee+(w+1)*B/(B+f))}function Z(B){var G=[],ne=B.length,ee,ie=0,pe=v,ve=m,Me,Ze,Ye,ze,Ie,q,ct,Xe,st;for(Me=B.lastIndexOf(x),Me<0&&(Me=0),Ze=0;Ze<Me;++Ze)B.charCodeAt(Ze)>=128&&N("not-basic"),G.push(B.charCodeAt(Ze));for(Ye=Me>0?Me+1:0;Ye<ne;){for(ze=ie,Ie=1,q=l;Ye>=ne&&N("invalid-input"),ct=z(B.charCodeAt(Ye++)),(ct>=l||ct>M((a-ie)/Ie))&&N("overflow"),ie+=ct*Ie,Xe=q<=ve?u:q>=ve+d?d:q-ve,!(ct<Xe);q+=l)st=l-Xe,Ie>M(a/st)&&N("overflow"),Ie*=st;ee=G.length+1,ve=X(ie-ze,ee,ze==0),M(ie/ee)>a-pe&&N("overflow"),pe+=M(ie/ee),ie%=ee,G.splice(ie++,0,pe)}return W(G)}function $(B){var G,ne,ee,ie,pe,ve,Me,Ze,Ye,ze,Ie,q=[],ct,Xe,st,nt;for(B=Q(B),ct=B.length,G=v,ne=0,pe=m,ve=0;ve<ct;++ve)Ie=B[ve],Ie<128&&q.push(R(Ie));for(ee=ie=q.length,ie&&q.push(x);ee<ct;){for(Me=a,ve=0;ve<ct;++ve)Ie=B[ve],Ie>=G&&Ie<Me&&(Me=Ie);for(Xe=ee+1,Me-G>M((a-ne)/Xe)&&N("overflow"),ne+=(Me-G)*Xe,G=Me,ve=0;ve<ct;++ve)if(Ie=B[ve],Ie<G&&++ne>a&&N("overflow"),Ie==G){for(Ze=ne,Ye=l;ze=Ye<=pe?u:Ye>=pe+d?d:Ye-pe,!(Ze<ze);Ye+=l)nt=Ze-ze,st=l-ze,q.push(R(F(ze+nt%st,0))),Ze=M(nt/st);q.push(R(F(Ze,0))),pe=X(ne,Xe,ee==ie),ne=0,++ee}++ne,++G}return q.join("")}function O(B){return L(B,function(G){return y.test(G)?Z(G.slice(4).toLowerCase()):G})}function H(B){return L(B,function(G){return g.test(G)?"xn--"+$(G):G})}if(o={version:"1.4.1",ucs2:{decode:Q,encode:W},decode:Z,encode:$,toASCII:H,toUnicode:O},i&&r)if(n.exports==i)r.exports=o;else for(P in o)o.hasOwnProperty(P)&&(i[P]=o[P]);else t.punycode=o})(Rm)})(Dg,Dg.exports);var j6=Dg.exports,$6=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),i=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var r=42;e[t]=r;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==r||o.enumerable!==!0)return!1}return!0},NM=typeof Symbol<"u"&&Symbol,Y6=$6,q6=function(){return typeof NM!="function"||typeof Symbol!="function"||typeof NM("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Y6()},UM={foo:{}},K6=Object,Z6=function(){return{__proto__:UM}.foo===UM.foo&&!({__proto__:null}instanceof K6)},Q6="Function.prototype.bind called on incompatible ",J6=Object.prototype.toString,ez=Math.max,tz="[object Function]",FM=function(e,t){for(var i=[],r=0;r<e.length;r+=1)i[r]=e[r];for(var s=0;s<t.length;s+=1)i[s+e.length]=t[s];return i},nz=function(e,t){for(var i=[],r=t||0,s=0;r<e.length;r+=1,s+=1)i[s]=e[r];return i},iz=function(n,e){for(var t="",i=0;i<n.length;i+=1)t+=n[i],i+1<n.length&&(t+=e);return t},rz=function(e){var t=this;if(typeof t!="function"||J6.apply(t)!==tz)throw new TypeError(Q6+t);for(var i=nz(arguments,1),r,s=function(){if(this instanceof r){var d=t.apply(this,FM(i,arguments));return Object(d)===d?d:this}return t.apply(e,FM(i,arguments))},o=ez(0,t.length-i.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(r=Function("binder","return function ("+iz(a,",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var u=function(){};u.prototype=t.prototype,r.prototype=new u,u.prototype=null}return r},sz=rz,xE=Function.prototype.bind||sz,oz=Function.prototype.call,az=Object.prototype.hasOwnProperty,lz=xE,uz=lz.call(oz,az),Pt,Xc=SyntaxError,NI=Function,Ec=TypeError,ay=function(n){try{return NI('"use strict"; return ('+n+").constructor;")()}catch{}},Dl=Object.getOwnPropertyDescriptor;if(Dl)try{Dl({},"")}catch{Dl=null}var ly=function(){throw new Ec},cz=Dl?function(){try{return arguments.callee,ly}catch{try{return Dl(arguments,"callee").get}catch{return ly}}}():ly,Ou=q6(),hz=Z6(),Qn=Object.getPrototypeOf||(hz?function(n){return n.__proto__}:null),Hu={},dz=typeof Uint8Array>"u"||!Qn?Pt:Qn(Uint8Array),Nl={"%AggregateError%":typeof AggregateError>"u"?Pt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Pt:ArrayBuffer,"%ArrayIteratorPrototype%":Ou&&Qn?Qn([][Symbol.iterator]()):Pt,"%AsyncFromSyncIteratorPrototype%":Pt,"%AsyncFunction%":Hu,"%AsyncGenerator%":Hu,"%AsyncGeneratorFunction%":Hu,"%AsyncIteratorPrototype%":Hu,"%Atomics%":typeof Atomics>"u"?Pt:Atomics,"%BigInt%":typeof BigInt>"u"?Pt:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Pt:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Pt:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Pt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?Pt:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Pt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Pt:FinalizationRegistry,"%Function%":NI,"%GeneratorFunction%":Hu,"%Int8Array%":typeof Int8Array>"u"?Pt:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Pt:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Pt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Ou&&Qn?Qn(Qn([][Symbol.iterator]())):Pt,"%JSON%":typeof JSON=="object"?JSON:Pt,"%Map%":typeof Map>"u"?Pt:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Ou||!Qn?Pt:Qn(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Pt:Promise,"%Proxy%":typeof Proxy>"u"?Pt:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?Pt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Pt:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Ou||!Qn?Pt:Qn(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Pt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Ou&&Qn?Qn(""[Symbol.iterator]()):Pt,"%Symbol%":Ou?Symbol:Pt,"%SyntaxError%":Xc,"%ThrowTypeError%":cz,"%TypedArray%":dz,"%TypeError%":Ec,"%Uint8Array%":typeof Uint8Array>"u"?Pt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Pt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Pt:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Pt:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?Pt:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Pt:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Pt:WeakSet};if(Qn)try{null.error}catch(n){var fz=Qn(Qn(n));Nl["%Error.prototype%"]=fz}var pz=function n(e){var t;if(e==="%AsyncFunction%")t=ay("async function () {}");else if(e==="%GeneratorFunction%")t=ay("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=ay("async function* () {}");else if(e==="%AsyncGenerator%"){var i=n("%AsyncGeneratorFunction%");i&&(t=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var r=n("%AsyncGenerator%");r&&Qn&&(t=Qn(r.prototype))}return Nl[e]=t,t},OM={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},hf=xE,Ng=uz,mz=hf.call(Function.call,Array.prototype.concat),gz=hf.call(Function.apply,Array.prototype.splice),BM=hf.call(Function.call,String.prototype.replace),Ug=hf.call(Function.call,String.prototype.slice),_z=hf.call(Function.call,RegExp.prototype.exec),vz=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,yz=/\\(\\)?/g,xz=function(e){var t=Ug(e,0,1),i=Ug(e,-1);if(t==="%"&&i!=="%")throw new Xc("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&t!=="%")throw new Xc("invalid intrinsic syntax, expected opening `%`");var r=[];return BM(e,vz,function(s,o,a,l){r[r.length]=a?BM(l,yz,"$1"):o||s}),r},Sz=function(e,t){var i=e,r;if(Ng(OM,i)&&(r=OM[i],i="%"+r[0]+"%"),Ng(Nl,i)){var s=Nl[i];if(s===Hu&&(s=pz(i)),typeof s>"u"&&!t)throw new Ec("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:i,value:s}}throw new Xc("intrinsic "+e+" does not exist!")},Ql=function(e,t){if(typeof e!="string"||e.length===0)throw new Ec("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new Ec('"allowMissing" argument must be a boolean');if(_z(/^%?[^%]*%?$/,e)===null)throw new Xc("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=xz(e),r=i.length>0?i[0]:"",s=Sz("%"+r+"%",t),o=s.name,a=s.value,l=!1,u=s.alias;u&&(r=u[0],gz(i,mz([0,1],u)));for(var d=1,f=!0;d<i.length;d+=1){var p=i[d],m=Ug(p,0,1),v=Ug(p,-1);if((m==='"'||m==="'"||m==="`"||v==='"'||v==="'"||v==="`")&&m!==v)throw new Xc("property names with quotes must have matching quotes");if((p==="constructor"||!f)&&(l=!0),r+="."+p,o="%"+r+"%",Ng(Nl,o))a=Nl[o];else if(a!=null){if(!(p in a)){if(!t)throw new Ec("base intrinsic for "+e+" exists, but the property is not available.");return}if(Dl&&d+1>=i.length){var x=Dl(a,p);f=!!x,f&&"get"in x&&!("originalValue"in x.get)?a=x.get:a=a[p]}else f=Ng(a,p),a=a[p];f&&!l&&(Nl[o]=a)}}return a},UI={exports:{}},Ez=Ql,u1=Ez("%Object.defineProperty%",!0),c1=function(){if(u1)try{return u1({},"a",{value:1}),!0}catch{return!1}return!1};c1.hasArrayLengthDefineBug=function(){if(!c1())return null;try{return u1([],"length",{value:1}).length!==1}catch{return!0}};var FI=c1,Tz=Ql,Xm=Tz("%Object.getOwnPropertyDescriptor%",!0);if(Xm)try{Xm([],"length")}catch{Xm=null}var OI=Xm,bz=FI(),SE=Ql,Sd=bz&&SE("%Object.defineProperty%",!0);if(Sd)try{Sd({},"a",{value:1})}catch{Sd=!1}var wz=SE("%SyntaxError%"),Bu=SE("%TypeError%"),kM=OI,Az=function(e,t,i){if(!e||typeof e!="object"&&typeof e!="function")throw new Bu("`obj` must be an object or a function`");if(typeof t!="string"&&typeof t!="symbol")throw new Bu("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Bu("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Bu("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Bu("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Bu("`loose`, if provided, must be a boolean");var r=arguments.length>3?arguments[3]:null,s=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,l=!!kM&&kM(e,t);if(Sd)Sd(e,t,{configurable:o===null&&l?l.configurable:!o,enumerable:r===null&&l?l.enumerable:!r,value:i,writable:s===null&&l?l.writable:!s});else if(a||!r&&!s&&!o)e[t]=i;else throw new wz("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},BI=Ql,zM=Az,Mz=FI(),GM=OI,HM=BI("%TypeError%"),Cz=BI("%Math.floor%"),Rz=function(e,t){if(typeof e!="function")throw new HM("`fn` is not a function");if(typeof t!="number"||t<0||t>4294967295||Cz(t)!==t)throw new HM("`length` must be a positive 32-bit integer");var i=arguments.length>2&&!!arguments[2],r=!0,s=!0;if("length"in e&&GM){var o=GM(e,"length");o&&!o.configurable&&(r=!1),o&&!o.writable&&(s=!1)}return(r||s||!i)&&(Mz?zM(e,"length",t,!0,!0):zM(e,"length",t)),e};(function(n){var e=xE,t=Ql,i=Rz,r=t("%TypeError%"),s=t("%Function.prototype.apply%"),o=t("%Function.prototype.call%"),a=t("%Reflect.apply%",!0)||e.call(o,s),l=t("%Object.defineProperty%",!0),u=t("%Math.max%");if(l)try{l({},"a",{value:1})}catch{l=null}n.exports=function(p){if(typeof p!="function")throw new r("a function is required");var m=a(e,o,arguments);return i(m,1+u(0,p.length-(arguments.length-1)),!0)};var d=function(){return a(e,s,arguments)};l?l(n.exports,"apply",{value:d}):n.exports.apply=d})(UI);var Pz=UI.exports,kI=Ql,zI=Pz,Iz=zI(kI("String.prototype.indexOf")),Lz=function(e,t){var i=kI(e,!!t);return typeof i=="function"&&Iz(e,".prototype.")>-1?zI(i):i};const Dz={},Nz=Object.freeze(Object.defineProperty({__proto__:null,default:Dz},Symbol.toStringTag,{value:"Module"})),Uz=wR(Nz);var EE=typeof Map=="function"&&Map.prototype,uy=Object.getOwnPropertyDescriptor&&EE?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Fg=EE&&uy&&typeof uy.get=="function"?uy.get:null,VM=EE&&Map.prototype.forEach,TE=typeof Set=="function"&&Set.prototype,cy=Object.getOwnPropertyDescriptor&&TE?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Og=TE&&cy&&typeof cy.get=="function"?cy.get:null,WM=TE&&Set.prototype.forEach,Fz=typeof WeakMap=="function"&&WeakMap.prototype,Ed=Fz?WeakMap.prototype.has:null,Oz=typeof WeakSet=="function"&&WeakSet.prototype,Td=Oz?WeakSet.prototype.has:null,Bz=typeof WeakRef=="function"&&WeakRef.prototype,XM=Bz?WeakRef.prototype.deref:null,kz=Boolean.prototype.valueOf,zz=Object.prototype.toString,Gz=Function.prototype.toString,Hz=String.prototype.match,bE=String.prototype.slice,ga=String.prototype.replace,Vz=String.prototype.toUpperCase,jM=String.prototype.toLowerCase,GI=RegExp.prototype.test,$M=Array.prototype.concat,Ds=Array.prototype.join,Wz=Array.prototype.slice,YM=Math.floor,h1=typeof BigInt=="function"?BigInt.prototype.valueOf:null,hy=Object.getOwnPropertySymbols,d1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,jc=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Mi=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===jc||"symbol")?Symbol.toStringTag:null,HI=Object.prototype.propertyIsEnumerable,qM=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(n){return n.__proto__}:null);function KM(n,e){if(n===1/0||n===-1/0||n!==n||n&&n>-1e3&&n<1e3||GI.call(/e/,e))return e;var t=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof n=="number"){var i=n<0?-YM(-n):YM(n);if(i!==n){var r=String(i),s=bE.call(e,r.length+1);return ga.call(r,t,"$&_")+"."+ga.call(ga.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return ga.call(e,t,"$&_")}var f1=Uz,ZM=f1.custom,QM=WI(ZM)?ZM:null,Xz=function n(e,t,i,r){var s=t||{};if(la(s,"quoteStyle")&&s.quoteStyle!=="single"&&s.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(la(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=la(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(la(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(la(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return jI(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return a?KM(e,l):l}if(typeof e=="bigint"){var u=String(e)+"n";return a?KM(e,u):u}var d=typeof s.depth>"u"?5:s.depth;if(typeof i>"u"&&(i=0),i>=d&&d>0&&typeof e=="object")return p1(e)?"[Array]":"[Object]";var f=uG(s,i);if(typeof r>"u")r=[];else if(XI(r,e)>=0)return"[Circular]";function p(z,F,X){if(F&&(r=Wz.call(r),r.push(F)),X){var Z={depth:s.depth};return la(s,"quoteStyle")&&(Z.quoteStyle=s.quoteStyle),n(z,Z,i+1,r)}return n(z,s,i+1,r)}if(typeof e=="function"&&!JM(e)){var m=eG(e),v=Jp(e,p);return"[Function"+(m?": "+m:" (anonymous)")+"]"+(v.length>0?" { "+Ds.call(v,", ")+" }":"")}if(WI(e)){var x=jc?ga.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):d1.call(e);return typeof e=="object"&&!jc?Gh(x):x}if(oG(e)){for(var y="<"+jM.call(String(e.nodeName)),g=e.attributes||[],T=0;T<g.length;T++)y+=" "+g[T].name+"="+VI(jz(g[T].value),"double",s);return y+=">",e.childNodes&&e.childNodes.length&&(y+="..."),y+="</"+jM.call(String(e.nodeName))+">",y}if(p1(e)){if(e.length===0)return"[]";var S=Jp(e,p);return f&&!lG(S)?"["+m1(S,f)+"]":"[ "+Ds.call(S,", ")+" ]"}if(Yz(e)){var w=Jp(e,p);return!("cause"in Error.prototype)&&"cause"in e&&!HI.call(e,"cause")?"{ ["+String(e)+"] "+Ds.call($M.call("[cause]: "+p(e.cause),w),", ")+" }":w.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Ds.call(w,", ")+" }"}if(typeof e=="object"&&o){if(QM&&typeof e[QM]=="function"&&f1)return f1(e,{depth:d-i});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(tG(e)){var M=[];return VM&&VM.call(e,function(z,F){M.push(p(F,e,!0)+" => "+p(z,e))}),eC("Map",Fg.call(e),M,f)}if(rG(e)){var R=[];return WM&&WM.call(e,function(z){R.push(p(z,e))}),eC("Set",Og.call(e),R,f)}if(nG(e))return dy("WeakMap");if(sG(e))return dy("WeakSet");if(iG(e))return dy("WeakRef");if(Kz(e))return Gh(p(Number(e)));if(Qz(e))return Gh(p(h1.call(e)));if(Zz(e))return Gh(kz.call(e));if(qz(e))return Gh(p(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(e===Rm)return"{ [object globalThis] }";if(!$z(e)&&!JM(e)){var P=Jp(e,p),N=qM?qM(e)===Object.prototype:e instanceof Object||e.constructor===Object,C=e instanceof Object?"":"null prototype",L=!N&&Mi&&Object(e)===e&&Mi in e?bE.call(Ga(e),8,-1):C?"Object":"",Q=N||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",W=Q+(L||C?"["+Ds.call($M.call([],L||[],C||[]),": ")+"] ":"");return P.length===0?W+"{}":f?W+"{"+m1(P,f)+"}":W+"{ "+Ds.call(P,", ")+" }"}return String(e)};function VI(n,e,t){var i=(t.quoteStyle||e)==="double"?'"':"'";return i+n+i}function jz(n){return ga.call(String(n),/"/g,"&quot;")}function p1(n){return Ga(n)==="[object Array]"&&(!Mi||!(typeof n=="object"&&Mi in n))}function $z(n){return Ga(n)==="[object Date]"&&(!Mi||!(typeof n=="object"&&Mi in n))}function JM(n){return Ga(n)==="[object RegExp]"&&(!Mi||!(typeof n=="object"&&Mi in n))}function Yz(n){return Ga(n)==="[object Error]"&&(!Mi||!(typeof n=="object"&&Mi in n))}function qz(n){return Ga(n)==="[object String]"&&(!Mi||!(typeof n=="object"&&Mi in n))}function Kz(n){return Ga(n)==="[object Number]"&&(!Mi||!(typeof n=="object"&&Mi in n))}function Zz(n){return Ga(n)==="[object Boolean]"&&(!Mi||!(typeof n=="object"&&Mi in n))}function WI(n){if(jc)return n&&typeof n=="object"&&n instanceof Symbol;if(typeof n=="symbol")return!0;if(!n||typeof n!="object"||!d1)return!1;try{return d1.call(n),!0}catch{}return!1}function Qz(n){if(!n||typeof n!="object"||!h1)return!1;try{return h1.call(n),!0}catch{}return!1}var Jz=Object.prototype.hasOwnProperty||function(n){return n in this};function la(n,e){return Jz.call(n,e)}function Ga(n){return zz.call(n)}function eG(n){if(n.name)return n.name;var e=Hz.call(Gz.call(n),/^function\s*([\w$]+)/);return e?e[1]:null}function XI(n,e){if(n.indexOf)return n.indexOf(e);for(var t=0,i=n.length;t<i;t++)if(n[t]===e)return t;return-1}function tG(n){if(!Fg||!n||typeof n!="object")return!1;try{Fg.call(n);try{Og.call(n)}catch{return!0}return n instanceof Map}catch{}return!1}function nG(n){if(!Ed||!n||typeof n!="object")return!1;try{Ed.call(n,Ed);try{Td.call(n,Td)}catch{return!0}return n instanceof WeakMap}catch{}return!1}function iG(n){if(!XM||!n||typeof n!="object")return!1;try{return XM.call(n),!0}catch{}return!1}function rG(n){if(!Og||!n||typeof n!="object")return!1;try{Og.call(n);try{Fg.call(n)}catch{return!0}return n instanceof Set}catch{}return!1}function sG(n){if(!Td||!n||typeof n!="object")return!1;try{Td.call(n,Td);try{Ed.call(n,Ed)}catch{return!0}return n instanceof WeakSet}catch{}return!1}function oG(n){return!n||typeof n!="object"?!1:typeof HTMLElement<"u"&&n instanceof HTMLElement?!0:typeof n.nodeName=="string"&&typeof n.getAttribute=="function"}function jI(n,e){if(n.length>e.maxStringLength){var t=n.length-e.maxStringLength,i="... "+t+" more character"+(t>1?"s":"");return jI(bE.call(n,0,e.maxStringLength),e)+i}var r=ga.call(ga.call(n,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,aG);return VI(r,"single",e)}function aG(n){var e=n.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+Vz.call(e.toString(16))}function Gh(n){return"Object("+n+")"}function dy(n){return n+" { ? }"}function eC(n,e,t,i){var r=i?m1(t,i):Ds.call(t,", ");return n+" ("+e+") {"+r+"}"}function lG(n){for(var e=0;e<n.length;e++)if(XI(n[e],`
`)>=0)return!1;return!0}function uG(n,e){var t;if(n.indent==="	")t="	";else if(typeof n.indent=="number"&&n.indent>0)t=Ds.call(Array(n.indent+1)," ");else return null;return{base:t,prev:Ds.call(Array(e+1),t)}}function m1(n,e){if(n.length===0)return"";var t=`
`+e.prev+e.base;return t+Ds.call(n,","+t)+`
`+e.prev}function Jp(n,e){var t=p1(n),i=[];if(t){i.length=n.length;for(var r=0;r<n.length;r++)i[r]=la(n,r)?e(n[r],n):""}var s=typeof hy=="function"?hy(n):[],o;if(jc){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var l in n)la(n,l)&&(t&&String(Number(l))===l&&l<n.length||jc&&o["$"+l]instanceof Symbol||(GI.call(/[^\w$]/,l)?i.push(e(l,n)+": "+e(n[l],n)):i.push(l+": "+e(n[l],n))));if(typeof hy=="function")for(var u=0;u<s.length;u++)HI.call(n,s[u])&&i.push("["+e(s[u])+"]: "+e(n[s[u]],n));return i}var wE=Ql,ih=Lz,cG=Xz,hG=wE("%TypeError%"),em=wE("%WeakMap%",!0),tm=wE("%Map%",!0),dG=ih("WeakMap.prototype.get",!0),fG=ih("WeakMap.prototype.set",!0),pG=ih("WeakMap.prototype.has",!0),mG=ih("Map.prototype.get",!0),gG=ih("Map.prototype.set",!0),_G=ih("Map.prototype.has",!0),AE=function(n,e){for(var t=n,i;(i=t.next)!==null;t=i)if(i.key===e)return t.next=i.next,i.next=n.next,n.next=i,i},vG=function(n,e){var t=AE(n,e);return t&&t.value},yG=function(n,e,t){var i=AE(n,e);i?i.value=t:n.next={key:e,next:n.next,value:t}},xG=function(n,e){return!!AE(n,e)},SG=function(){var e,t,i,r={assert:function(s){if(!r.has(s))throw new hG("Side channel does not contain "+cG(s))},get:function(s){if(em&&s&&(typeof s=="object"||typeof s=="function")){if(e)return dG(e,s)}else if(tm){if(t)return mG(t,s)}else if(i)return vG(i,s)},has:function(s){if(em&&s&&(typeof s=="object"||typeof s=="function")){if(e)return pG(e,s)}else if(tm){if(t)return _G(t,s)}else if(i)return xG(i,s);return!1},set:function(s,o){em&&s&&(typeof s=="object"||typeof s=="function")?(e||(e=new em),fG(e,s,o)):tm?(t||(t=new tm),gG(t,s,o)):(i||(i={key:{},next:null}),yG(i,s,o))}};return r},EG=String.prototype.replace,TG=/%20/g,fy={RFC1738:"RFC1738",RFC3986:"RFC3986"},ME={default:fy.RFC3986,formatters:{RFC1738:function(n){return EG.call(n,TG,"+")},RFC3986:function(n){return String(n)}},RFC1738:fy.RFC1738,RFC3986:fy.RFC3986},bG=ME,py=Object.prototype.hasOwnProperty,vl=Array.isArray,ws=function(){for(var n=[],e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n}(),wG=function(e){for(;e.length>1;){var t=e.pop(),i=t.obj[t.prop];if(vl(i)){for(var r=[],s=0;s<i.length;++s)typeof i[s]<"u"&&r.push(i[s]);t.obj[t.prop]=r}}},$I=function(e,t){for(var i=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)typeof e[r]<"u"&&(i[r]=e[r]);return i},AG=function n(e,t,i){if(!t)return e;if(typeof t!="object"){if(vl(e))e.push(t);else if(e&&typeof e=="object")(i&&(i.plainObjects||i.allowPrototypes)||!py.call(Object.prototype,t))&&(e[t]=!0);else return[e,t];return e}if(!e||typeof e!="object")return[e].concat(t);var r=e;return vl(e)&&!vl(t)&&(r=$I(e,i)),vl(e)&&vl(t)?(t.forEach(function(s,o){if(py.call(e,o)){var a=e[o];a&&typeof a=="object"&&s&&typeof s=="object"?e[o]=n(a,s,i):e.push(s)}else e[o]=s}),e):Object.keys(t).reduce(function(s,o){var a=t[o];return py.call(s,o)?s[o]=n(s[o],a,i):s[o]=a,s},r)},MG=function(e,t){return Object.keys(t).reduce(function(i,r){return i[r]=t[r],i},e)},CG=function(n,e,t){var i=n.replace(/\+/g," ");if(t==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},RG=function(e,t,i,r,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),i==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(d){return"%26%23"+parseInt(d.slice(2),16)+"%3B"});for(var a="",l=0;l<o.length;++l){var u=o.charCodeAt(l);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||s===bG.RFC1738&&(u===40||u===41)){a+=o.charAt(l);continue}if(u<128){a=a+ws[u];continue}if(u<2048){a=a+(ws[192|u>>6]+ws[128|u&63]);continue}if(u<55296||u>=57344){a=a+(ws[224|u>>12]+ws[128|u>>6&63]+ws[128|u&63]);continue}l+=1,u=65536+((u&1023)<<10|o.charCodeAt(l)&1023),a+=ws[240|u>>18]+ws[128|u>>12&63]+ws[128|u>>6&63]+ws[128|u&63]}return a},PG=function(e){for(var t=[{obj:{o:e},prop:"o"}],i=[],r=0;r<t.length;++r)for(var s=t[r],o=s.obj[s.prop],a=Object.keys(o),l=0;l<a.length;++l){var u=a[l],d=o[u];typeof d=="object"&&d!==null&&i.indexOf(d)===-1&&(t.push({obj:o,prop:u}),i.push(d))}return wG(t),e},IG=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},LG=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},DG=function(e,t){return[].concat(e,t)},NG=function(e,t){if(vl(e)){for(var i=[],r=0;r<e.length;r+=1)i.push(t(e[r]));return i}return t(e)},YI={arrayToObject:$I,assign:MG,combine:DG,compact:PG,decode:CG,encode:RG,isBuffer:LG,isRegExp:IG,maybeMap:NG,merge:AG},qI=SG,jm=YI,bd=ME,UG=Object.prototype.hasOwnProperty,tC={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},_o=Array.isArray,FG=Array.prototype.push,KI=function(n,e){FG.apply(n,_o(e)?e:[e])},OG=Date.prototype.toISOString,nC=bd.default,Ti={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:jm.encode,encodeValuesOnly:!1,format:nC,formatter:bd.formatters[nC],indices:!1,serializeDate:function(e){return OG.call(e)},skipNulls:!1,strictNullHandling:!1},BG=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},my={},kG=function n(e,t,i,r,s,o,a,l,u,d,f,p,m,v,x,y){for(var g=e,T=y,S=0,w=!1;(T=T.get(my))!==void 0&&!w;){var M=T.get(e);if(S+=1,typeof M<"u"){if(M===S)throw new RangeError("Cyclic object value");w=!0}typeof T.get(my)>"u"&&(S=0)}if(typeof l=="function"?g=l(t,g):g instanceof Date?g=f(g):i==="comma"&&_o(g)&&(g=jm.maybeMap(g,function(Z){return Z instanceof Date?f(Z):Z})),g===null){if(s)return a&&!v?a(t,Ti.encoder,x,"key",p):t;g=""}if(BG(g)||jm.isBuffer(g)){if(a){var R=v?t:a(t,Ti.encoder,x,"key",p);return[m(R)+"="+m(a(g,Ti.encoder,x,"value",p))]}return[m(t)+"="+m(String(g))]}var P=[];if(typeof g>"u")return P;var N;if(i==="comma"&&_o(g))v&&a&&(g=jm.maybeMap(g,a)),N=[{value:g.length>0?g.join(",")||null:void 0}];else if(_o(l))N=l;else{var C=Object.keys(g);N=u?C.sort(u):C}for(var L=r&&_o(g)&&g.length===1?t+"[]":t,Q=0;Q<N.length;++Q){var W=N[Q],z=typeof W=="object"&&typeof W.value<"u"?W.value:g[W];if(!(o&&z===null)){var F=_o(g)?typeof i=="function"?i(L,W):L:L+(d?"."+W:"["+W+"]");y.set(e,S);var X=qI();X.set(my,y),KI(P,n(z,F,i,r,s,o,i==="comma"&&v&&_o(g)?null:a,l,u,d,f,p,m,v,x,X))}}return P},zG=function(e){if(!e)return Ti;if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var t=e.charset||Ti.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=bd.default;if(typeof e.format<"u"){if(!UG.call(bd.formatters,e.format))throw new TypeError("Unknown format option provided.");i=e.format}var r=bd.formatters[i],s=Ti.filter;return(typeof e.filter=="function"||_o(e.filter))&&(s=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Ti.addQueryPrefix,allowDots:typeof e.allowDots>"u"?Ti.allowDots:!!e.allowDots,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Ti.charsetSentinel,delimiter:typeof e.delimiter>"u"?Ti.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Ti.encode,encoder:typeof e.encoder=="function"?e.encoder:Ti.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Ti.encodeValuesOnly,filter:s,format:i,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Ti.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Ti.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Ti.strictNullHandling}},GG=function(n,e){var t=n,i=zG(e),r,s;typeof i.filter=="function"?(s=i.filter,t=s("",t)):_o(i.filter)&&(s=i.filter,r=s);var o=[];if(typeof t!="object"||t===null)return"";var a;e&&e.arrayFormat in tC?a=e.arrayFormat:e&&"indices"in e?a=e.indices?"indices":"repeat":a="indices";var l=tC[a];if(e&&"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var u=l==="comma"&&e&&e.commaRoundTrip;r||(r=Object.keys(t)),i.sort&&r.sort(i.sort);for(var d=qI(),f=0;f<r.length;++f){var p=r[f];i.skipNulls&&t[p]===null||KI(o,kG(t[p],p,l,u,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,d))}var m=o.join(i.delimiter),v=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?v+="utf8=%26%2310003%3B&":v+="utf8=%E2%9C%93&"),m.length>0?v+m:""},$c=YI,g1=Object.prototype.hasOwnProperty,HG=Array.isArray,Zn={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:$c.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},VG=function(n){return n.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},ZI=function(n,e){return n&&typeof n=="string"&&e.comma&&n.indexOf(",")>-1?n.split(","):n},WG="utf8=%26%2310003%3B",XG="utf8=%E2%9C%93",jG=function(e,t){var i={__proto__:null},r=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,s=t.parameterLimit===1/0?void 0:t.parameterLimit,o=r.split(t.delimiter,s),a=-1,l,u=t.charset;if(t.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===XG?u="utf-8":o[l]===WG&&(u="iso-8859-1"),a=l,l=o.length);for(l=0;l<o.length;++l)if(l!==a){var d=o[l],f=d.indexOf("]="),p=f===-1?d.indexOf("="):f+1,m,v;p===-1?(m=t.decoder(d,Zn.decoder,u,"key"),v=t.strictNullHandling?null:""):(m=t.decoder(d.slice(0,p),Zn.decoder,u,"key"),v=$c.maybeMap(ZI(d.slice(p+1),t),function(x){return t.decoder(x,Zn.decoder,u,"value")})),v&&t.interpretNumericEntities&&u==="iso-8859-1"&&(v=VG(v)),d.indexOf("[]=")>-1&&(v=HG(v)?[v]:v),g1.call(i,m)?i[m]=$c.combine(i[m],v):i[m]=v}return i},$G=function(n,e,t,i){for(var r=i?e:ZI(e,t),s=n.length-1;s>=0;--s){var o,a=n[s];if(a==="[]"&&t.parseArrays)o=[].concat(r);else{o=t.plainObjects?Object.create(null):{};var l=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,u=parseInt(l,10);!t.parseArrays&&l===""?o={0:r}:!isNaN(u)&&a!==l&&String(u)===l&&u>=0&&t.parseArrays&&u<=t.arrayLimit?(o=[],o[u]=r):l!=="__proto__"&&(o[l]=r)}r=o}return r},YG=function(e,t,i,r){if(e){var s=i.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,l=i.depth>0&&o.exec(s),u=l?s.slice(0,l.index):s,d=[];if(u){if(!i.plainObjects&&g1.call(Object.prototype,u)&&!i.allowPrototypes)return;d.push(u)}for(var f=0;i.depth>0&&(l=a.exec(s))!==null&&f<i.depth;){if(f+=1,!i.plainObjects&&g1.call(Object.prototype,l[1].slice(1,-1))&&!i.allowPrototypes)return;d.push(l[1])}return l&&d.push("["+s.slice(l.index)+"]"),$G(d,t,i,r)}},qG=function(e){if(!e)return Zn;if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=typeof e.charset>"u"?Zn.charset:e.charset;return{allowDots:typeof e.allowDots>"u"?Zn.allowDots:!!e.allowDots,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:Zn.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:Zn.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:Zn.arrayLimit,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Zn.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:Zn.comma,decoder:typeof e.decoder=="function"?e.decoder:Zn.decoder,delimiter:typeof e.delimiter=="string"||$c.isRegExp(e.delimiter)?e.delimiter:Zn.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:Zn.depth,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:Zn.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:Zn.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:Zn.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Zn.strictNullHandling}},KG=function(n,e){var t=qG(e);if(n===""||n===null||typeof n>"u")return t.plainObjects?Object.create(null):{};for(var i=typeof n=="string"?jG(n,t):n,r=t.plainObjects?Object.create(null):{},s=Object.keys(i),o=0;o<s.length;++o){var a=s[o],l=YG(a,i[a],t,typeof n=="string");r=$c.merge(r,l,t)}return t.allowSparse===!0?r:$c.compact(r)},ZG=GG,QG=KG,JG=ME,eH={formats:JG,parse:QG,stringify:ZG},tH=j6;function Ro(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var nH=/^([a-z0-9.+-]+:)/i,iH=/:[0-9]*$/,rH=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,sH=["<",">",'"',"`"," ","\r",`
`,"	"],oH=["{","}","|","\\","^","`"].concat(sH),_1=["'"].concat(oH),iC=["%","/","?",";","#"].concat(_1),rC=["/","?","#"],aH=255,sC=/^[+a-z0-9A-Z_-]{0,63}$/,lH=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,uH={javascript:!0,"javascript:":!0},v1={javascript:!0,"javascript:":!0},Tc={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y1=eH;function cH(n,e,t){if(n&&typeof n=="object"&&n instanceof Ro)return n;var i=new Ro;return i.parse(n,e,t),i}Ro.prototype.parse=function(n,e,t){if(typeof n!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof n);var i=n.indexOf("?"),r=i!==-1&&i<n.indexOf("#")?"?":"#",s=n.split(r),o=/\\/g;s[0]=s[0].replace(o,"/"),n=s.join(r);var a=n;if(a=a.trim(),!t&&n.split("#").length===1){var l=rH.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=y1.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var u=nH.exec(a);if(u){u=u[0];var d=u.toLowerCase();this.protocol=d,a=a.substr(u.length)}if(t||u||a.match(/^\/\/[^@/]+@[^@/]+/)){var f=a.substr(0,2)==="//";f&&!(u&&v1[u])&&(a=a.substr(2),this.slashes=!0)}if(!v1[u]&&(f||u&&!Tc[u])){for(var p=-1,m=0;m<rC.length;m++){var v=a.indexOf(rC[m]);v!==-1&&(p===-1||v<p)&&(p=v)}var x,y;p===-1?y=a.lastIndexOf("@"):y=a.lastIndexOf("@",p),y!==-1&&(x=a.slice(0,y),a=a.slice(y+1),this.auth=decodeURIComponent(x)),p=-1;for(var m=0;m<iC.length;m++){var v=a.indexOf(iC[m]);v!==-1&&(p===-1||v<p)&&(p=v)}p===-1&&(p=a.length),this.host=a.slice(0,p),a=a.slice(p),this.parseHost(),this.hostname=this.hostname||"";var g=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!g)for(var T=this.hostname.split(/\./),m=0,S=T.length;m<S;m++){var w=T[m];if(w&&!w.match(sC)){for(var M="",R=0,P=w.length;R<P;R++)w.charCodeAt(R)>127?M+="x":M+=w[R];if(!M.match(sC)){var N=T.slice(0,m),C=T.slice(m+1),L=w.match(lH);L&&(N.push(L[1]),C.unshift(L[2])),C.length&&(a="/"+C.join(".")+a),this.hostname=N.join(".");break}}}this.hostname.length>aH?this.hostname="":this.hostname=this.hostname.toLowerCase(),g||(this.hostname=tH.toASCII(this.hostname));var Q=this.port?":"+this.port:"",W=this.hostname||"";this.host=W+Q,this.href+=this.host,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!uH[d])for(var m=0,S=_1.length;m<S;m++){var z=_1[m];if(a.indexOf(z)!==-1){var F=encodeURIComponent(z);F===z&&(F=escape(z)),a=a.split(z).join(F)}}var X=a.indexOf("#");X!==-1&&(this.hash=a.substr(X),a=a.slice(0,X));var Z=a.indexOf("?");if(Z!==-1?(this.search=a.substr(Z),this.query=a.substr(Z+1),e&&(this.query=y1.parse(this.query)),a=a.slice(0,Z)):e&&(this.search="",this.query={}),a&&(this.pathname=a),Tc[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var Q=this.pathname||"",$=this.search||"";this.path=Q+$}return this.href=this.format(),this};Ro.prototype.format=function(){var n=this.auth||"";n&&(n=encodeURIComponent(n),n=n.replace(/%3A/i,":"),n+="@");var e=this.protocol||"",t=this.pathname||"",i=this.hash||"",r=!1,s="";this.host?r=n+this.host:this.hostname&&(r=n+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=y1.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||Tc[e])&&r!==!1?(r="//"+(r||""),t&&t.charAt(0)!=="/"&&(t="/"+t)):r||(r=""),i&&i.charAt(0)!=="#"&&(i="#"+i),o&&o.charAt(0)!=="?"&&(o="?"+o),t=t.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+r+t+o+i};Ro.prototype.resolve=function(n){return this.resolveObject(cH(n,!1,!0)).format()};Ro.prototype.resolveObject=function(n){if(typeof n=="string"){var e=new Ro;e.parse(n,!1,!0),n=e}for(var t=new Ro,i=Object.keys(this),r=0;r<i.length;r++){var s=i[r];t[s]=this[s]}if(t.hash=n.hash,n.href==="")return t.href=t.format(),t;if(n.slashes&&!n.protocol){for(var o=Object.keys(n),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(t[l]=n[l])}return Tc[t.protocol]&&t.hostname&&!t.pathname&&(t.pathname="/",t.path=t.pathname),t.href=t.format(),t}if(n.protocol&&n.protocol!==t.protocol){if(!Tc[n.protocol]){for(var u=Object.keys(n),d=0;d<u.length;d++){var f=u[d];t[f]=n[f]}return t.href=t.format(),t}if(t.protocol=n.protocol,!n.host&&!v1[n.protocol]){for(var S=(n.pathname||"").split("/");S.length&&!(n.host=S.shift()););n.host||(n.host=""),n.hostname||(n.hostname=""),S[0]!==""&&S.unshift(""),S.length<2&&S.unshift(""),t.pathname=S.join("/")}else t.pathname=n.pathname;if(t.search=n.search,t.query=n.query,t.host=n.host||"",t.auth=n.auth,t.hostname=n.hostname||n.host,t.port=n.port,t.pathname||t.search){var p=t.pathname||"",m=t.search||"";t.path=p+m}return t.slashes=t.slashes||n.slashes,t.href=t.format(),t}var v=t.pathname&&t.pathname.charAt(0)==="/",x=n.host||n.pathname&&n.pathname.charAt(0)==="/",y=x||v||t.host&&n.pathname,g=y,T=t.pathname&&t.pathname.split("/")||[],S=n.pathname&&n.pathname.split("/")||[],w=t.protocol&&!Tc[t.protocol];if(w&&(t.hostname="",t.port=null,t.host&&(T[0]===""?T[0]=t.host:T.unshift(t.host)),t.host="",n.protocol&&(n.hostname=null,n.port=null,n.host&&(S[0]===""?S[0]=n.host:S.unshift(n.host)),n.host=null),y=y&&(S[0]===""||T[0]==="")),x)t.host=n.host||n.host===""?n.host:t.host,t.hostname=n.hostname||n.hostname===""?n.hostname:t.hostname,t.search=n.search,t.query=n.query,T=S;else if(S.length)T||(T=[]),T.pop(),T=T.concat(S),t.search=n.search,t.query=n.query;else if(n.search!=null){if(w){t.host=T.shift(),t.hostname=t.host;var M=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;M&&(t.auth=M.shift(),t.hostname=M.shift(),t.host=t.hostname)}return t.search=n.search,t.query=n.query,(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t}if(!T.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;for(var R=T.slice(-1)[0],P=(t.host||n.host||T.length>1)&&(R==="."||R==="..")||R==="",N=0,C=T.length;C>=0;C--)R=T[C],R==="."?T.splice(C,1):R===".."?(T.splice(C,1),N++):N&&(T.splice(C,1),N--);if(!y&&!g)for(;N--;N)T.unshift("..");y&&T[0]!==""&&(!T[0]||T[0].charAt(0)!=="/")&&T.unshift(""),P&&T.join("/").substr(-1)!=="/"&&T.push("");var L=T[0]===""||T[0]&&T[0].charAt(0)==="/";if(w){t.hostname=L?"":T.length?T.shift():"",t.host=t.hostname;var M=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;M&&(t.auth=M.shift(),t.hostname=M.shift(),t.host=t.hostname)}return y=y||t.host&&T.length,y&&!L&&T.unshift(""),T.length>0?t.pathname=T.join("/"):(t.pathname=null,t.path=null),(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=n.auth||t.auth,t.slashes=t.slashes||n.slashes,t.href=t.format(),t};Ro.prototype.parseHost=function(){var n=this.host,e=iH.exec(n);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),n=n.substr(0,n.length-e.length)),n&&(this.hostname=n)};const oC={};function Rt(n,e,t=3){if(oC[e])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${n}`):(i=i.split(`
`).splice(t).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${n}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${n}`),console.warn(i))),oC[e]=!0}function Yr(n){if(typeof n!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(n)}`)}function Hh(n){return n.split("?")[0].split("#")[0]}function hH(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function dH(n,e,t){return n.replace(new RegExp(hH(e),"g"),t)}function fH(n,e){let t="",i=0,r=-1,s=0,o=-1;for(let a=0;a<=n.length;++a){if(a<n.length)o=n.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||s===1))if(r!==a-1&&s===2){if(t.length<2||i!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){const l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",i=0):(t=t.slice(0,l),i=t.length-1-t.lastIndexOf("/")),r=a,s=0;continue}}else if(t.length===2||t.length===1){t="",i=0,r=a,s=0;continue}}e&&(t.length>0?t+="/..":t="..",i=2)}else t.length>0?t+=`/${n.slice(r+1,a)}`:t=n.slice(r+1,a),i=a-r-1;r=a,s=0}else o===46&&s!==-1?++s:s=-1}return t}const Gn={toPosix(n){return dH(n,"\\","/")},isUrl(n){return/^https?:/.test(this.toPosix(n))},isDataUrl(n){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(n)},isBlobUrl(n){return n.startsWith("blob:")},hasProtocol(n){return/^[^/:]+:/.test(this.toPosix(n))},getProtocol(n){Yr(n),n=this.toPosix(n);const e=/^file:\/\/\//.exec(n);if(e)return e[0];const t=/^[^/:]+:\/{0,2}/.exec(n);return t?t[0]:""},toAbsolute(n,e,t){if(Yr(n),this.isDataUrl(n)||this.isBlobUrl(n))return n;const i=Hh(this.toPosix(e??Fe.ADAPTER.getBaseUrl())),r=Hh(this.toPosix(t??this.rootname(i)));return n=this.toPosix(n),n.startsWith("/")?Gn.join(r,n.slice(1)):this.isAbsolute(n)?n:this.join(i,n)},normalize(n){if(Yr(n),n.length===0)return".";if(this.isDataUrl(n)||this.isBlobUrl(n))return n;n=this.toPosix(n);let e="";const t=n.startsWith("/");this.hasProtocol(n)&&(e=this.rootname(n),n=n.slice(e.length));const i=n.endsWith("/");return n=fH(n,!1),n.length>0&&i&&(n+="/"),t?`/${n}`:e+n},isAbsolute(n){return Yr(n),n=this.toPosix(n),this.hasProtocol(n)?!0:n.startsWith("/")},join(...n){if(n.length===0)return".";let e;for(let t=0;t<n.length;++t){const i=n[t];if(Yr(i),i.length>0)if(e===void 0)e=i;else{const r=n[t-1]??"";this.joinExtensions.includes(this.extname(r).toLowerCase())?e+=`/../${i}`:e+=`/${i}`}}return e===void 0?".":this.normalize(e)},dirname(n){if(Yr(n),n.length===0)return".";n=this.toPosix(n);let e=n.charCodeAt(0);const t=e===47;let i=-1,r=!0;const s=this.getProtocol(n),o=n;n=n.slice(s.length);for(let a=n.length-1;a>=1;--a)if(e=n.charCodeAt(a),e===47){if(!r){i=a;break}}else r=!1;return i===-1?t?"/":this.isUrl(o)?s+n:s:t&&i===1?"//":s+n.slice(0,i)},rootname(n){Yr(n),n=this.toPosix(n);let e="";if(n.startsWith("/")?e="/":e=this.getProtocol(n),this.isUrl(n)){const t=n.indexOf("/",e.length);t!==-1?e=n.slice(0,t):e=n,e.endsWith("/")||(e+="/")}return e},basename(n,e){Yr(n),e&&Yr(e),n=Hh(this.toPosix(n));let t=0,i=-1,r=!0,s;if(e!==void 0&&e.length>0&&e.length<=n.length){if(e.length===n.length&&e===n)return"";let o=e.length-1,a=-1;for(s=n.length-1;s>=0;--s){const l=n.charCodeAt(s);if(l===47){if(!r){t=s+1;break}}else a===-1&&(r=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=n.length),n.slice(t,i)}for(s=n.length-1;s>=0;--s)if(n.charCodeAt(s)===47){if(!r){t=s+1;break}}else i===-1&&(r=!1,i=s+1);return i===-1?"":n.slice(t,i)},extname(n){Yr(n),n=Hh(this.toPosix(n));let e=-1,t=0,i=-1,r=!0,s=0;for(let o=n.length-1;o>=0;--o){const a=n.charCodeAt(o);if(a===47){if(!r){t=o+1;break}continue}i===-1&&(r=!1,i=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||i===-1||s===0||s===1&&e===i-1&&e===t+1?"":n.slice(e,i)},parse(n){Yr(n);const e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;n=Hh(this.toPosix(n));let t=n.charCodeAt(0);const i=this.isAbsolute(n);let r;e.root=this.rootname(n),i||this.hasProtocol(n)?r=1:r=0;let s=-1,o=0,a=-1,l=!0,u=n.length-1,d=0;for(;u>=r;--u){if(t=n.charCodeAt(u),t===47){if(!l){o=u+1;break}continue}a===-1&&(l=!1,a=u+1),t===46?s===-1?s=u:d!==1&&(d=1):s!==-1&&(d=-1)}return s===-1||a===-1||d===0||d===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&i?e.base=e.name=n.slice(1,a):e.base=e.name=n.slice(o,a)):(o===0&&i?(e.name=n.slice(1,s),e.base=n.slice(1,a)):(e.name=n.slice(o,s),e.base=n.slice(o,a)),e.ext=n.slice(s,a)),e.dir=this.dirname(n),e},sep:"/",delimiter:":",joinExtensions:[".html"]};let gy;async function pH(){return gy??(gy=(async()=>{var s;const n=document.createElement("canvas").getContext("webgl");if(!n)return ji.UNPACK;const e=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!e)return ji.UNPACK;const t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t);const i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e);const r=new Uint8Array(4);return n.readPixels(0,0,1,1,n.RGBA,n.UNSIGNED_BYTE,r),n.deleteFramebuffer(i),n.deleteTexture(t),(s=n.getExtension("WEBGL_lose_context"))==null||s.loseContext(),r[0]<=r[3]?ji.PMA:ji.UNPACK})()),gy}let _y;function mH(){return typeof _y>"u"&&(_y=function(){var e;const n={stencil:!0,failIfMajorPerformanceCaveat:Fe.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!Fe.ADAPTER.getWebGLRenderingContext())return!1;const t=Fe.ADAPTER.createCanvas();let i=t.getContext("webgl",n)||t.getContext("experimental-webgl",n);const r=!!((e=i==null?void 0:i.getContextAttributes())!=null&&e.stencil);if(i){const s=i.getExtension("WEBGL_lose_context");s&&s.loseContext()}return i=null,r}catch{return!1}}()),_y}var gH={grad:.9,turn:360,rad:360/(2*Math.PI)},co=function(n){return typeof n=="string"?n.length>0:typeof n=="number"},ei=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*n)/t+0},Fr=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),n>t?t:n>e?n:e},QI=function(n){return(n=isFinite(n)?n%360:0)>0?n:n+360},aC=function(n){return{r:Fr(n.r,0,255),g:Fr(n.g,0,255),b:Fr(n.b,0,255),a:Fr(n.a)}},vy=function(n){return{r:ei(n.r),g:ei(n.g),b:ei(n.b),a:ei(n.a,3)}},_H=/^#([0-9a-f]{3,8})$/i,nm=function(n){var e=n.toString(16);return e.length<2?"0"+e:e},JI=function(n){var e=n.r,t=n.g,i=n.b,r=n.a,s=Math.max(e,t,i),o=s-Math.min(e,t,i),a=o?s===e?(t-i)/o:s===t?2+(i-e)/o:4+(e-t)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:r}},eL=function(n){var e=n.h,t=n.s,i=n.v,r=n.a;e=e/360*6,t/=100,i/=100;var s=Math.floor(e),o=i*(1-t),a=i*(1-(e-s)*t),l=i*(1-(1-e+s)*t),u=s%6;return{r:255*[i,a,o,o,l,i][u],g:255*[l,i,i,a,o,o][u],b:255*[o,o,l,i,i,a][u],a:r}},lC=function(n){return{h:QI(n.h),s:Fr(n.s,0,100),l:Fr(n.l,0,100),a:Fr(n.a)}},uC=function(n){return{h:ei(n.h),s:ei(n.s),l:ei(n.l),a:ei(n.a,3)}},cC=function(n){return eL((t=(e=n).s,{h:e.h,s:(t*=((i=e.l)<50?i:100-i)/100)>0?2*t/(i+t)*100:0,v:i+t,a:e.a}));var e,t,i},wd=function(n){return{h:(e=JI(n)).h,s:(r=(200-(t=e.s))*(i=e.v)/100)>0&&r<200?t*i/100/(r<=100?r:200-r)*100:0,l:r/2,a:e.a};var e,t,i,r},vH=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,yH=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,xH=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,SH=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,x1={string:[[function(n){var e=_H.exec(n);return e?(n=e[1]).length<=4?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:n.length===4?ei(parseInt(n[3]+n[3],16)/255,2):1}:n.length===6||n.length===8?{r:parseInt(n.substr(0,2),16),g:parseInt(n.substr(2,2),16),b:parseInt(n.substr(4,2),16),a:n.length===8?ei(parseInt(n.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(n){var e=xH.exec(n)||SH.exec(n);return e?e[2]!==e[4]||e[4]!==e[6]?null:aC({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(n){var e=vH.exec(n)||yH.exec(n);if(!e)return null;var t,i,r=lC({h:(t=e[1],i=e[2],i===void 0&&(i="deg"),Number(t)*(gH[i]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return cC(r)},"hsl"]],object:[[function(n){var e=n.r,t=n.g,i=n.b,r=n.a,s=r===void 0?1:r;return co(e)&&co(t)&&co(i)?aC({r:Number(e),g:Number(t),b:Number(i),a:Number(s)}):null},"rgb"],[function(n){var e=n.h,t=n.s,i=n.l,r=n.a,s=r===void 0?1:r;if(!co(e)||!co(t)||!co(i))return null;var o=lC({h:Number(e),s:Number(t),l:Number(i),a:Number(s)});return cC(o)},"hsl"],[function(n){var e=n.h,t=n.s,i=n.v,r=n.a,s=r===void 0?1:r;if(!co(e)||!co(t)||!co(i))return null;var o=function(a){return{h:QI(a.h),s:Fr(a.s,0,100),v:Fr(a.v,0,100),a:Fr(a.a)}}({h:Number(e),s:Number(t),v:Number(i),a:Number(s)});return eL(o)},"hsv"]]},hC=function(n,e){for(var t=0;t<e.length;t++){var i=e[t][0](n);if(i)return[i,e[t][1]]}return[null,void 0]},EH=function(n){return typeof n=="string"?hC(n.trim(),x1.string):typeof n=="object"&&n!==null?hC(n,x1.object):[null,void 0]},yy=function(n,e){var t=wd(n);return{h:t.h,s:Fr(t.s+100*e,0,100),l:t.l,a:t.a}},xy=function(n){return(299*n.r+587*n.g+114*n.b)/1e3/255},dC=function(n,e){var t=wd(n);return{h:t.h,s:t.s,l:Fr(t.l+100*e,0,100),a:t.a}},S1=function(){function n(e){this.parsed=EH(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return n.prototype.isValid=function(){return this.parsed!==null},n.prototype.brightness=function(){return ei(xy(this.rgba),2)},n.prototype.isDark=function(){return xy(this.rgba)<.5},n.prototype.isLight=function(){return xy(this.rgba)>=.5},n.prototype.toHex=function(){return e=vy(this.rgba),t=e.r,i=e.g,r=e.b,o=(s=e.a)<1?nm(ei(255*s)):"","#"+nm(t)+nm(i)+nm(r)+o;var e,t,i,r,s,o},n.prototype.toRgb=function(){return vy(this.rgba)},n.prototype.toRgbString=function(){return e=vy(this.rgba),t=e.r,i=e.g,r=e.b,(s=e.a)<1?"rgba("+t+", "+i+", "+r+", "+s+")":"rgb("+t+", "+i+", "+r+")";var e,t,i,r,s},n.prototype.toHsl=function(){return uC(wd(this.rgba))},n.prototype.toHslString=function(){return e=uC(wd(this.rgba)),t=e.h,i=e.s,r=e.l,(s=e.a)<1?"hsla("+t+", "+i+"%, "+r+"%, "+s+")":"hsl("+t+", "+i+"%, "+r+"%)";var e,t,i,r,s},n.prototype.toHsv=function(){return e=JI(this.rgba),{h:ei(e.h),s:ei(e.s),v:ei(e.v),a:ei(e.a,3)};var e},n.prototype.invert=function(){return As({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},n.prototype.saturate=function(e){return e===void 0&&(e=.1),As(yy(this.rgba,e))},n.prototype.desaturate=function(e){return e===void 0&&(e=.1),As(yy(this.rgba,-e))},n.prototype.grayscale=function(){return As(yy(this.rgba,-1))},n.prototype.lighten=function(e){return e===void 0&&(e=.1),As(dC(this.rgba,e))},n.prototype.darken=function(e){return e===void 0&&(e=.1),As(dC(this.rgba,-e))},n.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},n.prototype.alpha=function(e){return typeof e=="number"?As({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):ei(this.rgba.a,3);var t},n.prototype.hue=function(e){var t=wd(this.rgba);return typeof e=="number"?As({h:e,s:t.s,l:t.l,a:t.a}):ei(t.h)},n.prototype.isEqual=function(e){return this.toHex()===As(e).toHex()},n}(),As=function(n){return n instanceof S1?n:new S1(n)},fC=[],TH=function(n){n.forEach(function(e){fC.indexOf(e)<0&&(e(S1,x1),fC.push(e))})};function bH(n,e){var t={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var r in t)i[t[r]]=r;var s={};n.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,u=i[this.toHex()];if(u)return u;if(o!=null&&o.closest){var d=this.toRgb(),f=1/0,p="black";if(!s.length)for(var m in t)s[m]=new n(t[m]).toRgb();for(var v in t){var x=(a=d,l=s[v],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));x<f&&(f=x,p=v)}return p}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":t[a];return l?new n(l).toRgb():null},"name"])}TH([bH]);const Vu=class $m{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof $m)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,t){const i=typeof e;if(i!==typeof t)return!1;if(i==="number"||i==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((r,s)=>r===t[s]);if(e!==null&&t!==null){const r=Object.keys(e),s=Object.keys(t);return r.length!==s.length?!1:r.every(o=>e[o]===t[o])}return e===t}toRgba(){const[e,t,i,r]=this._components;return{r:e,g:t,b:i,a:r}}toRgb(){const[e,t,i]=this._components;return{r:e,g:t,b:i}}toRgbaString(){const[e,t,i]=this.toUint8RgbArray();return`rgba(${e},${t},${i},${this.alpha})`}toUint8RgbArray(e){const[t,i,r]=this._components;return e=e??[],e[0]=Math.round(t*255),e[1]=Math.round(i*255),e[2]=Math.round(r*255),e}toRgbArray(e){e=e??[];const[t,i,r]=this._components;return e[0]=t,e[1]=i,e[2]=r,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[t,i,r,s]=$m.temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=i,this._components[2]*=r,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(e===1)return(255<<24)+this._int;if(e===0)return t?0:this._int;let i=this._int>>16&255,r=this._int>>8&255,s=this._int&255;return t&&(i=i*e+.5|0,r=r*e+.5|0,s=s*e+.5|0),(e*255<<24)+(i<<16)+(r<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[t,i,r]=this._components;return this._components[0]=Math.round(t*e)/e,this._components[1]=Math.round(i*e)/e,this._components[2]=Math.round(r*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[t,i,r,s]=this._components;return e[0]=t,e[1]=i,e[2]=r,e[3]=s,e}normalize(e){let t,i,r,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;t=(o>>16&255)/255,i=(o>>8&255)/255,r=(o&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[t,i,r,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[t,i,r,s=255]=e,t/=255,i/=255,r/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=$m.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=As(e);o.isValid()&&({r:t,g:i,b:r,a:s}=o.rgba,t/=255,i/=255,r/=255)}if(t!==void 0)this._components[0]=t,this._components[1]=i,this._components[2]=r,this._components[3]=s,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,t,i]=this._components;this._int=(e*255<<16)+(t*255<<8)+(i*255|0)}_clamp(e,t=0,i=1){return typeof e=="number"?Math.min(Math.max(e,t),i):(e.forEach((r,s)=>{e[s]=Math.min(Math.max(r,t),i)}),e)}};Vu.shared=new Vu,Vu.temp=new Vu,Vu.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Jt=Vu;function wH(n){return Rt("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Jt.shared.setValue(n).toHex()}function AH(n){return Rt("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Jt.shared.setValue(n).toNumber()}function MH(){const n=[],e=[];for(let i=0;i<32;i++)n[i]=i,e[i]=i;n[rt.NORMAL_NPM]=rt.NORMAL,n[rt.ADD_NPM]=rt.ADD,n[rt.SCREEN_NPM]=rt.SCREEN,e[rt.NORMAL]=rt.NORMAL_NPM,e[rt.ADD]=rt.ADD_NPM,e[rt.SCREEN]=rt.SCREEN_NPM;const t=[];return t.push(e),t.push(n),t}const tL=MH();function nL(n,e){return tL[e?1:0][n]}function CH(n,e=null){const t=n*6;if(e=e||new Uint16Array(t),e.length!==t)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${t}`);for(let i=0,r=0;i<t;i+=6,r+=4)e[i+0]=r+0,e[i+1]=r+1,e[i+2]=r+2,e[i+3]=r+0,e[i+4]=r+2,e[i+5]=r+3;return e}function iL(n){if(n.BYTES_PER_ELEMENT===4)return n instanceof Float32Array?"Float32Array":n instanceof Uint32Array?"Uint32Array":"Int32Array";if(n.BYTES_PER_ELEMENT===2){if(n instanceof Uint16Array)return"Uint16Array"}else if(n.BYTES_PER_ELEMENT===1&&n instanceof Uint8Array)return"Uint8Array";return null}function Bg(n){return n+=n===0?1:0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n+1}function pC(n){return!(n&n-1)&&!!n}function mC(n){let e=(n>65535?1:0)<<4;n>>>=e;let t=(n>255?1:0)<<3;return n>>>=t,e|=t,t=(n>15?1:0)<<2,n>>>=t,e|=t,t=(n>3?1:0)<<1,n>>>=t,e|=t,e|n>>1}function bc(n,e,t){const i=n.length;let r;if(e>=i||t===0)return;t=e+t>i?i-e:t;const s=i-t;for(r=e;r<s;++r)n[r]=n[r+t];n.length=s}function _a(n){return n===0?0:n<0?-1:1}let RH=0;function Yl(){return++RH}const E1=class{constructor(n,e,t,i){this.left=n,this.top=e,this.right=t,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};E1.EMPTY=new E1(0,0,0,0);let gC=E1;const _C={},Ms=Object.create(null),na=Object.create(null);class PH{constructor(e,t,i){this._canvas=Fe.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||Fe.RESOLUTION,this.resize(e,t)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,t){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(t*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function vC(n,e,t){for(let i=0,r=4*t*e;i<e;++i,r+=4)if(n[r+3]!==0)return!1;return!0}function yC(n,e,t,i,r){const s=4*e;for(let o=i,a=i*s+4*t;o<=r;++o,a+=s)if(n[a+3]!==0)return!1;return!0}function IH(n){const{width:e,height:t}=n,i=n.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");const r=i.getImageData(0,0,e,t).data;let s=0,o=0,a=e-1,l=t-1;for(;o<t&&vC(r,e,o);)++o;if(o===t)return gC.EMPTY;for(;vC(r,e,l);)--l;for(;yC(r,e,s,o,l);)++s;for(;yC(r,e,a,o,l);)--a;return++a,++l,new gC(s,o,a,l)}function LH(n){const e=IH(n),{width:t,height:i}=e;let r=null;if(!e.isEmpty()){const s=n.getContext("2d");if(s===null)throw new TypeError("Failed to get canvas 2D context");r=s.getImageData(e.left,e.top,t,i)}return{width:t,height:i,data:r}}function DH(n,e=globalThis.location){if(n.startsWith("data:"))return"";e=e||globalThis.location;const t=new URL(n,document.baseURI);return t.hostname!==e.hostname||t.port!==e.port||t.protocol!==e.protocol?"anonymous":""}function Uo(n,e=1){var i;const t=(i=Fe.RETINA_PREFIX)==null?void 0:i.exec(n);return t?parseFloat(t[1]):e}var Ne=(n=>(n.Renderer="renderer",n.Application="application",n.RendererSystem="renderer-webgl-system",n.RendererPlugin="renderer-webgl-plugin",n.CanvasRendererSystem="renderer-canvas-system",n.CanvasRendererPlugin="renderer-canvas-plugin",n.Asset="asset",n.LoadParser="load-parser",n.ResolveParser="resolve-parser",n.CacheParser="cache-parser",n.DetectionParser="detection-parser",n))(Ne||{});const T1=n=>{if(typeof n=="function"||typeof n=="object"&&n.extension){if(!n.extension)throw new Error("Extension class must have an extension object");n={...typeof n.extension!="object"?{type:n.extension}:n.extension,ref:n}}if(typeof n=="object")n={...n};else throw new Error("Invalid extension type");return typeof n.type=="string"&&(n.type=[n.type]),n},xC=(n,e)=>T1(n).priority??e,$e={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...n){return n.map(T1).forEach(e=>{e.type.forEach(t=>{var i,r;return(r=(i=this._removeHandlers)[t])==null?void 0:r.call(i,e)})}),this},add(...n){return n.map(T1).forEach(e=>{e.type.forEach(t=>{const i=this._addHandlers,r=this._queue;i[t]?i[t](e):(r[t]=r[t]||[],r[t].push(e))})}),this},handle(n,e,t){const i=this._addHandlers,r=this._removeHandlers;if(i[n]||r[n])throw new Error(`Extension type ${n} already has a handler`);i[n]=e,r[n]=t;const s=this._queue;return s[n]&&(s[n].forEach(o=>e(o)),delete s[n]),this},handleByMap(n,e){return this.handle(n,t=>{e[t.name]=t.ref},t=>{delete e[t.name]})},handleByList(n,e,t=-1){return this.handle(n,i=>{e.includes(i.ref)||(e.push(i.ref),e.sort((r,s)=>xC(s,t)-xC(r,t)))},i=>{const r=e.indexOf(i.ref);r!==-1&&e.splice(r,1)})}};class b1{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const NH=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function UH(n){let e="";for(let t=0;t<n;++t)t>0&&(e+=`
else `),t<n-1&&(e+=`if(test == ${t}.0){}`);return e}function FH(n,e){if(n===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const t=e.createShader(e.FRAGMENT_SHADER);for(;;){const i=NH.replace(/%forloop%/gi,UH(n));if(e.shaderSource(t,i),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))n=n/2|0;else break}return n}const Sy=0,Ey=1,Ty=2,by=3,wy=4,Ay=5;class Ks{constructor(){this.data=0,this.blendMode=rt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Sy)}set blend(e){!!(this.data&1<<Sy)!==e&&(this.data^=1<<Sy)}get offsets(){return!!(this.data&1<<Ey)}set offsets(e){!!(this.data&1<<Ey)!==e&&(this.data^=1<<Ey)}get culling(){return!!(this.data&1<<Ty)}set culling(e){!!(this.data&1<<Ty)!==e&&(this.data^=1<<Ty)}get depthTest(){return!!(this.data&1<<by)}set depthTest(e){!!(this.data&1<<by)!==e&&(this.data^=1<<by)}get depthMask(){return!!(this.data&1<<Ay)}set depthMask(e){!!(this.data&1<<Ay)!==e&&(this.data^=1<<Ay)}get clockwiseFrontFace(){return!!(this.data&1<<wy)}set clockwiseFrontFace(e){!!(this.data&1<<wy)!==e&&(this.data^=1<<wy)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==rt.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new Ks;return e.depthTest=!1,e.blend=!0,e}}Ks.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const w1=[];function rL(n,e){if(!n)return null;let t="";if(typeof n=="string"){const i=/\.(\w{3,4})(?:$|\?|#)/i.exec(n);i&&(t=i[1].toLowerCase())}for(let i=w1.length-1;i>=0;--i){const r=w1[i];if(r.test&&r.test(n,t))return new r(n,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class ls{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,t,i,r,s,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:u,items:d}=this;this._aliasCount++;for(let f=0,p=d.length;f<p;f++)d[f][u](e,t,i,r,s,o,a,l);return d===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return t!==-1&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(ls.prototype,{dispatch:{value:ls.prototype.emit},run:{value:ls.prototype.emit}});class Zd{constructor(e=0,t=0){this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new ls("setRealSize"),this.onUpdate=new ls("update"),this.onError=new ls("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,t,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,t){return!1}}class A0 extends Zd{constructor(e,t){const{width:i,height:r}=t||{};if(!i||!r)throw new Error("BufferResource width or height invalid");super(i,r),this.data=e,this.unpackAlignment=t.unpackAlignment??4}upload(e,t,i){const r=e.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,this.unpackAlignment),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ji.UNPACK);const s=t.realWidth,o=t.realHeight;return i.width===s&&i.height===o?r.texSubImage2D(t.target,0,0,0,s,o,t.format,i.type,this.data):(i.width=s,i.height=o,r.texImage2D(t.target,0,i.internalFormat,s,o,0,t.format,i.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const OH={scaleMode:To.NEAREST,alphaMode:ji.NPM},A1=class Wu extends cf{constructor(e=null,t=null){super(),t=Object.assign({},Wu.defaultOptions,t);const{alphaMode:i,mipmap:r,anisotropicLevel:s,scaleMode:o,width:a,height:l,wrapMode:u,format:d,type:f,target:p,resolution:m,resourceOptions:v}=t;e&&!(e instanceof Zd)&&(e=rL(e,v),e.internal=!0),this.resolution=m||Fe.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=r,this.anisotropicLevel=s,this._wrapMode=u,this._scaleMode=o,this.format=d,this.type=f,this.target=p,this.alphaMode=i,this.uid=Yl(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let i;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,i=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,i=!0),i&&this.dirtyStyleId++,this}setSize(e,t,i){return i=i||this.resolution,this.setRealSize(e*i,t*i,i)}setRealSize(e,t,i){return this.resolution=i||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=pC(this.realWidth)&&pC(this.realHeight)}setResolution(e){const t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete na[this.cacheId],delete Ms[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Wu.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,t,i=Fe.STRICT_TEXTURE_CACHE){const r=typeof e=="string";let s=null;if(r)s=e;else{if(!e._pixiId){const a=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${Yl()}`}s=e._pixiId}let o=na[s];if(r&&i&&!o)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return o||(o=new Wu(e,t),o.cacheId=s,Wu.addToCache(o,s)),o}static fromBuffer(e,t,i,r){e=e||new Float32Array(t*i*4);const s=new A0(e,{width:t,height:i,...r==null?void 0:r.resourceOptions});let o,a;return e instanceof Float32Array?(o=Ee.RGBA,a=et.FLOAT):e instanceof Int32Array?(o=Ee.RGBA_INTEGER,a=et.INT):e instanceof Uint32Array?(o=Ee.RGBA_INTEGER,a=et.UNSIGNED_INT):e instanceof Int16Array?(o=Ee.RGBA_INTEGER,a=et.SHORT):e instanceof Uint16Array?(o=Ee.RGBA_INTEGER,a=et.UNSIGNED_SHORT):e instanceof Int8Array?(o=Ee.RGBA,a=et.BYTE):(o=Ee.RGBA,a=et.UNSIGNED_BYTE),s.internal=!0,new Wu(s,Object.assign({},OH,{type:a,format:o},r))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),na[t]&&na[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),na[t]=e)}static removeFromCache(e){if(typeof e=="string"){const t=na[e];if(t){const i=t.textureCacheIds.indexOf(e);return i>-1&&t.textureCacheIds.splice(i,1),delete na[e],t}}else if(e!=null&&e.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete na[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}};A1.defaultOptions={mipmap:Ws.POW2,anisotropicLevel:0,scaleMode:To.LINEAR,wrapMode:Co.CLAMP,alphaMode:ji.UNPACK,target:Sc.TEXTURE_2D,format:Ee.RGBA,type:et.UNSIGNED_BYTE},A1._globalBatch=0;let lt=A1;class M1{constructor(){this.texArray=null,this.blend=0,this.type=is.TRIANGLES,this.start=0,this.size=0,this.data=null}}let BH=0;class Cn{constructor(e,t=!0,i=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=t,this.id=BH++,this.disposeRunner=new ls("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?Hs.ELEMENT_ARRAY_BUFFER:Hs.ARRAY_BUFFER}get index(){return this.type===Hs.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new Cn(e)}}class kg{constructor(e,t=0,i=!1,r=et.FLOAT,s,o,a,l=1){this.buffer=e,this.size=t,this.normalized=i,this.type=r,this.stride=s,this.start=o,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(e,t,i,r,s){return new kg(e,t,i,r,s)}}const kH={Float32Array,Uint32Array,Int32Array,Uint8Array};function zH(n,e){let t=0,i=0;const r={};for(let l=0;l<n.length;l++)i+=e[l],t+=n[l].length;const s=new ArrayBuffer(t*4);let o=null,a=0;for(let l=0;l<n.length;l++){const u=e[l],d=n[l],f=iL(d);r[f]||(r[f]=new kH[f](s)),o=r[f];for(let p=0;p<d.length;p++){const m=(p/u|0)*i+a,v=p%u;o[m+v]=d[p]}a+=u}return new Float32Array(s)}const SC={5126:4,5123:2,5121:1};let GH=0;const HH={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Da{constructor(e=[],t={}){this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=GH++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ls("disposeGeometry"),this.refCount=0}addAttribute(e,t,i=0,r=!1,s,o,a,l=!1){if(!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof Cn||(t instanceof Array&&(t=new Float32Array(t)),t=new Cn(t));const u=e.split("|");if(u.length>1){for(let f=0;f<u.length;f++)this.addAttribute(u[f],t,i,r,s);return this}let d=this.buffers.indexOf(t);return d===-1&&(this.buffers.push(t),d=this.buffers.length-1),this.attributes[e]=new kg(d,i,r,s,o,a,l),this.instanced=this.instanced||l,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof Cn||(e instanceof Array&&(e=new Uint16Array(e)),e=new Cn(e)),e.type=Hs.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],t=[],i=new Cn;let r;for(r in this.attributes){const s=this.attributes[r],o=this.buffers[s.buffer];e.push(o.data),t.push(s.size*SC[s.type]/4),s.buffer=0}for(i.data=zH(e,t),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new Da;for(let t=0;t<this.buffers.length;t++)e.buffers[t]=new Cn(this.buffers[t].data.slice(0));for(const t in this.attributes){const i=this.attributes[t];e.attributes[t]=new kg(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=Hs.ELEMENT_ARRAY_BUFFER),e}static merge(e){const t=new Da,i=[],r=[],s=[];let o;for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)r[l]=r[l]||0,r[l]+=o.buffers[l].data.length,s[l]=0}for(let a=0;a<o.buffers.length;a++)i[a]=new HH[iL(o.buffers[a].data)](r[a]),t.buffers[a]=new Cn(i[a]);for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)i[l].set(o.buffers[l].data,s[l]),s[l]+=o.buffers[l].data.length}if(t.attributes=o.attributes,o.indexBuffer){t.indexBuffer=t.buffers[o.buffers.indexOf(o.indexBuffer)],t.indexBuffer.type=Hs.ELEMENT_ARRAY_BUFFER;let a=0,l=0,u=0,d=0;for(let f=0;f<o.buffers.length;f++)if(o.buffers[f]!==o.indexBuffer){d=f;break}for(const f in o.attributes){const p=o.attributes[f];(p.buffer|0)===d&&(l+=p.size*SC[p.type]/4)}for(let f=0;f<e.length;f++){const p=e[f].indexBuffer.data;for(let m=0;m<p.length;m++)t.indexBuffer.data[m+u]+=a;a+=e[f].buffers[d].data.length/l,u+=p.length}}return t}}class sL extends Da{constructor(e=!1){super(),this._buffer=new Cn(null,e,!1),this._indexBuffer=new Cn(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,et.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,et.FLOAT).addAttribute("aColor",this._buffer,4,!0,et.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,et.FLOAT).addIndex(this._indexBuffer)}}const zg=Math.PI*2,VH=180/Math.PI,WH=Math.PI/180;var di=(n=>(n[n.POLY=0]="POLY",n[n.RECT=1]="RECT",n[n.CIRC=2]="CIRC",n[n.ELIP=3]="ELIP",n[n.RREC=4]="RREC",n))(di||{});class Lt{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new Lt(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}}Lt.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const im=[new Lt,new Lt,new Lt,new Lt];class ut{constructor(e=0,t=0,i=0,r=0){this.x=Number(e),this.y=Number(t),this.width=Number(i),this.height=Number(r),this.type=di.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new ut(0,0,0,0)}clone(){return new ut(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}intersects(e,t){if(!t){const N=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=N)return!1;const C=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>C}const i=this.left,r=this.right,s=this.top,o=this.bottom;if(r<=i||o<=s)return!1;const a=im[0].set(e.left,e.top),l=im[1].set(e.left,e.bottom),u=im[2].set(e.right,e.top),d=im[3].set(e.right,e.bottom);if(u.x<=a.x||l.y<=a.y)return!1;const f=Math.sign(t.a*t.d-t.b*t.c);if(f===0||(t.apply(a,a),t.apply(l,l),t.apply(u,u),t.apply(d,d),Math.max(a.x,l.x,u.x,d.x)<=i||Math.min(a.x,l.x,u.x,d.x)>=r||Math.max(a.y,l.y,u.y,d.y)<=s||Math.min(a.y,l.y,u.y,d.y)>=o))return!1;const p=f*(l.y-a.y),m=f*(a.x-l.x),v=p*i+m*s,x=p*r+m*s,y=p*i+m*o,g=p*r+m*o;if(Math.max(v,x,y,g)<=p*a.x+m*a.y||Math.min(v,x,y,g)>=p*d.x+m*d.y)return!1;const T=f*(a.y-u.y),S=f*(u.x-a.x),w=T*i+S*s,M=T*r+S*s,R=T*i+S*o,P=T*r+S*o;return!(Math.max(w,M,R,P)<=T*a.x+S*a.y||Math.min(w,M,R,P)>=T*d.x+S*d.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this}fit(e){const t=Math.max(this.x,e.x),i=Math.min(this.x+this.width,e.x+e.width),r=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(i-t,0),this.y=r,this.height=Math.max(s-r,0),this}ceil(e=1,t=.001){const i=Math.ceil((this.x+this.width-t)*e)/e,r=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=i-this.x,this.height=r-this.y,this}enlarge(e){const t=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),r=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=i-t,this.y=r,this.height=s-r,this}}ut.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class M0{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.radius=i,this.type=di.CIRC}clone(){return new M0(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;const i=this.radius*this.radius;let r=this.x-e,s=this.y-t;return r*=r,s*=s,r+s<=i}getBounds(){return new ut(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}M0.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class C0{constructor(e=0,t=0,i=0,r=0){this.x=e,this.y=t,this.width=i,this.height=r,this.type=di.ELIP}clone(){return new C0(this.x,this.y,this.width,this.height)}contains(e,t){if(this.width<=0||this.height<=0)return!1;let i=(e-this.x)/this.width,r=(t-this.y)/this.height;return i*=i,r*=r,i+r<=1}getBounds(){return new ut(this.x-this.width,this.y-this.height,this.width,this.height)}}C0.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Ul{constructor(...e){let t=Array.isArray(e[0])?e[0]:e;if(typeof t[0]!="number"){const i=[];for(let r=0,s=t.length;r<s;r++)i.push(t[r].x,t[r].y);t=i}this.points=t,this.type=di.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),t=new Ul(e);return t.closeStroke=this.closeStroke,t}contains(e,t){let i=!1;const r=this.points.length/2;for(let s=0,o=r-1;s<r;o=s++){const a=this.points[s*2],l=this.points[s*2+1],u=this.points[o*2],d=this.points[o*2+1];l>t!=d>t&&e<(u-a)*((t-l)/(d-l))+a&&(i=!i)}return i}}Ul.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((n,e)=>`${n}, ${e}`,"")}]`};class R0{constructor(e=0,t=0,i=0,r=0,s=20){this.x=e,this.y=t,this.width=i,this.height=r,this.radius=s,this.type=di.RREC}clone(){return new R0(this.x,this.y,this.width,this.height,this.radius)}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+i&&t<=this.y+this.height-i||e>=this.x+i&&e<=this.x+this.width-i)return!0;let r=e-(this.x+i),s=t-(this.y+i);const o=i*i;if(r*r+s*s<=o||(r=e-(this.x+this.width-i),r*r+s*s<=o)||(s=t-(this.y+this.height-i),r*r+s*s<=o)||(r=e-(this.x+i),r*r+s*s<=o))return!0}return!1}}R0.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class an{constructor(e=1,t=0,i=0,r=1,s=0,o=0){this.array=null,this.a=e,this.b=t,this.c=i,this.d=r,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,i,r,s,o){return this.a=e,this.b=t,this.c=i,this.d=r,this.tx=s,this.ty=o,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const i=t||this.array;return e?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(e,t){t=t||new Lt;const i=e.x,r=e.y;return t.x=this.a*i+this.c*r+this.tx,t.y=this.b*i+this.d*r+this.ty,t}applyInverse(e,t){t=t||new Lt;const i=1/(this.a*this.d+this.c*-this.b),r=e.x,s=e.y;return t.x=this.d*i*r+-this.c*i*s+(this.ty*this.c-this.tx*this.d)*i,t.y=this.a*i*s+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),r=this.a,s=this.c,o=this.tx;return this.a=r*t-this.b*i,this.b=r*i+this.b*t,this.c=s*t-this.d*i,this.d=s*i+this.d*t,this.tx=o*t-this.ty*i,this.ty=o*i+this.ty*t,this}append(e){const t=this.a,i=this.b,r=this.c,s=this.d;return this.a=e.a*t+e.b*r,this.b=e.a*i+e.b*s,this.c=e.c*t+e.d*r,this.d=e.c*i+e.d*s,this.tx=e.tx*t+e.ty*r+this.tx,this.ty=e.tx*i+e.ty*s+this.ty,this}setTransform(e,t,i,r,s,o,a,l,u){return this.a=Math.cos(a+u)*s,this.b=Math.sin(a+u)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(i*this.a+r*this.c),this.ty=t-(i*this.b+r*this.d),this}prepend(e){const t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const i=this.a,r=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=r*e.a+this.d*e.c,this.d=r*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,i=this.b,r=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-r,s),l=Math.atan2(i,t),u=Math.abs(a+l);return u<1e-5||Math.abs(zg-u)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(t*t+i*i),e.scale.y=Math.sqrt(r*r+s*s),e.position.x=this.tx+(o.x*t+o.y*r),e.position.y=this.ty+(o.x*i+o.y*s),e}invert(){const e=this.a,t=this.b,i=this.c,r=this.d,s=this.tx,o=e*r-t*i;return this.a=r/o,this.b=-t/o,this.c=-i/o,this.d=e/o,this.tx=(i*this.ty-r*s)/o,this.ty=-(e*this.ty-t*s)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new an;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new an}static get TEMP_MATRIX(){return new an}}an.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const cl=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],hl=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],dl=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],fl=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],C1=[],oL=[],rm=Math.sign;function XH(){for(let n=0;n<16;n++){const e=[];C1.push(e);for(let t=0;t<16;t++){const i=rm(cl[n]*cl[t]+dl[n]*hl[t]),r=rm(hl[n]*cl[t]+fl[n]*hl[t]),s=rm(cl[n]*dl[t]+dl[n]*fl[t]),o=rm(hl[n]*dl[t]+fl[n]*fl[t]);for(let a=0;a<16;a++)if(cl[a]===i&&hl[a]===r&&dl[a]===s&&fl[a]===o){e.push(a);break}}}for(let n=0;n<16;n++){const e=new an;e.set(cl[n],hl[n],dl[n],fl[n],0,0),oL.push(e)}}XH();const pn={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:n=>cl[n],uY:n=>hl[n],vX:n=>dl[n],vY:n=>fl[n],inv:n=>n&8?n&15:-n&7,add:(n,e)=>C1[n][e],sub:(n,e)=>C1[n][pn.inv(e)],rotate180:n=>n^4,isVertical:n=>(n&3)===2,byDirection:(n,e)=>Math.abs(n)*2<=Math.abs(e)?e>=0?pn.S:pn.N:Math.abs(e)*2<=Math.abs(n)?n>0?pn.E:pn.W:e>0?n>0?pn.SE:pn.SW:n>0?pn.NE:pn.NW,matrixAppendRotationInv:(n,e,t=0,i=0)=>{const r=oL[pn.inv(e)];r.tx=t,r.ty=i,n.append(r)}};class Os{constructor(e,t,i=0,r=0){this._x=i,this._y=r,this.cb=e,this.scope=t}clone(e=this.cb,t=this.scope){return new Os(e,t,this._x,this._y)}set(e=0,t=e){return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}Os.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const R1=class{constructor(){this.worldTransform=new an,this.localTransform=new an,this.position=new Os(this.onChange,this,0,0),this.scale=new Os(this.onChange,this,1,1),this.pivot=new Os(this.onChange,this,0,0),this.skew=new Os(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const n=this.localTransform;this._localID!==this._currentLocalID&&(n.a=this._cx*this.scale.x,n.b=this._sx*this.scale.x,n.c=this._cy*this.scale.y,n.d=this._sy*this.scale.y,n.tx=this.position.x-(this.pivot.x*n.a+this.pivot.y*n.c),n.ty=this.position.y-(this.pivot.x*n.b+this.pivot.y*n.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(n){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==n._worldID){const t=n.worldTransform,i=this.worldTransform;i.a=e.a*t.a+e.b*t.c,i.b=e.a*t.b+e.b*t.d,i.c=e.c*t.a+e.d*t.c,i.d=e.c*t.b+e.d*t.d,i.tx=e.tx*t.a+e.ty*t.c+t.tx,i.ty=e.tx*t.b+e.ty*t.d+t.ty,this._parentID=n._worldID,this._worldID++}}setFromMatrix(n){n.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(n){this._rotation!==n&&(this._rotation=n,this.updateSkew())}};R1.IDENTITY=new R1;let P0=R1;P0.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var jH=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,$H=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function EC(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}function My(n){const e=new Array(n);for(let t=0;t<e.length;t++)e[t]=!1;return e}function aL(n,e){switch(n){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return My(2*e);case"bvec3":return My(3*e);case"bvec4":return My(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const wc=[{test:n=>n.type==="float"&&n.size===1&&!n.isArray,code:n=>`
            if(uv["${n}"] !== ud["${n}"].value)
            {
                ud["${n}"].value = uv["${n}"]
                gl.uniform1f(ud["${n}"].location, uv["${n}"])
            }
            `},{test:(n,e)=>(n.type==="sampler2D"||n.type==="samplerCube"||n.type==="sampler2DArray")&&n.size===1&&!n.isArray&&(e==null||e.castToBaseTexture!==void 0),code:n=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${n}"], t);

            if(ud["${n}"].value !== t)
            {
                ud["${n}"].value = t;
                gl.uniform1i(ud["${n}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(n,e)=>n.type==="mat3"&&n.size===1&&!n.isArray&&e.a!==void 0,code:n=>`
            gl.uniformMatrix3fv(ud["${n}"].location, false, uv["${n}"].toArray(true));
            `,codeUbo:n=>`
                var ${n}_matrix = uv.${n}.toArray(true);

                data[offset] = ${n}_matrix[0];
                data[offset+1] = ${n}_matrix[1];
                data[offset+2] = ${n}_matrix[2];
        
                data[offset + 4] = ${n}_matrix[3];
                data[offset + 5] = ${n}_matrix[4];
                data[offset + 6] = ${n}_matrix[5];
        
                data[offset + 8] = ${n}_matrix[6];
                data[offset + 9] = ${n}_matrix[7];
                data[offset + 10] = ${n}_matrix[8];
            `},{test:(n,e)=>n.type==="vec2"&&n.size===1&&!n.isArray&&e.x!==void 0,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${n}"].location, v.x, v.y);
                }`,codeUbo:n=>`
                v = uv.${n};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:n=>n.type==="vec2"&&n.size===1&&!n.isArray,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${n}"].location, v[0], v[1]);
                }
            `},{test:(n,e)=>n.type==="vec4"&&n.size===1&&!n.isArray&&e.width!==void 0,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${n}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:n=>`
                    v = uv.${n};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(n,e)=>n.type==="vec4"&&n.size===1&&!n.isArray&&e.red!==void 0,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${n}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:n=>`
                    v = uv.${n};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(n,e)=>n.type==="vec3"&&n.size===1&&!n.isArray&&e.red!==void 0,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${n}"].location, v.red, v.green, v.blue)
                }`,codeUbo:n=>`
                    v = uv.${n};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:n=>n.type==="vec4"&&n.size===1&&!n.isArray,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${n}"].location, v[0], v[1], v[2], v[3])
                }`}],YH={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},qH={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function KH(n,e){var i;const t=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const r in n.uniforms){const s=e[r];if(!s){((i=n.uniforms[r])==null?void 0:i.group)===!0&&(n.uniforms[r].ubo?t.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):t.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `));continue}const o=n.uniforms[r];let a=!1;for(let l=0;l<wc.length;l++)if(wc[l].test(s,o)){t.push(wc[l].code(r,o)),a=!0;break}if(!a){const l=(s.size===1&&!s.isArray?YH:qH)[s.type].replace("location",`ud["${r}"].location`);t.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",t.join(`
`))}const lL={};let ku=lL;function ZH(){if(ku===lL||ku!=null&&ku.isContextLost()){const n=Fe.ADAPTER.createCanvas();let e;Fe.PREFER_ENV>=Zl.WEBGL2&&(e=n.getContext("webgl2",{})),e||(e=n.getContext("webgl",{})||n.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),ku=e}return ku}let sm;function QH(){if(!sm){sm=Ur.MEDIUM;const n=ZH();if(n&&n.getShaderPrecisionFormat){const e=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT);e&&(sm=e.precision?Ur.HIGH:Ur.MEDIUM)}}return sm}function TC(n,e){const t=n.getShaderSource(e).split(`
`).map((u,d)=>`${d}: ${u}`),i=n.getShaderInfoLog(e),r=i.split(`
`),s={},o=r.map(u=>parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(u=>u&&!s[u]?(s[u]=!0,!0):!1),a=[""];o.forEach(u=>{t[u-1]=`%c${t[u-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=t.join(`
`);a[0]=l,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function JH(n,e,t,i){n.getProgramParameter(e,n.LINK_STATUS)||(n.getShaderParameter(t,n.COMPILE_STATUS)||TC(n,t),n.getShaderParameter(i,n.COMPILE_STATUS)||TC(n,i),console.error("PixiJS Error: Could not initialize shader."),n.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",n.getProgramInfoLog(e)))}const e7={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function uL(n){return e7[n]}let om=null;const bC={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function cL(n,e){if(!om){const t=Object.keys(bC);om={};for(let i=0;i<t.length;++i){const r=t[i];om[n[r]]=bC[r]}}return om[e]}function wC(n,e,t){if(n.substring(0,9)!=="precision"){let i=e;return e===Ur.HIGH&&t!==Ur.HIGH&&(i=Ur.MEDIUM),`precision ${i} float;
${n}`}else if(t!==Ur.HIGH&&n.substring(0,15)==="precision highp")return n.replace("precision highp","precision mediump");return n}let Vh;function t7(){if(typeof Vh=="boolean")return Vh;try{Vh=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Vh=!1}return Vh}let n7=0;const am={},P1=class Xu{constructor(e,t,i="pixi-shader",r={}){this.extra={},this.id=n7++,this.vertexSrc=e||Xu.defaultVertexSrc,this.fragmentSrc=t||Xu.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=r,this.vertexSrc.substring(0,8)!=="#version"&&(i=i.replace(/\s+/g,"-"),am[i]?(am[i]++,i+=`-${am[i]}`):am[i]=1,this.vertexSrc=`#define SHADER_NAME ${i}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${i}
${this.fragmentSrc}`,this.vertexSrc=wC(this.vertexSrc,Xu.defaultVertexPrecision,Ur.HIGH),this.fragmentSrc=wC(this.fragmentSrc,Xu.defaultFragmentPrecision,QH())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return $H}static get defaultFragmentSrc(){return jH}static from(e,t,i){const r=e+t;let s=_C[r];return s||(_C[r]=s=new Xu(e,t,i)),s}};P1.defaultVertexPrecision=Ur.HIGH,P1.defaultFragmentPrecision=bo.apple.device?Ur.HIGH:Ur.MEDIUM;let wo=P1,i7=0;class us{constructor(e,t,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=i7++,this.static=!!t,this.ubo=!!i,e instanceof Cn?(this.buffer=e,this.buffer.type=Hs.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new Cn(new Float32Array(1)),this.buffer.type=Hs.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,t,i){if(!this.ubo)this.uniforms[e]=new us(t,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,t,i){return new us(e,t,i)}static uboFrom(e,t){return new us(e,t??!0,!0)}}class Vs{constructor(e,t){this.uniformBindCount=0,this.program=e,t?t instanceof us?this.uniformGroup=t:this.uniformGroup=new us(t):this.uniformGroup=new us({}),this.disposeRunner=new ls("disposeShader")}checkUniformExists(e,t){if(t.uniforms[e])return!0;for(const i in t.uniforms){const r=t.uniforms[i];if(r.group===!0&&this.checkUniformExists(e,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,t,i){const r=wo.from(e,t);return new Vs(r,i)}}class r7{constructor(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},!t.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!t.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const i=new Int32Array(e);for(let s=0;s<e;s++)i[s]=s;this.defaultGroupCache[e]=us.from({uSamplers:i},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${e}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new wo(this.vertexSrc,r)}const t={tint:new Float32Array([1,1,1,1]),translationMatrix:new an,default:this.defaultGroupCache[e]};return new Vs(this.programCache[e],t)}generateSampleSrc(e){let t="";t+=`
`,t+=`
`;for(let i=0;i<e;i++)i>0&&(t+=`
else `),i<e-1&&(t+=`if(vTextureId < ${i}.5)`),t+=`
{`,t+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,t+=`
}`;return t+=`
`,t+=`
`,t}}class I1{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function s7(){return!bo.apple.device}function o7(n){let e=!0;const t=Fe.ADAPTER.getNavigator();if(bo.tablet||bo.phone){if(bo.apple.device){const i=t.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(e=!1)}if(bo.android.device){const i=t.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(e=!1)}}return e?n:4}class I0{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var a7=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,l7=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const Qh=class Kr extends I0{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=sL,this.vertexSize=6,this.state=Ks.for2d(),this.size=Kr.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??o7(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??s7(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return Rt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return l7}static get defaultFragmentTemplate(){return a7}setShaderGenerator({vertex:e=Kr.defaultVertexSrc,fragment:t=Kr.defaultFragmentTemplate}={}){this.shaderGenerator=new r7(e,t)}contextChange(){const e=this.renderer.gl;Fe.PREFER_ENV===Zl.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),Kr.defaultMaxTextures),this.maxTextures=FH(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:t}=Kr,i=this.size/4,r=Math.floor(i/this.maxTextures)+1;for(;e.length<i;)e.push(new M1);for(;t.length<r;)t.push(new I1);for(let s=0;s<this.maxTextures;s++)this._tempBoundTextures[s]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:t}=this,i=Kr._textureArrayPool,r=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++lt._globalBatch,l=0,u=i[0],d=0;r.copyBoundTextures(s,t);for(let f=0;f<this._bufferSize;++f){const p=e[f];e[f]=null,p._batchEnabled!==a&&(u.count>=t&&(r.boundArray(u,s,a,t),this.buildDrawCalls(u,d,f),d=f,u=i[++l],++a),p._batchEnabled=a,p.touched=o,u.elements[u.count++]=p)}u.count>0&&(r.boundArray(u,s,a,t),this.buildDrawCalls(u,d,this._bufferSize),++l,++a);for(let f=0;f<s.length;f++)s[f]=null;lt._globalBatch=a}buildDrawCalls(e,t,i){const{_bufferedElements:r,_attributeBuffer:s,_indexBuffer:o,vertexSize:a}=this,l=Kr._drawCallPool;let u=this._dcIndex,d=this._aIndex,f=this._iIndex,p=l[u];p.start=this._iIndex,p.texArray=e;for(let m=t;m<i;++m){const v=r[m],x=v._texture.baseTexture,y=tL[x.alphaMode?1:0][v.blendMode];r[m]=null,t<m&&p.blend!==y&&(p.size=f-p.start,t=m,p=l[++u],p.texArray=e,p.start=f),this.packInterleavedGeometry(v,s,o,d,f),d+=v.vertexData.length/2*a,f+=v.indices.length,p.blend=y}t<i&&(p.size=f-p.start,++u),this._dcIndex=u,this._aIndex=d,this._iIndex=f}bindAndClearTexArray(e){const t=this.renderer.texture;for(let i=0;i<e.count;i++)t.bind(e.elements[i],e.ids[i]),e.elements[i]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:t,_indexBuffer:i}=this;Kr.canUploadSameBuffer?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:t,state:i}=this.renderer,r=Kr._drawCallPool;let s=null;for(let o=0;o<e;o++){const{texArray:a,type:l,size:u,start:d,blend:f}=r[o];s!==a&&(s=a,this.bindAndClearTexArray(a)),this.state.blendMode=f,i.set(this.state),t.drawElements(l,u,t.UNSIGNED_SHORT,d*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Kr.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const t=Bg(Math.ceil(e/8)),i=mC(t),r=t*8;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);let s=this._aBuffers[r];return s||(this._aBuffers[r]=s=new b1(r*this.vertexSize*4)),s}getIndexBuffer(e){const t=Bg(Math.ceil(e/12)),i=mC(t),r=t*12;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);let s=this._iBuffers[i];return s||(this._iBuffers[i]=s=new Uint16Array(r)),s}packInterleavedGeometry(e,t,i,r,s){const{uint32View:o,float32View:a}=t,l=r/this.vertexSize,u=e.uvs,d=e.indices,f=e.vertexData,p=e._texture.baseTexture._batchLocation,m=Math.min(e.worldAlpha,1),v=Jt.shared.setValue(e._tintRGB).toPremultiplied(m,e._texture.baseTexture.alphaMode>0);for(let x=0;x<f.length;x+=2)a[r++]=f[x],a[r++]=f[x+1],a[r++]=u[x],a[r++]=u[x+1],o[r++]=v,a[r++]=p;for(let x=0;x<d.length;x++)i[s++]=l+d[x]}};Qh.defaultBatchSize=4096,Qh.extension={name:"batch",type:Ne.RendererPlugin},Qh._drawCallPool=[],Qh._textureArrayPool=[];let pl=Qh;$e.add(pl);var u7=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,c7=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const L1=class Jh extends Vs{constructor(e,t,i){const r=wo.from(e||Jh.defaultVertexSrc,t||Jh.defaultFragmentSrc);super(r,i),this.padding=0,this.resolution=Jh.defaultResolution,this.multisample=Jh.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Ks}apply(e,t,i,r,s){e.applyFilter(this,t,i,r)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return c7}static get defaultFragmentSrc(){return u7}};L1.defaultResolution=1,L1.defaultMultisample=Dn.NONE;let Ni=L1;class Gg{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Jt(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:t,background:i,backgroundAlpha:r}=e,s=i??t;s!==void 0&&(this.color=s),this.alpha=r}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}Gg.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Gg.extension={type:[Ne.RendererSystem,Ne.CanvasRendererSystem],name:"background"};$e.add(Gg);class hL{constructor(e){this.renderer=e,this.emptyRenderer=new I0(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,t){const{boundTextures:i}=this.renderer.texture;for(let r=t-1;r>=0;--r)e[r]=i[r]||null,e[r]&&(e[r]._batchLocation=r)}boundArray(e,t,i,r){const{elements:s,ids:o,count:a}=e;let l=0;for(let u=0;u<a;u++){const d=s[u],f=d._batchLocation;if(f>=0&&f<r&&t[f]===d){o[u]=f;continue}for(;l<r;){const p=t[l];if(p&&p._batchEnabled===i&&p._batchLocation===l){l++;continue}o[u]=l,d._batchLocation=l,t[l]=d;break}}}destroy(){this.renderer=null}}hL.extension={type:Ne.RendererSystem,name:"batch"};$e.add(hL);let AC=0;class Hg{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=AC++}init(e){if(e.context)this.initFromContext(e.context);else{const t=this.renderer.background.alpha<1,i=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:t,premultipliedAlpha:i,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=AC++,this.renderer.runners.contextChange.emit(e);const t=this.renderer.view;t.addEventListener!==void 0&&(t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const t=this.createContext(this.renderer.view,e);this.initFromContext(t)}createContext(e,t){let i;if(Fe.PREFER_ENV>=Zl.WEBGL2&&(i=e.getContext("webgl2",t)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,t={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const t=e.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),t&&!t.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=i||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Hg.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},Hg.extension={type:Ne.RendererSystem,name:"context"};$e.add(Hg);class D1{constructor(e,t){if(this.width=Math.round(e),this.height=Math.round(t),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ls("disposeFramebuffer"),this.multisample=Dn.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,t){return this.colorTextures[e]=t||new lt(null,{scaleMode:To.NEAREST,resolution:1,mipmap:Ws.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new lt(null,{scaleMode:To.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Ws.OFF,format:Ee.DEPTH_COMPONENT,type:et.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,t){if(e=Math.round(e),t=Math.round(t),!e||!t)throw new Error("Framebuffer width and height must not be zero");if(!(e===this.width&&t===this.height)){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){const r=this.colorTextures[i],s=r.resolution;r.setSize(e/s,t/s)}if(this.depthTexture){const i=this.depthTexture.resolution;this.depthTexture.setSize(e/i,t/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class dL extends lt{constructor(e={}){if(typeof e=="number"){const t=arguments[0],i=arguments[1],r=arguments[2],s=arguments[3];e={width:t,height:i,scaleMode:r,resolution:s}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=Dn.NONE),super(null,e),this.mipmap=Ws.OFF,this.valid=!0,this._clear=new Jt([0,0,0,0]),this.framebuffer=new D1(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t){this.framebuffer.resize(e*this.resolution,t*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Na extends Zd{constructor(e){const t=e,i=t.naturalWidth||t.videoWidth||t.width,r=t.naturalHeight||t.videoHeight||t.height;super(i,r),this.source=e,this.noSubImage=!1}static crossOrigin(e,t,i){i===void 0&&!t.startsWith("data:")?e.crossOrigin=DH(t):i!==!1&&(e.crossOrigin=typeof i=="string"?i:"anonymous")}upload(e,t,i,r){const s=e.gl,o=t.realWidth,a=t.realHeight;if(r=r||this.source,typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement){if(!r.complete||r.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ji.UNPACK),!this.noSubImage&&t.target===s.TEXTURE_2D&&i.width===o&&i.height===a?s.texSubImage2D(s.TEXTURE_2D,0,0,0,t.format,i.type,r):(i.width=o,i.height=a,s.texImage2D(t.target,0,i.internalFormat,t.format,i.type,r)),!0}update(){if(this.destroyed)return;const e=this.source,t=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;this.resize(t,i),super.update()}dispose(){this.source=null}}class fL extends Na{constructor(e,t){if(t=t||{},typeof e=="string"){const i=new Image;Na.crossOrigin(i,e,t.crossorigin),i.src=e,e=i}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(t.createBitmap??Fe.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof t.alphaMode=="number"?t.alphaMode:null,this.bitmap=null,this._load=null,t.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((t,i)=>{const r=this.source;this.url=r.src;const s=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.update(),this._load=null,this.createBitmap?t(this.process()):t(this))};r.complete&&r.src?s():(r.onload=s,r.onerror=o=>{i(o),this.onError.emit(o)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const t=globalThis.createImageBitmap,i=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:i?"cors":"no-cors"}).then(r=>r.blob()).then(r=>t(r,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ji.UNPACK?"premultiply":"none"})).then(r=>this.destroyed?Promise.reject():(this.bitmap=r,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,t,i){if(typeof this.alphaMode=="number"&&(t.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,t,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,t,i,this.bitmap),!this.preserveBitmap){let r=!0;const s=t._glTextures;for(const o in s){const a=s[o];if(a!==i&&a.dirtyId!==t.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class CE{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,t,i){const r=t.width,s=t.height;if(i){const o=e.width/2/r,a=e.height/2/s,l=e.x/r+o,u=e.y/s+a;i=pn.add(i,pn.NW),this.x0=l+o*pn.uX(i),this.y0=u+a*pn.uY(i),i=pn.add(i,2),this.x1=l+o*pn.uX(i),this.y1=u+a*pn.uY(i),i=pn.add(i,2),this.x2=l+o*pn.uX(i),this.y2=u+a*pn.uY(i),i=pn.add(i,2),this.x3=l+o*pn.uX(i),this.y3=u+a*pn.uY(i)}else this.x0=e.x/r,this.y0=e.y/s,this.x1=(e.x+e.width)/r,this.y1=e.y/s,this.x2=(e.x+e.width)/r,this.y2=(e.y+e.height)/s,this.x3=e.x/r,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}CE.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const MC=new CE;function lm(n){n.destroy=function(){},n.on=function(){},n.once=function(){},n.emit=function(){}}class Pe extends cf{constructor(e,t,i,r,s,o,a){if(super(),this.noFrame=!1,t||(this.noFrame=!0,t=new ut(0,0,1,1)),e instanceof Pe&&(e=e.baseTexture),this.baseTexture=e,this._frame=t,this.trim=r,this.valid=!1,this.destroyed=!1,this._uvs=MC,this.uvMatrix=null,this.orig=i||t,this._rotate=Number(s||0),s===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new Lt(o.x,o.y):new Lt(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=t:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:t}=this.baseTexture;t!=null&&t.url&&Ms[t.url]&&Pe.removeFromCache(t.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Pe.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var r;const e=this._frame.clone(),t=this._frame===this.orig?e:this.orig.clone(),i=new Pe(this.baseTexture,!this.noFrame&&e,t,(r=this.trim)==null?void 0:r.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=e),i}updateUvs(){this._uvs===MC&&(this._uvs=new CE),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,t={},i=Fe.STRICT_TEXTURE_CACHE){const r=typeof e=="string";let s=null;if(r)s=e;else if(e instanceof lt){if(!e.cacheId){const a=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e.cacheId=`${a}-${Yl()}`,lt.addToCache(e,e.cacheId)}s=e.cacheId}else{if(!e._pixiId){const a=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${Yl()}`}s=e._pixiId}let o=Ms[s];if(r&&i&&!o)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return!o&&!(e instanceof lt)?(t.resolution||(t.resolution=Uo(e)),o=new Pe(new lt(e,t)),o.baseTexture.cacheId=s,lt.addToCache(o.baseTexture,s),Pe.addToCache(o,s)):!o&&e instanceof lt&&(o=new Pe(e),Pe.addToCache(o,s)),o}static fromURL(e,t){const i=Object.assign({autoLoad:!1},t==null?void 0:t.resourceOptions),r=Pe.from(e,Object.assign({resourceOptions:i},t),!1),s=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):s.load().then(()=>Promise.resolve(r))}static fromBuffer(e,t,i,r){return new Pe(lt.fromBuffer(e,t,i,r))}static fromLoader(e,t,i,r){const s=new lt(e,Object.assign({scaleMode:lt.defaultOptions.scaleMode,resolution:Uo(t)},r)),{resource:o}=s;o instanceof fL&&(o.url=t);const a=new Pe(s);return i||(i=t),lt.addToCache(a.baseTexture,i),Pe.addToCache(a,i),i!==t&&(lt.addToCache(a.baseTexture,t),Pe.addToCache(a,t)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),Ms[t]&&Ms[t]!==e&&console.warn(`Texture added to the cache with an id [${t}] that already had an entry`),Ms[t]=e)}static removeFromCache(e){if(typeof e=="string"){const t=Ms[e];if(t){const i=t.textureCacheIds.indexOf(e);return i>-1&&t.textureCacheIds.splice(i,1),delete Ms[e],t}}else if(e!=null&&e.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)Ms[e.textureCacheIds[t]]===e&&delete Ms[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:t,y:i,width:r,height:s}=e,o=t+r>this.baseTexture.width,a=i+s>this.baseTexture.height;if(o||a){const l=o&&a?"and":"or",u=`X: ${t} + ${r} = ${t+r} > ${this.baseTexture.width}`,d=`Y: ${i} + ${s} = ${i+s} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${u} ${l} ${d}`)}this.valid=r&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return Pe._EMPTY||(Pe._EMPTY=new Pe(new lt),lm(Pe._EMPTY),lm(Pe._EMPTY.baseTexture)),Pe._EMPTY}static get WHITE(){if(!Pe._WHITE){const e=Fe.ADAPTER.createCanvas(16,16),t=e.getContext("2d");e.width=16,e.height=16,t.fillStyle="white",t.fillRect(0,0,16,16),Pe._WHITE=new Pe(lt.from(e)),lm(Pe._WHITE),lm(Pe._WHITE.baseTexture)}return Pe._WHITE}}class Jl extends Pe{constructor(e,t){super(e,t),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t,i=!0){const r=this.baseTexture.resolution,s=Math.round(e*r)/r,o=Math.round(t*r)/r;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,i&&this.baseTexture.resize(s,o),this.updateUvs()}setResolution(e){const{baseTexture:t}=this;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))}static create(e){return new Jl(new dL(e))}}class pL{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,t,i=Dn.NONE){const r=new dL(Object.assign({width:e,height:t,resolution:1,multisample:i},this.textureOptions));return new Jl(r)}getOptimalTexture(e,t,i=1,r=Dn.NONE){let s;e=Math.max(Math.ceil(e*i-1e-6),1),t=Math.max(Math.ceil(t*i-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||t!==this._pixelsHeight?(e=Bg(e),t=Bg(t),s=((e&65535)<<16|t&65535)>>>0,r>1&&(s+=r*4294967296)):s=r>1?-r:-1,this.texturePool[s]||(this.texturePool[s]=[]);let o=this.texturePool[s].pop();return o||(o=this.createTexture(e,t,r)),o.filterPoolKey=s,o.setResolution(i),o}getFilterTexture(e,t,i){const r=this.getOptimalTexture(e.width,e.height,t||e.resolution,i||Dn.NONE);return r.filterFrame=e.filterFrame,r}returnTexture(e){const t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const t in this.texturePool){const i=this.texturePool[t];if(i)for(let r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const t in this.texturePool){if(!(Number(t)<0))continue;const i=this.texturePool[t];if(i)for(let r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}pL.SCREEN_KEY=-1;class h7 extends Da{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class mL extends Da{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Cn(this.vertices),this.uvBuffer=new Cn(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,t){let i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,this.uvs[2]=i+t.width/e.width,this.uvs[3]=r,this.uvs[4]=i+t.width/e.width,this.uvs[5]=r+t.height/e.height,this.uvs[6]=i,this.uvs[7]=r+t.height/e.height,i=t.x,r=t.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+t.width,this.vertices[3]=r,this.vertices[4]=i+t.width,this.vertices[5]=r+t.height,this.vertices[6]=i,this.vertices[7]=r+t.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class d7{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Dn.NONE,this.sourceFrame=new ut,this.destinationFrame=new ut,this.bindingSourceFrame=new ut,this.bindingDestinationFrame=new ut,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const um=[new Lt,new Lt,new Lt,new Lt],Cy=new an;class gL{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new pL,this.statePool=[],this.quad=new h7,this.quadUv=new mL,this.tempRect=new ut,this.activeState={},this.globalUniforms=new us({outputFrame:new ut,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,t){const i=this.renderer,r=this.defaultFilterStack,s=this.statePool.pop()||new d7,o=i.renderTexture;let a,l;if(o.current){const y=o.current;a=y.resolution,l=y.multisample}else a=i.resolution,l=i.multisample;let u=t[0].resolution||a,d=t[0].multisample??l,f=t[0].padding,p=t[0].autoFit,m=t[0].legacy??!0;for(let y=1;y<t.length;y++){const g=t[y];u=Math.min(u,g.resolution||a),d=Math.min(d,g.multisample??l),f=this.useMaxPadding?Math.max(f,g.padding):f+g.padding,p=p&&g.autoFit,m=m||(g.legacy??!0)}r.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),r.push(s),s.resolution=u,s.multisample=d,s.legacy=m,s.target=e,s.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),s.sourceFrame.pad(f);const v=this.tempRect.copyFrom(o.sourceFrame);i.projection.transform&&this.transformAABB(Cy.copyFrom(i.projection.transform).invert(),v),p?(s.sourceFrame.fit(v),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(v)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,o.current?o.current.resolution:i.resolution,o.sourceFrame,o.destinationFrame,i.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,u,d),s.filters=t,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;const x=this.tempRect;x.x=0,x.y=0,x.width=s.sourceFrame.width,x.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=i.projection.transform,i.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,x),i.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,t=e.pop(),i=t.filters;this.activeState=t;const r=this.globalUniforms.uniforms;r.outputFrame=t.sourceFrame,r.resolution=t.resolution;const s=r.inputSize,o=r.inputPixel,a=r.inputClamp;if(s[0]=t.destinationFrame.width,s[1]=t.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*t.resolution),o[1]=Math.round(s[1]*t.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=t.sourceFrame.width*s[2]-.5*o[2],a[3]=t.sourceFrame.height*s[3]-.5*o[3],t.legacy){const u=r.filterArea;u[0]=t.destinationFrame.width,u[1]=t.destinationFrame.height,u[2]=t.sourceFrame.x,u[3]=t.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const l=e[e.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,t.renderTexture,l.renderTexture,Ls.BLEND,t),this.returnFilterTexture(t.renderTexture);else{let u=t.renderTexture,d=this.getOptimalFilterTexture(u.width,u.height,t.resolution);d.filterFrame=u.filterFrame;let f=0;for(f=0;f<i.length-1;++f){f===1&&t.multisample>1&&(d=this.getOptimalFilterTexture(u.width,u.height,t.resolution),d.filterFrame=u.filterFrame),i[f].apply(this,u,d,Ls.CLEAR,t);const p=u;u=d,d=p}i[f].apply(this,u,l.renderTexture,Ls.BLEND,t),f>1&&t.multisample>1&&this.returnFilterTexture(t.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(d)}t.clear(),this.statePool.push(t)}bindAndClear(e,t=Ls.CLEAR){const{renderTexture:i,state:r}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e==null?void 0:e.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,i.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const s=r.stateId&1||this.forceClear;(t===Ls.CLEAR||t===Ls.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,t,i,r){const s=this.renderer;s.state.set(e.state),this.bindAndClear(i,r),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(t._frame,t.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(is.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(is.TRIANGLE_STRIP))}calculateSpriteMatrix(e,t){const{sourceFrame:i,destinationFrame:r}=this.activeState,{orig:s}=t._texture,o=e.set(r.width,0,0,r.height,i.x,i.y),a=t.worldTransform.copyTo(an.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(t.anchor.x,t.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,t,i=1,r=Dn.NONE){return this.texturePool.getOptimalTexture(e,t,i,r)}getFilterTexture(e,t,i){if(typeof e=="number"){const s=e;e=t,t=s}e=e||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution,i||Dn.NONE);return r.filterFrame=e.filterFrame,r}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,t){const i=um[0],r=um[1],s=um[2],o=um[3];i.set(t.left,t.top),r.set(t.left,t.bottom),s.set(t.right,t.top),o.set(t.right,t.bottom),e.apply(i,i),e.apply(r,r),e.apply(s,s),e.apply(o,o);const a=Math.min(i.x,r.x,s.x,o.x),l=Math.min(i.y,r.y,s.y,o.y),u=Math.max(i.x,r.x,s.x,o.x),d=Math.max(i.y,r.y,s.y,o.y);t.x=a,t.y=l,t.width=u-a,t.height=d-l}roundFrame(e,t,i,r,s){if(!(e.width<=0||e.height<=0||i.width<=0||i.height<=0)){if(s){const{a:o,b:a,c:l,d:u}=s;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(u)>1e-4))return}s=s?Cy.copyFrom(s):Cy.identity(),s.translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.transformAABB(s,e),e.ceil(t),this.transformAABB(s.invert(),e)}}}gL.extension={type:Ne.RendererSystem,name:"filter"};$e.add(gL);class f7{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Dn.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const p7=new ut;class _L{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new D1(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new ut,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let t=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;Fe.PREFER_ENV===Zl.WEBGL_LEGACY&&(t=null,i=null),t?e.drawBuffers=r=>t.drawBuffersWEBGL(r):(this.hasMRT=!1,e.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,t,i=0){const{gl:r}=this;if(e){const s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==i&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=i),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,i)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let o=0;o<e.colorTextures.length;o++){const a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t){const o=t.width>>i,a=t.height>>i,l=o/t.width;this.setViewport(t.x*l,t.y*l,o,a)}else{const o=e.width>>i,a=e.height>>i;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,t,i,r){const s=this.viewport;e=Math.round(e),t=Math.round(t),i=Math.round(i),r=Math.round(r),(s.width!==i||s.height!==r||s.x!==e||s.y!==t)&&(s.x=e,s.y=t,s.width=i,s.height=r,this.gl.viewport(e,t,i,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,t,i,r,s=s1.COLOR|s1.DEPTH){const{gl:o}=this;o.clearColor(e,t,i,r),o.clear(s)}initFramebuffer(e){const{gl:t}=this,i=new f7(t.createFramebuffer());return i.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(e),e.disposeRunner.add(this),i}resizeFramebuffer(e){const{gl:t}=this,i=e.glFramebuffers[this.CONTEXT_UID];if(i.stencil){t.bindRenderbuffer(t.RENDERBUFFER,i.stencil);let o;this.renderer.context.webGLVersion===1?o=t.DEPTH_STENCIL:e.depth&&e.stencil?o=t.DEPTH24_STENCIL8:e.depth?o=t.DEPTH_COMPONENT24:o=t.STENCIL_INDEX8,i.msaaBuffer?t.renderbufferStorageMultisample(t.RENDERBUFFER,i.multisample,o,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,o,e.width,e.height)}const r=e.colorTextures;let s=r.length;t.drawBuffers||(s=Math.min(s,1));for(let o=0;o<s;o++){const a=r[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),o===0&&i.msaaBuffer&&(t.bindRenderbuffer(t.RENDERBUFFER,i.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,i.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,t){const{gl:i}=this,r=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures;let o=s.length;i.drawBuffers||(o=Math.min(o,1)),r.multisample>1&&this.canMultisampleFramebuffer(e)?r.msaaBuffer=r.msaaBuffer||i.createRenderbuffer():r.msaaBuffer&&(i.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const a=[];for(let l=0;l<o;l++){const u=s[l],d=u.parentTextureArray||u;this.renderer.texture.bind(d,0),l===0&&r.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,r.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,d._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,r.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+l,u.target,d._glTextures[this.CONTEXT_UID].texture,t),a.push(i.COLOR_ATTACHMENT0+l))}if(a.length>1&&i.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){const l=e.depthTexture;this.renderer.texture.bind(l,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,t)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){r.stencil=r.stencil||i.createRenderbuffer();let l,u;this.renderer.context.webGLVersion===1?(l=i.DEPTH_STENCIL_ATTACHMENT,u=i.DEPTH_STENCIL):e.depth&&e.stencil?(l=i.DEPTH_STENCIL_ATTACHMENT,u=i.DEPTH24_STENCIL8):e.depth?(l=i.DEPTH_ATTACHMENT,u=i.DEPTH_COMPONENT24):(l=i.STENCIL_ATTACHMENT,u=i.STENCIL_INDEX8),i.bindRenderbuffer(i.RENDERBUFFER,r.stencil),r.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,u,e.width,e.height):i.renderbufferStorage(i.RENDERBUFFER,u,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,l,i.RENDERBUFFER,r.stencil)}else r.stencil&&(i.deleteRenderbuffer(r.stencil),r.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:t}=this;let i=Dn.NONE;if(e<=1||t===null)return i;for(let r=0;r<t.length;r++)if(t[r]<=e){i=t[r];break}return i===1&&(i=Dn.NONE),i}blit(e,t,i){const{current:r,renderer:s,gl:o,CONTEXT_UID:a}=this;if(s.context.webGLVersion!==2||!r)return;const l=r.glFramebuffers[a];if(!l)return;if(!e){if(!l.msaaBuffer)return;const d=r.colorTextures[0];if(!d)return;l.blitFramebuffer||(l.blitFramebuffer=new D1(r.width,r.height),l.blitFramebuffer.addColorTexture(0,d)),e=l.blitFramebuffer,e.colorTextures[0]!==d&&(e.colorTextures[0]=d,e.dirtyId++,e.dirtyFormat++),(e.width!==r.width||e.height!==r.height)&&(e.width=r.width,e.height=r.height,e.dirtyId++,e.dirtySize++)}t||(t=p7,t.width=r.width,t.height=r.height),i||(i=t);const u=t.width===i.width&&t.height===i.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(t.left,t.top,t.right,t.bottom,i.left,i.top,i.right,i.bottom,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,t){const i=e.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!i)return;delete e.glFramebuffers[this.CONTEXT_UID];const s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),t||(r.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&r.deleteRenderbuffer(i.msaaBuffer),i.stencil&&r.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,t)}disposeAll(e){const t=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<t.length;i++)this.disposeFramebuffer(t[i],e)}forceStencil(){const e=this.current;if(!e)return;const t=e.glFramebuffers[this.CONTEXT_UID];if(!t||t.stencil&&e.stencil)return;e.stencil=!0;const i=e.width,r=e.height,s=this.gl,o=t.stencil=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o);let a,l;this.renderer.context.webGLVersion===1?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH_STENCIL):e.depth?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH24_STENCIL8):(a=s.STENCIL_ATTACHMENT,l=s.STENCIL_INDEX8),t.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,t.multisample,l,i,r):s.renderbufferStorage(s.RENDERBUFFER,l,i,r),s.framebufferRenderbuffer(s.FRAMEBUFFER,a,s.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new ut}destroy(){this.renderer=null}}_L.extension={type:Ne.RendererSystem,name:"framebuffer"};$e.add(_L);const Ry={5126:4,5123:2,5121:1};class vL{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,t.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;Fe.PREFER_ENV===Zl.WEBGL_LEGACY&&(i=null),i?(e.createVertexArray=()=>i.createVertexArrayOES(),e.bindVertexArray=r=>i.bindVertexArrayOES(r),e.deleteVertexArray=r=>i.deleteVertexArrayOES(r)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(t.webGLVersion!==2){const i=e.getExtension("ANGLE_instanced_arrays");i?(e.vertexAttribDivisor=(r,s)=>i.vertexAttribDivisorANGLE(r,s),e.drawElementsInstanced=(r,s,o,a,l)=>i.drawElementsInstancedANGLE(r,s,o,a,l),e.drawArraysInstanced=(r,s,o,a)=>i.drawArraysInstancedANGLE(r,s,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=t.webGLVersion===2||!!t.extensions.uint32ElementIndex}bind(e,t){t=t||this.renderer.shader.shader;const{gl:i}=this;let r=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;r||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=r={},s=!0);const o=r[t.program.id]||this.initGeometryVao(e,t,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?i.bindVertexArray(o):this.activateVao(e,t.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,t=this.renderer.buffer;for(let i=0;i<e.buffers.length;i++){const r=e.buffers[i];t.update(r)}}checkCompatibility(e,t){const i=e.attributes,r=t.attributeData;for(const s in r)if(!i[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,t){const i=e.attributes,r=t.attributeData,s=["g",e.id];for(const o in i)r[o]&&s.push(o,r[o].location);return s.join("-")}initGeometryVao(e,t,i=!0){const r=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=t.program;a.glPrograms[s]||this.renderer.shader.generateProgram(t),this.checkCompatibility(e,a);const l=this.getSignature(e,a),u=e.glVertexArrayObjects[this.CONTEXT_UID];let d=u[l];if(d)return u[a.id]=d,d;const f=e.buffers,p=e.attributes,m={},v={};for(const x in f)m[x]=0,v[x]=0;for(const x in p)!p[x].size&&a.attributeData[x]?p[x].size=a.attributeData[x].size:p[x].size||console.warn(`PIXI Geometry attribute '${x}' size cannot be determined (likely the bound shader does not have the attribute)`),m[p[x].buffer]+=p[x].size*Ry[p[x].type];for(const x in p){const y=p[x],g=y.size;y.stride===void 0&&(m[y.buffer]===g*Ry[y.type]?y.stride=0:y.stride=m[y.buffer]),y.start===void 0&&(y.start=v[y.buffer],v[y.buffer]+=g*Ry[y.type])}d=r.createVertexArray(),r.bindVertexArray(d);for(let x=0;x<f.length;x++){const y=f[x];o.bind(y),i&&y._glBuffers[s].refCount++}return this.activateVao(e,a),u[a.id]=d,u[l]=d,r.bindVertexArray(null),o.unbind(Hs.ARRAY_BUFFER),d}disposeGeometry(e,t){var a;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const i=e.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,s=e.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(e.disposeRunner.remove(this),!!i){if(o)for(let l=0;l<s.length;l++){const u=s[l]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!t&&o.dispose(s[l],t))}if(!t){for(const l in i)if(l[0]==="g"){const u=i[l];this._activeVao===u&&this.unbind(),r.deleteVertexArray(u)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const t=Object.keys(this.managedGeometries);for(let i=0;i<t.length;i++)this.disposeGeometry(this.managedGeometries[t[i]],e)}activateVao(e,t){const i=this.gl,r=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);let l=null;for(const u in a){const d=a[u],f=o[d.buffer],p=f._glBuffers[r];if(t.attributeData[u]){l!==p&&(s.bind(f),l=p);const m=t.attributeData[u].location;if(i.enableVertexAttribArray(m),i.vertexAttribPointer(m,d.size,d.type||i.FLOAT,d.normalized,d.stride,d.start),d.instance)if(this.hasInstance)i.vertexAttribDivisor(m,d.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,t,i,r){const{gl:s}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,t||o.indexBuffer.data.length,l,(i||0)*a,r||1):s.drawElements(e,t||o.indexBuffer.data.length,l,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,i,t||o.getSize(),r||1):s.drawArrays(e,i,t||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}vL.extension={type:Ne.RendererSystem,name:"geometry"};$e.add(vL);const CC=new an;class RE{constructor(e,t){this._texture=e,this.mapCoord=new an,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof t>"u"?.5:t,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,t){t===void 0&&(t=e);const i=this.mapCoord;for(let r=0;r<e.length;r+=2){const s=e[r],o=e[r+1];t[r]=s*i.a+o*i.c+i.tx,t[r+1]=s*i.b+o*i.d+i.ty}return t}update(e){const t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;const i=t._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const r=t.orig,s=t.trim;s&&(CC.set(r.width/s.width,0,0,r.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(CC));const o=t.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(t._frame.x+l+u)/o.width,a[1]=(t._frame.y+l+u)/o.height,a[2]=(t._frame.x+t._frame.width-l+u)/o.width,a[3]=(t._frame.y+t._frame.height-l+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=t._frame.width===o.width&&t._frame.height===o.height&&t.rotate===0,!0}}var m7=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,g7=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class _7 extends Ni{constructor(e,t,i){let r=null;typeof e!="string"&&t===void 0&&i===void 0&&(r=e,e=void 0,t=void 0,i=void 0),super(e||g7,t||m7,i),this.maskSprite=r,this.maskMatrix=new an}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,t,i,r){const s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new RE(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,t,i,r))}}class v7{constructor(e=null){this.type=Bn.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Ni.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Bn.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class yL{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,t){let i=t;if(!i.isMaskData){const s=this.maskDataPool.pop()||new v7;s.pooled=!0,s.maskObject=t,i=s}const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(r),i._colorMask=r?r._colorMask:15,i.autoDetect&&this.detect(i),i._target=e,i.type!==Bn.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case Bn.SCISSOR:this.renderer.scissor.push(i);break;case Bn.STENCIL:this.renderer.stencil.push(i);break;case Bn.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case Bn.COLOR:this.pushColorMask(i);break}i.type===Bn.SPRITE&&this.maskStack.push(i)}pop(e){const t=this.maskStack.pop();if(!(!t||t._target!==e)){if(t.enabled)switch(t.type){case Bn.SCISSOR:this.renderer.scissor.pop(t);break;case Bn.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case Bn.SPRITE:this.popSpriteMask(t);break;case Bn.COLOR:this.popColorMask(t);break}if(t.reset(),t.pooled&&this.maskDataPool.push(t),this.maskStack.length!==0){const i=this.maskStack[this.maskStack.length-1];i.type===Bn.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(e){const t=e.maskObject;t?t.isSprite?e.type=Bn.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=Bn.SCISSOR:e.type=Bn.STENCIL:e.type=Bn.COLOR}pushSpriteMask(e){const{maskObject:t}=e,i=e._target;let r=e._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new _7])),r[0].resolution=e.resolution,r[0].multisample=e.multisample,r[0].maskSprite=t;const s=i.filterArea;i.filterArea=t.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=s,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const t=e._colorMask,i=e._colorMask=t&e.colorMask;i!==t&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(e){const t=e._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==t&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}}yL.extension={type:Ne.RendererSystem,name:"mask"};$e.add(yL);class xL{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:t}=this.renderer,i=this.getStackLength();this.maskStack=e;const r=this.getStackLength();r!==i&&(r===0?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const RC=new an,PC=[],SL=class Ym extends xL{constructor(e){super(e),this.glConst=Fe.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const t=e._scissorRect,{maskObject:i}=e,{renderer:r}=this,s=r.renderTexture,o=i.getBounds(!0,PC.pop()??new ut);this.roundFrameToPixels(o,s.current?s.current.resolution:r.resolution,s.sourceFrame,s.destinationFrame,r.projection.transform),t&&o.fit(t),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;const{a:t,b:i,c:r,d:s}=e;return(Math.abs(i)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(s)>1e-4)}testScissor(e){const{maskObject:t}=e;if(!t.isFastRect||!t.isFastRect()||Ym.isMatrixRotated(t.worldTransform)||Ym.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const i=e._scissorRectLocal;return i.width>0&&i.height>0}roundFrameToPixels(e,t,i,r,s){Ym.isMatrixRotated(s)||(s=s?RC.copyFrom(s):RC.identity(),s.translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.renderer.filter.transformAABB(s,e),e.fit(r),e.x=Math.round(e.x*t),e.y=Math.round(e.y*t),e.width=Math.round(e.width*t),e.height=Math.round(e.height*t))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:t}=this.renderer;e&&PC.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=e.y:t=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}};SL.extension={type:Ne.RendererSystem,name:"scissor"};let y7=SL;$e.add(y7);class EL extends xL{constructor(e){super(e),this.glConst=Fe.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const t=e.maskObject,{gl:i}=this.renderer,r=e._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),e._stencilCounter++;const s=e._colorMask;s!==0&&(e._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,r,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,s!==0&&(e._colorMask=s,i.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}pop(e){const t=this.renderer.gl;if(this.getStackLength()===0)t.disable(t.STENCIL_TEST);else{const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,r=i?i._colorMask:15;r!==0&&(i._colorMask=0,t.colorMask(!1,!1,!1,!1)),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,r!==0&&(i._colorMask=r,t.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}EL.extension={type:Ne.RendererSystem,name:"stencil"};$e.add(EL);class TL{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return Rt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return Rt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return Rt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const t in e)this.plugins[t]=new e[t](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}TL.extension={type:[Ne.RendererSystem,Ne.CanvasRendererSystem],name:"_plugin"};$e.add(TL);class bL{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new an,this.transform=null}update(e,t,i,r){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);const s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(e,t,i,r){const s=this.projectionMatrix,o=r?-1:1;s.identity(),s.a=1/t.width*2,s.d=o*(1/t.height*2),s.tx=-1-t.x*s.a,s.ty=-o-t.y*s.d}setTransform(e){}destroy(){this.renderer=null}}bL.extension={type:Ne.RendererSystem,name:"projection"};$e.add(bL);const x7=new P0,IC=new ut;class wL{constructor(e){this.renderer=e,this._tempMatrix=new an}generateTexture(e,t){const{region:i,...r}=t||{},s=(i==null?void 0:i.copyTo(IC))||e.getLocalBounds(IC,!0),o=r.resolution||this.renderer.resolution;s.width=Math.max(s.width,1/o),s.height=Math.max(s.height,1/o),r.width=s.width,r.height=s.height,r.resolution=o,r.multisample??(r.multisample=this.renderer.multisample);const a=Jl.create(r);this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;const l=e.transform;return e.transform=x7,this.renderer.render(e,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=l,a}destroy(){}}wL.extension={type:[Ne.RendererSystem,Ne.CanvasRendererSystem],name:"textureGenerator"};$e.add(wL);const il=new ut,Wh=new ut;class AL{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new ut,this.destinationFrame=new ut,this.viewportFrame=new ut}contextChange(){var t;const e=(t=this.renderer)==null?void 0:t.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,t,i){const r=this.renderer;this.current=e;let s,o,a;e?(s=e.baseTexture,a=s.resolution,t||(il.width=e.frame.width,il.height=e.frame.height,t=il),i||(Wh.x=e.frame.x,Wh.y=e.frame.y,Wh.width=t.width,Wh.height=t.height,i=Wh),o=s.framebuffer):(a=r.resolution,t||(il.width=r._view.screen.width,il.height=r._view.screen.height,t=il),i||(i=il,i.width=t.width,i.height=t.height));const l=this.viewportFrame;l.x=i.x*a,l.y=i.y*a,l.width=i.width*a,l.height=i.height*a,e||(l.y=r.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(i,t,a,!o),e?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(i)}clear(e,t){const i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,r=Jt.shared.setValue(e||i);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&r.premultiply(r.alpha);const s=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=s.width!==o.width||s.height!==o.height;if(a){let{x:l,y:u,width:d,height:f}=this.viewportFrame;l=Math.round(l),u=Math.round(u),d=Math.round(d),f=Math.round(f),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,u,d,f)}this.renderer.framebuffer.clear(r.red,r.green,r.blue,r.alpha,t),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}AL.extension={type:Ne.RendererSystem,name:"renderTexture"};$e.add(AL);class S7{constructor(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function E7(n,e){const t={},i=e.getProgramParameter(n,e.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=e.getActiveAttrib(n,r);if(s.name.startsWith("gl_"))continue;const o=cL(e,s.type),a={type:o,name:s.name,size:uL(o),location:e.getAttribLocation(n,s.name)};t[s.name]=a}return t}function T7(n,e){const t={},i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let r=0;r<i;r++){const s=e.getActiveUniform(n,r),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),l=cL(e,s.type);t[o]={name:o,index:r,type:l,size:s.size,isArray:a,value:aL(l,s.size)}}return t}function b7(n,e){var a;const t=EC(n,n.VERTEX_SHADER,e.vertexSrc),i=EC(n,n.FRAGMENT_SHADER,e.fragmentSrc),r=n.createProgram();n.attachShader(r,t),n.attachShader(r,i);const s=(a=e.extra)==null?void 0:a.transformFeedbackVaryings;if(s&&(typeof n.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):n.transformFeedbackVaryings(r,s.names,s.bufferMode==="separate"?n.SEPARATE_ATTRIBS:n.INTERLEAVED_ATTRIBS)),n.linkProgram(r),n.getProgramParameter(r,n.LINK_STATUS)||JH(n,r,t,i),e.attributeData=E7(r,n),e.uniformData=T7(r,n),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const l=Object.keys(e.attributeData);l.sort((u,d)=>u>d?1:-1);for(let u=0;u<l.length;u++)e.attributeData[l[u]].location=u,n.bindAttribLocation(r,u,l[u]);n.linkProgram(r)}n.deleteShader(t),n.deleteShader(i);const o={};for(const l in e.uniformData){const u=e.uniformData[l];o[l]={location:n.getUniformLocation(r,l),value:aL(u.type,u.size)}}return new S7(r,o)}function w7(n,e,t,i,r){t.buffer.update(r)}const A7={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},ML={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function M7(n){const e=n.map(s=>({data:s,offset:0,dataLen:0,dirty:0}));let t=0,i=0,r=0;for(let s=0;s<e.length;s++){const o=e[s];if(t=ML[o.data.type],o.data.size>1&&(t=Math.max(t,16)*o.data.size),o.dataLen=t,i%t!==0&&i<16){const a=i%t%16;i+=a,r+=a}i+t>16?(r=Math.ceil(r/16)*16,o.offset=r,r+=t,i=t):(o.offset=r,i+=t,r+=t)}return r=Math.ceil(r/16)*16,{uboElements:e,size:r}}function C7(n,e){const t=[];for(const i in n)e[i]&&t.push(e[i]);return t.sort((i,r)=>i.index-r.index),t}function R7(n,e){if(!n.autoManage)return{size:0,syncFunc:w7};const t=C7(n.uniforms,e),{uboElements:i,size:r}=M7(t),s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<i.length;o++){const a=i[o],l=n.uniforms[a.data.name],u=a.data.name;let d=!1;for(let f=0;f<wc.length;f++){const p=wc[f];if(p.codeUbo&&p.test(a.data,l)){s.push(`offset = ${a.offset/4};`,wc[f].codeUbo(a.data.name,l)),d=!0;break}}if(!d)if(a.data.size>1){const f=uL(a.data.type),p=Math.max(ML[a.data.type]/16,1),m=f/p,v=(4-m%4)%4;s.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*p}; i++)
                {
                    for(var j = 0; j < ${m}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${v};
                }

                `)}else{const f=A7[a.data.type];s.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};
                ${f};
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:r,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}let P7=0;const cm={textureCount:0,uboCount:0};class CL{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=P7++}systemCheck(){if(!t7())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,t){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const i=e.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),t||(cm.textureCount=0,cm.uboCount=0,this.syncUniformGroup(e.uniformGroup,cm)),r}setUniforms(e){const t=this.shader.program,i=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(i.uniformData,e,this.renderer)}syncUniformGroup(e,t){const i=this.getGlProgram();(!e.static||e.dirtyId!==i.uniformDirtyGroups[e.id])&&(i.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,i,t))}syncUniforms(e,t,i){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,i)}createSyncGroups(e){const t=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[t]||(this.cache[t]=KH(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,t){const i=this.getGlProgram();if(!e.static||e.dirtyId!==0||!i.uniformGroups[e.id]){e.dirtyId=0;const r=i.uniformGroups[e.id]||this.createSyncBufferGroup(e,i,t);e.buffer.update(),r(i.uniformData,e.uniforms,this.renderer,cm,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,i.uniformBufferBindings[t])}createSyncBufferGroup(e,t,i){const{gl:r}=this.renderer;this.renderer.buffer.bind(e.buffer);const s=this.gl.getUniformBlockIndex(t.program,i);t.uniformBufferBindings[i]=this.shader.uniformBindCount,r.uniformBlockBinding(t.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(e,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=R7(e,this.shader.program.uniformData)),e.autoManage){const l=new Float32Array(a.size/4);e.buffer.update(l)}return t.uniformGroups[e.id]=a.syncFunc,t.uniformGroups[e.id]}getSignature(e,t,i){const r=e.uniforms,s=[`${i}-`];for(const o in r)s.push(o),t[o]&&s.push(t[o].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const t=this.gl,i=e.program,r=b7(t,i);return i.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}CL.extension={type:Ne.RendererSystem,name:"shader"};$e.add(CL);class Vg{constructor(e){this.renderer=e}run(e){const{renderer:t}=this;t.runners.init.emit(t.options),e.hello&&console.log(`PixiJS 7.3.3 - ${t.rendererLogId} - https://pixijs.com`),t.resize(t.screen.width,t.screen.height)}destroy(){}}Vg.defaultOptions={hello:!1},Vg.extension={type:[Ne.RendererSystem,Ne.CanvasRendererSystem],name:"startup"};$e.add(Vg);function I7(n,e=[]){return e[rt.NORMAL]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.ADD]=[n.ONE,n.ONE],e[rt.MULTIPLY]=[n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.SCREEN]=[n.ONE,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.OVERLAY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.DARKEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.LIGHTEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.COLOR_DODGE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.COLOR_BURN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.HARD_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.SOFT_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.DIFFERENCE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.EXCLUSION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.HUE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.SATURATION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.COLOR]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.LUMINOSITY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.NONE]=[0,0],e[rt.NORMAL_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.ADD_NPM]=[n.SRC_ALPHA,n.ONE,n.ONE,n.ONE],e[rt.SCREEN_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.SRC_IN]=[n.DST_ALPHA,n.ZERO],e[rt.SRC_OUT]=[n.ONE_MINUS_DST_ALPHA,n.ZERO],e[rt.SRC_ATOP]=[n.DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],e[rt.DST_OVER]=[n.ONE_MINUS_DST_ALPHA,n.ONE],e[rt.DST_IN]=[n.ZERO,n.SRC_ALPHA],e[rt.DST_OUT]=[n.ZERO,n.ONE_MINUS_SRC_ALPHA],e[rt.DST_ATOP]=[n.ONE_MINUS_DST_ALPHA,n.SRC_ALPHA],e[rt.XOR]=[n.ONE_MINUS_DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],e[rt.SUBTRACT]=[n.ONE,n.ONE,n.ONE,n.ONE,n.FUNC_REVERSE_SUBTRACT,n.FUNC_ADD],e}const L7=0,D7=1,N7=2,U7=3,F7=4,O7=5,RL=class N1{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=rt.NONE,this._blendEq=!1,this.map=[],this.map[L7]=this.setBlend,this.map[D7]=this.setOffset,this.map[N7]=this.setCullFace,this.map[U7]=this.setDepthTest,this.map[F7]=this.setFrontFace,this.map[O7]=this.setDepthMask,this.checks=[],this.defaultState=new Ks,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=I7(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,i=0;for(;t;)t&1&&this.map[i].call(this,!!(e.data&1<<i)),t=t>>1,i++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(N1.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(N1.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const t=this.blendModes[e],i=this.gl;t.length===2?i.blendFunc(t[0],t[1]):i.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,i.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){const i=this.checks.indexOf(e);t&&i===-1?this.checks.push(e):!t&&i!==-1&&this.checks.splice(i,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};RL.extension={type:Ne.RendererSystem,name:"state"};let B7=RL;$e.add(B7);class k7 extends cf{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const t=(e.priority??[]).filter(r=>e.systems[r]),i=[...t,...Object.keys(e.systems).filter(r=>!t.includes(r))];for(const r of i)this.addSystem(e.systems[r],r)}addRunners(...e){e.forEach(t=>{this.runners[t]=new ls(t)})}addSystem(e,t){const i=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);this[t]=i,this._systemsHash[t]=i;for(const r in this.runners)this.runners[r].add(i);return this}emitWithCustomOptions(e,t){const i=Object.keys(this._systemsHash);e.items.forEach(r=>{const s=i.find(o=>this._systemsHash[o]===r);r[e.name](t[s])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const ed=class qm{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=qm.defaultMaxIdle,this.checkCountMax=qm.defaultCheckCountMax,this.mode=qm.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==vE.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,t=e.managedTextures;let i=!1;for(let r=0;r<t.length;r++){const s=t[r];s.resource&&this.count-s.touched>this.maxIdle&&(e.destroyTexture(s,!0),t[r]=null,i=!0)}if(i){let r=0;for(let s=0;s<t.length;s++)t[s]!==null&&(t[r++]=t[s]);t.length=r}}unload(e){const t=this.renderer.texture,i=e._texture;i&&!i.framebuffer&&t.destroyTexture(i);for(let r=e.children.length-1;r>=0;r--)this.unload(e.children[r])}destroy(){this.renderer=null}};ed.defaultMode=vE.AUTO,ed.defaultMaxIdle=60*60,ed.defaultCheckCountMax=60*10,ed.extension={type:Ne.RendererSystem,name:"textureGC"};let ml=ed;$e.add(ml);class Py{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=et.UNSIGNED_BYTE,this.internalFormat=Ee.RGBA,this.samplerType=0}}function z7(n){let e;return"WebGL2RenderingContext"in globalThis&&n instanceof globalThis.WebGL2RenderingContext?e={[n.RGB]:Ue.FLOAT,[n.RGBA]:Ue.FLOAT,[n.ALPHA]:Ue.FLOAT,[n.LUMINANCE]:Ue.FLOAT,[n.LUMINANCE_ALPHA]:Ue.FLOAT,[n.R8]:Ue.FLOAT,[n.R8_SNORM]:Ue.FLOAT,[n.RG8]:Ue.FLOAT,[n.RG8_SNORM]:Ue.FLOAT,[n.RGB8]:Ue.FLOAT,[n.RGB8_SNORM]:Ue.FLOAT,[n.RGB565]:Ue.FLOAT,[n.RGBA4]:Ue.FLOAT,[n.RGB5_A1]:Ue.FLOAT,[n.RGBA8]:Ue.FLOAT,[n.RGBA8_SNORM]:Ue.FLOAT,[n.RGB10_A2]:Ue.FLOAT,[n.RGB10_A2UI]:Ue.FLOAT,[n.SRGB8]:Ue.FLOAT,[n.SRGB8_ALPHA8]:Ue.FLOAT,[n.R16F]:Ue.FLOAT,[n.RG16F]:Ue.FLOAT,[n.RGB16F]:Ue.FLOAT,[n.RGBA16F]:Ue.FLOAT,[n.R32F]:Ue.FLOAT,[n.RG32F]:Ue.FLOAT,[n.RGB32F]:Ue.FLOAT,[n.RGBA32F]:Ue.FLOAT,[n.R11F_G11F_B10F]:Ue.FLOAT,[n.RGB9_E5]:Ue.FLOAT,[n.R8I]:Ue.INT,[n.R8UI]:Ue.UINT,[n.R16I]:Ue.INT,[n.R16UI]:Ue.UINT,[n.R32I]:Ue.INT,[n.R32UI]:Ue.UINT,[n.RG8I]:Ue.INT,[n.RG8UI]:Ue.UINT,[n.RG16I]:Ue.INT,[n.RG16UI]:Ue.UINT,[n.RG32I]:Ue.INT,[n.RG32UI]:Ue.UINT,[n.RGB8I]:Ue.INT,[n.RGB8UI]:Ue.UINT,[n.RGB16I]:Ue.INT,[n.RGB16UI]:Ue.UINT,[n.RGB32I]:Ue.INT,[n.RGB32UI]:Ue.UINT,[n.RGBA8I]:Ue.INT,[n.RGBA8UI]:Ue.UINT,[n.RGBA16I]:Ue.INT,[n.RGBA16UI]:Ue.UINT,[n.RGBA32I]:Ue.INT,[n.RGBA32UI]:Ue.UINT,[n.DEPTH_COMPONENT16]:Ue.FLOAT,[n.DEPTH_COMPONENT24]:Ue.FLOAT,[n.DEPTH_COMPONENT32F]:Ue.FLOAT,[n.DEPTH_STENCIL]:Ue.FLOAT,[n.DEPTH24_STENCIL8]:Ue.FLOAT,[n.DEPTH32F_STENCIL8]:Ue.FLOAT}:e={[n.RGB]:Ue.FLOAT,[n.RGBA]:Ue.FLOAT,[n.ALPHA]:Ue.FLOAT,[n.LUMINANCE]:Ue.FLOAT,[n.LUMINANCE_ALPHA]:Ue.FLOAT,[n.DEPTH_STENCIL]:Ue.FLOAT},e}function G7(n){let e;return"WebGL2RenderingContext"in globalThis&&n instanceof globalThis.WebGL2RenderingContext?e={[et.UNSIGNED_BYTE]:{[Ee.RGBA]:n.RGBA8,[Ee.RGB]:n.RGB8,[Ee.RG]:n.RG8,[Ee.RED]:n.R8,[Ee.RGBA_INTEGER]:n.RGBA8UI,[Ee.RGB_INTEGER]:n.RGB8UI,[Ee.RG_INTEGER]:n.RG8UI,[Ee.RED_INTEGER]:n.R8UI,[Ee.ALPHA]:n.ALPHA,[Ee.LUMINANCE]:n.LUMINANCE,[Ee.LUMINANCE_ALPHA]:n.LUMINANCE_ALPHA},[et.BYTE]:{[Ee.RGBA]:n.RGBA8_SNORM,[Ee.RGB]:n.RGB8_SNORM,[Ee.RG]:n.RG8_SNORM,[Ee.RED]:n.R8_SNORM,[Ee.RGBA_INTEGER]:n.RGBA8I,[Ee.RGB_INTEGER]:n.RGB8I,[Ee.RG_INTEGER]:n.RG8I,[Ee.RED_INTEGER]:n.R8I},[et.UNSIGNED_SHORT]:{[Ee.RGBA_INTEGER]:n.RGBA16UI,[Ee.RGB_INTEGER]:n.RGB16UI,[Ee.RG_INTEGER]:n.RG16UI,[Ee.RED_INTEGER]:n.R16UI,[Ee.DEPTH_COMPONENT]:n.DEPTH_COMPONENT16},[et.SHORT]:{[Ee.RGBA_INTEGER]:n.RGBA16I,[Ee.RGB_INTEGER]:n.RGB16I,[Ee.RG_INTEGER]:n.RG16I,[Ee.RED_INTEGER]:n.R16I},[et.UNSIGNED_INT]:{[Ee.RGBA_INTEGER]:n.RGBA32UI,[Ee.RGB_INTEGER]:n.RGB32UI,[Ee.RG_INTEGER]:n.RG32UI,[Ee.RED_INTEGER]:n.R32UI,[Ee.DEPTH_COMPONENT]:n.DEPTH_COMPONENT24},[et.INT]:{[Ee.RGBA_INTEGER]:n.RGBA32I,[Ee.RGB_INTEGER]:n.RGB32I,[Ee.RG_INTEGER]:n.RG32I,[Ee.RED_INTEGER]:n.R32I},[et.FLOAT]:{[Ee.RGBA]:n.RGBA32F,[Ee.RGB]:n.RGB32F,[Ee.RG]:n.RG32F,[Ee.RED]:n.R32F,[Ee.DEPTH_COMPONENT]:n.DEPTH_COMPONENT32F},[et.HALF_FLOAT]:{[Ee.RGBA]:n.RGBA16F,[Ee.RGB]:n.RGB16F,[Ee.RG]:n.RG16F,[Ee.RED]:n.R16F},[et.UNSIGNED_SHORT_5_6_5]:{[Ee.RGB]:n.RGB565},[et.UNSIGNED_SHORT_4_4_4_4]:{[Ee.RGBA]:n.RGBA4},[et.UNSIGNED_SHORT_5_5_5_1]:{[Ee.RGBA]:n.RGB5_A1},[et.UNSIGNED_INT_2_10_10_10_REV]:{[Ee.RGBA]:n.RGB10_A2,[Ee.RGBA_INTEGER]:n.RGB10_A2UI},[et.UNSIGNED_INT_10F_11F_11F_REV]:{[Ee.RGB]:n.R11F_G11F_B10F},[et.UNSIGNED_INT_5_9_9_9_REV]:{[Ee.RGB]:n.RGB9_E5},[et.UNSIGNED_INT_24_8]:{[Ee.DEPTH_STENCIL]:n.DEPTH24_STENCIL8},[et.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[Ee.DEPTH_STENCIL]:n.DEPTH32F_STENCIL8}}:e={[et.UNSIGNED_BYTE]:{[Ee.RGBA]:n.RGBA,[Ee.RGB]:n.RGB,[Ee.ALPHA]:n.ALPHA,[Ee.LUMINANCE]:n.LUMINANCE,[Ee.LUMINANCE_ALPHA]:n.LUMINANCE_ALPHA},[et.UNSIGNED_SHORT_5_6_5]:{[Ee.RGB]:n.RGB},[et.UNSIGNED_SHORT_4_4_4_4]:{[Ee.RGBA]:n.RGBA},[et.UNSIGNED_SHORT_5_5_5_1]:{[Ee.RGBA]:n.RGBA}},e}class PL{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new lt,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=G7(e),this.samplerTypes=z7(e);const t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(let r=0;r<t;r++)this.boundTextures[r]=null;this.emptyTextures={};const i=new Py(e.createTexture());e.bindTexture(e.TEXTURE_2D,i.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=i,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new Py(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let r=0;r<6;r++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let r=0;r<this.boundTextures.length;r++)this.bind(null,r)}bind(e,t=0){const{gl:i}=this;if(e=e==null?void 0:e.castToBaseTexture(),(e==null?void 0:e.valid)&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const r=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),i.bindTexture(e.target,r.texture)),r.dirtyId!==e.dirtyId?(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),this.updateTexture(e)):r.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[t]=e}else this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[t]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:t,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(let r=0;r<i.length;r++)i[r]===e&&(this.currentLocation!==r&&(t.activeTexture(t.TEXTURE0+r),this.currentLocation=r),t.bindTexture(e.target,this.emptyTextures[e.target].texture),i[r]=null)}ensureSamplerType(e){const{boundTextures:t,hasIntegerTextures:i,CONTEXT_UID:r}=this;if(i)for(let s=e-1;s>=0;--s){const o=t[s];o&&o._glTextures[r].samplerType!==Ue.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(e){const t=new Py(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t}initTextureType(e,t){var i;t.internalFormat=((i=this.internalFormats[e.type])==null?void 0:i[e.format])??e.format,t.samplerType=this.samplerTypes[t.internalFormat]??Ue.FLOAT,this.webGLVersion===2&&e.type===et.HALF_FLOAT?t.type=this.gl.HALF_FLOAT:t.type=e.type}updateTexture(e){var r;const t=e._glTextures[this.CONTEXT_UID];if(!t)return;const i=this.renderer;if(this.initTextureType(e,t),(r=e.resource)==null?void 0:r.upload(i,e,t))t.samplerType!==Ue.FLOAT&&(this.hasIntegerTextures=!0);else{const s=e.realWidth,o=e.realHeight,a=i.gl;(t.width!==s||t.height!==o||t.dirtyId<0)&&(t.width=s,t.height=o,a.texImage2D(e.target,0,t.internalFormat,s,o,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}destroyTexture(e,t){const{gl:i}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),i.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){const r=this.managedTextures.indexOf(e);r!==-1&&bc(this.managedTextures,r,1)}}updateTextureStyle(e){var i;const t=e._glTextures[this.CONTEXT_UID];t&&((e.mipmap===Ws.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?t.mipmap=!1:t.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?t.wrapMode=Co.CLAMP:t.wrapMode=e.wrapMode,(i=e.resource)!=null&&i.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)}setStyle(e,t){const i=this.gl;if(t.mipmap&&e.mipmap!==Ws.ON_MANUAL&&i.generateMipmap(e.target),i.texParameteri(e.target,i.TEXTURE_WRAP_S,t.wrapMode),i.texParameteri(e.target,i.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===To.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);const r=this.renderer.context.extensions.anisotropicFiltering;if(r&&e.anisotropicLevel>0&&e.scaleMode===To.LINEAR){const s=Math.min(e.anisotropicLevel,i.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(e.target,r.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===To.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(e.target,i.TEXTURE_MAG_FILTER,e.scaleMode===To.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}PL.extension={type:Ne.RendererSystem,name:"texture"};$e.add(PL);class IL{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:t,CONTEXT_UID:i}=this,r=e._glTransformFeedbacks[i]||this.createGLTransformFeedback(e);t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,t){const{gl:i,renderer:r}=this;t&&r.shader.bind(t),i.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:t,renderer:i,CONTEXT_UID:r}=this,s=t.createTransformFeedback();e._glTransformFeedbacks[r]=s,t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,s);for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];a&&(i.buffer.update(a),a._glBuffers[r].refCount++,t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[r].buffer||null))}return t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),s}disposeTransformFeedback(e,t){const i=e._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this);const s=this.renderer.buffer;if(s)for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];if(!a)continue;const l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!t&&s.dispose(a,t))}i&&(t||r.deleteTransformFeedback(i),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}IL.extension={type:Ne.RendererSystem,name:"transformFeedback"};$e.add(IL);class Wg{constructor(e){this.renderer=e}init(e){this.screen=new ut(0,0,e.width,e.height),this.element=e.view||Fe.ADAPTER.createCanvas(),this.resolution=e.resolution||Fe.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,t){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(t*this.resolution);const i=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=i,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",i,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var t;e&&((t=this.element.parentNode)==null||t.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}Wg.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},Wg.extension={type:[Ne.RendererSystem,Ne.CanvasRendererSystem],name:"_view"};$e.add(Wg);Fe.PREFER_ENV=Zl.WEBGL2;Fe.STRICT_TEXTURE_CACHE=!1;Fe.RENDER_OPTIONS={...Hg.defaultOptions,...Gg.defaultOptions,...Wg.defaultOptions,...Vg.defaultOptions};Object.defineProperties(Fe,{WRAP_MODE:{get(){return lt.defaultOptions.wrapMode},set(n){Rt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),lt.defaultOptions.wrapMode=n}},SCALE_MODE:{get(){return lt.defaultOptions.scaleMode},set(n){Rt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),lt.defaultOptions.scaleMode=n}},MIPMAP_TEXTURES:{get(){return lt.defaultOptions.mipmap},set(n){Rt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),lt.defaultOptions.mipmap=n}},ANISOTROPIC_LEVEL:{get(){return lt.defaultOptions.anisotropicLevel},set(n){Rt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),lt.defaultOptions.anisotropicLevel=n}},FILTER_RESOLUTION:{get(){return Rt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Ni.defaultResolution},set(n){Ni.defaultResolution=n}},FILTER_MULTISAMPLE:{get(){return Rt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Ni.defaultMultisample},set(n){Ni.defaultMultisample=n}},SPRITE_MAX_TEXTURES:{get(){return pl.defaultMaxTextures},set(n){Rt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),pl.defaultMaxTextures=n}},SPRITE_BATCH_SIZE:{get(){return pl.defaultBatchSize},set(n){Rt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),pl.defaultBatchSize=n}},CAN_UPLOAD_SAME_BUFFER:{get(){return pl.canUploadSameBuffer},set(n){Rt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),pl.canUploadSameBuffer=n}},GC_MODE:{get(){return ml.defaultMode},set(n){Rt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ml.defaultMode=n}},GC_MAX_IDLE:{get(){return ml.defaultMaxIdle},set(n){Rt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ml.defaultMaxIdle=n}},GC_MAX_CHECK_COUNT:{get(){return ml.defaultCheckCountMax},set(n){Rt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ml.defaultCheckCountMax=n}},PRECISION_VERTEX:{get(){return wo.defaultVertexPrecision},set(n){Rt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),wo.defaultVertexPrecision=n}},PRECISION_FRAGMENT:{get(){return wo.defaultFragmentPrecision},set(n){Rt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),wo.defaultFragmentPrecision=n}}});var Ua=(n=>(n[n.INTERACTION=50]="INTERACTION",n[n.HIGH=25]="HIGH",n[n.NORMAL=0]="NORMAL",n[n.LOW=-25]="LOW",n[n.UTILITY=-50]="UTILITY",n))(Ua||{});class Iy{constructor(e,t=null,i=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=i,this.once=r}match(e,t=null){return this.fn===e&&this.context===t}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=e?null:t,this.previous=null,t}}const LL=class rr{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Iy(null,null,1/0),this.deltaMS=1/rr.targetFPMS,this.elapsedMS=1/rr.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,i=Ua.NORMAL){return this._addListener(new Iy(e,t,i))}addOnce(e,t,i=Ua.NORMAL){return this._addListener(new Iy(e,t,i,!0))}_addListener(e){let t=this._head.next,i=this._head;if(!t)e.connect(i);else{for(;t;){if(e.priority>t.priority){e.connect(i);break}i=t,t=t.next}e.previous||e.connect(i)}return this._startIfPossible(),this}remove(e,t){let i=this._head.next;for(;i;)i.match(e,t)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*rr.targetFPMS;const i=this._head;let r=i.next;for(;r;)r=r.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),i=Math.min(Math.max(0,t)/1e3,rr.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!rr._shared){const e=rr._shared=new rr;e.autoStart=!0,e._protected=!0}return rr._shared}static get system(){if(!rr._system){const e=rr._system=new rr;e.autoStart=!0,e._protected=!0}return rr._system}};LL.targetFPMS=.06;let ni=LL;Object.defineProperties(Fe,{TARGET_FPMS:{get(){return ni.targetFPMS},set(n){Rt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),ni.targetFPMS=n}}});class DL{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,Ua.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?ni.shared:new ni,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}DL.extension=Ne.Application;$e.add(DL);const NL=[];$e.handleByList(Ne.Renderer,NL);function H7(n){for(const e of NL)if(e.test(n))return new e(n);throw new Error("Unable to auto-detect a suitable renderer.")}var V7=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,W7=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const X7=V7,UL=W7;class FL{constructor(e){this.renderer=e}contextChange(e){let t;if(this.renderer.context.webGLVersion===1){const i=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,i)}else{const i=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,i)}t>=Dn.HIGH?this.multisample=Dn.HIGH:t>=Dn.MEDIUM?this.multisample=Dn.MEDIUM:t>=Dn.LOW?this.multisample=Dn.LOW:this.multisample=Dn.NONE}destroy(){}}FL.extension={type:Ne.RendererSystem,name:"_multisample"};$e.add(FL);class j7{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class OL{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:t,CONTEXT_UID:i}=this,r=e._glBuffers[i]||this.createGLBuffer(e);t.bindBuffer(e.type,r.buffer)}unbind(e){const{gl:t}=this;t.bindBuffer(e,null)}bindBufferBase(e,t){const{gl:i,CONTEXT_UID:r}=this;if(this.boundBufferBases[t]!==e){const s=e._glBuffers[r]||this.createGLBuffer(e);this.boundBufferBases[t]=e,i.bindBufferBase(i.UNIFORM_BUFFER,t,s.buffer)}}bindBufferRange(e,t,i){const{gl:r,CONTEXT_UID:s}=this;i=i||0;const o=e._glBuffers[s]||this.createGLBuffer(e);r.bindBufferRange(r.UNIFORM_BUFFER,t||0,o.buffer,i*256,256)}update(e){const{gl:t,CONTEXT_UID:i}=this,r=e._glBuffers[i]||this.createGLBuffer(e);if(e._updateID!==r.updateID)if(r.updateID=e._updateID,t.bindBuffer(e.type,r.buffer),r.byteLength>=e.data.byteLength)t.bufferSubData(e.type,0,e.data);else{const s=e.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;r.byteLength=e.data.byteLength,t.bufferData(e.type,e.data,s)}}dispose(e,t){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const i=e._glBuffers[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this),i&&(t||r.deleteBuffer(i.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const t=Object.keys(this.managedBuffers);for(let i=0;i<t.length;i++)this.dispose(this.managedBuffers[t[i]],e)}createGLBuffer(e){const{CONTEXT_UID:t,gl:i}=this;return e._glBuffers[t]=new j7(i.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[t]}}OL.extension={type:Ne.RendererSystem,name:"buffer"};$e.add(OL);class BL{constructor(e){this.renderer=e}render(e,t){const i=this.renderer;let r,s,o,a;if(t&&(r=t.renderTexture,s=t.clear,o=t.transform,a=t.skipUpdateTransform),this.renderingToScreen=!r,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=o,!i.context.isLost){if(r||(this.lastObjectRendered=e),!a){const l=e.enableTempParent();e.updateTransform(),e.disableTempParent(l)}i.renderTexture.bind(r),i.batch.currentRenderer.start(),(s??i.background.clearBeforeRender)&&i.renderTexture.clear(),e.render(i),i.batch.currentRenderer.flush(),r&&(t.blit&&i.framebuffer.blit(),r.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}BL.extension={type:Ne.RendererSystem,name:"objectRenderer"};$e.add(BL);const Km=class U1 extends k7{constructor(e){super(),this.type=RI.WEBGL,e=Object.assign({},Fe.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new us({projectionMatrix:new an},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:U1.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in e&&(Rt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=U1.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:mH()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Rt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Rt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Rt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Rt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){Rt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return Rt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){Rt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return Rt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}};Km.extension={type:Ne.Renderer,priority:1},Km.__plugins={},Km.__systems={};let PE=Km;$e.handleByMap(Ne.RendererPlugin,PE.__plugins);$e.handleByMap(Ne.RendererSystem,PE.__systems);$e.add(PE);class kL extends Zd{constructor(e,t){const{width:i,height:r}=t||{};super(i,r),this.items=[],this.itemDirtyIds=[];for(let s=0;s<e;s++){const o=new lt;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,t){for(let i=0;i<this.length;i++)e[i]&&(e[i].castToBaseTexture?this.addBaseTextureAt(e[i].castToBaseTexture(),i):e[i]instanceof Zd?this.addResourceAt(e[i],i):this.addResourceAt(rL(e[i],t),i))}dispose(){for(let e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,t){if(!this.items[t])throw new Error(`Index ${t} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=e,this.items[t].on("update",e.update,e)}unbind(e){super.unbind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=null,this.items[t].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map(t=>t.resource).filter(t=>t).map(t=>t.load());return this._load=Promise.all(e).then(()=>{const{realWidth:t,realHeight:i}=this.items[0];return this.resize(t,i),this.update(),Promise.resolve(this)}),this._load}}class $7 extends kL{constructor(e,t){const{width:i,height:r}=t||{};let s,o;Array.isArray(e)?(s=e,o=e.length):o=e,super(o,{width:i,height:r}),s&&this.initFromArray(s,t)}addBaseTextureAt(e,t){if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=Sc.TEXTURE_2D_ARRAY}upload(e,t,i){const{length:r,itemDirtyIds:s,items:o}=this,{gl:a}=e;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,r,0,t.format,i.type,null);for(let l=0;l<r;l++){const u=o[l];s[l]<u.dirtyId&&(s[l]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,u.resource.width,u.resource.height,1,t.format,i.type,u.resource.source))}return!0}}class Y7 extends Na{constructor(e){super(e)}static test(e){const{OffscreenCanvas:t}=globalThis;return t&&e instanceof t?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const zL=class td extends kL{constructor(e,t){const{width:i,height:r,autoLoad:s,linkBaseTexture:o}=t||{};if(e&&e.length!==td.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:i,height:r});for(let a=0;a<td.SIDES;a++)this.items[a].target=Sc.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,e&&this.initFromArray(e,t),s!==!1&&this.load()}bind(e){super.bind(e),e.target=Sc.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,i){if(i===void 0&&(i=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=Sc.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(e,t,i){const r=this.itemDirtyIds;for(let s=0;s<td.SIDES;s++){const o=this.items[s];(r[s]<o.dirtyId||i.dirtyId<t.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,i),r[s]=o.dirtyId):r[s]<-1&&(e.gl.texImage2D(o.target,0,i.internalFormat,t.realWidth,t.realHeight,0,t.format,i.type,null),r[s]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===td.SIDES}};zL.SIDES=6;let q7=zL;class cc extends Na{constructor(e,t){t=t||{};let i,r,s;typeof e=="string"?(i=cc.EMPTY,r=e,s=!0):(i=e,r=null,s=!1),super(i),this.url=r,this.crossOrigin=t.crossOrigin??!0,this.alphaMode=typeof t.alphaMode=="number"?t.alphaMode:null,this.ownsImageBitmap=t.ownsImageBitmap??s,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,t)=>{if(this.url===null){e(this);return}try{const i=await Fe.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await i.blob();if(this.destroyed)return;const s=await createImageBitmap(r,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ji.UNPACK?"premultiply":"none"});if(this.destroyed){s.close();return}this.source=s,this.update(),e(this)}catch(i){if(this.destroyed)return;t(i),this.onError.emit(i)}}),this._load)}upload(e,t,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(t.alphaMode=this.alphaMode),super.upload(e,t,i)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return cc._EMPTY=cc._EMPTY??Fe.ADAPTER.createCanvas(0,0),cc._EMPTY}}const F1=class Zm extends Na{constructor(e,t){t=t||{},super(Fe.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},Zm.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;Na.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;const t=e.width,i=e.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let r=t*this.scale,s=i*this.scale;(this._overrideWidth||this._overrideHeight)&&(r=this._overrideWidth||this._overrideHeight/i*t,s=this._overrideHeight||this._overrideWidth/t*i),r=Math.round(r),s=Math.round(s);const o=this.source;o.width=r,o.height=s,o._pixiId=`canvas_${Yl()}`,o.getContext("2d").drawImage(e,0,0,t,i,0,0,r,s),this._resolve(),this._resolve=null}}static getSize(e){const t=Zm.SVG_SIZE.exec(e),i={};return t&&(i[t[1]]=Math.round(parseFloat(t[3])),i[t[5]]=Math.round(parseFloat(t[7]))),i}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,t){return t==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&Zm.SVG_XML.test(e)}};F1.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,F1.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let O1=F1;const B1=class k1 extends Na{constructor(e,t){if(t=t||{},!(e instanceof HTMLVideoElement)){const i=document.createElement("video");t.autoLoad!==!1&&i.setAttribute("preload","auto"),t.playsinline!==!1&&(i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline","")),t.muted===!0&&(i.setAttribute("muted",""),i.muted=!0),t.loop===!0&&i.setAttribute("loop",""),t.autoPlay!==!1&&i.setAttribute("autoplay",""),typeof e=="string"&&(e=[e]);const r=e[0].src||e[0];Na.crossOrigin(i,r,t.crossorigin);for(let s=0;s<e.length;++s){const o=document.createElement("source");let{src:a,mime:l}=e[s];if(a=a||e[s],a.startsWith("data:"))l=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){const u=a.split("?").shift().toLowerCase(),d=u.slice(u.lastIndexOf(".")+1);l=l||k1.MIME_TYPES[d]||`video/${d}`}o.src=a,l&&(o.type=l),i.appendChild(o)}e=i}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const t=ni.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((t,i)=>{this.valid?t(this):(this._resolve=t,this._reject=i,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!t&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(ni.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(ni.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(ni.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,t){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||k1.TYPES.includes(t)}};B1.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],B1.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let GL=B1;w1.push(cc,fL,Y7,GL,O1,A0,q7,$7);class Xg{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?ut.EMPTY:(e=e||new ut(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,t){const{a:i,b:r,c:s,d:o,tx:a,ty:l}=e,u=i*t.x+s*t.y+a,d=r*t.x+o*t.y+l;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,d),this.maxY=Math.max(this.maxY,d)}addQuad(e){let t=this.minX,i=this.minY,r=this.maxX,s=this.maxY,o=e[0],a=e[1];t=o<t?o:t,i=a<i?a:i,r=o>r?o:r,s=a>s?a:s,o=e[2],a=e[3],t=o<t?o:t,i=a<i?a:i,r=o>r?o:r,s=a>s?a:s,o=e[4],a=e[5],t=o<t?o:t,i=a<i?a:i,r=o>r?o:r,s=a>s?a:s,o=e[6],a=e[7],t=o<t?o:t,i=a<i?a:i,r=o>r?o:r,s=a>s?a:s,this.minX=t,this.minY=i,this.maxX=r,this.maxY=s}addFrame(e,t,i,r,s){this.addFrameMatrix(e.worldTransform,t,i,r,s)}addFrameMatrix(e,t,i,r,s){const o=e.a,a=e.b,l=e.c,u=e.d,d=e.tx,f=e.ty;let p=this.minX,m=this.minY,v=this.maxX,x=this.maxY,y=o*t+l*i+d,g=a*t+u*i+f;p=y<p?y:p,m=g<m?g:m,v=y>v?y:v,x=g>x?g:x,y=o*r+l*i+d,g=a*r+u*i+f,p=y<p?y:p,m=g<m?g:m,v=y>v?y:v,x=g>x?g:x,y=o*t+l*s+d,g=a*t+u*s+f,p=y<p?y:p,m=g<m?g:m,v=y>v?y:v,x=g>x?g:x,y=o*r+l*s+d,g=a*r+u*s+f,p=y<p?y:p,m=g<m?g:m,v=y>v?y:v,x=g>x?g:x,this.minX=p,this.minY=m,this.maxX=v,this.maxY=x}addVertexData(e,t,i){let r=this.minX,s=this.minY,o=this.maxX,a=this.maxY;for(let l=t;l<i;l+=2){const u=e[l],d=e[l+1];r=u<r?u:r,s=d<s?d:s,o=u>o?u:o,a=d>a?d:a}this.minX=r,this.minY=s,this.maxX=o,this.maxY=a}addVertices(e,t,i,r){this.addVerticesMatrix(e.worldTransform,t,i,r)}addVerticesMatrix(e,t,i,r,s=0,o=s){const a=e.a,l=e.b,u=e.c,d=e.d,f=e.tx,p=e.ty;let m=this.minX,v=this.minY,x=this.maxX,y=this.maxY;for(let g=i;g<r;g+=2){const T=t[g],S=t[g+1],w=a*T+u*S+f,M=d*S+l*T+p;m=Math.min(m,w-s),x=Math.max(x,w+s),v=Math.min(v,M-o),y=Math.max(y,M+o)}this.minX=m,this.minY=v,this.maxX=x,this.maxY=y}addBounds(e){const t=this.minX,i=this.minY,r=this.maxX,s=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<i?e.minY:i,this.maxX=e.maxX>r?e.maxX:r,this.maxY=e.maxY>s?e.maxY:s}addBoundsMask(e,t){const i=e.minX>t.minX?e.minX:t.minX,r=e.minY>t.minY?e.minY:t.minY,s=e.maxX<t.maxX?e.maxX:t.maxX,o=e.maxY<t.maxY?e.maxY:t.maxY;if(i<=s&&r<=o){const a=this.minX,l=this.minY,u=this.maxX,d=this.maxY;this.minX=i<a?i:a,this.minY=r<l?r:l,this.maxX=s>u?s:u,this.maxY=o>d?o:d}}addBoundsMatrix(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,t){const i=e.minX>t.x?e.minX:t.x,r=e.minY>t.y?e.minY:t.y,s=e.maxX<t.x+t.width?e.maxX:t.x+t.width,o=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(i<=s&&r<=o){const a=this.minX,l=this.minY,u=this.maxX,d=this.maxY;this.minX=i<a?i:a,this.minY=r<l?r:l,this.maxX=s>u?s:u,this.maxY=o>d?o:d}}pad(e=0,t=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)}addFramePad(e,t,i,r,s,o){e-=s,t-=o,i+=s,r+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>r?this.maxY:r}}class hn extends cf{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new P0,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Xg,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const t=Object.keys(e);for(let i=0;i<t.length;++i){const r=t[i];Object.defineProperty(hn.prototype,r,Object.getOwnPropertyDescriptor(e,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),t||(this._boundsRect||(this._boundsRect=new ut),t=this._boundsRect),this._bounds.getRectangle(t)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new ut),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Xg);const t=this.transform,i=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(i==null?void 0:i.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const r=this._bounds,s=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,e);return this.parent=i,this.transform=t,this._bounds=r,this._bounds.updateID+=this._boundsID-s,o}toGlobal(e,t,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)}toLocal(e,t,i,r){return t&&(e=t.toGlobal(e,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,i)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,t=0,i=1,r=1,s=0,o=0,a=0,l=0,u=0){return this.position.x=e,this.position.y=t,this.scale.x=i||1,this.scale.y=r||1,this.rotation=s,this.skew.x=o,this.skew.y=a,this.pivot.x=l,this.pivot.y=u,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new K7),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*VH}set angle(e){this.transform.rotation=e*WH}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount--,t._maskRefCount===0&&(t.renderable=!0,t.isMask=!1))}if(this._mask=e,this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount===0&&(t.renderable=!1,t.isMask=!0),t._maskRefCount++)}}}}class K7 extends hn{constructor(){super(...arguments),this.sortDirty=null}}hn.prototype.displayObjectUpdateTransform=hn.prototype.updateTransform;const Z7=new an;function Q7(n,e){return n.zIndex===e.zIndex?n._lastSortedIndex-e._lastSortedIndex:n.zIndex-e.zIndex}const HL=class z1 extends hn{constructor(){super(),this.children=[],this.sortableChildren=z1.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{const t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;const i=this.getChildIndex(e),r=this.getChildIndex(t);this.children[i]=t,this.children[r]=e,this.onChildrenChange(i<r?i:r)}getChildIndex(e){const t=this.children.indexOf(e);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const i=this.getChildIndex(e);bc(this.children,i,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{const t=e[0],i=this.children.indexOf(t);if(i===-1)return null;t.parent=null,t.transform._parentID=-1,bc(this.children,i,1),this._boundsID++,this.onChildrenChange(i),t.emit("removed",this),this.emit("childRemoved",t,this,i)}return e[0]}removeChildAt(e){const t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,bc(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){const i=e,r=t,s=r-i;let o;if(s>0&&s<=r){o=this.children.splice(i,s);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,i=this.children.length;t<i;++t){const r=this.children[t];r._lastSortedIndex=t,!e&&r.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(Q7),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){const i=this.children[e];i.visible&&i.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const t=this.children[e];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const i=t._mask.isMaskData?t._mask.maskObject:t._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(t._bounds,i._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){const i=super.getLocalBounds(e);if(!t)for(let r=0,s=this.children.length;r<s;++r){const o=this.children[r];o.visible&&o.updateTransform()}return i}_calculateBounds(){}_renderWithCulling(e){const t=e.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let i,r;this.cullArea?(i=this.cullArea,r=this.worldTransform):this._render!==z1.prototype._render&&(i=this.getBounds(!0));const s=e.projection.transform;if(s&&(r?(r=Z7.copyFrom(r),r.prepend(s)):r=s),i&&t.intersects(i,r))this._render(e);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){const l=this.children[o],u=l.cullable;l.cullable=u||!this.cullArea,l.render(e),l.cullable=u}}render(e){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let i=0,r=this.children.length;i<r;++i)this.children[i].render(e)}}renderAdvanced(e){var s,o,a;const t=this.filters,i=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let l=0;l<t.length;l++)t[l].enabled&&this._enabledFilters.push(t[l])}const r=t&&((s=this._enabledFilters)==null?void 0:s.length)||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==Bn.NONE));if(r&&e.batch.flush(),t&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.push(this,this._enabledFilters),i&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let l=0,u=this.children.length;l<u;++l)this.children[l].render(e)}r&&e.batch.flush(),i&&e.mask.pop(this),t&&((a=this._enabledFilters)!=null&&a.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const t=typeof e=="boolean"?e:e==null?void 0:e.children,i=this.removeChildren(0,this.children.length);if(t)for(let r=0;r<i.length;++r)i[r].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const t=this.getLocalBounds().width;t!==0?this.scale.x=e/t:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const t=this.getLocalBounds().height;t!==0?this.scale.y=e/t:this.scale.y=1,this._height=e}};HL.defaultSortableChildren=!1;let Oi=HL;Oi.prototype.containerUpdateTransform=Oi.prototype.updateTransform;Object.defineProperties(Fe,{SORTABLE_CHILDREN:{get(){return Oi.defaultSortableChildren},set(n){Rt("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Oi.defaultSortableChildren=n}}});var L0=(n=>(n[n.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",n[n.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",n))(L0||{});const Xh=new Lt,J7=new Uint16Array([0,1,2,0,2,3]);class Zs extends Oi{constructor(e){super(),this._anchor=new Os(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Jt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=rt.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||Pe.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=J7,this.pluginName="batch",this.isSprite=!0,this._roundPixels=Fe.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=_a(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=_a(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const t=this.transform.worldTransform,i=t.a,r=t.b,s=t.c,o=t.d,a=t.tx,l=t.ty,u=this.vertexData,d=e.trim,f=e.orig,p=this._anchor;let m=0,v=0,x=0,y=0;if(d?(v=d.x-p._x*f.width,m=v+d.width,y=d.y-p._y*f.height,x=y+d.height):(v=-p._x*f.width,m=v+f.width,y=-p._y*f.height,x=y+f.height),u[0]=i*v+s*y+a,u[1]=o*y+r*v+l,u[2]=i*m+s*y+a,u[3]=o*y+r*m+l,u[4]=i*m+s*x+a,u[5]=o*x+r*m+l,u[6]=i*v+s*x+a,u[7]=o*x+r*v+l,this._roundPixels){const g=Fe.RESOLUTION;for(let T=0;T<u.length;++T)u[T]=Math.round(u[T]*g)/g}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,t=this.vertexTrimmedData,i=e.orig,r=this._anchor,s=this.transform.worldTransform,o=s.a,a=s.b,l=s.c,u=s.d,d=s.tx,f=s.ty,p=-r._x*i.width,m=p+i.width,v=-r._y*i.height,x=v+i.height;if(t[0]=o*p+l*v+d,t[1]=u*v+a*p+f,t[2]=o*m+l*v+d,t[3]=u*v+a*m+f,t[4]=o*m+l*x+d,t[5]=u*x+a*m+f,t[6]=o*p+l*x+d,t[7]=u*x+a*p+f,this._roundPixels){const y=Fe.RESOLUTION;for(let g=0;g<t.length;++g)t[g]=Math.round(t[g]*y)/y}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,t=this._texture.orig;!e||e.width===t.width&&e.height===t.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new Xg),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new ut),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,Xh);const t=this._texture.orig.width,i=this._texture.orig.height,r=-t*this.anchor.x;let s=0;return Xh.x>=r&&Xh.x<r+t&&(s=-i*this.anchor.y,Xh.y>=s&&Xh.y<s+i)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const t=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!t)}this._texture=null}static from(e,t){const i=e instanceof Pe?e:Pe.from(e,t);return new Zs(i)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const t=_a(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const t=_a(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||Pe.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const hm={willReadFrequently:!0},Cs=class Ke{static get experimentalLetterSpacingSupported(){let e=Ke._experimentalLetterSpacingSupported;if(e!==void 0){const t=Fe.ADAPTER.getCanvasRenderingContext2D().prototype;e=Ke._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,i,r,s,o,a,l,u){this.text=e,this.style=t,this.width=i,this.height=r,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=u}static measureText(e,t,i,r=Ke._canvas){i=i??t.wordWrap;const s=t.toFontString(),o=Ke.measureFont(s);o.fontSize===0&&(o.fontSize=t.fontSize,o.ascent=t.fontSize);const a=r.getContext("2d",hm);a.font=s;const l=(i?Ke.wordWrap(e,t,r):e).split(/(?:\r\n|\r|\n)/),u=new Array(l.length);let d=0;for(let v=0;v<l.length;v++){const x=Ke._measureText(l[v],t.letterSpacing,a);u[v]=x,d=Math.max(d,x)}let f=d+t.strokeThickness;t.dropShadow&&(f+=t.dropShadowDistance);const p=t.lineHeight||o.fontSize+t.strokeThickness;let m=Math.max(p,o.fontSize+t.strokeThickness*2)+t.leading+(l.length-1)*(p+t.leading);return t.dropShadow&&(m+=t.dropShadowDistance),new Ke(e,t,f,m,l,u,p+t.leading,d,o)}static _measureText(e,t,i){let r=!1;Ke.experimentalLetterSpacingSupported&&(Ke.experimentalLetterSpacing?(i.letterSpacing=`${t}px`,i.textLetterSpacing=`${t}px`,r=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let s=i.measureText(e).width;return s>0&&(r?s-=t:s+=(Ke.graphemeSegmenter(e).length-1)*t),s}static wordWrap(e,t,i=Ke._canvas){const r=i.getContext("2d",hm);let s=0,o="",a="";const l=Object.create(null),{letterSpacing:u,whiteSpace:d}=t,f=Ke.collapseSpaces(d),p=Ke.collapseNewlines(d);let m=!f;const v=t.wordWrapWidth+u,x=Ke.tokenize(e);for(let y=0;y<x.length;y++){let g=x[y];if(Ke.isNewline(g)){if(!p){a+=Ke.addLine(o),m=!f,o="",s=0;continue}g=" "}if(f){const S=Ke.isBreakingSpace(g),w=Ke.isBreakingSpace(o[o.length-1]);if(S&&w)continue}const T=Ke.getFromCache(g,u,l,r);if(T>v)if(o!==""&&(a+=Ke.addLine(o),o="",s=0),Ke.canBreakWords(g,t.breakWords)){const S=Ke.wordWrapSplit(g);for(let w=0;w<S.length;w++){let M=S[w],R=M,P=1;for(;S[w+P];){const C=S[w+P];if(!Ke.canBreakChars(R,C,g,w,t.breakWords))M+=C;else break;R=C,P++}w+=P-1;const N=Ke.getFromCache(M,u,l,r);N+s>v&&(a+=Ke.addLine(o),m=!1,o="",s=0),o+=M,s+=N}}else{o.length>0&&(a+=Ke.addLine(o),o="",s=0);const S=y===x.length-1;a+=Ke.addLine(g,!S),m=!1,o="",s=0}else T+s>v&&(m=!1,a+=Ke.addLine(o),o="",s=0),(o.length>0||!Ke.isBreakingSpace(g)||m)&&(o+=g,s+=T)}return a+=Ke.addLine(o,!1),a}static addLine(e,t=!0){return e=Ke.trimRight(e),e=t?`${e}
`:e,e}static getFromCache(e,t,i,r){let s=i[e];return typeof s!="number"&&(s=Ke._measureText(e,t,r)+t,i[e]=s),s}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){const i=e[t];if(!Ke.isBreakingSpace(i))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:Ke._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:Ke._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const t=[];let i="";if(typeof e!="string")return t;for(let r=0;r<e.length;r++){const s=e[r],o=e[r+1];if(Ke.isBreakingSpace(s,o)||Ke.isNewline(s)){i!==""&&(t.push(i),i=""),t.push(s);continue}i+=s}return i!==""&&t.push(i),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,i,r,s){return!0}static wordWrapSplit(e){return Ke.graphemeSegmenter(e)}static measureFont(e){if(Ke._fonts[e])return Ke._fonts[e];const t={ascent:0,descent:0,fontSize:0},i=Ke._canvas,r=Ke._context;r.font=e;const s=Ke.METRICS_STRING+Ke.BASELINE_SYMBOL,o=Math.ceil(r.measureText(s).width);let a=Math.ceil(r.measureText(Ke.BASELINE_SYMBOL).width);const l=Math.ceil(Ke.HEIGHT_MULTIPLIER*a);if(a=a*Ke.BASELINE_MULTIPLIER|0,o===0||l===0)return Ke._fonts[e]=t,t;i.width=o,i.height=l,r.fillStyle="#f00",r.fillRect(0,0,o,l),r.font=e,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(s,0,a);const u=r.getImageData(0,0,o,l).data,d=u.length,f=o*4;let p=0,m=0,v=!1;for(p=0;p<a;++p){for(let x=0;x<f;x+=4)if(u[m+x]!==255){v=!0;break}if(!v)m+=f;else break}for(t.ascent=a-p,m=d-f,v=!1,p=l;p>a;--p){for(let x=0;x<f;x+=4)if(u[m+x]!==255){v=!0;break}if(!v)m-=f;else break}return t.descent=p-a,t.fontSize=t.ascent+t.descent,Ke._fonts[e]=t,t}static clearMetrics(e=""){e?delete Ke._fonts[e]:Ke._fonts={}}static get _canvas(){var e;if(!Ke.__canvas){let t;try{const i=new OffscreenCanvas(0,0);if((e=i.getContext("2d",hm))!=null&&e.measureText)return Ke.__canvas=i,i;t=Fe.ADAPTER.createCanvas()}catch{t=Fe.ADAPTER.createCanvas()}t.width=t.height=10,Ke.__canvas=t}return Ke.__canvas}static get _context(){return Ke.__context||(Ke.__context=Ke._canvas.getContext("2d",hm)),Ke.__context}};Cs.METRICS_STRING="|q",Cs.BASELINE_SYMBOL="M",Cs.BASELINE_MULTIPLIER=1.4,Cs.HEIGHT_MULTIPLIER=2,Cs.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const n=new Intl.Segmenter;return e=>[...n.segment(e)].map(t=>t.segment)}return n=>[...n]})(),Cs.experimentalLetterSpacing=!1,Cs._fonts={},Cs._newlines=[10,13],Cs._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let ua=Cs;const e9=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],VL=class nd{constructor(e){this.styleID=0,this.reset(),Dy(this,e,e)}clone(){const e={};return Dy(e,this,nd.defaultStyle),new nd(e)}reset(){Dy(this,nd.defaultStyle,nd.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const t=Ly(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const t=Ly(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){t9(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const t=Ly(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let i=t.length-1;i>=0;i--){let r=t[i].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!e9.includes(r)&&(r=`"${r}"`),t[i]=r}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}};VL.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:L0.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Fa=VL;function Ly(n){const e=Jt.shared,t=i=>{const r=e.setValue(i);return r.alpha===1?r.toHex():r.toRgbaString()};return Array.isArray(n)?n.map(t):t(n)}function t9(n,e){if(!Array.isArray(n)||!Array.isArray(e)||n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}function Dy(n,e,t){for(const i in t)Array.isArray(e[i])?n[i]=e[i].slice():n[i]=e[i]}const n9={texture:!0,children:!1,baseTexture:!0},WL=class G1 extends Zs{constructor(e,t,i){let r=!1;i||(i=Fe.ADAPTER.createCanvas(),r=!0),i.width=3,i.height=3;const s=Pe.from(i);s.orig=new ut,s.trim=new ut,super(s),this._ownCanvas=r,this.canvas=i,this.context=i.getContext("2d",{willReadFrequently:!0}),this._resolution=G1.defaultResolution??Fe.RESOLUTION,this._autoResolution=G1.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return ua.experimentalLetterSpacing}static set experimentalLetterSpacing(e){Rt("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),ua.experimentalLetterSpacing=e}updateText(e){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const i=this.context,r=ua.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=r.width,o=r.height,a=r.lines,l=r.lineHeight,u=r.lineWidths,d=r.maxLineWidth,f=r.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+t.padding*2)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=t.strokeThickness,i.textBaseline=t.textBaseline,i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit;let p,m;const v=t.dropShadow?2:1;for(let x=0;x<v;++x){const y=t.dropShadow&&x===0,g=y?Math.ceil(Math.max(1,o)+t.padding*2):0,T=g*this._resolution;if(y){i.fillStyle="black",i.strokeStyle="black";const w=t.dropShadowColor,M=t.dropShadowBlur*this._resolution,R=t.dropShadowDistance*this._resolution;i.shadowColor=Jt.shared.setValue(w).setAlpha(t.dropShadowAlpha).toRgbaString(),i.shadowBlur=M,i.shadowOffsetX=Math.cos(t.dropShadowAngle)*R,i.shadowOffsetY=Math.sin(t.dropShadowAngle)*R+T}else i.fillStyle=this._generateFillStyle(t,a,r),i.strokeStyle=t.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;let S=(l-f.fontSize)/2;l-f.fontSize<0&&(S=0);for(let w=0;w<a.length;w++)p=t.strokeThickness/2,m=t.strokeThickness/2+w*l+f.ascent+S,t.align==="right"?p+=d-u[w]:t.align==="center"&&(p+=(d-u[w])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(a[w],p+t.padding,m+t.padding-g,!0),t.fill&&this.drawLetterSpacing(a[w],p+t.padding,m+t.padding-g)}this.updateTexture()}drawLetterSpacing(e,t,i,r=!1){const s=this._style.letterSpacing;let o=!1;if(ua.experimentalLetterSpacingSupported&&(ua.experimentalLetterSpacing?(this.context.letterSpacing=`${s}px`,this.context.textLetterSpacing=`${s}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),s===0||o){r?this.context.strokeText(e,t,i):this.context.fillText(e,t,i);return}let a=t;const l=ua.graphemeSegmenter(e);let u=this.context.measureText(e).width,d=0;for(let f=0;f<l.length;++f){const p=l[f];r?this.context.strokeText(p,a,i):this.context.fillText(p,a,i);let m="";for(let v=f+1;v<l.length;++v)m+=l[v];d=this.context.measureText(m).width,a+=u-d+s,u=d}}updateTexture(){const e=this.canvas;if(this._style.trim){const o=LH(e);o.data&&(e.width=o.width,e.height=o.height,this.context.putImageData(o.data,0,0))}const t=this._texture,i=this._style,r=i.trim?0:i.padding,s=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-r,t.trim.y=-r,t.orig.width=t._frame.width-r*2,t.orig.height=t._frame.height-r*2,this._onTextureUpdate(),s.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,i){const r=e.fill;if(Array.isArray(r)){if(r.length===1)return r[0]}else return r;let s;const o=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,l=this.canvas.width/this._resolution-o-a*2,u=this.canvas.height/this._resolution-o-a*2,d=r.slice(),f=e.fillGradientStops.slice();if(!f.length){const p=d.length+1;for(let m=1;m<p;++m)f.push(m/p)}if(d.unshift(r[0]),f.unshift(0),d.push(r[r.length-1]),f.push(1),e.fillGradientType===L0.LINEAR_VERTICAL){s=this.context.createLinearGradient(l/2,a,l/2,u+a);const p=i.fontProperties.fontSize+e.strokeThickness;for(let m=0;m<t.length;m++){const v=i.lineHeight*(m-1)+p,x=i.lineHeight*m;let y=x;m>0&&v>x&&(y=(x+v)/2);const g=x+p,T=i.lineHeight*(m+1);let S=g;m+1<t.length&&T<g&&(S=(g+T)/2);const w=(S-y)/u;for(let M=0;M<d.length;M++){let R=0;typeof f[M]=="number"?R=f[M]:R=M/d.length;let P=Math.min(1,Math.max(0,y/u+R*w));P=Number(P.toFixed(5)),s.addColorStop(P,d[M])}}}else{s=this.context.createLinearGradient(a,u/2,l+a,u/2);const p=d.length+1;let m=1;for(let v=0;v<d.length;v++){let x;typeof f[v]=="number"?x=f[v]:x=m/p,s.addColorStop(x,d[v]),m++}}return s}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},n9,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const t=_a(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const t=_a(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof Fa?this._style=e:this._style=new Fa(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};WL.defaultAutoResolution=!0;let IE=WL;class jg{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Qm{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const t=e.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const s in t){const o=t[s].match(/^[a-z]+/gm)[0],a=t[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(const u in a){const d=a[u].split("="),f=d[0],p=d[1].replace(/"/gm,""),m=parseFloat(p),v=isNaN(m)?p:m;l[f]=v}i[o].push(l)}const r=new jg;return i.info.forEach(s=>r.info.push({face:s.face,size:parseInt(s.size,10)})),i.common.forEach(s=>r.common.push({lineHeight:parseInt(s.lineHeight,10)})),i.page.forEach(s=>r.page.push({id:parseInt(s.id,10),file:s.file})),i.char.forEach(s=>r.char.push({id:parseInt(s.id,10),page:parseInt(s.page,10),x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xoffset:parseInt(s.xoffset,10),yoffset:parseInt(s.yoffset,10),xadvance:parseInt(s.xadvance,10)})),i.kerning.forEach(s=>r.kerning.push({first:parseInt(s.first,10),second:parseInt(s.second,10),amount:parseInt(s.amount,10)})),i.distanceField.forEach(s=>r.distanceField.push({distanceRange:parseInt(s.distanceRange,10),fieldType:s.fieldType})),r}}class H1{static test(e){const t=e;return typeof e!="string"&&"getElementsByTagName"in e&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const t=new jg,i=e.getElementsByTagName("info"),r=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),l=e.getElementsByTagName("distanceField");for(let u=0;u<i.length;u++)t.info.push({face:i[u].getAttribute("face"),size:parseInt(i[u].getAttribute("size"),10)});for(let u=0;u<r.length;u++)t.common.push({lineHeight:parseInt(r[u].getAttribute("lineHeight"),10)});for(let u=0;u<s.length;u++)t.page.push({id:parseInt(s[u].getAttribute("id"),10)||0,file:s[u].getAttribute("file")});for(let u=0;u<o.length;u++){const d=o[u];t.char.push({id:parseInt(d.getAttribute("id"),10),page:parseInt(d.getAttribute("page"),10)||0,x:parseInt(d.getAttribute("x"),10),y:parseInt(d.getAttribute("y"),10),width:parseInt(d.getAttribute("width"),10),height:parseInt(d.getAttribute("height"),10),xoffset:parseInt(d.getAttribute("xoffset"),10),yoffset:parseInt(d.getAttribute("yoffset"),10),xadvance:parseInt(d.getAttribute("xadvance"),10)})}for(let u=0;u<a.length;u++)t.kerning.push({first:parseInt(a[u].getAttribute("first"),10),second:parseInt(a[u].getAttribute("second"),10),amount:parseInt(a[u].getAttribute("amount"),10)});for(let u=0;u<l.length;u++)t.distanceField.push({fieldType:l[u].getAttribute("fieldType"),distanceRange:parseInt(l[u].getAttribute("distanceRange"),10)});return t}}class V1{static test(e){return typeof e=="string"&&e.includes("<font>")?H1.test(Fe.ADAPTER.parseXML(e)):!1}static parse(e){return H1.parse(Fe.ADAPTER.parseXML(e))}}const Ny=[Qm,H1,V1];function i9(n){for(let e=0;e<Ny.length;e++)if(Ny[e].test(n))return Ny[e];return null}function r9(n,e,t,i,r,s){const o=t.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const l=t.dropShadow?t.dropShadowDistance:0,u=t.padding||0,d=n.width/i-l-u*2,f=n.height/i-l-u*2,p=o.slice(),m=t.fillGradientStops.slice();if(!m.length){const v=p.length+1;for(let x=1;x<v;++x)m.push(x/v)}if(p.unshift(o[0]),m.unshift(0),p.push(o[o.length-1]),m.push(1),t.fillGradientType===L0.LINEAR_VERTICAL){a=e.createLinearGradient(d/2,u,d/2,f+u);let v=0;const x=(s.fontProperties.fontSize+t.strokeThickness)/f;for(let y=0;y<r.length;y++){const g=s.lineHeight*y;for(let T=0;T<p.length;T++){let S=0;typeof m[T]=="number"?S=m[T]:S=T/p.length;const w=g/f+S*x;let M=Math.max(v,w);M=Math.min(M,1),a.addColorStop(M,p[T]),v=M}}}else{a=e.createLinearGradient(u,f/2,d+u,f/2);const v=p.length+1;let x=1;for(let y=0;y<p.length;y++){let g;typeof m[y]=="number"?g=m[y]:g=x/v,a.addColorStop(g,p[y]),x++}}return a}function s9(n,e,t,i,r,s,o){const a=t.text,l=t.fontProperties;e.translate(i,r),e.scale(s,s);const u=o.strokeThickness/2,d=-(o.strokeThickness/2);if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=r9(n,e,o,s,[a],t),e.strokeStyle=o.stroke,o.dropShadow){const f=o.dropShadowColor,p=o.dropShadowBlur*s,m=o.dropShadowDistance*s;e.shadowColor=Jt.shared.setValue(f).setAlpha(o.dropShadowAlpha).toRgbaString(),e.shadowBlur=p,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*m,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*m}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,u,d+t.lineHeight-l.descent),o.fill&&e.fillText(a,u,d+t.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function Jm(n){return n.codePointAt?n.codePointAt(0):n.charCodeAt(0)}function XL(n){return Array.from?Array.from(n):n.split("")}function o9(n){typeof n=="string"&&(n=[n]);const e=[];for(let t=0,i=n.length;t<i;t++){const r=n[t];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const s=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...XL(r))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const ia=class Rs{constructor(e,t,i){var d;const[r]=e.info,[s]=e.common,[o]=e.page,[a]=e.distanceField,l=Uo(o.file),u={};this._ownsTextures=i,this.font=r.face,this.size=r.size,this.lineHeight=s.lineHeight/l,this.chars={},this.pageTextures=u;for(let f=0;f<e.page.length;f++){const{id:p,file:m}=e.page[f];u[p]=t instanceof Array?t[f]:t[m],a!=null&&a.fieldType&&a.fieldType!=="none"&&(u[p].baseTexture.alphaMode=ji.NO_PREMULTIPLIED_ALPHA,u[p].baseTexture.mipmap=Ws.OFF)}for(let f=0;f<e.char.length;f++){const{id:p,page:m}=e.char[f];let{x:v,y:x,width:y,height:g,xoffset:T,yoffset:S,xadvance:w}=e.char[f];v/=l,x/=l,y/=l,g/=l,T/=l,S/=l,w/=l;const M=new ut(v+u[m].frame.x/l,x+u[m].frame.y/l,y,g);this.chars[p]={xOffset:T,yOffset:S,xAdvance:w,kerning:{},texture:new Pe(u[m].baseTexture,M),page:m}}for(let f=0;f<e.kerning.length;f++){let{first:p,second:m,amount:v}=e.kerning[f];p/=l,m/=l,v/=l,this.chars[m]&&(this.chars[m].kerning[p]=v)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((d=a==null?void 0:a.fieldType)==null?void 0:d.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,t,i){let r;if(e instanceof jg)r=e;else{const o=i9(e);if(!o)throw new Error("Unrecognized data format for font.");r=o.parse(e)}t instanceof Pe&&(t=[t]);const s=new Rs(r,t,i);return Rs.available[s.font]=s,s}static uninstall(e){const t=Rs.available[e];if(!t)throw new Error(`No font found named '${e}'`);t.destroy(),delete Rs.available[e]}static from(e,t,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:r,padding:s,resolution:o,textureWidth:a,textureHeight:l,...u}=Object.assign({},Rs.defaultOptions,i),d=o9(r),f=t instanceof Fa?t:new Fa(t),p=a,m=new jg;m.info[0]={face:f.fontFamily,size:f.fontSize},m.common[0]={lineHeight:f.fontSize};let v=0,x=0,y,g,T,S=0;const w=[];for(let R=0;R<d.length;R++){y||(y=Fe.ADAPTER.createCanvas(),y.width=a,y.height=l,g=y.getContext("2d"),T=new lt(y,{resolution:o,...u}),w.push(new Pe(T)),m.page.push({id:w.length-1,file:""}));const P=d[R],N=ua.measureText(P,f,!1,y),C=N.width,L=Math.ceil(N.height),Q=Math.ceil((f.fontStyle==="italic"?2:1)*C);if(x>=l-L*o){if(x===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${f.fontFamily}', fontSize: ${f.fontSize}px, char: '${P}')`);--R,y=null,g=null,T=null,x=0,v=0,S=0;continue}if(S=Math.max(L+N.fontProperties.descent,S),Q*o+v>=p){if(v===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${f.fontFamily}', fontSize: ${f.fontSize}px, char: '${P}')`);--R,x+=S*o,x=Math.ceil(x),v=0,S=0;continue}s9(y,g,N,v,x,o,f);const W=Jm(N.text);m.char.push({id:W,page:w.length-1,x:v/o,y:x/o,width:Q,height:L,xoffset:0,yoffset:0,xadvance:C-(f.dropShadow?f.dropShadowDistance:0)-(f.stroke?f.strokeThickness:0)}),v+=(Q+2*s)*o,v=Math.ceil(v)}if(!(i!=null&&i.skipKerning))for(let R=0,P=d.length;R<P;R++){const N=d[R];for(let C=0;C<P;C++){const L=d[C],Q=g.measureText(N).width,W=g.measureText(L).width,z=g.measureText(N+L).width-(Q+W);z&&m.kerning.push({first:Jm(N),second:Jm(L),amount:z})}}const M=new Rs(m,w,!0);return Rs.available[e]!==void 0&&Rs.uninstall(e),Rs.available[e]=M,M}};ia.ALPHA=[["a","z"],["A","Z"]," "],ia.NUMERIC=[["0","9"]],ia.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],ia.ASCII=[[" ","~"]],ia.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:ia.ALPHANUMERIC},ia.available={};let ra=ia;class a9{constructor(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const t=this.uvBuffer.data;(!this.data||this.data.length!==t.length)&&(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}}const Uy=new Lt,LC=new Ul,jL=class $L extends Oi{constructor(e,t,i,r=is.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=i||Ks.for2d(),this.drawMode=r,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=Fe.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===is.TRIANGLES&&t.length<$L.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const t=this.geometry,i=this.shader;i.uvMatrix&&(i.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=i._tintRGB,this._texture=i.texture;const r=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[r]),e.plugins[r].render(this)}calculateVertices(){const e=this.geometry.buffers[0],t=e.data,i=e._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==t.length&&(this.vertexData=new Float32Array(t.length));const r=this.transform.worldTransform,s=r.a,o=r.b,a=r.c,l=r.d,u=r.tx,d=r.ty,f=this.vertexData;for(let p=0;p<f.length/2;p++){const m=t[p*2],v=t[p*2+1];f[p*2]=s*m+a*v+u,f[p*2+1]=o*m+l*v+d}if(this._roundPixels){const p=Fe.RESOLUTION;for(let m=0;m<f.length;++m)f[m]=Math.round(f[m]*p)/p}this.vertexDirty=i}calculateUvs(){const e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new a9(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,Uy);const t=this.geometry.getBuffer("aVertexPosition").data,i=LC.points,r=this.geometry.getIndex().data,s=r.length,o=this.drawMode===4?3:1;for(let a=0;a+2<s;a+=o){const l=r[a]*2,u=r[a+1]*2,d=r[a+2]*2;if(i[0]=t[l],i[1]=t[l+1],i[2]=t[u],i[3]=t[u+1],i[4]=t[d],i[5]=t[d+1],LC.contains(Uy.x,Uy.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};jL.BATCHABLE_SIZE=100;let Qd=jL;class D0 extends Da{constructor(e,t,i){super();const r=new Cn(e),s=new Cn(t,!0),o=new Cn(i,!0,!0);this.addAttribute("aVertexPosition",r,2,!1,et.FLOAT).addAttribute("aTextureCoord",s,2,!1,et.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var l9=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,u9=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class Jd extends Vs{constructor(e,t){const i={uSampler:e,alpha:1,uTextureMatrix:an.IDENTITY,uColor:new Float32Array([1,1,1,1])};t=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},t),t.uniforms&&Object.assign(i,t.uniforms),super(t.program||wo.from(u9,l9),i),this._colorDirty=!1,this.uvMatrix=new RE(e),this.batchable=t.program===void 0,this.pluginName=t.pluginName,this._tintColor=new Jt(t.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=t.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;Jt.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}var c9=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,h9=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const DC=[],NC=[],UC=[],YL=class qL extends Oi{constructor(e,t={}){super();const{align:i,tint:r,maxWidth:s,letterSpacing:o,fontName:a,fontSize:l}=Object.assign({},qL.styleDefaults,t);if(!ra.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=i,this._tintColor=new Jt(r),this._font=void 0,this._fontName=a,this._fontSize=l,this.text=e,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new Os(()=>{this.dirty=!0},this,0,0),this._roundPixels=Fe.ROUND_PIXELS,this.dirty=!0,this._resolution=Fe.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var Q;const e=ra.available[this._fontName],t=this.fontSize,i=t/e.size,r=new Lt,s=[],o=[],a=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",u=XL(l),d=this._maxWidth*e.size/t,f=e.distanceFieldType==="none"?DC:NC;let p=null,m=0,v=0,x=0,y=-1,g=0,T=0,S=0,w=0;for(let W=0;W<u.length;W++){const z=u[W],F=Jm(z);if(/(?:\s)/.test(z)&&(y=W,g=m,w++),z==="\r"||z===`
`){o.push(m),a.push(-1),v=Math.max(v,m),++x,++T,r.x=0,r.y+=e.lineHeight,p=null,w=0;continue}const X=e.chars[F];if(!X)continue;p&&X.kerning[p]&&(r.x+=X.kerning[p]);const Z=UC.pop()||{texture:Pe.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Lt};Z.texture=X.texture,Z.line=x,Z.charCode=F,Z.position.x=Math.round(r.x+X.xOffset+this._letterSpacing/2),Z.position.y=Math.round(r.y+X.yOffset),Z.prevSpaces=w,s.push(Z),m=Z.position.x+Math.max(X.xAdvance-X.xOffset,X.texture.orig.width),r.x+=X.xAdvance+this._letterSpacing,S=Math.max(S,X.yOffset+X.texture.height),p=F,y!==-1&&d>0&&r.x>d&&(++T,bc(s,1+y-T,1+W-y),W=y,y=-1,o.push(g),a.push(s.length>0?s[s.length-1].prevSpaces:0),v=Math.max(v,g),x++,r.x=0,r.y+=e.lineHeight,p=null,w=0)}const M=u[u.length-1];M!=="\r"&&M!==`
`&&(/(?:\s)/.test(M)&&(m=g),o.push(m),v=Math.max(v,m),a.push(-1));const R=[];for(let W=0;W<=x;W++){let z=0;this._align==="right"?z=v-o[W]:this._align==="center"?z=(v-o[W])/2:this._align==="justify"&&(z=a[W]<0?0:(v-o[W])/a[W]),R.push(z)}const P=s.length,N={},C=[],L=this._activePagesMeshData;f.push(...L);for(let W=0;W<P;W++){const z=s[W].texture,F=z.baseTexture.uid;if(!N[F]){let X=f.pop();if(!X){const $=new D0;let O,H;e.distanceFieldType==="none"?(O=new Jd(Pe.EMPTY),H=rt.NORMAL):(O=new Jd(Pe.EMPTY,{program:wo.from(h9,c9),uniforms:{uFWidth:0}}),H=rt.NORMAL_NPM);const B=new Qd($,O);B.blendMode=H,X={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:B,vertices:null,uvs:null,indices:null}}X.index=0,X.indexCount=0,X.vertexCount=0,X.uvsCount=0,X.total=0;const{_textureCache:Z}=this;Z[F]=Z[F]||new Pe(z.baseTexture),X.mesh.texture=Z[F],X.mesh.tint=this._tintColor.value,C.push(X),N[F]=X}N[F].total++}for(let W=0;W<L.length;W++)C.includes(L[W])||this.removeChild(L[W].mesh);for(let W=0;W<C.length;W++)C[W].mesh.parent!==this&&this.addChild(C[W].mesh);this._activePagesMeshData=C;for(const W in N){const z=N[W],F=z.total;if(!(((Q=z.indices)==null?void 0:Q.length)>6*F)||z.vertices.length<Qd.BATCHABLE_SIZE*2)z.vertices=new Float32Array(4*2*F),z.uvs=new Float32Array(4*2*F),z.indices=new Uint16Array(6*F);else{const X=z.total,Z=z.vertices;for(let $=X*4*2;$<Z.length;$++)Z[$]=0}z.mesh.size=6*F}for(let W=0;W<P;W++){const z=s[W];let F=z.position.x+R[z.line]*(this._align==="justify"?z.prevSpaces:1);this._roundPixels&&(F=Math.round(F));const X=F*i,Z=z.position.y*i,$=z.texture,O=N[$.baseTexture.uid],H=$.frame,B=$._uvs,G=O.index++;O.indices[G*6+0]=0+G*4,O.indices[G*6+1]=1+G*4,O.indices[G*6+2]=2+G*4,O.indices[G*6+3]=0+G*4,O.indices[G*6+4]=2+G*4,O.indices[G*6+5]=3+G*4,O.vertices[G*8+0]=X,O.vertices[G*8+1]=Z,O.vertices[G*8+2]=X+H.width*i,O.vertices[G*8+3]=Z,O.vertices[G*8+4]=X+H.width*i,O.vertices[G*8+5]=Z+H.height*i,O.vertices[G*8+6]=X,O.vertices[G*8+7]=Z+H.height*i,O.uvs[G*8+0]=B.x0,O.uvs[G*8+1]=B.y0,O.uvs[G*8+2]=B.x1,O.uvs[G*8+3]=B.y1,O.uvs[G*8+4]=B.x2,O.uvs[G*8+5]=B.y2,O.uvs[G*8+6]=B.x3,O.uvs[G*8+7]=B.y3}this._textWidth=v*i,this._textHeight=(r.y+e.lineHeight)*i;for(const W in N){const z=N[W];if(this.anchor.x!==0||this.anchor.y!==0){let $=0;const O=this._textWidth*this.anchor.x,H=this._textHeight*this.anchor.y;for(let B=0;B<z.total;B++)z.vertices[$++]-=O,z.vertices[$++]-=H,z.vertices[$++]-=O,z.vertices[$++]-=H,z.vertices[$++]-=O,z.vertices[$++]-=H,z.vertices[$++]-=O,z.vertices[$++]-=H}this._maxLineHeight=S*i;const F=z.mesh.geometry.getBuffer("aVertexPosition"),X=z.mesh.geometry.getBuffer("aTextureCoord"),Z=z.mesh.geometry.getIndex();F.data=z.vertices,X.data=z.uvs,Z.data=z.indices,F.update(),X.update(),Z.update()}for(let W=0;W<s.length;W++)UC.push(s[W]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:i,size:r}=ra.available[this._fontName];if(i!=="none"){const{a:s,b:o,c:a,d:l}=this.worldTransform,u=Math.sqrt(s*s+o*o),d=Math.sqrt(a*a+l*l),f=(Math.abs(u)+Math.abs(d))/2,p=this.fontSize/r,m=e._view.resolution;for(const v of this._activePagesMeshData)v.mesh.shader.uniforms.uFWidth=f*t*p*m}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=ra.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!ra.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??ra.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:t}=this,i=ra.available[this._fontName].distanceFieldType==="none"?DC:NC;i.push(...this._activePagesMeshData);for(const r of this._activePagesMeshData)this.removeChild(r.mesh);this._activePagesMeshData=[],i.filter(r=>t[r.mesh.texture.baseTexture.uid]).forEach(r=>{r.mesh.texture=Pe.EMPTY});for(const r in t)t[r].destroy(),delete t[r];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};YL.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};let d9=YL;const FC={loader:Ne.LoadParser,resolver:Ne.ResolveParser,cache:Ne.CacheParser,detection:Ne.DetectionParser};$e.handle(Ne.Asset,n=>{const e=n.ref;Object.entries(FC).filter(([t])=>!!e[t]).forEach(([t,i])=>$e.add(Object.assign(e[t],{extension:e[t].extension??i})))},n=>{const e=n.ref;Object.keys(FC).filter(t=>!!e[t]).forEach(t=>$e.remove(e[t]))});class f9{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(t=>{this._assetList.push(t)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<t;i++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function rh(n,e){if(Array.isArray(e)){for(const t of e)if(n.startsWith(`data:${t}`))return!0;return!1}return n.startsWith(`data:${e}`)}function Ha(n,e){const t=n.split("?")[0],i=Gn.extname(t).toLowerCase();return Array.isArray(e)?e.includes(i):i===e}const ns=(n,e,t=!1)=>(Array.isArray(n)||(n=[n]),e?n.map(i=>typeof i=="string"||t?e(i):i):n),W1=(n,e)=>{const t=e.split("?")[1];return t&&(n+=`?${t}`),n};function KL(n,e,t,i,r){const s=e[t];for(let o=0;o<s.length;o++){const a=s[o];t<e.length-1?KL(n.replace(i[t],a),e,t+1,i,r):r.push(n.replace(i[t],a))}}function p9(n){const e=/\{(.*?)\}/g,t=n.match(e),i=[];if(t){const r=[];t.forEach(s=>{const o=s.substring(1,s.length-1).split(",");r.push(o)}),KL(n,r,0,t,i)}else i.push(n);return i}const $g=n=>!Array.isArray(n);class m9{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);return t||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){const i=ns(e);let r;for(let a=0;a<this.parsers.length;a++){const l=this.parsers[a];if(l.test(t)){r=l.getCacheableAssets(i,t);break}}r||(r={},i.forEach(a=>{r[a]=t}));const s=Object.keys(r),o={cacheKeys:s,keys:i};if(i.forEach(a=>{this._cacheMap.set(a,o)}),s.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==t&&console.warn("[Cache] already has key:",a),this._cache.set(a,r[a])}),t instanceof Pe){const a=t;i.forEach(l=>{a.baseTexture!==Pe.EMPTY.baseTexture&&lt.addToCache(a.baseTexture,l),Pe.addToCache(a,l)})}}remove(e){if(!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const t=this._cacheMap.get(e);t.cacheKeys.forEach(i=>{this._cache.delete(i)}),t.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const yl=new m9;class g9{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,i)=>(this._parsersValidated=!1,e[t]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){const i={promise:null,parser:null};return i.promise=(async()=>{var o,a;let r=null,s=null;if(t.loadParser&&(s=this._parserHash[t.loadParser],s||console.warn(`[Assets] specified load parser "${t.loadParser}" not found while loading ${e}`)),!s){for(let l=0;l<this.parsers.length;l++){const u=this.parsers[l];if(u.load&&((o=u.test)!=null&&o.call(u,e,t,this))){s=u;break}}if(!s)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await s.load(e,t,this),i.parser=s;for(let l=0;l<this.parsers.length;l++){const u=this.parsers[l];u.parse&&u.parse&&await((a=u.testParse)==null?void 0:a.call(u,r,t,this))&&(r=await u.parse(r,t,this)||r,i.parser=u)}return r})(),i}async load(e,t){this._parsersValidated||this._validateParsers();let i=0;const r={},s=$g(e),o=ns(e,u=>({alias:[u],src:u})),a=o.length,l=o.map(async u=>{const d=Gn.toAbsolute(u.src);if(!r[u.src])try{this.promiseCache[d]||(this.promiseCache[d]=this._getLoadPromiseAndParser(d,u)),r[u.src]=await this.promiseCache[d].promise,t&&t(++i/a)}catch(f){throw delete this.promiseCache[d],delete r[u.src],new Error(`[Loader.load] Failed to load ${d}.
${f}`)}});return await Promise.all(l),s?r[o[0].src]:r}async unload(e){const t=ns(e,i=>({alias:[i],src:i})).map(async i=>{var o,a;const r=Gn.toAbsolute(i.src),s=this.promiseCache[r];if(s){const l=await s.promise;delete this.promiseCache[r],(a=(o=s.parser)==null?void 0:o.unload)==null||a.call(o,l,i,this)}});await Promise.all(t)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,t)=>(e[t.name]&&console.warn(`[Assets] loadParser name conflict "${t.name}"`),{...e,[t.name]:t}),{})}}var hs=(n=>(n[n.Low=0]="Low",n[n.Normal=1]="Normal",n[n.High=2]="High",n))(hs||{});const _9=".json",v9="application/json",y9={extension:{type:Ne.LoadParser,priority:hs.Low},name:"loadJson",test(n){return rh(n,v9)||Ha(n,_9)},async load(n){return await(await Fe.ADAPTER.fetch(n)).json()}};$e.add(y9);const x9=".txt",S9="text/plain",E9={name:"loadTxt",extension:{type:Ne.LoadParser,priority:hs.Low},test(n){return rh(n,S9)||Ha(n,x9)},async load(n){return await(await Fe.ADAPTER.fetch(n)).text()}};$e.add(E9);const T9=["normal","bold","100","200","300","400","500","600","700","800","900"],b9=[".ttf",".otf",".woff",".woff2"],w9=["font/ttf","font/otf","font/woff","font/woff2"],A9=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function M9(n){const e=Gn.extname(n),t=Gn.basename(n,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1));let i=t.length>0;for(const s of t)if(!s.match(A9)){i=!1;break}let r=t.join(" ");return i||(r=`"${r.replace(/[\\"]/g,"\\$&")}"`),r}const C9=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function R9(n){return C9.test(n)?n:encodeURI(n)}const P9={extension:{type:Ne.LoadParser,priority:hs.Low},name:"loadWebFont",test(n){return rh(n,w9)||Ha(n,b9)},async load(n,e){var i,r,s;const t=Fe.ADAPTER.getFontFaceSet();if(t){const o=[],a=((i=e.data)==null?void 0:i.family)??M9(n),l=((s=(r=e.data)==null?void 0:r.weights)==null?void 0:s.filter(d=>T9.includes(d)))??["normal"],u=e.data??{};for(let d=0;d<l.length;d++){const f=l[d],p=new FontFace(a,`url(${R9(n)})`,{...u,weight:f});await p.load(),t.add(p),o.push(p)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(n){(Array.isArray(n)?n:[n]).forEach(e=>Fe.ADAPTER.getFontFaceSet().delete(e))}};$e.add(P9);let OC=0,Fy;const I9="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",L9={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${I9}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},D9={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let Oy;class N9{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const t=URL.createObjectURL(new Blob([L9.code],{type:"application/javascript"})),i=new Worker(t);i.addEventListener("message",r=>{i.terminate(),URL.revokeObjectURL(t),e(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Fy===void 0&&(Fy=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<Fy&&(Oy||(Oy=URL.createObjectURL(new Blob([D9.code],{type:"application/javascript"}))),this._createdWorkers++,e=new Worker(Oy),e.addEventListener("message",t=>{this.complete(t.data),this.returnWorker(t.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,t){await this._initWorkers();const i=new Promise((r,s)=>{this.queue.push({id:e,arguments:t,resolve:r,reject:s})});return this.next(),i}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const t=this.queue.pop(),i=t.id;this.resolveHash[OC]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:OC++,id:i})}}const BC=new N9;function df(n,e,t){n.resource.internal=!0;const i=new Pe(n),r=()=>{delete e.promiseCache[t],yl.has(t)&&yl.remove(t)};return i.baseTexture.once("destroyed",()=>{t in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),r())}),i.once("destroyed",()=>{n.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),r())}),i}const U9=[".jpeg",".jpg",".png",".webp",".avif"],F9=["image/jpeg","image/png","image/webp","image/avif"];async function O9(n){const e=await Fe.ADAPTER.fetch(n);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${n}: ${e.status} ${e.statusText}`);const t=await e.blob();return await createImageBitmap(t)}const N0={name:"loadTextures",extension:{type:Ne.LoadParser,priority:hs.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(n){return rh(n,F9)||Ha(n,U9)},async load(n,e,t){var a;const i=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let r;i?this.config.preferWorkers&&await BC.isImageBitmapSupported()?r=await BC.loadImageBitmap(n):r=await O9(n):r=await new Promise((l,u)=>{const d=new Image;d.crossOrigin=this.config.crossOrigin,d.src=n,d.complete?l(d):(d.onload=()=>l(d),d.onerror=f=>u(f))});const s={...e.data};s.resolution??(s.resolution=Uo(n)),i&&((a=s.resourceOptions)==null?void 0:a.ownsImageBitmap)===void 0&&(s.resourceOptions={...s.resourceOptions},s.resourceOptions.ownsImageBitmap=!0);const o=new lt(r,s);return o.resource.src=n,df(o,t,n)},unload(n){n.destroy(!0)}};$e.add(N0);const B9=".svg",k9="image/svg+xml",z9={extension:{type:Ne.LoadParser,priority:hs.High},name:"loadSVG",test(n){return rh(n,k9)||Ha(n,B9)},async testParse(n){return O1.test(n)},async parse(n,e,t){var s;const i=new O1(n,(s=e==null?void 0:e.data)==null?void 0:s.resourceOptions);await i.load();const r=new lt(i,{resolution:Uo(n),...e==null?void 0:e.data});return r.resource.src=e.src,df(r,t,e.src)},async load(n,e){return(await Fe.ADAPTER.fetch(n)).text()},unload:N0.unload};$e.add(z9);const G9=[".mp4",".m4v",".webm",".ogv"],H9=["video/mp4","video/webm","video/ogg"],V9={name:"loadVideo",extension:{type:Ne.LoadParser,priority:hs.High},config:{defaultAutoPlay:!0},test(n){return rh(n,H9)||Ha(n,G9)},async load(n,e,t){var o;let i;const r=await(await Fe.ADAPTER.fetch(n)).blob(),s=URL.createObjectURL(r);try{const a={autoPlay:this.config.defaultAutoPlay,...(o=e==null?void 0:e.data)==null?void 0:o.resourceOptions},l=new GL(s,a);await l.load();const u=new lt(l,{alphaMode:await pH(),resolution:Uo(n),...e==null?void 0:e.data});u.resource.src=n,i=df(u,t,n),i.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(s)})}catch(a){throw URL.revokeObjectURL(s),a}return i},unload(n){n.destroy(!0)}};$e.add(V9);class W9{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>`${e}${this._bundleIdConnector}${t}`,extractAssetIdFromBundle:(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const t=e;this._defaultSearchParams=Object.keys(t).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(t[i])}`).join("&")}}getAlias(e){const{alias:t,name:i,src:r,srcs:s}=e;return ns(t||i||r||s,o=>typeof o=="string"?o:Array.isArray(o)?o.map(a=>(a==null?void 0:a.src)??(a==null?void 0:a.srcs)??a):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(t=>{this.addBundle(t.name,t.assets)})}addBundle(e,t){const i=[];Array.isArray(t)?t.forEach(r=>{const s=r.src??r.srcs,o=r.alias??r.name;let a;if(typeof o=="string"){const l=this._createBundleAssetId(e,o);i.push(l),a=[o,l]}else{const l=o.map(u=>this._createBundleAssetId(e,u));i.push(...l),a=[...o,...l]}this.add({...r,alias:a,src:s})}):Object.keys(t).forEach(r=>{const s=[r,this._createBundleAssetId(e,r)];if(typeof t[r]=="string")this.add({alias:s,src:t[r]});else if(Array.isArray(t[r]))this.add({alias:s,src:t[r]});else{const o=t[r],a=o.src??o.srcs;this.add({...o,alias:s,src:Array.isArray(a)?a:[a]})}i.push(...s)}),this._bundles[e]=i}add(e,t,i,r,s){const o=[];typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"?(Rt("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:e,src:t,data:i,format:r,loadParser:s})):Array.isArray(e)?o.push(...e):o.push(e);let a;a=l=>{this.hasKey(l)&&console.warn(`[Resolver] already has key: ${l} overwriting`)},ns(o).forEach(l=>{const{src:u,srcs:d}=l;let{data:f,format:p,loadParser:m}=l;const v=ns(u||d).map(g=>typeof g=="string"?p9(g):Array.isArray(g)?g:[g]),x=this.getAlias(l);Array.isArray(x)?x.forEach(a):a(x);const y=[];v.forEach(g=>{g.forEach(T=>{let S={};if(typeof T!="object"){S.src=T;for(let w=0;w<this._parsers.length;w++){const M=this._parsers[w];if(M.test(T)){S=M.parse(T);break}}}else f=T.data??f,p=T.format??p,m=T.loadParser??m,S={...S,...T};if(!x)throw new Error(`[Resolver] alias is undefined for this asset: ${S.src}`);S=this.buildResolvedAsset(S,{aliases:x,data:f,format:p,loadParser:m}),y.push(S)})}),x.forEach(g=>{this._assetMap[g]=y})})}resolveBundle(e){const t=$g(e);e=ns(e);const i={};return e.forEach(r=>{const s=this._bundles[r];if(s){const o=this.resolve(s),a={};for(const l in o){const u=o[l];a[this._extractAssetIdFromBundle(r,l)]=u}i[r]=a}}),t?i[e[0]]:i}resolveUrl(e){const t=this.resolve(e);if(typeof e!="string"){const i={};for(const r in t)i[r]=t[r].src;return i}return t.src}resolve(e){const t=$g(e);e=ns(e);const i={};return e.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let s=this._assetMap[r];const o=s[0],a=this._getPreferredOrder(s);a==null||a.priority.forEach(l=>{a.params[l].forEach(u=>{const d=s.filter(f=>f[l]?f[l]===u:!1);d.length&&(s=d)})}),this._resolverHash[r]=s[0]??o}else this._resolverHash[r]=this.buildResolvedAsset({alias:[r],src:r},{});i[r]=this._resolverHash[r]}),t?i[e[0]]:i}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let t=0;t<e.length;t++){const i=e[0],r=this._preferredOrder.find(s=>s.params.format.includes(i.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const t=/\?/.test(e)?"&":"?";return`${e}${t}${this._defaultSearchParams}`}buildResolvedAsset(e,t){const{aliases:i,data:r,loadParser:s,format:o}=t;return(this._basePath||this._rootPath)&&(e.src=Gn.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=i??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...r||{},...e.data},e.loadParser=s??e.loadParser,e.format=o??Gn.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class X9{constructor(){this._detections=[],this._initialized=!1,this.resolver=new W9,this.loader=new g9,this.cache=yl,this._backgroundLoader=new f9(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var s,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let a=e.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const t=((s=e.texturePreference)==null?void 0:s.resolution)??1,i=typeof t=="number"?[t]:t,r=await this._detectFormats({preferredFormats:(o=e.texturePreference)==null?void 0:o.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:i}}),e.preferences&&this.setPreferences(e.preferences)}add(e,t,i,r,s){this.resolver.add(e,t,i,r,s)}async load(e,t){this._initialized||await this.init();const i=$g(e),r=ns(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(u=>!this.resolver.hasKey(u))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),s=this.resolver.resolve(r),o=await this._mapLoadToResolve(s,t);return i?o[r[0]]:o}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let i=!1;typeof e=="string"&&(i=!0,e=[e]);const r=this.resolver.resolveBundle(e),s={},o=Object.keys(r);let a=0,l=0;const u=()=>{t==null||t(++a/l)},d=o.map(f=>{const p=r[f];return l+=Object.keys(p).length,this._mapLoadToResolve(p,u).then(m=>{s[f]=m})});return await Promise.all(d),i?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolveBundle(e);Object.values(t).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return yl.get(e);const t={};for(let i=0;i<e.length;i++)t[i]=yl.get(e[i]);return t}async _mapLoadToResolve(e,t){const i=Object.values(e),r=Object.keys(e);this._backgroundLoader.active=!1;const s=await this.loader.load(i,t);this._backgroundLoader.active=!0;const o={};return i.forEach((a,l)=>{const u=s[a.src],d=[a.src];a.alias&&d.push(...a.alias),o[r[l]]=u,yl.set(d,u)}),o}async unload(e){this._initialized||await this.init();const t=ns(e).map(r=>typeof r!="string"?r.src:r),i=this.resolver.resolve(t);await this._unloadFromResolved(i)}async unloadBundle(e){this._initialized||await this.init(),e=ns(e);const t=this.resolver.resolveBundle(e),i=Object.keys(t).map(r=>this._unloadFromResolved(t[r]));await Promise.all(i)}async _unloadFromResolved(e){const t=Object.values(e);t.forEach(i=>{yl.remove(i.src)}),await this.loader.unload(t)}async _detectFormats(e){let t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const i of e.detections)e.skipDetections||await i.test()?t=await i.add(t):e.skipDetections||(t=await i.remove(t));return t=t.filter((i,r)=>t.indexOf(i)===r),t}get detections(){return this._detections}get preferWorkers(){return N0.config.preferWorkers}set preferWorkers(e){Rt("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(i=>i in e).forEach(i=>{t.config[i]=e[i]})})}}const Al=new X9;$e.handleByList(Ne.LoadParser,Al.loader.parsers).handleByList(Ne.ResolveParser,Al.resolver.parsers).handleByList(Ne.CacheParser,Al.cache.parsers).handleByList(Ne.DetectionParser,Al.detections);const j9={extension:Ne.CacheParser,test:n=>Array.isArray(n)&&n.every(e=>e instanceof Pe),getCacheableAssets:(n,e)=>{const t={};return n.forEach(i=>{e.forEach((r,s)=>{t[i+(s===0?"":s+1)]=r})}),t}};$e.add(j9);async function ZL(n){if("Image"in globalThis)return new Promise(e=>{const t=new Image;t.onload=()=>{e(!0)},t.onerror=()=>{e(!1)},t.src=n});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(n)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const $9={extension:{type:Ne.DetectionParser,priority:1},test:async()=>ZL("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async n=>[...n,"avif"],remove:async n=>n.filter(e=>e!=="avif")};$e.add($9);const Y9={extension:{type:Ne.DetectionParser,priority:0},test:async()=>ZL("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async n=>[...n,"webp"],remove:async n=>n.filter(e=>e!=="webp")};$e.add(Y9);const kC=["png","jpg","jpeg"],q9={extension:{type:Ne.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async n=>[...n,...kC],remove:async n=>n.filter(e=>!kC.includes(e))};$e.add(q9);const K9="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function LE(n){return K9?!1:document.createElement("video").canPlayType(n)!==""}const Z9={extension:{type:Ne.DetectionParser,priority:0},test:async()=>LE("video/webm"),add:async n=>[...n,"webm"],remove:async n=>n.filter(e=>e!=="webm")};$e.add(Z9);const Q9={extension:{type:Ne.DetectionParser,priority:0},test:async()=>LE("video/mp4"),add:async n=>[...n,"mp4","m4v"],remove:async n=>n.filter(e=>e!=="mp4"&&e!=="m4v")};$e.add(Q9);const J9={extension:{type:Ne.DetectionParser,priority:0},test:async()=>LE("video/ogg"),add:async n=>[...n,"ogv"],remove:async n=>n.filter(e=>e!=="ogv")};$e.add(J9);const eV={extension:Ne.ResolveParser,test:N0.test,parse:n=>{var e;return{resolution:parseFloat(((e=Fe.RETINA_PREFIX.exec(n))==null?void 0:e[1])??"1"),format:Gn.extname(n).slice(1),src:n}}};$e.add(eV);const tV=[".xml",".fnt"],nV={extension:{type:Ne.LoadParser,priority:hs.Normal},name:"loadBitmapFont",test(n){return tV.includes(Gn.extname(n).toLowerCase())},async testParse(n){return Qm.test(n)||V1.test(n)},async parse(n,e,t){const i=Qm.test(n)?Qm.parse(n):V1.parse(n),{src:r}=e,{page:s}=i,o=[];for(let u=0;u<s.length;++u){const d=s[u].file;let f=Gn.join(Gn.dirname(r),d);f=W1(f,r),o.push(f)}const a=await t.load(o),l=o.map(u=>a[u]);return ra.install(i,l,!0)},async load(n,e){return(await Fe.ADAPTER.fetch(n)).text()},unload(n){n.destroy()}};$e.add(nV);const Yg={build(n){const e=n.points;let t,i,r,s,o,a;if(n.type===di.CIRC){const v=n.shape;t=v.x,i=v.y,o=a=v.radius,r=s=0}else if(n.type===di.ELIP){const v=n.shape;t=v.x,i=v.y,o=v.width,a=v.height,r=s=0}else{const v=n.shape,x=v.width/2,y=v.height/2;t=v.x+x,i=v.y+y,o=a=Math.max(0,Math.min(v.radius,Math.min(x,y))),r=x-o,s=y-a}if(!(o>=0&&a>=0&&r>=0&&s>=0)){e.length=0;return}const l=Math.ceil(2.3*Math.sqrt(o+a)),u=l*8+(r?4:0)+(s?4:0);if(e.length=u,u===0)return;if(l===0){e.length=8,e[0]=e[6]=t+r,e[1]=e[3]=i+s,e[2]=e[4]=t-r,e[5]=e[7]=i-s;return}let d=0,f=l*4+(r?2:0)+2,p=f,m=u;{const v=r+o,x=s,y=t+v,g=t-v,T=i+x;if(e[d++]=y,e[d++]=T,e[--f]=T,e[--f]=g,s){const S=i-x;e[p++]=g,e[p++]=S,e[--m]=S,e[--m]=y}}for(let v=1;v<l;v++){const x=Math.PI/2*(v/l),y=r+Math.cos(x)*o,g=s+Math.sin(x)*a,T=t+y,S=t-y,w=i+g,M=i-g;e[d++]=T,e[d++]=w,e[--f]=w,e[--f]=S,e[p++]=S,e[p++]=M,e[--m]=M,e[--m]=T}{const v=r,x=s+a,y=t+v,g=t-v,T=i+x,S=i-x;e[d++]=y,e[d++]=T,e[--m]=S,e[--m]=y,r&&(e[d++]=g,e[d++]=T,e[--m]=S,e[--m]=g)}},triangulate(n,e){const t=n.points,i=e.points,r=e.indices;if(t.length===0)return;let s=i.length/2;const o=s;let a,l;if(n.type!==di.RREC){const d=n.shape;a=d.x,l=d.y}else{const d=n.shape;a=d.x+d.width/2,l=d.y+d.height/2}const u=n.matrix;i.push(n.matrix?u.a*a+u.c*l+u.tx:a,n.matrix?u.b*a+u.d*l+u.ty:l),s++,i.push(t[0],t[1]);for(let d=2;d<t.length;d+=2)i.push(t[d],t[d+1]),r.push(s++,o,s);r.push(o+1,o,s)}};function zC(n,e=!1){const t=n.length;if(t<6)return;let i=0;for(let r=0,s=n[t-2],o=n[t-1];r<t;r+=2){const a=n[r],l=n[r+1];i+=(a-s)*(l+o),s=a,o=l}if(!e&&i>0||e&&i<=0){const r=t/2;for(let s=r+r%2;s<t;s+=2){const o=t-s-2,a=t-s-1,l=s,u=s+1;[n[o],n[l]]=[n[l],n[o]],[n[a],n[u]]=[n[u],n[a]]}}}const QL={build(n){n.points=n.shape.points.slice()},triangulate(n,e){let t=n.points;const i=n.holes,r=e.points,s=e.indices;if(t.length>=6){zC(t,!1);const o=[];for(let u=0;u<i.length;u++){const d=i[u];zC(d.points,!0),o.push(t.length/2),t=t.concat(d.points)}const a=X6(t,o,2);if(!a)return;const l=r.length/2;for(let u=0;u<a.length;u+=3)s.push(a[u]+l),s.push(a[u+1]+l),s.push(a[u+2]+l);for(let u=0;u<t.length;u++)r.push(t[u])}}},iV={build(n){const e=n.shape,t=e.x,i=e.y,r=e.width,s=e.height,o=n.points;o.length=0,r>=0&&s>=0&&o.push(t,i,t+r,i,t+r,i+s,t,i+s)},triangulate(n,e){const t=n.points,i=e.points;if(t.length===0)return;const r=i.length/2;i.push(t[0],t[1],t[2],t[3],t[6],t[7],t[4],t[5]),e.indices.push(r,r+1,r+2,r+1,r+2,r+3)}},rV={build(n){Yg.build(n)},triangulate(n,e){Yg.triangulate(n,e)}};var Mr=(n=>(n.MITER="miter",n.BEVEL="bevel",n.ROUND="round",n))(Mr||{}),va=(n=>(n.BUTT="butt",n.ROUND="round",n.SQUARE="square",n))(va||{});const Yc={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(n,e=20){if(!this.adaptive||!n||isNaN(n))return e;let t=Math.ceil(n/this.maxLength);return t<this.minSegments?t=this.minSegments:t>this.maxSegments&&(t=this.maxSegments),t}};class GC{static curveTo(e,t,i,r,s,o){const a=o[o.length-2],l=o[o.length-1]-t,u=a-e,d=r-t,f=i-e,p=Math.abs(l*f-u*d);if(p<1e-8||s===0)return(o[o.length-2]!==e||o[o.length-1]!==t)&&o.push(e,t),null;const m=l*l+u*u,v=d*d+f*f,x=l*d+u*f,y=s*Math.sqrt(m)/p,g=s*Math.sqrt(v)/p,T=y*x/m,S=g*x/v,w=y*f+g*u,M=y*d+g*l,R=u*(g+T),P=l*(g+T),N=f*(y+S),C=d*(y+S),L=Math.atan2(P-M,R-w),Q=Math.atan2(C-M,N-w);return{cx:w+e,cy:M+t,radius:s,startAngle:L,endAngle:Q,anticlockwise:u*d>f*l}}static arc(e,t,i,r,s,o,a,l,u){const d=a-o,f=Yc._segmentsCount(Math.abs(d)*s,Math.ceil(Math.abs(d)/zg)*40),p=d/(f*2),m=p*2,v=Math.cos(p),x=Math.sin(p),y=f-1,g=y%1/y;for(let T=0;T<=y;++T){const S=T+g*T,w=p+o+m*S,M=Math.cos(w),R=-Math.sin(w);u.push((v*M+x*R)*s+i,(v*-R+x*M)*s+r)}}}class sV{constructor(){this.reset()}begin(e,t,i){this.reset(),this.style=e,this.start=t,this.attribStart=i}end(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class DE{static curveLength(e,t,i,r,s,o,a,l){let u=0,d=0,f=0,p=0,m=0,v=0,x=0,y=0,g=0,T=0,S=0,w=e,M=t;for(let R=1;R<=10;++R)d=R/10,f=d*d,p=f*d,m=1-d,v=m*m,x=v*m,y=x*e+3*v*d*i+3*m*f*s+p*a,g=x*t+3*v*d*r+3*m*f*o+p*l,T=w-y,S=M-g,w=y,M=g,u+=Math.sqrt(T*T+S*S);return u}static curveTo(e,t,i,r,s,o,a){const l=a[a.length-2],u=a[a.length-1];a.length-=2;const d=Yc._segmentsCount(DE.curveLength(l,u,e,t,i,r,s,o));let f=0,p=0,m=0,v=0,x=0;a.push(l,u);for(let y=1,g=0;y<=d;++y)g=y/d,f=1-g,p=f*f,m=p*f,v=g*g,x=v*g,a.push(m*l+3*p*g*e+3*f*v*i+x*s,m*u+3*p*g*t+3*f*v*r+x*o)}}function HC(n,e,t,i,r,s,o,a){const l=n-t*r,u=e-i*r,d=n+t*s,f=e+i*s;let p,m;o?(p=i,m=-t):(p=-i,m=t);const v=l+p,x=u+m,y=d+p,g=f+m;return a.push(v,x,y,g),2}function rl(n,e,t,i,r,s,o,a){const l=t-n,u=i-e;let d=Math.atan2(l,u),f=Math.atan2(r-n,s-e);a&&d<f?d+=Math.PI*2:!a&&d>f&&(f+=Math.PI*2);let p=d;const m=f-d,v=Math.abs(m),x=Math.sqrt(l*l+u*u),y=(15*v*Math.sqrt(x)/Math.PI>>0)+1,g=m/y;if(p+=g,a){o.push(n,e,t,i);for(let T=1,S=p;T<y;T++,S+=g)o.push(n,e,n+Math.sin(S)*x,e+Math.cos(S)*x);o.push(n,e,r,s)}else{o.push(t,i,n,e);for(let T=1,S=p;T<y;T++,S+=g)o.push(n+Math.sin(S)*x,e+Math.cos(S)*x,n,e);o.push(r,s,n,e)}return y*2}function oV(n,e){const t=n.shape;let i=n.points||t.points.slice();const r=e.closePointEps;if(i.length===0)return;const s=n.lineStyle,o=new Lt(i[0],i[1]),a=new Lt(i[i.length-2],i[i.length-1]),l=t.type!==di.POLY||t.closeStroke,u=Math.abs(o.x-a.x)<r&&Math.abs(o.y-a.y)<r;if(l){i=i.slice(),u&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));const $=(o.x+a.x)*.5,O=(a.y+o.y)*.5;i.unshift($,O),i.push($,O)}const d=e.points,f=i.length/2;let p=i.length;const m=d.length/2,v=s.width/2,x=v*v,y=s.miterLimit*s.miterLimit;let g=i[0],T=i[1],S=i[2],w=i[3],M=0,R=0,P=-(T-w),N=g-S,C=0,L=0,Q=Math.sqrt(P*P+N*N);P/=Q,N/=Q,P*=v,N*=v;const W=s.alignment,z=(1-W)*2,F=W*2;l||(s.cap===va.ROUND?p+=rl(g-P*(z-F)*.5,T-N*(z-F)*.5,g-P*z,T-N*z,g+P*F,T+N*F,d,!0)+2:s.cap===va.SQUARE&&(p+=HC(g,T,P,N,z,F,!0,d))),d.push(g-P*z,T-N*z,g+P*F,T+N*F);for(let $=1;$<f-1;++$){g=i[($-1)*2],T=i[($-1)*2+1],S=i[$*2],w=i[$*2+1],M=i[($+1)*2],R=i[($+1)*2+1],P=-(T-w),N=g-S,Q=Math.sqrt(P*P+N*N),P/=Q,N/=Q,P*=v,N*=v,C=-(w-R),L=S-M,Q=Math.sqrt(C*C+L*L),C/=Q,L/=Q,C*=v,L*=v;const O=S-g,H=T-w,B=S-M,G=R-w,ne=O*B+H*G,ee=H*B-G*O,ie=ee<0;if(Math.abs(ee)<.001*Math.abs(ne)){d.push(S-P*z,w-N*z,S+P*F,w+N*F),ne>=0&&(s.join===Mr.ROUND?p+=rl(S,w,S-P*z,w-N*z,S-C*z,w-L*z,d,!1)+4:p+=2,d.push(S-C*F,w-L*F,S+C*z,w+L*z));continue}const pe=(-P+g)*(-N+w)-(-P+S)*(-N+T),ve=(-C+M)*(-L+w)-(-C+S)*(-L+R),Me=(O*ve-B*pe)/ee,Ze=(G*pe-H*ve)/ee,Ye=(Me-S)*(Me-S)+(Ze-w)*(Ze-w),ze=S+(Me-S)*z,Ie=w+(Ze-w)*z,q=S-(Me-S)*F,ct=w-(Ze-w)*F,Xe=Math.min(O*O+H*H,B*B+G*G),st=ie?z:F,nt=Xe+st*st*x,Kt=Ye<=nt;let gt=s.join;if(gt===Mr.MITER&&Ye/x>y&&(gt=Mr.BEVEL),Kt)switch(gt){case Mr.MITER:{d.push(ze,Ie,q,ct);break}case Mr.BEVEL:{ie?d.push(ze,Ie,S+P*F,w+N*F,ze,Ie,S+C*F,w+L*F):d.push(S-P*z,w-N*z,q,ct,S-C*z,w-L*z,q,ct),p+=2;break}case Mr.ROUND:{ie?(d.push(ze,Ie,S+P*F,w+N*F),p+=rl(S,w,S+P*F,w+N*F,S+C*F,w+L*F,d,!0)+4,d.push(ze,Ie,S+C*F,w+L*F)):(d.push(S-P*z,w-N*z,q,ct),p+=rl(S,w,S-P*z,w-N*z,S-C*z,w-L*z,d,!1)+4,d.push(S-C*z,w-L*z,q,ct));break}}else{switch(d.push(S-P*z,w-N*z,S+P*F,w+N*F),gt){case Mr.MITER:{ie?d.push(q,ct,q,ct):d.push(ze,Ie,ze,Ie),p+=2;break}case Mr.ROUND:{ie?p+=rl(S,w,S+P*F,w+N*F,S+C*F,w+L*F,d,!0)+2:p+=rl(S,w,S-P*z,w-N*z,S-C*z,w-L*z,d,!1)+2;break}}d.push(S-C*z,w-L*z,S+C*F,w+L*F),p+=2}}g=i[(f-2)*2],T=i[(f-2)*2+1],S=i[(f-1)*2],w=i[(f-1)*2+1],P=-(T-w),N=g-S,Q=Math.sqrt(P*P+N*N),P/=Q,N/=Q,P*=v,N*=v,d.push(S-P*z,w-N*z,S+P*F,w+N*F),l||(s.cap===va.ROUND?p+=rl(S-P*(z-F)*.5,w-N*(z-F)*.5,S-P*z,w-N*z,S+P*F,w+N*F,d,!1)+2:s.cap===va.SQUARE&&(p+=HC(S,w,P,N,z,F,!1,d)));const X=e.indices,Z=Yc.epsilon*Yc.epsilon;for(let $=m;$<p+m-2;++$)g=d[$*2],T=d[$*2+1],S=d[($+1)*2],w=d[($+1)*2+1],M=d[($+2)*2],R=d[($+2)*2+1],!(Math.abs(g*(w-R)+S*(R-T)+M*(T-w))<Z)&&X.push($,$+1,$+2)}function aV(n,e){let t=0;const i=n.shape,r=n.points||i.points,s=i.type!==di.POLY||i.closeStroke;if(r.length===0)return;const o=e.points,a=e.indices,l=r.length/2,u=o.length/2;let d=u;for(o.push(r[0],r[1]),t=1;t<l;t++)o.push(r[t*2],r[t*2+1]),a.push(d,d+1),d++;s&&a.push(d,u)}function VC(n,e){n.lineStyle.native?aV(n,e):oV(n,e)}class NE{static curveLength(e,t,i,r,s,o){const a=e-2*i+s,l=t-2*r+o,u=2*i-2*e,d=2*r-2*t,f=4*(a*a+l*l),p=4*(a*u+l*d),m=u*u+d*d,v=2*Math.sqrt(f+p+m),x=Math.sqrt(f),y=2*f*x,g=2*Math.sqrt(m),T=p/x;return(y*v+x*p*(v-g)+(4*m*f-p*p)*Math.log((2*x+T+v)/(T+g)))/(4*y)}static curveTo(e,t,i,r,s){const o=s[s.length-2],a=s[s.length-1],l=Yc._segmentsCount(NE.curveLength(o,a,e,t,i,r));let u=0,d=0;for(let f=1;f<=l;++f){const p=f/l;u=o+(e-o)*p,d=a+(t-a)*p,s.push(u+(e+(i-e)*p-u)*p,d+(t+(r-t)*p-d)*p)}}}const By={[di.POLY]:QL,[di.CIRC]:Yg,[di.ELIP]:Yg,[di.RECT]:iV,[di.RREC]:rV},WC=[],dm=[];class qg{constructor(e,t=null,i=null,r=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=i,this.fillStyle=t,this.matrix=r,this.type=e.type}clone(){return new qg(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const zu=new Lt,JL=class e3 extends sL{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Xg,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),dm.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t.reset(),WC.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,i=null,r=null){const s=new qg(e,t,i,r);return this.graphicsData.push(s),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;const i=new qg(e,null,null,t),r=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=r.lineStyle,r.holes.push(i),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const t=this.graphicsData;for(let i=0;i<t.length;++i){const r=t[i];if(r.fillStyle.visible&&r.shape&&(r.matrix?r.matrix.applyInverse(e,zu):zu.copyFrom(e),r.shape.contains(zu.x,zu.y))){let s=!1;if(r.holes){for(let o=0;o<r.holes.length;o++)if(r.holes[o].shape.contains(zu.x,zu.y)){s=!0;break}}if(!s)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,t=this.graphicsData;let i=null,r=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],r=i.style);for(let l=this.shapeIndex;l<t.length;l++){this.shapeIndex++;const u=t[l],d=u.fillStyle,f=u.lineStyle;By[u.type].build(u),u.matrix&&this.transformPoints(u.points,u.matrix),(d.visible||f.visible)&&this.processHoles(u.holes);for(let p=0;p<2;p++){const m=p===0?d:f;if(!m.visible)continue;const v=m.texture.baseTexture,x=this.indices.length,y=this.points.length/2;v.wrapMode=Co.REPEAT,p===0?this.processFill(u):this.processLine(u);const g=this.points.length/2-y;g!==0&&(i&&!this._compareStyles(r,m)&&(i.end(x,y),i=null),i||(i=WC.pop()||new sV,i.begin(m,x,y),this.batches.push(i),r=m),this.addUvs(this.points,e,m.texture,y,g,m.matrix))}}const s=this.indices.length,o=this.points.length/2;if(i&&i.end(s,o),this.batches.length===0){this.batchable=!0;return}const a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){const i=this.graphicsData[e],r=i.fillStyle,s=i.lineStyle;if(r&&!r.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let t=0,i=e.length;t<i;t++){const r=e[t];for(let s=0;s<r.size;s++){const o=r.start+s;this.indicesUint16[o]=this.indicesUint16[o]-r.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let t=0;t<e.length;t++)if(e[t].style.native)return!1;return this.points.length<e3.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++lt._globalBatch;for(let f=0;f<this.drawCalls.length;f++)this.drawCalls[f].texArray.clear(),dm.push(this.drawCalls[f]);this.drawCalls.length=0;const t=this.colors,i=this.textureIds;let r=dm.pop();r||(r=new M1,r.texArray=new I1),r.texArray.count=0,r.start=0,r.size=0,r.type=is.TRIANGLES;let s=0,o=null,a=0,l=!1,u=is.TRIANGLES,d=0;this.drawCalls.push(r);for(let f=0;f<this.batches.length;f++){const p=this.batches[f],m=8,v=p.style,x=v.texture.baseTexture;l!==!!v.native&&(l=!!v.native,u=l?is.LINES:is.TRIANGLES,o=null,s=m,e++),o!==x&&(o=x,x._batchEnabled!==e&&(s===m&&(e++,s=0,r.size>0&&(r=dm.pop(),r||(r=new M1,r.texArray=new I1),this.drawCalls.push(r)),r.start=d,r.size=0,r.texArray.count=0,r.type=u),x.touched=1,x._batchEnabled=e,x._batchLocation=s,x.wrapMode=Co.REPEAT,r.texArray.elements[r.texArray.count++]=x,s++)),r.size+=p.size,d+=p.size,a=x._batchLocation,this.addColors(t,v.color,v.alpha,p.attribSize,p.attribStart),this.addTextureIds(i,a,p.attribSize,p.attribStart)}lt._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,t=this.uvs,i=this.colors,r=this.textureIds,s=new ArrayBuffer(e.length*3*4),o=new Float32Array(s),a=new Uint32Array(s);let l=0;for(let u=0;u<e.length/2;u++)o[l++]=e[u*2],o[l++]=e[u*2+1],o[l++]=t[u*2],o[l++]=t[u*2+1],a[l++]=i[u],o[l++]=r[u];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?QL.triangulate(e,this):By[e.type].triangulate(e,this)}processLine(e){VC(e,this);for(let t=0;t<e.holes.length;t++)VC(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){const i=e[t];By[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let i=0;i<e.length/2;i++){const r=e[i*2],s=e[i*2+1];e[i*2]=t.a*r+t.c*s+t.tx,e[i*2+1]=t.b*r+t.d*s+t.ty}}addColors(e,t,i,r,s=0){const o=Jt.shared.setValue(t).toLittleEndianNumber(),a=Jt.shared.setValue(o).toPremultiplied(i);e.length=Math.max(e.length,s+r);for(let l=0;l<r;l++)e[s+l]=a}addTextureIds(e,t,i,r=0){e.length=Math.max(e.length,r+i);for(let s=0;s<i;s++)e[r+s]=t}addUvs(e,t,i,r,s,o=null){let a=0;const l=t.length,u=i.frame;for(;a<s;){let f=e[(r+a)*2],p=e[(r+a)*2+1];if(o){const m=o.a*f+o.c*p+o.tx;p=o.b*f+o.d*p+o.ty,f=m}a++,t.push(f/u.width,p/u.height)}const d=i.baseTexture;(u.width<d.width||u.height<d.height)&&this.adjustUvs(t,i,l,s)}adjustUvs(e,t,i,r){const s=t.baseTexture,o=1e-6,a=i+r*2,l=t.frame,u=l.width/s.width,d=l.height/s.height;let f=l.x/l.width,p=l.y/l.height,m=Math.floor(e[i]+o),v=Math.floor(e[i+1]+o);for(let x=i+2;x<a;x+=2)m=Math.min(m,Math.floor(e[x]+o)),v=Math.min(v,Math.floor(e[x+1]+o));f-=m,p-=v;for(let x=i;x<a;x+=2)e[x]=(e[x]+f)*u,e[x+1]=(e[x+1]+p)*d}};JL.BATCHABLE_SIZE=100;let lV=JL;class U0{constructor(){this.color=16777215,this.alpha=1,this.texture=Pe.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new U0;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=Pe.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class UE extends U0{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=va.BUTT,this.join=Mr.MITER,this.miterLimit=10}clone(){const e=new UE;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=va.BUTT,this.join=Mr.MITER,this.miterLimit=10}}const ky={},X1=class eg extends Oi{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new U0,this._lineStyle=new UE,this._matrix=null,this._holeMode=!1,this.state=Ks.for2d(),this._geometry=e||new lV,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Jt(16777215),this.blendMode=rt.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new eg(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,i,r=.5,s=!1){return typeof e=="number"&&(e={width:e,color:t,alpha:i,alignment:r,native:s}),this.lineTextureStyle(e)}lineTextureStyle(e){const t={width:0,texture:Pe.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:va.BUTT,join:Mr.MITER,miterLimit:10};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const i=e.width>0&&e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:i},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Ul,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new Ul,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);const i=this.currentPath.points,r=i[i.length-2],s=i[i.length-1];return(r!==e||s!==t)&&i.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,i,r){this._initCurve();const s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),NE.curveTo(e,t,i,r,s),this}bezierCurveTo(e,t,i,r,s,o){return this._initCurve(),DE.curveTo(e,t,i,r,s,o,this.currentPath.points),this}arcTo(e,t,i,r,s){this._initCurve(e,t);const o=this.currentPath.points,a=GC.curveTo(e,t,i,r,s,o);if(a){const{cx:l,cy:u,radius:d,startAngle:f,endAngle:p,anticlockwise:m}=a;this.arc(l,u,d,f,p,m)}return this}arc(e,t,i,r,s,o=!1){if(r===s)return this;if(!o&&s<=r?s+=zg:o&&r<=s&&(r+=zg),s-r===0)return this;const a=e+Math.cos(r)*i,l=t+Math.sin(r)*i,u=this._geometry.closePointEps;let d=this.currentPath?this.currentPath.points:null;if(d){const f=Math.abs(d[d.length-2]-a),p=Math.abs(d[d.length-1]-l);f<u&&p<u||d.push(a,l)}else this.moveTo(a,l),d=this.currentPath.points;return GC.arc(a,l,e,t,i,r,s,o,d),this}beginFill(e=0,t){return this.beginTextureFill({texture:Pe.WHITE,color:e,alpha:t})}normalizeColor(e){const t=Jt.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??(e.alpha=t.alpha)}beginTextureFill(e){const t={texture:Pe.WHITE,color:16777215,matrix:null};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const i=e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:i},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,i,r){return this.drawShape(new ut(e,t,i,r))}drawRoundedRect(e,t,i,r,s){return this.drawShape(new R0(e,t,i,r,s))}drawCircle(e,t,i){return this.drawShape(new M0(e,t,i))}drawEllipse(e,t,i,r){return this.drawShape(new C0(e,t,i,r))}drawPolygon(...e){let t,i=!0;const r=e[0];r.points?(i=r.closeStroke,t=r.points):Array.isArray(e[0])?t=e[0]:t=e;const s=new Ul(t);return s.closeStroke=i,this.drawShape(s),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===di.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,t=this.blendMode,i=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(e.points);for(let r=0;r<i;r++){const s=e.batches[r],o=s.style.color,a=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),l=new Float32Array(e.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),u=new Uint16Array(e.indicesUint16.buffer,s.start*2,s.size),d={vertexData:a,blendMode:t,indices:u,uvs:l,_batchRGB:Jt.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[r]=d}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,i=this.batches.length;t<i;t++){const r=this.batches[t];r.worldAlpha=this.worldAlpha*r.alpha,e.plugins[this.pluginName].render(r)}}}_renderDirect(e){const t=this._resolveDirectShader(e),i=this._geometry,r=this.worldAlpha,s=t.uniforms,o=i.drawCalls;s.translationMatrix=this.transform.worldTransform,Jt.shared.setValue(this._tintColor).premultiply(r).toArray(s.tint),e.shader.bind(t),e.geometry.bind(i,t),e.state.set(this.state);for(let a=0,l=o.length;a<l;a++)this._renderDrawCallDirect(e,i.drawCalls[a])}_renderDrawCallDirect(e,t){const{texArray:i,type:r,size:s,start:o}=t,a=i.count;for(let l=0;l<a;l++)e.texture.bind(i.elements[l],l);e.geometry.draw(r,s,o)}_resolveDirectShader(e){let t=this.shader;const i=this.pluginName;if(!t){if(!ky[i]){const{maxTextures:r}=e.plugins[i],s=new Int32Array(r);for(let l=0;l<r;l++)s[l]=l;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new an,default:us.from({uSamplers:s},!0)},a=e.plugins[i]._shader.program;ky[i]=new Vs(a,o)}t=ky[i]}return t}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:t,minY:i,maxX:r,maxY:s}=e.bounds;this._bounds.addFrame(this.transform,t,i,r,s)}containsPoint(e){return this.worldTransform.applyInverse(e,eg._TEMP_POINT),this._geometry.containsPoint(eg._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t._tintRGB=Jt.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const t=this.transform.worldTransform,i=t.a,r=t.b,s=t.c,o=t.d,a=t.tx,l=t.ty,u=this._geometry.points,d=this.vertexData;let f=0;for(let p=0;p<u.length;p+=2){const m=u[p],v=u[p+1];d[f++]=i*m+s*v+a,d[f++]=o*v+r*m+l}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};X1.curves=Yc,X1._TEMP_POINT=new Lt;let Ad=X1;class uV extends D0{constructor(e=100,t=100,i=10,r=10){super(),this.segWidth=i,this.segHeight=r,this.width=e,this.height=t,this.build()}build(){const e=this.segWidth*this.segHeight,t=[],i=[],r=[],s=this.segWidth-1,o=this.segHeight-1,a=this.width/s,l=this.height/o;for(let d=0;d<e;d++){const f=d%this.segWidth,p=d/this.segWidth|0;t.push(f*a,p*l),i.push(f/s,p/o)}const u=s*o;for(let d=0;d<u;d++){const f=d%s,p=d/s|0,m=p*this.segWidth+f,v=p*this.segWidth+f+1,x=(p+1)*this.segWidth+f,y=(p+1)*this.segWidth+f+1;r.push(m,v,x,v,y,x)}this.buffers[0].data=new Float32Array(t),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}class cV extends D0{constructor(e=200,t,i=0){super(new Float32Array(t.length*4),new Float32Array(t.length*4),new Uint16Array((t.length-1)*6)),this.points=t,this._width=e,this.textureScale=i,this.build()}get width(){return this._width}build(){const e=this.points;if(!e)return;const t=this.getBuffer("aVertexPosition"),i=this.getBuffer("aTextureCoord"),r=this.getIndex();if(e.length<1)return;t.data.length/4!==e.length&&(t.data=new Float32Array(e.length*4),i.data=new Float32Array(e.length*4),r.data=new Uint16Array((e.length-1)*6));const s=i.data,o=r.data;s[0]=0,s[1]=0,s[2]=0,s[3]=1;let a=0,l=e[0];const u=this._width*this.textureScale,d=e.length;for(let p=0;p<d;p++){const m=p*4;if(this.textureScale>0){const v=l.x-e[p].x,x=l.y-e[p].y,y=Math.sqrt(v*v+x*x);l=e[p],a+=y/u}else a=p/(d-1);s[m]=a,s[m+1]=0,s[m+2]=a,s[m+3]=1}let f=0;for(let p=0;p<d-1;p++){const m=p*2;o[f++]=m,o[f++]=m+1,o[f++]=m+2,o[f++]=m+2,o[f++]=m+1,o[f++]=m+3}i.update(),r.update(),this.updateVertices()}updateVertices(){const e=this.points;if(e.length<1)return;let t=e[0],i,r=0,s=0;const o=this.buffers[0].data,a=e.length,l=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let u=0;u<a;u++){const d=e[u],f=u*4;u<e.length-1?i=e[u+1]:i=d,s=-(i.x-t.x),r=i.y-t.y;const p=Math.sqrt(r*r+s*s);p<1e-6?(r=0,s=0):(r/=p,s/=p,r*=l,s*=l),o[f]=d.x+r,o[f+1]=d.y+s,o[f+2]=d.x-r,o[f+3]=d.y-s,t=d}this.buffers[0].update()}update(){this.textureScale>0?this.build():this.updateVertices()}}class hV extends Qd{constructor(e,t,i){const r=new uV(e.width,e.height,t,i),s=new Jd(Pe.WHITE);super(r,s),this.texture=e,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;const e=this.geometry,{width:t,height:i}=this.shader.texture;this.autoResize&&(e.width!==t||e.height!==i)&&(e.width=this.shader.texture.width,e.height=this.shader.texture.height,e.build())}set texture(e){this.shader.texture!==e&&(this.shader.texture=e,this._textureID=-1,e.baseTexture.valid?this.textureUpdated():e.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(e)}destroy(e){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(e)}}const fm=10;class dV extends hV{constructor(e,t,i,r,s){var o,a,l,u;super(Pe.WHITE,4,4),this._origWidth=e.orig.width,this._origHeight=e.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=t??((o=e.defaultBorders)==null?void 0:o.left)??fm,this._rightWidth=r??((a=e.defaultBorders)==null?void 0:a.right)??fm,this._topHeight=i??((l=e.defaultBorders)==null?void 0:l.top)??fm,this._bottomHeight=s??((u=e.defaultBorders)==null?void 0:u.bottom)??fm,this.texture=e}textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh()}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(e){this.geometry.getBuffer("aVertexPosition").data=e}updateHorizontalVertices(){const e=this.vertices,t=this._getMinScale();e[9]=e[11]=e[13]=e[15]=this._topHeight*t,e[17]=e[19]=e[21]=e[23]=this._height-this._bottomHeight*t,e[25]=e[27]=e[29]=e[31]=this._height}updateVerticalVertices(){const e=this.vertices,t=this._getMinScale();e[2]=e[10]=e[18]=e[26]=this._leftWidth*t,e[4]=e[12]=e[20]=e[28]=this._width-this._rightWidth*t,e[6]=e[14]=e[22]=e[30]=this._width}_getMinScale(){const e=this._leftWidth+this._rightWidth,t=this._width>e?1:this._width/e,i=this._topHeight+this._bottomHeight,r=this._height>i?1:this._height/i;return Math.min(t,r)}get width(){return this._width}set width(e){this._width=e,this._refresh()}get height(){return this._height}set height(e){this._height=e,this._refresh()}get leftWidth(){return this._leftWidth}set leftWidth(e){this._leftWidth=e,this._refresh()}get rightWidth(){return this._rightWidth}set rightWidth(e){this._rightWidth=e,this._refresh()}get topHeight(){return this._topHeight}set topHeight(e){this._topHeight=e,this._refresh()}get bottomHeight(){return this._bottomHeight}set bottomHeight(e){this._bottomHeight=e,this._refresh()}_refresh(){const e=this.texture,t=this.geometry.buffers[1].data;this._origWidth=e.orig.width,this._origHeight=e.orig.height;const i=1/this._origWidth,r=1/this._origHeight;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1,t[2]=t[10]=t[18]=t[26]=i*this._leftWidth,t[4]=t[12]=t[20]=t[28]=1-i*this._rightWidth,t[9]=t[11]=t[13]=t[15]=r*this._topHeight,t[17]=t[19]=t[21]=t[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}class fV extends Qd{constructor(e=Pe.EMPTY,t,i,r,s){const o=new D0(t,i,r);o.getBuffer("aVertexPosition").static=!1;const a=new Jd(e);super(o,a,null,s),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(e){this.geometry.getBuffer("aVertexPosition").data=e}_render(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(e)}}class pV extends Qd{constructor(e,t,i=0){const r=new cV(e.height,t,i),s=new Jd(e);i>0&&(e.baseTexture.wrapMode=Co.REPEAT),super(r,s),this.autoUpdate=!0}_render(e){const t=this.geometry;(this.autoUpdate||t._width!==this.shader.texture.height)&&(t._width=this.shader.texture.height,t.update()),super._render(e)}}class mV extends Oi{constructor(e=1500,t,i=16384,r=!1){super();const s=16384;i>s&&(i=s),this._properties=[!1,!0,!1,!1,!1],this._maxSize=e,this._batchSize=i,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=rt.NORMAL,this.autoResize=r,this.roundPixels=!0,this.baseTexture=null,this.setProperties(t),this._tintColor=new Jt(0),this.tintRgb=new Float32Array(3),this.tint=16777215}setProperties(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintColor.toRgbArray(this.tintRgb)}render(e){!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",()=>this.onChildrenChange(0))),e.batch.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))}onChildrenChange(e){const t=Math.floor(e/this._batchSize);for(;this._bufferUpdateIDs.length<t;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[t]=++this._updateID}dispose(){if(this._buffers){for(let e=0;e<this._buffers.length;++e)this._buffers[e].destroy();this._buffers=null}}destroy(e){super.destroy(e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}class XC{constructor(e,t,i){this.geometry=new Da,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let r=0;r<e.length;++r){let s=e[r];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||et.FLOAT,offset:s.offset},t[r]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let t=0;this.indexBuffer=new Cn(CH(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=t,t+=a.size,this.dynamicStride+=a.size}const i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new Cn(this.dynamicData,!1,!1);let r=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=r,r+=a.size,this.staticStride+=a.size}const s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new Cn(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];e.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===et.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];e.addAttribute(a.attributeName,this.staticBuffer,0,a.type===et.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(e,t,i){for(let r=0;r<this.dynamicProperties.length;r++){const s=this.dynamicProperties[r];s.uploadFunction(e,t,i,s.type===et.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,t,i){for(let r=0;r<this.staticProperties.length;r++){const s=this.staticProperties[r];s.uploadFunction(e,t,i,s.type===et.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var gV=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,_V=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class t3 extends I0{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new an,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:et.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Vs.from(_V,gV,{}),this.state=Ks.for2d()}render(e){const t=e.children,i=e._maxSize,r=e._batchSize,s=this.renderer;let o=t.length;if(o===0)return;o>i&&!e.autoResize&&(o=i);let a=e._buffers;a||(a=e._buffers=this.generateBuffers(e));const l=t[0]._texture.baseTexture,u=l.alphaMode>0;this.state.blendMode=nL(e.blendMode,u),s.state.set(this.state);const d=s.gl,f=e.worldTransform.copyTo(this.tempMatrix);f.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=f.toArray(!0),this.shader.uniforms.uColor=Jt.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,u).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let p=!1;for(let m=0,v=0;m<o;m+=r,v+=1){let x=o-m;x>r&&(x=r),v>=a.length&&a.push(this._generateOneMoreBuffer(e));const y=a[v];y.uploadDynamic(t,m,x);const g=e._bufferUpdateIDs[v]||0;p=p||y._updateID<g,p&&(y._updateID=e._updateID,y.uploadStatic(t,m,x)),s.geometry.bind(y.geometry),d.drawElements(d.TRIANGLES,x*6,d.UNSIGNED_SHORT,0)}}generateBuffers(e){const t=[],i=e._maxSize,r=e._batchSize,s=e._properties;for(let o=0;o<i;o+=r)t.push(new XC(this.properties,s,r));return t}_generateOneMoreBuffer(e){const t=e._batchSize,i=e._properties;return new XC(this.properties,i,t)}uploadVertices(e,t,i,r,s,o){let a=0,l=0,u=0,d=0;for(let f=0;f<i;++f){const p=e[t+f],m=p._texture,v=p.scale.x,x=p.scale.y,y=m.trim,g=m.orig;y?(l=y.x-p.anchor.x*g.width,a=l+y.width,d=y.y-p.anchor.y*g.height,u=d+y.height):(a=g.width*(1-p.anchor.x),l=g.width*-p.anchor.x,u=g.height*(1-p.anchor.y),d=g.height*-p.anchor.y),r[o]=l*v,r[o+1]=d*x,r[o+s]=a*v,r[o+s+1]=d*x,r[o+s*2]=a*v,r[o+s*2+1]=u*x,r[o+s*3]=l*v,r[o+s*3+1]=u*x,o+=s*4}}uploadPosition(e,t,i,r,s,o){for(let a=0;a<i;a++){const l=e[t+a].position;r[o]=l.x,r[o+1]=l.y,r[o+s]=l.x,r[o+s+1]=l.y,r[o+s*2]=l.x,r[o+s*2+1]=l.y,r[o+s*3]=l.x,r[o+s*3+1]=l.y,o+=s*4}}uploadRotation(e,t,i,r,s,o){for(let a=0;a<i;a++){const l=e[t+a].rotation;r[o]=l,r[o+s]=l,r[o+s*2]=l,r[o+s*3]=l,o+=s*4}}uploadUvs(e,t,i,r,s,o){for(let a=0;a<i;++a){const l=e[t+a]._texture._uvs;l?(r[o]=l.x0,r[o+1]=l.y0,r[o+s]=l.x1,r[o+s+1]=l.y1,r[o+s*2]=l.x2,r[o+s*2+1]=l.y2,r[o+s*3]=l.x3,r[o+s*3+1]=l.y3,o+=s*4):(r[o]=0,r[o+1]=0,r[o+s]=0,r[o+s+1]=0,r[o+s*2]=0,r[o+s*2+1]=0,r[o+s*3]=0,r[o+s*3+1]=0,o+=s*4)}}uploadTint(e,t,i,r,s,o){for(let a=0;a<i;++a){const l=e[t+a],u=Jt.shared.setValue(l._tintRGB).toPremultiplied(l.alpha,l.texture.baseTexture.alphaMode>0);r[o]=u,r[o+s]=u,r[o+s*2]=u,r[o+s*3]=u,o+=s*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}t3.extension={name:"particle",type:Ne.RendererPlugin};$e.add(t3);class ef extends Zs{constructor(e,t=!0){super(e[0]instanceof Pe?e[0]:e[0].texture),this._textures=null,this._durations=null,this._autoUpdate=t,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=e}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(ni.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(ni.shared.add(this.update,this,Ua.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(e){this.stop(),this.currentFrame=e}gotoAndPlay(e){this.currentFrame=e,this.play()}update(e){if(!this._playing)return;const t=this.animationSpeed*e,i=this.currentFrame;if(this._durations!==null){let r=this._currentTime%1*this._durations[this.currentFrame];for(r+=t/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];const s=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*s,this._currentTime+=s;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=t;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<i||this.animationSpeed<0&&this.currentFrame>i)&&this.onLoop(),this.updateTexture())}updateTexture(){const e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this._texture=this._textures[e],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(e){this.stop(),super.destroy(e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(e){const t=[];for(let i=0;i<e.length;++i)t.push(Pe.from(e[i]));return new ef(t)}static fromImages(e){const t=[];for(let i=0;i<e.length;++i)t.push(Pe.from(e[i]));return new ef(t)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(e){if(e[0]instanceof Pe)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(let t=0;t<e.length;t++)this._textures.push(e[t].texture),this._durations.push(e[t].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e}set currentFrame(e){if(e<0||e>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${e}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(ni.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(ni.shared.add(this.update,this),this._isConnectedToTicker=!0))}}const jh=new Lt;class FE extends Zs{constructor(e,t=100,i=100){super(e),this.tileTransform=new P0,this._width=t,this._height=i,this.uvMatrix=this.texture.uvMatrix||new RE(e),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale(e){this.tileTransform.scale.copyFrom(e)}get tilePosition(){return this.tileTransform.position}set tilePosition(e){this.tileTransform.position.copyFrom(e)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render(e){const t=this._texture;!t||!t.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))}_calculateBounds(){const e=this._width*-this._anchor._x,t=this._height*-this._anchor._y,i=this._width*(1-this._anchor._x),r=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,t,i,r)}getLocalBounds(e){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new ut),e=this._localBoundsRect),this._bounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,jh);const t=this._width,i=this._height,r=-t*this.anchor._x;if(jh.x>=r&&jh.x<r+t){const s=-i*this.anchor._y;if(jh.y>=s&&jh.y<s+i)return!0}return!1}destroy(e){super.destroy(e),this.tileTransform=null,this.uvMatrix=null}static from(e,t){const i=e instanceof Pe?e:Pe.from(e,t);return new FE(i,t.width,t.height)}get width(){return this._width}set width(e){this._width=e}get height(){return this._height}set height(e){this._height=e}}var vV=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,yV=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,xV=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,jC=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,SV=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const pm=new an;class n3 extends I0{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new mL,this.state=Ks.for2d()}contextChange(){const e=this.renderer,t={globals:e.globalUniforms};this.simpleShader=Vs.from(jC,SV,t),this.shader=e.context.webGLVersion>1?Vs.from(yV,vV,t):Vs.from(jC,xV,t)}render(e){const t=this.renderer,i=this.quad;let r=i.vertices;r[0]=r[6]=e._width*-e.anchor.x,r[1]=r[3]=e._height*-e.anchor.y,r[2]=r[4]=e._width*(1-e.anchor.x),r[5]=r[7]=e._height*(1-e.anchor.y);const s=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;r=i.uvs,r[0]=r[6]=-s,r[1]=r[3]=-o,r[2]=r[4]=1-s,r[5]=r[7]=1-o,i.invalidate();const a=e._texture,l=a.baseTexture,u=l.alphaMode>0,d=e.tileTransform.localTransform,f=e.uvMatrix;let p=l.isPowerOfTwo&&a.frame.width===l.width&&a.frame.height===l.height;p&&(l._glTextures[t.CONTEXT_UID]?p=l.wrapMode!==Co.CLAMP:l.wrapMode===Co.CLAMP&&(l.wrapMode=Co.REPEAT));const m=p?this.simpleShader:this.shader,v=a.width,x=a.height,y=e._width,g=e._height;pm.set(d.a*v/y,d.b*v/g,d.c*x/y,d.d*x/g,d.tx/y,d.ty/g),pm.invert(),p?pm.prepend(f.mapCoord):(m.uniforms.uMapCoord=f.mapCoord.toArray(!0),m.uniforms.uClampFrame=f.uClampFrame,m.uniforms.uClampOffset=f.uClampOffset),m.uniforms.uTransform=pm.toArray(!0),m.uniforms.uColor=Jt.shared.setValue(e.tint).premultiply(e.worldAlpha,u).toArray(m.uniforms.uColor),m.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),m.uniforms.uSampler=a,t.shader.bind(m),t.geometry.bind(i),this.state.blendMode=nL(e.blendMode,u),t.state.set(this.state),t.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}n3.extension={name:"tilingSprite",type:Ne.RendererPlugin};$e.add(n3);const i3=class j1{constructor(e){this.stage=new Oi,e=Object.assign({forceCanvas:!1},e),this.renderer=H7(e),j1._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){var e;return(e=this.renderer)==null?void 0:e.view}get screen(){var e;return(e=this.renderer)==null?void 0:e.screen}destroy(e,t){const i=j1._plugins.slice(0);i.reverse(),i.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}};i3._plugins=[];let F0=i3;$e.handleByList(Ne.Application,F0._plugins);class r3{static init(e){Object.defineProperty(this,"resizeTo",{set(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let t,i;if(this._resizeTo===globalThis.window)t=globalThis.innerWidth,i=globalThis.innerHeight;else{const{clientWidth:r,clientHeight:s}=this._resizeTo;t=r,i=s}this.renderer.resize(t,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}r3.extension=Ne.Application;$e.add(r3);var s3={exports:{}},EV="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",TV=EV,bV=TV;function o3(){}function a3(){}a3.resetWarningCache=o3;var wV=function(){function n(i,r,s,o,a,l){if(l!==bV){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}n.isRequired=n;function e(){return n}var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:a3,resetWarningCache:o3};return t.PropTypes=t,t};s3.exports=wV();var AV=s3.exports;const nn=t0(AV);function ur(n){return ur=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ur(n)}function l3(n){var e=function(t,i){if(ur(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,i||"default");if(ur(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(t)}(n,"string");return ur(e)==="symbol"?e:String(e)}function Mn(n,e,t){return(e=l3(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zy(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function Fo(n){return function(e){if(Array.isArray(e))return zy(e)}(n)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(n)||function(e,t){if(e){if(typeof e=="string")return zy(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set"?Array.from(e):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?zy(e,t):void 0}}(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function bn(n,e){for(var t=arguments.length,i=new Array(t>2?t-2:0),r=2;r<t;r++)i[r-2]=arguments[r]}var MV=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function CV(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var RV=function(n){return n==null};function id(n){var e=[];if(n===void 0)return e;if(typeof n=="string")e=n.split(",");else if(typeof n=="number")e=[n];else if(Array.isArray(n))e=Fo(n);else{if(n===null||ur(n)!=="object")return e;e=[n&&(n==null?void 0:n.x)||0,n&&(n==null?void 0:n.y)||0]}return e.filter(function(t){return!RV(t)&&!isNaN(t)}).map(Number)}function $C(n,e){if(n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Gy(n){return n instanceof Lt||n instanceof Os}var Kg=["click","mousedown","mousemove","mouseout","mouseover","mouseup","mouseupoutside","tap","touchstart","touchmove","touchend","touchendoutside","pointercancel","pointerout","pointerover","pointertap","pointerdown","pointerup","pointerupoutside","pointermove","rightclick","rightdown","rightup","rightupoutside","touchcancel","touchendoutside","touchmove","touchstart"];function Hy(n,e,t){if(Gy(n[e])&&Gy(t))n[e].copyFrom(t);else if(Gy(n[e])){var i=id(t);bn(i!==void 0&&i.length>0&&i.length<3,"The property `%s` is a `PIXI.Point` or `PIXI.ObservablePoint` and must be set to a comma-separated string of either 1 or 2 coordinates, a 1 or 2 element array containing coordinates, or a PIXI Point/ObservablePoint. If only one coordinate is given then X and Y will be set to the provided value. Received: `%s` of type `%s`.",e,JSON.stringify(t),ur(t)),n[e].set(i.shift(),i.shift())}else n[e]=t}var Gu,u3=function(n){var e,t=n;if(!Array.isArray(t)){if(e=n,Object.prototype.toString.call(e)!=="[object Object]")throw new Error("collection needs to be an Array or Object");t=Object.keys(n)}var i={};return t.forEach(function(r){i[r]=!0}),function(r){return i[r]!==void 0}},c3=function(n){return function(){return!n.apply(void 0,arguments)}},$1="children",PV=(Mn(Gu={},$1,!0),Mn(Gu,"parent",!0),Mn(Gu,"worldAlpha",!0),Mn(Gu,"worldTransform",!0),Mn(Gu,"worldVisible",!0),Gu),Y1={alpha:1,buttonMode:!1,cacheAsBitmap:!1,cursor:null,filterArea:null,filters:null,hitArea:null,interactive:!1,mask:null,pivot:0,position:0,renderable:!0,rotation:0,scale:1,skew:0,transform:null,visible:!0,x:0,y:0},Xs=function(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=function(a){return requestAnimationFrame(function(){var l,u;a==null||(l=a.__reactpixi)===null||l===void 0||(u=l.root)===null||u===void 0||u.emit("__REACT_PIXI_REQUEST_RENDER__")})},r=function(a,l){if(t.hasOwnProperty(a))return bn(l.typeofs.some(function(u){return ur(t[a])===u})||l.instanceofs.some(function(u){return t[a]instanceof u}),"".concat(n," ").concat(a," prop is invalid")),t[a]};if(t.texture)return bn(t.texture instanceof Pe,"".concat(n," texture needs to be typeof `Texture`")),t.texture;var s=r("image",{typeofs:["string"],instanceofs:[HTMLImageElement]})||r("video",{typeofs:["string"],instanceofs:[HTMLVideoElement]})||r("source",{typeofs:["string","number"],instanceofs:[HTMLImageElement,HTMLVideoElement,HTMLCanvasElement,Pe]});bn(!!s,"".concat(n," could not get texture from props"));var o=Pe.from(s);return o.__reactpixi={root:e},o.once("update",i),o.once("loaded",i),o.valid&&i(o),o},IV=c3(u3([].concat(Fo(Object.keys(PV)),Fo(Kg))));function js(n,e,t){var i=!1;if(bn(hn.prototype.isPrototypeOf(n),"instance needs to be typeof `DisplayObject`, got `%s`",ur(n)),!t.ignoreEvents)for(var r=typeof n.removeListener=="function",s=typeof n.on=="function",o=0;o<Kg.length;o++){var a=Kg[o];e[a]!==t[a]&&(i=!0,typeof e[a]=="function"&&r&&n.removeListener(a,e[a]),typeof t[a]=="function"&&s&&n.on(a,t[a]))}var l=Object.keys(t||{});if(t.overwriteProps){for(var u=0;u<l.length;u++){var d=l[u];e[d]!==t[d]&&(i=!0,Hy(n,d,t[d]))}return i}for(var f=l.filter(IV),p=0;p<f.length;p++){var m=f[p],v=t[m];t[m]!==e[m]&&(i=!0),v!==void 0?Hy(n,m,v):m in Y1?(console.warn("setting default value: ".concat(m,", from: ").concat(n[m]," to: ").concat(v," for"),n),i=!0,Hy(n,m,Y1[m])):console.warn("ignoring prop: ".concat(m,", from ").concat(n[m]," to ").concat(v," for"),n)}return i}var LV=function(n,e){var t=e.text,i=e.style;return new d9(t,i)},DV=function(){return new Oi};function Va(n,e){if(n==null)return{};var t,i,r=function(o,a){if(o==null)return{};var l,u,d={},f=Object.keys(o);for(u=0;u<f.length;u++)l=f[u],a.indexOf(l)>=0||(d[l]=o[l]);return d}(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}var NV=["draw","geometry"],UV=function(n,e){var t=e.geometry;bn(!t||t instanceof Ad,"Graphics geometry needs to be a `PIXI.Graphics`");var i=t?new Ad(t.geometry):new Ad;return i.applyProps=function(r,s,o){var a=o.draw;o.geometry;var l=js(r,s,Va(o,NV));return s.draw!==a&&typeof a=="function"&&(l=!0,a.call(i,i)),l},i},FV=["image","texture"],OV=function(n,e){var t=e.leftWidth,i=t===void 0?10:t,r=e.topHeight,s=r===void 0?10:r,o=e.rightWidth,a=o===void 0?10:o,l=e.bottomHeight,u=l===void 0?10:l,d=Xs("NineSlicePlane",n,e),f=new dV(d,i,s,a,u);return f.applyProps=function(p,m,v){var x=v.image,y=v.texture,g=js(p,m,Va(v,FV));return(x||y)&&(y!==m.texture&&(g=!0),p.texture=Xs("NineSlicePlane",n,v)),g},f};function YC(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function mm(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?YC(Object(t),!0).forEach(function(i){Mn(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):YC(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}var BV=function(n,e){var t=e.maxSize,i=t===void 0?1500:t,r=e.batchSize,s=r===void 0?16384:r,o=e.autoResize,a=o!==void 0&&o,l=mm(mm({},{vertices:!1,scale:!0,position:!0,rotation:!0,uvs:!0,tint:!0}),e.properties||{}),u=mm(mm({},{children:!1,texture:!1,baseTexture:!1}),e.destroyOptions||{}),d=new mV(i,l,s,a);return d.willUnmount=function(f,p,m){f.destroy(u)},d},kV=["image","texture"],zV=function(n,e){var t=new Zs(Xs("Sprite",n,e));return t.applyProps=function(i,r,s){var o=s.image,a=s.texture,l=js(i,r,Va(s,kV));return(a&&r.texture!==s.texture||o&&r.image!==s.image)&&(r.texture!==s.texture&&(l=!0),i.texture=Xs("Sprite",n,s)),l},t},GV=["textures","isPlaying","initialFrame","images"],HV=function(n,e){var t=e.textures,i=e.images,r=e.isPlaying,s=r===void 0||r,o=e.initialFrame,a=function(u){return u.map(function(d){return bn(d instanceof Pe||(d==null?void 0:d.texture),"AnimationSprite texture needs to be an array of `PIXI.Texture` or `{ texture: PIXI.Texture, time:\n                number }`"),d})},l=i?ef.fromImages(i):new ef(a(t));return l[s?"gotoAndPlay":"gotoAndStop"](o||0),l.applyProps=function(u,d,f){var p=f.textures,m=f.isPlaying,v=f.initialFrame,x=f.images,y=js(u,d,Va(f,GV));if(x&&d.images!==x){for(var g=[],T=0;T<x.length;++T)g.push(Pe.from(x[T]));u.textures=g,y=!0}if(p&&d.textures!==p&&(u.textures=a(p),y=!0),m!==d.isPlaying||v!==d.initialFrame){var S=typeof v=="number"?v:l.currentFrame||0;l[m?"gotoAndPlay":"gotoAndStop"](S),y=!0}return y},l},VV=function(n,e){var t=e.text,i=t===void 0?"":t,r=e.style,s=r===void 0?{}:r,o=e.isSprite,a=new IE(i,s);return o?(a.updateText(),new Zs(a.texture)):a},WV=["tileScale","tilePosition","image","texture"],XV=function(n,e){var t=e.width,i=t===void 0?100:t,r=e.height,s=r===void 0?100:r,o=Xs("TilingSprite",n,e),a=new FE(o,i,s);return a.applyProps=function(l,u,d){var f=d.tileScale,p=d.tilePosition,m=d.image,v=d.texture,x=js(l,u,Va(d,WV));if(p){var y,g=id(p);(y=l.tilePosition).set.apply(y,Fo(g)),x=!$C(id(u.tilePosition),g)||x}if(f){var T,S=id(f);(T=l.tileScale).set.apply(T,Fo(S)),x=!$C(id(u.tileScale),S)||x}return(m||v)&&(v!==u.texture&&(x=!0),l.texture=Xs("Sprite",n,d)),x},a},jV=["image","texture"],$V=function(n,e){var t=Xs("Mesh",n,e),i=e.vertices,r=e.uvs,s=e.indices,o=e.drawMode,a=o===void 0?is.TRIANGLES:o,l=new fV(t,i,r,s,a);return l.applyProps=function(u,d,f){var p=f.image,m=f.texture,v=js(u,d,Va(f,jV));return(p||m)&&(m!==d.texture&&(v=!0),u.texture=Xs("Mesh",n,f)),v},l},YV=["image","texture"],qV=function(n,e){var t=Xs("SimpleRope",n,e),i=e.points,r=new pV(t,i);return r.applyProps=function(s,o,a){var l=a.image,u=a.texture,d=Va(a,YV);bn(Array.isArray(a.points),"SimpleRope points needs to be %s","Array<PIXI.Point>");var f=js(s,o,d);return(l||u)&&(u!==o.texture&&(f=!0),s.texture=Xs("SimpleRope",n,a)),f},r},KV=Object.freeze({__proto__:null,BitmapText:LV,Container:DV,Graphics:UV,NineSlicePlane:OV,ParticleContainer:BV,Sprite:zV,Text:VV,TilingSprite:XV,SimpleMesh:$V,SimpleRope:qV,AnimatedSprite:HV});function qC(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function KC(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?qC(Object(t),!0).forEach(function(i){Mn(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):qC(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}var Zi={BitmapText:"BitmapText",Container:"Container",Graphics:"Graphics",NineSlicePlane:"NineSlicePlane",ParticleContainer:"ParticleContainer",Sprite:"Sprite",AnimatedSprite:"AnimatedSprite",Text:"Text",TilingSprite:"TilingSprite",SimpleMesh:"SimpleMesh",SimpleRope:"SimpleRope"},ZV=Object.keys(Zi).reduce(function(n,e){return KC(KC({},n),{},Mn({},e,KV[e]))},{}),h3={};function QV(n,e){return bn(!!n,"Expect type to be defined, got `%s`",n),bn(!Zi[n],"Component `%s` could not be created, already exists in default components.",n),h3[n]=e,n}var ZC,QC,JC,eR,q1={},K1={},JV={get exports(){return K1},set exports(n){K1=n}},tR={};function eW(){return QC||(QC=1,JV.exports=(ZC||(ZC=1,function(n){function e(O,H){var B=O.length;O.push(H);e:for(;0<B;){var G=B-1>>>1,ne=O[G];if(!(0<r(ne,H)))break e;O[G]=H,O[B]=ne,B=G}}function t(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var H=O[0],B=O.pop();if(B!==H){O[0]=B;e:for(var G=0,ne=O.length,ee=ne>>>1;G<ee;){var ie=2*(G+1)-1,pe=O[ie],ve=ie+1,Me=O[ve];if(0>r(pe,B))ve<ne&&0>r(Me,pe)?(O[G]=Me,O[ve]=B,G=ve):(O[G]=pe,O[ie]=B,G=ie);else{if(!(ve<ne&&0>r(Me,B)))break e;O[G]=Me,O[ve]=B,G=ve}}}return H}function r(O,H){var B=O.sortIndex-H.sortIndex;return B!==0?B:O.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,f=null,p=3,m=!1,v=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function S(O){for(var H=t(u);H!==null;){if(H.callback===null)i(u);else{if(!(H.startTime<=O))break;i(u),H.sortIndex=H.expirationTime,e(l,H)}H=t(u)}}function w(O){if(x=!1,S(O),!v)if(t(l)!==null)v=!0,Z(M);else{var H=t(u);H!==null&&$(w,H.startTime-O)}}function M(O,H){v=!1,x&&(x=!1,g(C),C=-1),m=!0;var B=p;try{for(S(H),f=t(l);f!==null&&(!(f.expirationTime>H)||O&&!W());){var G=f.callback;if(typeof G=="function"){f.callback=null,p=f.priorityLevel;var ne=G(f.expirationTime<=H);H=n.unstable_now(),typeof ne=="function"?f.callback=ne:f===t(l)&&i(l),S(H)}else i(l);f=t(l)}if(f!==null)var ee=!0;else{var ie=t(u);ie!==null&&$(w,ie.startTime-H),ee=!1}return ee}finally{f=null,p=B,m=!1}}typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var R,P=!1,N=null,C=-1,L=5,Q=-1;function W(){return!(n.unstable_now()-Q<L)}function z(){if(N!==null){var O=n.unstable_now();Q=O;var H=!0;try{H=N(!0,O)}finally{H?R():(P=!1,N=null)}}else P=!1}if(typeof T=="function")R=function(){T(z)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,X=F.port2;F.port1.onmessage=z,R=function(){X.postMessage(null)}}else R=function(){y(z,0)};function Z(O){N=O,P||(P=!0,R())}function $(O,H){C=y(function(){O(n.unstable_now())},H)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(O){O.callback=null},n.unstable_continueExecution=function(){v||m||(v=!0,Z(M))},n.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<O?Math.floor(1e3/O):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(O){switch(p){case 1:case 2:case 3:var H=3;break;default:H=p}var B=p;p=H;try{return O()}finally{p=B}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(O,H){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var B=p;p=O;try{return H()}finally{p=B}},n.unstable_scheduleCallback=function(O,H,B){var G=n.unstable_now();switch(B=typeof B=="object"&&B!==null&&typeof(B=B.delay)=="number"&&0<B?G+B:G,O){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return O={id:d++,callback:H,priorityLevel:O,startTime:B,expirationTime:ne=B+ne,sortIndex:-1},B>G?(O.sortIndex=B,e(u,O),t(l)===null&&O===t(u)&&(x?(g(C),C=-1):x=!0,$(w,B-G))):(O.sortIndex=ne,e(l,O),v||m||(v=!0,Z(M))),O},n.unstable_shouldYield=W,n.unstable_wrapCallback=function(O){var H=p;return function(){var B=p;p=H;try{return O.apply(this,arguments)}finally{p=B}}}}(tR)),tR)),K1}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function tW(){return eR||(eR=1,JC=function(n){var e={},t=Bs,i=eW(),r=Object.assign;function s(c){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+c,_=1;_<arguments.length;_++)h+="&args[]="+encodeURIComponent(arguments[_]);return"Minified React error #"+c+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,a=Symbol.for("react.element"),l=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),m=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),y=Symbol.for("react.suspense_list"),g=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),S=Symbol.for("react.offscreen"),w=Symbol.iterator;function M(c){return c===null||typeof c!="object"?null:typeof(c=w&&c[w]||c["@@iterator"])=="function"?c:null}function R(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case u:return"Fragment";case l:return"Portal";case f:return"Profiler";case d:return"StrictMode";case x:return"Suspense";case y:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case m:return(c.displayName||"Context")+".Consumer";case p:return(c._context.displayName||"Context")+".Provider";case v:var h=c.render;return(c=c.displayName)||(c=(c=h.displayName||h.name||"")!==""?"ForwardRef("+c+")":"ForwardRef"),c;case g:return(h=c.displayName||null)!==null?h:R(c.type)||"Memo";case T:h=c._payload,c=c._init;try{return R(c(h))}catch{}}return null}function P(c){var h=c.type;switch(c.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=(c=h.render).displayName||c.name||"",h.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return R(h);case 8:return h===d?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function N(c){var h=c,_=c;if(c.alternate)for(;h.return;)h=h.return;else{c=h;do 4098&(h=c).flags&&(_=h.return),c=h.return;while(c)}return h.tag===3?_:null}function C(c){if(N(c)!==c)throw Error(s(188))}function L(c){var h=c.alternate;if(!h){if((h=N(c))===null)throw Error(s(188));return h!==c?null:c}for(var _=c,E=h;;){var b=_.return;if(b===null)break;var A=b.alternate;if(A===null){if((E=b.return)!==null){_=E;continue}break}if(b.child===A.child){for(A=b.child;A;){if(A===_)return C(b),c;if(A===E)return C(b),h;A=A.sibling}throw Error(s(188))}if(_.return!==E.return)_=b,E=A;else{for(var U=!1,V=b.child;V;){if(V===_){U=!0,_=b,E=A;break}if(V===E){U=!0,E=b,_=A;break}V=V.sibling}if(!U){for(V=A.child;V;){if(V===_){U=!0,_=A,E=b;break}if(V===E){U=!0,E=A,_=b;break}V=V.sibling}if(!U)throw Error(s(189))}}if(_.alternate!==E)throw Error(s(190))}if(_.tag!==3)throw Error(s(188));return _.stateNode.current===_?c:h}function Q(c){return(c=L(c))!==null?W(c):null}function W(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var h=W(c);if(h!==null)return h;c=c.sibling}return null}function z(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){if(c.tag!==4){var h=z(c);if(h!==null)return h}c=c.sibling}return null}var F,X=Array.isArray,Z=n.getPublicInstance,$=n.getRootHostContext,O=n.getChildHostContext,H=n.prepareForCommit,B=n.resetAfterCommit,G=n.createInstance,ne=n.appendInitialChild,ee=n.finalizeInitialChildren,ie=n.prepareUpdate,pe=n.shouldSetTextContent,ve=n.createTextInstance,Me=n.scheduleTimeout,Ze=n.cancelTimeout,Ye=n.noTimeout,ze=n.isPrimaryRenderer,Ie=n.supportsMutation,q=n.supportsPersistence,ct=n.supportsHydration,Xe=n.getInstanceFromNode,st=n.preparePortalMount,nt=n.getCurrentEventPriority,Kt=n.detachDeletedInstance,gt=n.supportsMicrotasks,xt=n.scheduleMicrotask,Ft=n.supportsTestSelectors,Un=n.findFiberRoot,Fn=n.getBoundingRect,k=n.getTextContent,I=n.isHiddenSubtree,re=n.matchAccessibilityRole,we=n.setFocusIfFocusable,ye=n.setupIntersectionObserver,Ae=n.appendChild,Qe=n.appendChildToContainer,Re=n.commitTextUpdate,Oe=n.commitMount,ft=n.commitUpdate,Bt=n.insertBefore,be=n.insertInContainerBefore,Ht=n.removeChild,yt=n.removeChildFromContainer,ht=n.resetTextContent,it=n.hideInstance,Ve=n.hideTextInstance,wt=n.unhideInstance,j=n.unhideTextInstance,Be=n.clearContainer,Te=n.cloneInstance,ce=n.createContainerChildSet,Ce=n.appendChildToContainerChildSet,at=n.finalizeContainerChildren,Ct=n.replaceContainerChildren,wn=n.cloneHiddenInstance,Wn=n.cloneHiddenTextInstance,Yt=n.canHydrateInstance,ri=n.canHydrateTextInstance,pr=n.canHydrateSuspenseInstance,sh=n.isSuspenseInstancePending,oh=n.isSuspenseInstanceFallback,nu=n.getSuspenseInstanceFallbackErrorDetails,pf=n.registerSuspenseInstanceRetry,Qs=n.getNextHydratableSibling,mf=n.getFirstHydratableChild,gf=n.getFirstHydratableChildWithinContainer,k0=n.getFirstHydratableChildWithinSuspenseInstance,z0=n.hydrateInstance,G0=n.hydrateTextInstance,D=n.hydrateSuspenseInstance,J=n.getNextHydratableInstanceAfterSuspenseInstance,oe=n.commitHydratedContainer,ae=n.commitHydratedSuspenseInstance,se=n.clearSuspenseBoundary,ke=n.clearSuspenseBoundaryFromContainer,Je=n.shouldDeleteUnhydratedTailInstances,ot=n.didNotMatchHydratedContainerTextInstance,pt=n.didNotMatchHydratedTextInstance;function _t(c){if(F===void 0)try{throw Error()}catch(_){var h=_.stack.trim().match(/\n( *(at )?)/);F=h&&h[1]||""}return`
`+F+c}var mt=!1;function vt(c,h){if(!c||mt)return"";mt=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(ue){var E=ue}Reflect.construct(c,[],h)}else{try{h.call()}catch(ue){E=ue}c.call(h.prototype)}else{try{throw Error()}catch(ue){E=ue}c()}}catch(ue){if(ue&&E&&typeof ue.stack=="string"){for(var b=ue.stack.split(`
`),A=E.stack.split(`
`),U=b.length-1,V=A.length-1;1<=U&&0<=V&&b[U]!==A[V];)V--;for(;1<=U&&0<=V;U--,V--)if(b[U]!==A[V]){if(U!==1||V!==1)do if(U--,0>--V||b[U]!==A[V]){var te=`
`+b[U].replace(" at new "," at ");return c.displayName&&te.includes("<anonymous>")&&(te=te.replace("<anonymous>",c.displayName)),te}while(1<=U&&0<=V);break}}}finally{mt=!1,Error.prepareStackTrace=_}return(c=c?c.displayName||c.name:"")?_t(c):""}var dn=Object.prototype.hasOwnProperty,si=[],en=-1;function Xn(c){return{current:c}}function dt(c){0>en||(c.current=si[en],si[en]=null,en--)}function We(c,h){en++,si[en]=c.current,c.current=h}var mr={},bt=Xn(mr),xn=Xn(!1),ds=mr;function gr(c,h){var _=c.type.contextTypes;if(!_)return mr;var E=c.stateNode;if(E&&E.__reactInternalMemoizedUnmaskedChildContext===h)return E.__reactInternalMemoizedMaskedChildContext;var b,A={};for(b in _)A[b]=h[b];return E&&((c=c.stateNode).__reactInternalMemoizedUnmaskedChildContext=h,c.__reactInternalMemoizedMaskedChildContext=A),A}function oi(c){return(c=c.childContextTypes)!=null}function Pn(){dt(xn),dt(bt)}function fs(c,h,_){if(bt.current!==mr)throw Error(s(168));We(bt,h),We(xn,_)}function iu(c,h,_){var E=c.stateNode;if(h=h.childContextTypes,typeof E.getChildContext!="function")return _;for(var b in E=E.getChildContext())if(!(b in h))throw Error(s(108,P(c)||"Unknown",b));return r({},_,E)}function ai(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||mr,ds=bt.current,We(bt,c),We(xn,xn.current),!0}function ru(c,h,_){var E=c.stateNode;if(!E)throw Error(s(169));_?(c=iu(c,h,ds),E.__reactInternalMemoizedMergedChildContext=c,dt(xn),dt(bt),We(bt,c)):dt(xn),We(xn,_)}var Qi=Math.clz32?Math.clz32:function(c){return(c>>>=0)===0?32:31-(_f(c)/R3|0)|0},_f=Math.log,R3=Math.LN2,H0=64,V0=4194304;function ah(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&c;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&c;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function vf(c,h){var _=c.pendingLanes;if(_===0)return 0;var E=0,b=c.suspendedLanes,A=c.pingedLanes,U=268435455&_;if(U!==0){var V=U&~b;V!==0?E=ah(V):(A&=U)!==0&&(E=ah(A))}else(U=_&~b)!==0?E=ah(U):A!==0&&(E=ah(A));if(E===0)return 0;if(h!==0&&h!==E&&!(h&b)&&((b=E&-E)>=(A=h&-h)||b===16&&4194240&A))return h;if(4&E&&(E|=16&_),(h=c.entangledLanes)!==0)for(c=c.entanglements,h&=E;0<h;)b=1<<(_=31-Qi(h)),E|=c[_],h&=~b;return E}function P3(c,h){switch(c){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;default:return-1}}function W0(c){return(c=-1073741825&c.pendingLanes)!==0?c:1073741824&c?1073741824:0}function BE(){var c=H0;return!(4194240&(H0<<=1))&&(H0=64),c}function X0(c){for(var h=[],_=0;31>_;_++)h.push(c);return h}function lh(c,h,_){c.pendingLanes|=h,h!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),(c=c.eventTimes)[h=31-Qi(h)]=_}function j0(c,h){var _=c.entangledLanes|=h;for(c=c.entanglements;_;){var E=31-Qi(_),b=1<<E;b&h|c[E]&h&&(c[E]|=h),_&=~b}}var zt=0;function kE(c){return 1<(c&=-c)?4<c?268435455&c?16:536870912:4:1}var $0=i.unstable_scheduleCallback,zE=i.unstable_cancelCallback,I3=i.unstable_shouldYield,L3=i.unstable_requestPaint,jn=i.unstable_now,Y0=i.unstable_ImmediatePriority,D3=i.unstable_UserBlockingPriority,GE=i.unstable_NormalPriority,N3=i.unstable_IdlePriority,yf=null,ps=null,zr=typeof Object.is=="function"?Object.is:function(c,h){return c===h&&(c!==0||1/c==1/h)||c!=c&&h!=h},Js=null,xf=!1,q0=!1;function HE(c){Js===null?Js=[c]:Js.push(c)}function ms(){if(!q0&&Js!==null){q0=!0;var c=0,h=zt;try{var _=Js;for(zt=1;c<_.length;c++){var E=_[c];do E=E(!0);while(E!==null)}Js=null,xf=!1}catch(b){throw Js!==null&&(Js=Js.slice(c+1)),$0(Y0,ms),b}finally{zt=h,q0=!1}}return null}var su=[],ou=0,Sf=null,Ef=0,_r=[],vr=0,Wa=null,gs=1,eo="";function Xa(c,h){su[ou++]=Ef,su[ou++]=Sf,Sf=c,Ef=h}function VE(c,h,_){_r[vr++]=gs,_r[vr++]=eo,_r[vr++]=Wa,Wa=c;var E=gs;c=eo;var b=32-Qi(E)-1;E&=~(1<<b),_+=1;var A=32-Qi(h)+b;if(30<A){var U=b-b%5;A=(E&(1<<U)-1).toString(32),E>>=U,b-=U,gs=1<<32-Qi(h)+b|_<<b|E,eo=A+c}else gs=1<<A|_<<b|E,eo=c}function K0(c){c.return!==null&&(Xa(c,1),VE(c,1,0))}function Z0(c){for(;c===Sf;)Sf=su[--ou],su[ou]=null,Ef=su[--ou],su[ou]=null;for(;c===Wa;)Wa=_r[--vr],_r[vr]=null,eo=_r[--vr],_r[vr]=null,gs=_r[--vr],_r[vr]=null}var Ji=null,yr=null,ln=!1,uh=!1,Gr=null;function WE(c,h){var _=br(5,null,null,0);_.elementType="DELETED",_.stateNode=h,_.return=c,(h=c.deletions)===null?(c.deletions=[_],c.flags|=16):h.push(_)}function XE(c,h){switch(c.tag){case 5:return(h=Yt(h,c.type,c.pendingProps))!==null&&(c.stateNode=h,Ji=c,yr=mf(h),!0);case 6:return(h=ri(h,c.pendingProps))!==null&&(c.stateNode=h,Ji=c,yr=null,!0);case 13:if((h=pr(h))!==null){var _=Wa!==null?{id:gs,overflow:eo}:null;return c.memoizedState={dehydrated:h,treeContext:_,retryLane:1073741824},(_=br(18,null,null,0)).stateNode=h,_.return=c,c.child=_,Ji=c,yr=null,!0}return!1;default:return!1}}function Q0(c){return(1&c.mode)!=0&&(128&c.flags)==0}function J0(c){if(ln){var h=yr;if(h){var _=h;if(!XE(c,h)){if(Q0(c))throw Error(s(418));h=Qs(_);var E=Ji;h&&XE(c,h)?WE(E,_):(c.flags=-4097&c.flags|2,ln=!1,Ji=c)}}else{if(Q0(c))throw Error(s(418));c.flags=-4097&c.flags|2,ln=!1,Ji=c}}}function jE(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;Ji=c}function Tf(c){if(!ct||c!==Ji)return!1;if(!ln)return jE(c),ln=!0,!1;if(c.tag!==3&&(c.tag!==5||Je(c.type)&&!pe(c.type,c.memoizedProps))){var h=yr;if(h){if(Q0(c))throw $E(),Error(s(418));for(;h;)WE(c,h),h=Qs(h)}}if(jE(c),c.tag===13){if(!ct)throw Error(s(316));if(!(c=(c=c.memoizedState)!==null?c.dehydrated:null))throw Error(s(317));yr=J(c)}else yr=Ji?Qs(c.stateNode):null;return!0}function $E(){for(var c=yr;c;)c=Qs(c)}function au(){ct&&(yr=Ji=null,uh=ln=!1)}function e_(c){Gr===null?Gr=[c]:Gr.push(c)}var U3=o.ReactCurrentBatchConfig;function bf(c,h){if(zr(c,h))return!0;if(typeof c!="object"||c===null||typeof h!="object"||h===null)return!1;var _=Object.keys(c),E=Object.keys(h);if(_.length!==E.length)return!1;for(E=0;E<_.length;E++){var b=_[E];if(!dn.call(h,b)||!zr(c[b],h[b]))return!1}return!0}function F3(c){switch(c.tag){case 5:return _t(c.type);case 16:return _t("Lazy");case 13:return _t("Suspense");case 19:return _t("SuspenseList");case 0:case 2:case 15:return c=vt(c.type,!1);case 11:return c=vt(c.type.render,!1);case 1:return c=vt(c.type,!0);default:return""}}function Hr(c,h){if(c&&c.defaultProps){for(var _ in h=r({},h),c=c.defaultProps)h[_]===void 0&&(h[_]=c[_]);return h}return h}var wf=Xn(null),Af=null,lu=null,t_=null;function n_(){t_=lu=Af=null}function YE(c,h,_){ze?(We(wf,h._currentValue),h._currentValue=_):(We(wf,h._currentValue2),h._currentValue2=_)}function i_(c){var h=wf.current;dt(wf),ze?c._currentValue=h:c._currentValue2=h}function r_(c,h,_){for(;c!==null;){var E=c.alternate;if((c.childLanes&h)!==h?(c.childLanes|=h,E!==null&&(E.childLanes|=h)):E!==null&&(E.childLanes&h)!==h&&(E.childLanes|=h),c===_)break;c=c.return}}function uu(c,h){Af=c,t_=lu=null,(c=c.dependencies)!==null&&c.firstContext!==null&&(c.lanes&h&&(zi=!0),c.firstContext=null)}function xr(c){var h=ze?c._currentValue:c._currentValue2;if(t_!==c)if(c={context:c,memoizedValue:h,next:null},lu===null){if(Af===null)throw Error(s(308));lu=c,Af.dependencies={lanes:0,firstContext:c}}else lu=lu.next=c;return h}var ja=null;function s_(c){ja===null?ja=[c]:ja.push(c)}function qE(c,h,_,E){var b=h.interleaved;return b===null?(_.next=_,s_(h)):(_.next=b.next,b.next=_),h.interleaved=_,_s(c,E)}function _s(c,h){c.lanes|=h;var _=c.alternate;for(_!==null&&(_.lanes|=h),_=c,c=c.return;c!==null;)c.childLanes|=h,(_=c.alternate)!==null&&(_.childLanes|=h),_=c,c=c.return;return _.tag===3?_.stateNode:null}var zo=!1;function o_(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function KE(c,h){c=c.updateQueue,h.updateQueue===c&&(h.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function to(c,h){return{eventTime:c,lane:h,tag:0,payload:null,callback:null,next:null}}function Go(c,h,_){var E=c.updateQueue;if(E===null)return null;if(E=E.shared,(2&Nt)!=0){var b=E.pending;return b===null?h.next=h:(h.next=b.next,b.next=h),E.pending=h,_s(c,_)}return(b=E.interleaved)===null?(h.next=h,s_(E)):(h.next=b.next,b.next=h),E.interleaved=h,_s(c,_)}function Mf(c,h,_){if((h=h.updateQueue)!==null&&(h=h.shared,(4194240&_)!=0)){var E=h.lanes;_|=E&=c.pendingLanes,h.lanes=_,j0(c,_)}}function ZE(c,h){var _=c.updateQueue,E=c.alternate;if(E!==null&&_===(E=E.updateQueue)){var b=null,A=null;if((_=_.firstBaseUpdate)!==null){do{var U={eventTime:_.eventTime,lane:_.lane,tag:_.tag,payload:_.payload,callback:_.callback,next:null};A===null?b=A=U:A=A.next=U,_=_.next}while(_!==null);A===null?b=A=h:A=A.next=h}else b=A=h;return _={baseState:E.baseState,firstBaseUpdate:b,lastBaseUpdate:A,shared:E.shared,effects:E.effects},void(c.updateQueue=_)}(c=_.lastBaseUpdate)===null?_.firstBaseUpdate=h:c.next=h,_.lastBaseUpdate=h}function Cf(c,h,_,E){var b=c.updateQueue;zo=!1;var A=b.firstBaseUpdate,U=b.lastBaseUpdate,V=b.shared.pending;if(V!==null){b.shared.pending=null;var te=V,ue=te.next;te.next=null,U===null?A=ue:U.next=ue,U=te;var de=c.alternate;de!==null&&(V=(de=de.updateQueue).lastBaseUpdate)!==U&&(V===null?de.firstBaseUpdate=ue:V.next=ue,de.lastBaseUpdate=te)}if(A!==null){var De=b.baseState;for(U=0,de=ue=te=null,V=A;;){var he=V.lane,Se=V.eventTime;if((E&he)===he){de!==null&&(de=de.next={eventTime:Se,lane:0,tag:V.tag,payload:V.payload,callback:V.callback,next:null});e:{var je=c,Et=V;switch(he=h,Se=_,Et.tag){case 1:if(typeof(je=Et.payload)=="function"){De=je.call(Se,De,he);break e}De=je;break e;case 3:je.flags=-65537&je.flags|128;case 0:if((he=typeof(je=Et.payload)=="function"?je.call(Se,De,he):je)==null)break e;De=r({},De,he);break e;case 2:zo=!0}}V.callback!==null&&V.lane!==0&&(c.flags|=64,(he=b.effects)===null?b.effects=[V]:he.push(V))}else Se={eventTime:Se,lane:he,tag:V.tag,payload:V.payload,callback:V.callback,next:null},de===null?(ue=de=Se,te=De):de=de.next=Se,U|=he;if((V=V.next)===null){if((V=b.shared.pending)===null)break;V=(he=V).next,he.next=null,b.lastBaseUpdate=he,b.shared.pending=null}}if(de===null&&(te=De),b.baseState=te,b.firstBaseUpdate=ue,b.lastBaseUpdate=de,(h=b.shared.interleaved)!==null){b=h;do U|=b.lane,b=b.next;while(b!==h)}else A===null&&(b.shared.lanes=0);Ya|=U,c.lanes=U,c.memoizedState=De}}function QE(c,h,_){if(c=h.effects,h.effects=null,c!==null)for(h=0;h<c.length;h++){var E=c[h],b=E.callback;if(b!==null){if(E.callback=null,E=_,typeof b!="function")throw Error(s(191,b));b.call(E)}}}var JE=new t.Component().refs;function a_(c,h,_,E){_=(_=_(E,h=c.memoizedState))==null?h:r({},h,_),c.memoizedState=_,c.lanes===0&&(c.updateQueue.baseState=_)}var Rf={isMounted:function(c){return!!(c=c._reactInternals)&&N(c)===c},enqueueSetState:function(c,h,_){c=c._reactInternals;var E=vi(),b=Xo(c),A=to(E,b);A.payload=h,_!=null&&(A.callback=_),(h=Go(c,A,b))!==null&&(Tr(h,c,b,E),Mf(h,c,b))},enqueueReplaceState:function(c,h,_){c=c._reactInternals;var E=vi(),b=Xo(c),A=to(E,b);A.tag=1,A.payload=h,_!=null&&(A.callback=_),(h=Go(c,A,b))!==null&&(Tr(h,c,b,E),Mf(h,c,b))},enqueueForceUpdate:function(c,h){c=c._reactInternals;var _=vi(),E=Xo(c),b=to(_,E);b.tag=2,h!=null&&(b.callback=h),(h=Go(c,b,E))!==null&&(Tr(h,c,E,_),Mf(h,c,E))}};function eT(c,h,_,E,b,A,U){return typeof(c=c.stateNode).shouldComponentUpdate=="function"?c.shouldComponentUpdate(E,A,U):!h.prototype||!h.prototype.isPureReactComponent||!bf(_,E)||!bf(b,A)}function tT(c,h,_){var E=!1,b=mr,A=h.contextType;return typeof A=="object"&&A!==null?A=xr(A):(b=oi(h)?ds:bt.current,A=(E=(E=h.contextTypes)!=null)?gr(c,b):mr),h=new h(_,A),c.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=Rf,c.stateNode=h,h._reactInternals=c,E&&((c=c.stateNode).__reactInternalMemoizedUnmaskedChildContext=b,c.__reactInternalMemoizedMaskedChildContext=A),h}function nT(c,h,_,E){c=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(_,E),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(_,E),h.state!==c&&Rf.enqueueReplaceState(h,h.state,null)}function l_(c,h,_,E){var b=c.stateNode;b.props=_,b.state=c.memoizedState,b.refs=JE,o_(c);var A=h.contextType;typeof A=="object"&&A!==null?b.context=xr(A):(A=oi(h)?ds:bt.current,b.context=gr(c,A)),b.state=c.memoizedState,typeof(A=h.getDerivedStateFromProps)=="function"&&(a_(c,h,A,_),b.state=c.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(h=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),h!==b.state&&Rf.enqueueReplaceState(b,b.state,null),Cf(c,_,b,E),b.state=c.memoizedState),typeof b.componentDidMount=="function"&&(c.flags|=4194308)}function ch(c,h,_){if((c=_.ref)!==null&&typeof c!="function"&&typeof c!="object"){if(_._owner){if(_=_._owner){if(_.tag!==1)throw Error(s(309));var E=_.stateNode}if(!E)throw Error(s(147,c));var b=E,A=""+c;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===A?h.ref:(h=function(U){var V=b.refs;V===JE&&(V=b.refs={}),U===null?delete V[A]:V[A]=U},h._stringRef=A,h)}if(typeof c!="string")throw Error(s(284));if(!_._owner)throw Error(s(290,c))}return c}function Pf(c,h){throw c=Object.prototype.toString.call(h),Error(s(31,c==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":c))}function iT(c){return(0,c._init)(c._payload)}function rT(c){function h(fe,K){if(c){var le=fe.deletions;le===null?(fe.deletions=[K],fe.flags|=16):le.push(K)}}function _(fe,K){if(!c)return null;for(;K!==null;)h(fe,K),K=K.sibling;return null}function E(fe,K){for(fe=new Map;K!==null;)K.key!==null?fe.set(K.key,K):fe.set(K.index,K),K=K.sibling;return fe}function b(fe,K){return(fe=$o(fe,K)).index=0,fe.sibling=null,fe}function A(fe,K,le){return fe.index=le,c?(le=fe.alternate)!==null?(le=le.index)<K?(fe.flags|=2,K):le:(fe.flags|=2,K):(fe.flags|=1048576,K)}function U(fe){return c&&fe.alternate===null&&(fe.flags|=2),fe}function V(fe,K,le,_e){return K===null||K.tag!==6?((K=Y_(le,fe.mode,_e)).return=fe,K):((K=b(K,le)).return=fe,K)}function te(fe,K,le,_e){var tt=le.type;return tt===u?de(fe,K,le.props.children,_e,le.key):K!==null&&(K.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===T&&iT(tt)===K.type)?((_e=b(K,le.props)).ref=ch(fe,K,le),_e.return=fe,_e):((_e=np(le.type,le.key,le.props,null,fe.mode,_e)).ref=ch(fe,K,le),_e.return=fe,_e)}function ue(fe,K,le,_e){return K===null||K.tag!==4||K.stateNode.containerInfo!==le.containerInfo||K.stateNode.implementation!==le.implementation?((K=q_(le,fe.mode,_e)).return=fe,K):((K=b(K,le.children||[])).return=fe,K)}function de(fe,K,le,_e,tt){return K===null||K.tag!==7?((K=Za(le,fe.mode,_e,tt)).return=fe,K):((K=b(K,le)).return=fe,K)}function De(fe,K,le){if(typeof K=="string"&&K!==""||typeof K=="number")return(K=Y_(""+K,fe.mode,le)).return=fe,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case a:return(le=np(K.type,K.key,K.props,null,fe.mode,le)).ref=ch(fe,null,K),le.return=fe,le;case l:return(K=q_(K,fe.mode,le)).return=fe,K;case T:return De(fe,(0,K._init)(K._payload),le)}if(X(K)||M(K))return(K=Za(K,fe.mode,le,null)).return=fe,K;Pf(fe,K)}return null}function he(fe,K,le,_e){var tt=K!==null?K.key:null;if(typeof le=="string"&&le!==""||typeof le=="number")return tt!==null?null:V(fe,K,""+le,_e);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case a:return le.key===tt?te(fe,K,le,_e):null;case l:return le.key===tt?ue(fe,K,le,_e):null;case T:return he(fe,K,(tt=le._init)(le._payload),_e)}if(X(le)||M(le))return tt!==null?null:de(fe,K,le,_e,null);Pf(fe,le)}return null}function Se(fe,K,le,_e,tt){if(typeof _e=="string"&&_e!==""||typeof _e=="number")return V(K,fe=fe.get(le)||null,""+_e,tt);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case a:return te(K,fe=fe.get(_e.key===null?le:_e.key)||null,_e,tt);case l:return ue(K,fe=fe.get(_e.key===null?le:_e.key)||null,_e,tt);case T:return Se(fe,K,le,(0,_e._init)(_e._payload),tt)}if(X(_e)||M(_e))return de(K,fe=fe.get(le)||null,_e,tt,null);Pf(K,_e)}return null}function je(fe,K,le,_e){for(var tt=null,Vt=null,qe=K,Gt=K=0,ui=null;qe!==null&&Gt<le.length;Gt++){qe.index>Gt?(ui=qe,qe=null):ui=qe.sibling;var Wt=he(fe,qe,le[Gt],_e);if(Wt===null){qe===null&&(qe=ui);break}c&&qe&&Wt.alternate===null&&h(fe,qe),K=A(Wt,K,Gt),Vt===null?tt=Wt:Vt.sibling=Wt,Vt=Wt,qe=ui}if(Gt===le.length)return _(fe,qe),ln&&Xa(fe,Gt),tt;if(qe===null){for(;Gt<le.length;Gt++)(qe=De(fe,le[Gt],_e))!==null&&(K=A(qe,K,Gt),Vt===null?tt=qe:Vt.sibling=qe,Vt=qe);return ln&&Xa(fe,Gt),tt}for(qe=E(fe,qe);Gt<le.length;Gt++)(ui=Se(qe,fe,Gt,le[Gt],_e))!==null&&(c&&ui.alternate!==null&&qe.delete(ui.key===null?Gt:ui.key),K=A(ui,K,Gt),Vt===null?tt=ui:Vt.sibling=ui,Vt=ui);return c&&qe.forEach(function(Yo){return h(fe,Yo)}),ln&&Xa(fe,Gt),tt}function Et(fe,K,le,_e){var tt=M(le);if(typeof tt!="function")throw Error(s(150));if((le=tt.call(le))==null)throw Error(s(151));for(var Vt=tt=null,qe=K,Gt=K=0,ui=null,Wt=le.next();qe!==null&&!Wt.done;Gt++,Wt=le.next()){qe.index>Gt?(ui=qe,qe=null):ui=qe.sibling;var Yo=he(fe,qe,Wt.value,_e);if(Yo===null){qe===null&&(qe=ui);break}c&&qe&&Yo.alternate===null&&h(fe,qe),K=A(Yo,K,Gt),Vt===null?tt=Yo:Vt.sibling=Yo,Vt=Yo,qe=ui}if(Wt.done)return _(fe,qe),ln&&Xa(fe,Gt),tt;if(qe===null){for(;!Wt.done;Gt++,Wt=le.next())(Wt=De(fe,Wt.value,_e))!==null&&(K=A(Wt,K,Gt),Vt===null?tt=Wt:Vt.sibling=Wt,Vt=Wt);return ln&&Xa(fe,Gt),tt}for(qe=E(fe,qe);!Wt.done;Gt++,Wt=le.next())(Wt=Se(qe,fe,Gt,Wt.value,_e))!==null&&(c&&Wt.alternate!==null&&qe.delete(Wt.key===null?Gt:Wt.key),K=A(Wt,K,Gt),Vt===null?tt=Wt:Vt.sibling=Wt,Vt=Wt);return c&&qe.forEach(function(oD){return h(fe,oD)}),ln&&Xa(fe,Gt),tt}return function fe(K,le,_e,tt){if(typeof _e=="object"&&_e!==null&&_e.type===u&&_e.key===null&&(_e=_e.props.children),typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case a:e:{for(var Vt=_e.key,qe=le;qe!==null;){if(qe.key===Vt){if((Vt=_e.type)===u){if(qe.tag===7){_(K,qe.sibling),(le=b(qe,_e.props.children)).return=K,K=le;break e}}else if(qe.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===T&&iT(Vt)===qe.type){_(K,qe.sibling),(le=b(qe,_e.props)).ref=ch(K,qe,_e),le.return=K,K=le;break e}_(K,qe);break}h(K,qe),qe=qe.sibling}_e.type===u?((le=Za(_e.props.children,K.mode,tt,_e.key)).return=K,K=le):((tt=np(_e.type,_e.key,_e.props,null,K.mode,tt)).ref=ch(K,le,_e),tt.return=K,K=tt)}return U(K);case l:e:{for(qe=_e.key;le!==null;){if(le.key===qe){if(le.tag===4&&le.stateNode.containerInfo===_e.containerInfo&&le.stateNode.implementation===_e.implementation){_(K,le.sibling),(le=b(le,_e.children||[])).return=K,K=le;break e}_(K,le);break}h(K,le),le=le.sibling}(le=q_(_e,K.mode,tt)).return=K,K=le}return U(K);case T:return fe(K,le,(qe=_e._init)(_e._payload),tt)}if(X(_e))return je(K,le,_e,tt);if(M(_e))return Et(K,le,_e,tt);Pf(K,_e)}return typeof _e=="string"&&_e!==""||typeof _e=="number"?(_e=""+_e,le!==null&&le.tag===6?(_(K,le.sibling),(le=b(le,_e)).return=K,K=le):(_(K,le),(le=Y_(_e,K.mode,tt)).return=K,K=le),U(K)):_(K,le)}}var cu=rT(!0),sT=rT(!1),hh={},Sr=Xn(hh),dh=Xn(hh),hu=Xn(hh);function vs(c){if(c===hh)throw Error(s(174));return c}function u_(c,h){We(hu,h),We(dh,c),We(Sr,hh),c=$(h),dt(Sr),We(Sr,c)}function du(){dt(Sr),dt(dh),dt(hu)}function oT(c){var h=vs(hu.current),_=vs(Sr.current);_!==(h=O(_,c.type,h))&&(We(dh,c),We(Sr,h))}function c_(c){dh.current===c&&(dt(Sr),dt(dh))}var Sn=Xn(0);function If(c){for(var h=c;h!==null;){if(h.tag===13){var _=h.memoizedState;if(_!==null&&((_=_.dehydrated)===null||sh(_)||oh(_)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if(128&h.flags)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var h_=[];function d_(){for(var c=0;c<h_.length;c++){var h=h_[c];ze?h._workInProgressVersionPrimary=null:h._workInProgressVersionSecondary=null}h_.length=0}var Lf=o.ReactCurrentDispatcher,f_=o.ReactCurrentBatchConfig,$a=0,fn=null,$n=null,Yn=null,Df=!1,fh=!1,ph=0,O3=0;function gi(){throw Error(s(321))}function p_(c,h){if(h===null)return!1;for(var _=0;_<h.length&&_<c.length;_++)if(!zr(c[_],h[_]))return!1;return!0}function m_(c,h,_,E,b,A){if($a=A,fn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,Lf.current=c===null||c.memoizedState===null?G3:H3,c=_(E,b),fh){A=0;do{if(fh=!1,ph=0,25<=A)throw Error(s(301));A+=1,Yn=$n=null,h.updateQueue=null,Lf.current=V3,c=_(E,b)}while(fh)}if(Lf.current=Ff,h=$n!==null&&$n.next!==null,$a=0,Yn=$n=fn=null,Df=!1,h)throw Error(s(300));return c}function g_(){var c=ph!==0;return ph=0,c}function ys(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yn===null?fn.memoizedState=Yn=c:Yn=Yn.next=c,Yn}function Er(){if($n===null){var c=fn.alternate;c=c!==null?c.memoizedState:null}else c=$n.next;var h=Yn===null?fn.memoizedState:Yn.next;if(h!==null)Yn=h,$n=c;else{if(c===null)throw Error(s(310));c={memoizedState:($n=c).memoizedState,baseState:$n.baseState,baseQueue:$n.baseQueue,queue:$n.queue,next:null},Yn===null?fn.memoizedState=Yn=c:Yn=Yn.next=c}return Yn}function mh(c,h){return typeof h=="function"?h(c):h}function __(c){var h=Er(),_=h.queue;if(_===null)throw Error(s(311));_.lastRenderedReducer=c;var E=$n,b=E.baseQueue,A=_.pending;if(A!==null){if(b!==null){var U=b.next;b.next=A.next,A.next=U}E.baseQueue=b=A,_.pending=null}if(b!==null){A=b.next,E=E.baseState;var V=U=null,te=null,ue=A;do{var de=ue.lane;if(($a&de)===de)te!==null&&(te=te.next={lane:0,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),E=ue.hasEagerState?ue.eagerState:c(E,ue.action);else{var De={lane:de,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null};te===null?(V=te=De,U=E):te=te.next=De,fn.lanes|=de,Ya|=de}ue=ue.next}while(ue!==null&&ue!==A);te===null?U=E:te.next=V,zr(E,h.memoizedState)||(zi=!0),h.memoizedState=E,h.baseState=U,h.baseQueue=te,_.lastRenderedState=E}if((c=_.interleaved)!==null){b=c;do A=b.lane,fn.lanes|=A,Ya|=A,b=b.next;while(b!==c)}else b===null&&(_.lanes=0);return[h.memoizedState,_.dispatch]}function v_(c){var h=Er(),_=h.queue;if(_===null)throw Error(s(311));_.lastRenderedReducer=c;var E=_.dispatch,b=_.pending,A=h.memoizedState;if(b!==null){_.pending=null;var U=b=b.next;do A=c(A,U.action),U=U.next;while(U!==b);zr(A,h.memoizedState)||(zi=!0),h.memoizedState=A,h.baseQueue===null&&(h.baseState=A),_.lastRenderedState=A}return[A,E]}function aT(){}function lT(c,h){var _=fn,E=Er(),b=h(),A=!zr(E.memoizedState,b);if(A&&(E.memoizedState=b,zi=!0),E=E.queue,y_(hT.bind(null,_,E,c),[c]),E.getSnapshot!==h||A||Yn!==null&&1&Yn.memoizedState.tag){if(_.flags|=2048,gh(9,cT.bind(null,_,E,b,h),void 0,null),qn===null)throw Error(s(349));30&$a||uT(_,h,b)}return b}function uT(c,h,_){c.flags|=16384,c={getSnapshot:h,value:_},(h=fn.updateQueue)===null?(h={lastEffect:null,stores:null},fn.updateQueue=h,h.stores=[c]):(_=h.stores)===null?h.stores=[c]:_.push(c)}function cT(c,h,_,E){h.value=_,h.getSnapshot=E,dT(h)&&fT(c)}function hT(c,h,_){return _(function(){dT(h)&&fT(c)})}function dT(c){var h=c.getSnapshot;c=c.value;try{var _=h();return!zr(c,_)}catch{return!0}}function fT(c){var h=_s(c,1);h!==null&&Tr(h,c,1,-1)}function pT(c){var h=ys();return typeof c=="function"&&(c=c()),h.memoizedState=h.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mh,lastRenderedState:c},h.queue=c,c=c.dispatch=z3.bind(null,fn,c),[h.memoizedState,c]}function gh(c,h,_,E){return c={tag:c,create:h,destroy:_,deps:E,next:null},(h=fn.updateQueue)===null?(h={lastEffect:null,stores:null},fn.updateQueue=h,h.lastEffect=c.next=c):(_=h.lastEffect)===null?h.lastEffect=c.next=c:(E=_.next,_.next=c,c.next=E,h.lastEffect=c),c}function mT(){return Er().memoizedState}function Nf(c,h,_,E){var b=ys();fn.flags|=c,b.memoizedState=gh(1|h,_,void 0,E===void 0?null:E)}function Uf(c,h,_,E){var b=Er();E=E===void 0?null:E;var A=void 0;if($n!==null){var U=$n.memoizedState;if(A=U.destroy,E!==null&&p_(E,U.deps))return void(b.memoizedState=gh(h,_,A,E))}fn.flags|=c,b.memoizedState=gh(1|h,_,A,E)}function gT(c,h){return Nf(8390656,8,c,h)}function y_(c,h){return Uf(2048,8,c,h)}function _T(c,h){return Uf(4,2,c,h)}function vT(c,h){return Uf(4,4,c,h)}function yT(c,h){return typeof h=="function"?(c=c(),h(c),function(){h(null)}):h!=null?(c=c(),h.current=c,function(){h.current=null}):void 0}function xT(c,h,_){return _=_!=null?_.concat([c]):null,Uf(4,4,yT.bind(null,h,c),_)}function x_(){}function ST(c,h){var _=Er();h=h===void 0?null:h;var E=_.memoizedState;return E!==null&&h!==null&&p_(h,E[1])?E[0]:(_.memoizedState=[c,h],c)}function ET(c,h){var _=Er();h=h===void 0?null:h;var E=_.memoizedState;return E!==null&&h!==null&&p_(h,E[1])?E[0]:(c=c(),_.memoizedState=[c,h],c)}function TT(c,h,_){return 21&$a?(zr(_,h)||(_=BE(),fn.lanes|=_,Ya|=_,c.baseState=!0),h):(c.baseState&&(c.baseState=!1,zi=!0),c.memoizedState=_)}function B3(c,h){var _=zt;zt=_!==0&&4>_?_:4,c(!0);var E=f_.transition;f_.transition={};try{c(!1),h()}finally{zt=_,f_.transition=E}}function bT(){return Er().memoizedState}function k3(c,h,_){var E=Xo(c);_={lane:E,action:_,hasEagerState:!1,eagerState:null,next:null},wT(c)?AT(h,_):(_=qE(c,h,_,E))!==null&&(Tr(_,c,E,vi()),MT(_,h,E))}function z3(c,h,_){var E=Xo(c),b={lane:E,action:_,hasEagerState:!1,eagerState:null,next:null};if(wT(c))AT(h,b);else{var A=c.alternate;if(c.lanes===0&&(A===null||A.lanes===0)&&(A=h.lastRenderedReducer)!==null)try{var U=h.lastRenderedState,V=A(U,_);if(b.hasEagerState=!0,b.eagerState=V,zr(V,U)){var te=h.interleaved;return te===null?(b.next=b,s_(h)):(b.next=te.next,te.next=b),void(h.interleaved=b)}}catch{}(_=qE(c,h,b,E))!==null&&(Tr(_,c,E,b=vi()),MT(_,h,E))}}function wT(c){var h=c.alternate;return c===fn||h!==null&&h===fn}function AT(c,h){fh=Df=!0;var _=c.pending;_===null?h.next=h:(h.next=_.next,_.next=h),c.pending=h}function MT(c,h,_){if(4194240&_){var E=h.lanes;_|=E&=c.pendingLanes,h.lanes=_,j0(c,_)}}var Ff={readContext:xr,useCallback:gi,useContext:gi,useEffect:gi,useImperativeHandle:gi,useInsertionEffect:gi,useLayoutEffect:gi,useMemo:gi,useReducer:gi,useRef:gi,useState:gi,useDebugValue:gi,useDeferredValue:gi,useTransition:gi,useMutableSource:gi,useSyncExternalStore:gi,useId:gi,unstable_isNewReconciler:!1},G3={readContext:xr,useCallback:function(c,h){return ys().memoizedState=[c,h===void 0?null:h],c},useContext:xr,useEffect:gT,useImperativeHandle:function(c,h,_){return _=_!=null?_.concat([c]):null,Nf(4194308,4,yT.bind(null,h,c),_)},useLayoutEffect:function(c,h){return Nf(4194308,4,c,h)},useInsertionEffect:function(c,h){return Nf(4,2,c,h)},useMemo:function(c,h){var _=ys();return h=h===void 0?null:h,c=c(),_.memoizedState=[c,h],c},useReducer:function(c,h,_){var E=ys();return h=_!==void 0?_(h):h,E.memoizedState=E.baseState=h,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:h},E.queue=c,c=c.dispatch=k3.bind(null,fn,c),[E.memoizedState,c]},useRef:function(c){return c={current:c},ys().memoizedState=c},useState:pT,useDebugValue:x_,useDeferredValue:function(c){return ys().memoizedState=c},useTransition:function(){var c=pT(!1),h=c[0];return c=B3.bind(null,c[1]),ys().memoizedState=c,[h,c]},useMutableSource:function(){},useSyncExternalStore:function(c,h,_){var E=fn,b=ys();if(ln){if(_===void 0)throw Error(s(407));_=_()}else{if(_=h(),qn===null)throw Error(s(349));30&$a||uT(E,h,_)}b.memoizedState=_;var A={value:_,getSnapshot:h};return b.queue=A,gT(hT.bind(null,E,A,c),[c]),E.flags|=2048,gh(9,cT.bind(null,E,A,_,h),void 0,null),_},useId:function(){var c=ys(),h=qn.identifierPrefix;if(ln){var _=eo;h=":"+h+"R"+(_=(gs&~(1<<32-Qi(gs)-1)).toString(32)+_),0<(_=ph++)&&(h+="H"+_.toString(32)),h+=":"}else h=":"+h+"r"+(_=O3++).toString(32)+":";return c.memoizedState=h},unstable_isNewReconciler:!1},H3={readContext:xr,useCallback:ST,useContext:xr,useEffect:y_,useImperativeHandle:xT,useInsertionEffect:_T,useLayoutEffect:vT,useMemo:ET,useReducer:__,useRef:mT,useState:function(){return __(mh)},useDebugValue:x_,useDeferredValue:function(c){return TT(Er(),$n.memoizedState,c)},useTransition:function(){return[__(mh)[0],Er().memoizedState]},useMutableSource:aT,useSyncExternalStore:lT,useId:bT,unstable_isNewReconciler:!1},V3={readContext:xr,useCallback:ST,useContext:xr,useEffect:y_,useImperativeHandle:xT,useInsertionEffect:_T,useLayoutEffect:vT,useMemo:ET,useReducer:v_,useRef:mT,useState:function(){return v_(mh)},useDebugValue:x_,useDeferredValue:function(c){var h=Er();return $n===null?h.memoizedState=c:TT(h,$n.memoizedState,c)},useTransition:function(){return[v_(mh)[0],Er().memoizedState]},useMutableSource:aT,useSyncExternalStore:lT,useId:bT,unstable_isNewReconciler:!1};function fu(c,h){try{var _="",E=h;do _+=F3(E),E=E.return;while(E);var b=_}catch(A){b=`
Error generating stack: `+A.message+`
`+A.stack}return{value:c,source:h,stack:b,digest:null}}function S_(c,h,_){return{value:c,source:null,stack:_??null,digest:h??null}}function E_(c,h){try{console.error(h.value)}catch(_){setTimeout(function(){throw _})}}var W3=typeof WeakMap=="function"?WeakMap:Map;function CT(c,h,_){(_=to(-1,_)).tag=3,_.payload={element:null};var E=h.value;return _.callback=function(){Kf||(Kf=!0,G_=E),E_(0,h)},_}function RT(c,h,_){(_=to(-1,_)).tag=3;var E=c.type.getDerivedStateFromError;if(typeof E=="function"){var b=h.value;_.payload=function(){return E(b)},_.callback=function(){E_(0,h)}}var A=c.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(_.callback=function(){E_(0,h),typeof E!="function"&&(Vo===null?Vo=new Set([this]):Vo.add(this));var U=h.stack;this.componentDidCatch(h.value,{componentStack:U!==null?U:""})}),_}function PT(c,h,_){var E=c.pingCache;if(E===null){E=c.pingCache=new W3;var b=new Set;E.set(h,b)}else(b=E.get(h))===void 0&&(b=new Set,E.set(h,b));b.has(_)||(b.add(_),c=J3.bind(null,c,h,_),h.then(c,c))}function IT(c){do{var h;if((h=c.tag===13)&&(h=(h=c.memoizedState)===null||h.dehydrated!==null),h)return c;c=c.return}while(c!==null);return null}function LT(c,h,_,E,b){return 1&c.mode?(c.flags|=65536,c.lanes=b,c):(c===h?c.flags|=65536:(c.flags|=128,_.flags|=131072,_.flags&=-52805,_.tag===1&&(_.alternate===null?_.tag=17:((h=to(-1,1)).tag=2,Go(_,h,1))),_.lanes|=1),c)}var X3=o.ReactCurrentOwner,zi=!1;function Gi(c,h,_,E){h.child=c===null?sT(h,null,_,E):cu(h,c.child,_,E)}function DT(c,h,_,E,b){_=_.render;var A=h.ref;return uu(h,b),E=m_(c,h,_,E,A,b),_=g_(),c===null||zi?(ln&&_&&K0(h),h.flags|=1,Gi(c,h,E,b),h.child):(h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~b,no(c,h,b))}function NT(c,h,_,E,b){if(c===null){var A=_.type;return typeof A!="function"||$_(A)||A.defaultProps!==void 0||_.compare!==null||_.defaultProps!==void 0?((c=np(_.type,null,E,h,h.mode,b)).ref=h.ref,c.return=h,h.child=c):(h.tag=15,h.type=A,UT(c,h,A,E,b))}if(A=c.child,(c.lanes&b)==0){var U=A.memoizedProps;if((_=(_=_.compare)!==null?_:bf)(U,E)&&c.ref===h.ref)return no(c,h,b)}return h.flags|=1,(c=$o(A,E)).ref=h.ref,c.return=h,h.child=c}function UT(c,h,_,E,b){if(c!==null){var A=c.memoizedProps;if(bf(A,E)&&c.ref===h.ref){if(zi=!1,h.pendingProps=E=A,(c.lanes&b)==0)return h.lanes=c.lanes,no(c,h,b);131072&c.flags&&(zi=!0)}}return T_(c,h,_,E,b)}function FT(c,h,_){var E=h.pendingProps,b=E.children,A=c!==null?c.memoizedState:null;if(E.mode==="hidden")if(!(1&h.mode))h.memoizedState={baseLanes:0,cachePool:null,transitions:null},We(mu,er),er|=_;else{if(!(1073741824&_))return c=A!==null?A.baseLanes|_:_,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:c,cachePool:null,transitions:null},h.updateQueue=null,We(mu,er),er|=c,null;h.memoizedState={baseLanes:0,cachePool:null,transitions:null},E=A!==null?A.baseLanes:_,We(mu,er),er|=E}else A!==null?(E=A.baseLanes|_,h.memoizedState=null):E=_,We(mu,er),er|=E;return Gi(c,h,b,_),h.child}function OT(c,h){var _=h.ref;(c===null&&_!==null||c!==null&&c.ref!==_)&&(h.flags|=512,h.flags|=2097152)}function T_(c,h,_,E,b){var A=oi(_)?ds:bt.current;return A=gr(h,A),uu(h,b),_=m_(c,h,_,E,A,b),E=g_(),c===null||zi?(ln&&E&&K0(h),h.flags|=1,Gi(c,h,_,b),h.child):(h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~b,no(c,h,b))}function BT(c,h,_,E,b){if(oi(_)){var A=!0;ai(h)}else A=!1;if(uu(h,b),h.stateNode===null)zf(c,h),tT(h,_,E),l_(h,_,E,b),E=!0;else if(c===null){var U=h.stateNode,V=h.memoizedProps;U.props=V;var te=U.context,ue=_.contextType;typeof ue=="object"&&ue!==null?ue=xr(ue):ue=gr(h,ue=oi(_)?ds:bt.current);var de=_.getDerivedStateFromProps,De=typeof de=="function"||typeof U.getSnapshotBeforeUpdate=="function";De||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(V!==E||te!==ue)&&nT(h,U,E,ue),zo=!1;var he=h.memoizedState;U.state=he,Cf(h,E,U,b),te=h.memoizedState,V!==E||he!==te||xn.current||zo?(typeof de=="function"&&(a_(h,_,de,E),te=h.memoizedState),(V=zo||eT(h,_,V,E,he,te,ue))?(De||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(h.flags|=4194308)):(typeof U.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=E,h.memoizedState=te),U.props=E,U.state=te,U.context=ue,E=V):(typeof U.componentDidMount=="function"&&(h.flags|=4194308),E=!1)}else{U=h.stateNode,KE(c,h),V=h.memoizedProps,ue=h.type===h.elementType?V:Hr(h.type,V),U.props=ue,De=h.pendingProps,he=U.context,typeof(te=_.contextType)=="object"&&te!==null?te=xr(te):te=gr(h,te=oi(_)?ds:bt.current);var Se=_.getDerivedStateFromProps;(de=typeof Se=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(V!==De||he!==te)&&nT(h,U,E,te),zo=!1,he=h.memoizedState,U.state=he,Cf(h,E,U,b);var je=h.memoizedState;V!==De||he!==je||xn.current||zo?(typeof Se=="function"&&(a_(h,_,Se,E),je=h.memoizedState),(ue=zo||eT(h,_,ue,E,he,je,te)||!1)?(de||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(E,je,te),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(E,je,te)),typeof U.componentDidUpdate=="function"&&(h.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof U.componentDidUpdate!="function"||V===c.memoizedProps&&he===c.memoizedState||(h.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||V===c.memoizedProps&&he===c.memoizedState||(h.flags|=1024),h.memoizedProps=E,h.memoizedState=je),U.props=E,U.state=je,U.context=te,E=ue):(typeof U.componentDidUpdate!="function"||V===c.memoizedProps&&he===c.memoizedState||(h.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||V===c.memoizedProps&&he===c.memoizedState||(h.flags|=1024),E=!1)}return b_(c,h,_,E,A,b)}function b_(c,h,_,E,b,A){OT(c,h);var U=(128&h.flags)!=0;if(!E&&!U)return b&&ru(h,_,!1),no(c,h,A);E=h.stateNode,X3.current=h;var V=U&&typeof _.getDerivedStateFromError!="function"?null:E.render();return h.flags|=1,c!==null&&U?(h.child=cu(h,c.child,null,A),h.child=cu(h,null,V,A)):Gi(c,h,V,A),h.memoizedState=E.state,b&&ru(h,_,!0),h.child}function kT(c){var h=c.stateNode;h.pendingContext?fs(0,h.pendingContext,h.pendingContext!==h.context):h.context&&fs(0,h.context,!1),u_(c,h.containerInfo)}function zT(c,h,_,E,b){return au(),e_(b),h.flags|=256,Gi(c,h,_,E),h.child}var _h,vh,Of,Bf,w_={dehydrated:null,treeContext:null,retryLane:0};function A_(c){return{baseLanes:c,cachePool:null,transitions:null}}function GT(c,h,_){var E,b=h.pendingProps,A=Sn.current,U=!1,V=(128&h.flags)!=0;if((E=V)||(E=(c===null||c.memoizedState!==null)&&(2&A)!=0),E?(U=!0,h.flags&=-129):c!==null&&c.memoizedState===null||(A|=1),We(Sn,1&A),c===null)return J0(h),(c=h.memoizedState)!==null&&(c=c.dehydrated)!==null?(1&h.mode?oh(c)?h.lanes=8:h.lanes=1073741824:h.lanes=1,null):(V=b.children,c=b.fallback,U?(b=h.mode,U=h.child,V={mode:"hidden",children:V},!(1&b)&&U!==null?(U.childLanes=0,U.pendingProps=V):U=ip(V,b,0,null),c=Za(c,b,_,null),U.return=h,c.return=h,U.sibling=c,h.child=U,h.child.memoizedState=A_(_),h.memoizedState=w_,c):M_(h,V));if((A=c.memoizedState)!==null&&(E=A.dehydrated)!==null)return function(ue,de,De,he,Se,je,Et){if(De)return 256&de.flags?(de.flags&=-257,kf(ue,de,Et,he=S_(Error(s(422))))):de.memoizedState!==null?(de.child=ue.child,de.flags|=128,null):(je=he.fallback,Se=de.mode,he=ip({mode:"visible",children:he.children},Se,0,null),(je=Za(je,Se,Et,null)).flags|=2,he.return=de,je.return=de,he.sibling=je,de.child=he,1&de.mode&&cu(de,ue.child,null,Et),de.child.memoizedState=A_(Et),de.memoizedState=w_,je);if(!(1&de.mode))return kf(ue,de,Et,null);if(oh(Se))return he=nu(Se).digest,je=Error(s(419)),he=S_(je,he,void 0),kf(ue,de,Et,he);if(De=(Et&ue.childLanes)!=0,zi||De){if((he=qn)!==null){switch(Et&-Et){case 4:Se=2;break;case 16:Se=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Se=32;break;case 536870912:Se=268435456;break;default:Se=0}(Se=Se&(he.suspendedLanes|Et)?0:Se)!==0&&Se!==je.retryLane&&(je.retryLane=Se,_s(ue,Se),Tr(he,ue,Se,-1))}return j_(),kf(ue,de,Et,he=S_(Error(s(421))))}return sh(Se)?(de.flags|=128,de.child=ue.child,de=eD.bind(null,ue),pf(Se,de),null):(ue=je.treeContext,ct&&(yr=k0(Se),Ji=de,ln=!0,Gr=null,uh=!1,ue!==null&&(_r[vr++]=gs,_r[vr++]=eo,_r[vr++]=Wa,gs=ue.id,eo=ue.overflow,Wa=de)),de=M_(de,he.children),de.flags|=4096,de)}(c,h,V,b,E,A,_);if(U){U=b.fallback,V=h.mode,E=(A=c.child).sibling;var te={mode:"hidden",children:b.children};return!(1&V)&&h.child!==A?((b=h.child).childLanes=0,b.pendingProps=te,h.deletions=null):(b=$o(A,te)).subtreeFlags=14680064&A.subtreeFlags,E!==null?U=$o(E,U):(U=Za(U,V,_,null)).flags|=2,U.return=h,b.return=h,b.sibling=U,h.child=b,b=U,U=h.child,V=(V=c.child.memoizedState)===null?A_(_):{baseLanes:V.baseLanes|_,cachePool:null,transitions:V.transitions},U.memoizedState=V,U.childLanes=c.childLanes&~_,h.memoizedState=w_,b}return c=(U=c.child).sibling,b=$o(U,{mode:"visible",children:b.children}),!(1&h.mode)&&(b.lanes=_),b.return=h,b.sibling=null,c!==null&&((_=h.deletions)===null?(h.deletions=[c],h.flags|=16):_.push(c)),h.child=b,h.memoizedState=null,b}function M_(c,h){return(h=ip({mode:"visible",children:h},c.mode,0,null)).return=c,c.child=h}function kf(c,h,_,E){return E!==null&&e_(E),cu(h,c.child,null,_),(c=M_(h,h.pendingProps.children)).flags|=2,h.memoizedState=null,c}function HT(c,h,_){c.lanes|=h;var E=c.alternate;E!==null&&(E.lanes|=h),r_(c.return,h,_)}function C_(c,h,_,E,b){var A=c.memoizedState;A===null?c.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:E,tail:_,tailMode:b}:(A.isBackwards=h,A.rendering=null,A.renderingStartTime=0,A.last=E,A.tail=_,A.tailMode=b)}function VT(c,h,_){var E=h.pendingProps,b=E.revealOrder,A=E.tail;if(Gi(c,h,E.children,_),(2&(E=Sn.current))!=0)E=1&E|2,h.flags|=128;else{if(c!==null&&128&c.flags)e:for(c=h.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&HT(c,_,h);else if(c.tag===19)HT(c,_,h);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===h)break e;for(;c.sibling===null;){if(c.return===null||c.return===h)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}E&=1}if(We(Sn,E),(1&h.mode)==0)h.memoizedState=null;else switch(b){case"forwards":for(_=h.child,b=null;_!==null;)(c=_.alternate)!==null&&If(c)===null&&(b=_),_=_.sibling;(_=b)===null?(b=h.child,h.child=null):(b=_.sibling,_.sibling=null),C_(h,!1,b,_,A);break;case"backwards":for(_=null,b=h.child,h.child=null;b!==null;){if((c=b.alternate)!==null&&If(c)===null){h.child=b;break}c=b.sibling,b.sibling=_,_=b,b=c}C_(h,!0,_,null,A);break;case"together":C_(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function zf(c,h){!(1&h.mode)&&c!==null&&(c.alternate=null,h.alternate=null,h.flags|=2)}function no(c,h,_){if(c!==null&&(h.dependencies=c.dependencies),Ya|=h.lanes,(_&h.childLanes)==0)return null;if(c!==null&&h.child!==c.child)throw Error(s(153));if(h.child!==null){for(_=$o(c=h.child,c.pendingProps),h.child=_,_.return=h;c.sibling!==null;)c=c.sibling,(_=_.sibling=$o(c,c.pendingProps)).return=h;_.sibling=null}return h.child}function xs(c){c.flags|=4}function WT(c,h){if(c!==null&&c.child===h.child)return!0;if(16&h.flags)return!1;for(c=h.child;c!==null;){if(12854&c.flags||12854&c.subtreeFlags)return!1;c=c.sibling}return!0}if(Ie)_h=function(c,h){for(var _=h.child;_!==null;){if(_.tag===5||_.tag===6)ne(c,_.stateNode);else if(_.tag!==4&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===h)break;for(;_.sibling===null;){if(_.return===null||_.return===h)return;_=_.return}_.sibling.return=_.return,_=_.sibling}},vh=function(){},Of=function(c,h,_,E,b){if((c=c.memoizedProps)!==E){var A=h.stateNode,U=vs(Sr.current);_=ie(A,_,c,E,b,U),(h.updateQueue=_)&&xs(h)}},Bf=function(c,h,_,E){_!==E&&xs(h)};else if(q){_h=function(c,h,_,E){for(var b=h.child;b!==null;){if(b.tag===5){var A=b.stateNode;_&&E&&(A=wn(A,b.type,b.memoizedProps,b)),ne(c,A)}else if(b.tag===6)A=b.stateNode,_&&E&&(A=Wn(A,b.memoizedProps,b)),ne(c,A);else if(b.tag!==4){if(b.tag===22&&b.memoizedState!==null)(A=b.child)!==null&&(A.return=b),_h(c,b,!0,!0);else if(b.child!==null){b.child.return=b,b=b.child;continue}}if(b===h)break;for(;b.sibling===null;){if(b.return===null||b.return===h)return;b=b.return}b.sibling.return=b.return,b=b.sibling}};var XT=function(c,h,_,E){for(var b=h.child;b!==null;){if(b.tag===5){var A=b.stateNode;_&&E&&(A=wn(A,b.type,b.memoizedProps,b)),Ce(c,A)}else if(b.tag===6)A=b.stateNode,_&&E&&(A=Wn(A,b.memoizedProps,b)),Ce(c,A);else if(b.tag!==4){if(b.tag===22&&b.memoizedState!==null)(A=b.child)!==null&&(A.return=b),XT(c,b,!0,!0);else if(b.child!==null){b.child.return=b,b=b.child;continue}}if(b===h)break;for(;b.sibling===null;){if(b.return===null||b.return===h)return;b=b.return}b.sibling.return=b.return,b=b.sibling}};vh=function(c,h){var _=h.stateNode;if(!WT(c,h)){c=_.containerInfo;var E=ce(c);XT(E,h,!1,!1),_.pendingChildren=E,xs(h),at(c,E)}},Of=function(c,h,_,E,b){var A=c.stateNode,U=c.memoizedProps;if((c=WT(c,h))&&U===E)h.stateNode=A;else{var V=h.stateNode,te=vs(Sr.current),ue=null;U!==E&&(ue=ie(V,_,U,E,b,te)),c&&ue===null?h.stateNode=A:(A=Te(A,ue,_,U,E,h,c,V),ee(A,_,E,b,te)&&xs(h),h.stateNode=A,c?xs(h):_h(A,h,!1,!1))}},Bf=function(c,h,_,E){_!==E?(c=vs(hu.current),_=vs(Sr.current),h.stateNode=ve(E,c,_,h),xs(h)):h.stateNode=c.stateNode}}else vh=function(){},Of=function(){},Bf=function(){};function yh(c,h){if(!ln)switch(c.tailMode){case"hidden":h=c.tail;for(var _=null;h!==null;)h.alternate!==null&&(_=h),h=h.sibling;_===null?c.tail=null:_.sibling=null;break;case"collapsed":_=c.tail;for(var E=null;_!==null;)_.alternate!==null&&(E=_),_=_.sibling;E===null?h||c.tail===null?c.tail=null:c.tail.sibling=null:E.sibling=null}}function Ci(c){var h=c.alternate!==null&&c.alternate.child===c.child,_=0,E=0;if(h)for(var b=c.child;b!==null;)_|=b.lanes|b.childLanes,E|=14680064&b.subtreeFlags,E|=14680064&b.flags,b.return=c,b=b.sibling;else for(b=c.child;b!==null;)_|=b.lanes|b.childLanes,E|=b.subtreeFlags,E|=b.flags,b.return=c,b=b.sibling;return c.subtreeFlags|=E,c.childLanes=_,h}function j3(c,h,_){var E=h.pendingProps;switch(Z0(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ci(h),null;case 1:case 17:return oi(h.type)&&Pn(),Ci(h),null;case 3:return _=h.stateNode,du(),dt(xn),dt(bt),d_(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),c!==null&&c.child!==null||(Tf(h)?xs(h):c===null||c.memoizedState.isDehydrated&&!(256&h.flags)||(h.flags|=1024,Gr!==null&&(W_(Gr),Gr=null))),vh(c,h),Ci(h),null;case 5:c_(h),_=vs(hu.current);var b=h.type;if(c!==null&&h.stateNode!=null)Of(c,h,b,E,_),c.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!E){if(h.stateNode===null)throw Error(s(166));return Ci(h),null}if(c=vs(Sr.current),Tf(h)){if(!ct)throw Error(s(175));c=z0(h.stateNode,h.type,h.memoizedProps,_,c,h,!uh),h.updateQueue=c,c!==null&&xs(h)}else{var A=G(b,E,_,c,h);_h(A,h,!1,!1),h.stateNode=A,ee(A,b,E,_,c)&&xs(h)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return Ci(h),null;case 6:if(c&&h.stateNode!=null)Bf(c,h,c.memoizedProps,E);else{if(typeof E!="string"&&h.stateNode===null)throw Error(s(166));if(c=vs(hu.current),_=vs(Sr.current),Tf(h)){if(!ct)throw Error(s(176));if(c=h.stateNode,_=h.memoizedProps,(E=G0(c,_,h,!uh))&&(b=Ji)!==null)switch(b.tag){case 3:ot(b.stateNode.containerInfo,c,_,(1&b.mode)!=0);break;case 5:pt(b.type,b.memoizedProps,b.stateNode,c,_,(1&b.mode)!=0)}E&&xs(h)}else h.stateNode=ve(E,c,_,h)}return Ci(h),null;case 13:if(dt(Sn),E=h.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(ln&&yr!==null&&1&h.mode&&!(128&h.flags))$E(),au(),h.flags|=98560,b=!1;else if(b=Tf(h),E!==null&&E.dehydrated!==null){if(c===null){if(!b)throw Error(s(318));if(!ct)throw Error(s(344));if(!(b=(b=h.memoizedState)!==null?b.dehydrated:null))throw Error(s(317));D(b,h)}else au(),!(128&h.flags)&&(h.memoizedState=null),h.flags|=4;Ci(h),b=!1}else Gr!==null&&(W_(Gr),Gr=null),b=!0;if(!b)return 65536&h.flags?h:null}return 128&h.flags?(h.lanes=_,h):((_=E!==null)!=(c!==null&&c.memoizedState!==null)&&_&&(h.child.flags|=8192,1&h.mode&&(c===null||1&Sn.current?On===0&&(On=3):j_())),h.updateQueue!==null&&(h.flags|=4),Ci(h),null);case 4:return du(),vh(c,h),c===null&&st(h.stateNode.containerInfo),Ci(h),null;case 10:return i_(h.type._context),Ci(h),null;case 19:if(dt(Sn),(b=h.memoizedState)===null)return Ci(h),null;if(E=(128&h.flags)!=0,(A=b.rendering)===null)if(E)yh(b,!1);else{if(On!==0||c!==null&&128&c.flags)for(c=h.child;c!==null;){if((A=If(c))!==null){for(h.flags|=128,yh(b,!1),(c=A.updateQueue)!==null&&(h.updateQueue=c,h.flags|=4),h.subtreeFlags=0,c=_,_=h.child;_!==null;)b=c,(E=_).flags&=14680066,(A=E.alternate)===null?(E.childLanes=0,E.lanes=b,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=A.childLanes,E.lanes=A.lanes,E.child=A.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=A.memoizedProps,E.memoizedState=A.memoizedState,E.updateQueue=A.updateQueue,E.type=A.type,b=A.dependencies,E.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext}),_=_.sibling;return We(Sn,1&Sn.current|2),h.child}c=c.sibling}b.tail!==null&&jn()>z_&&(h.flags|=128,E=!0,yh(b,!1),h.lanes=4194304)}else{if(!E)if((c=If(A))!==null){if(h.flags|=128,E=!0,(c=c.updateQueue)!==null&&(h.updateQueue=c,h.flags|=4),yh(b,!0),b.tail===null&&b.tailMode==="hidden"&&!A.alternate&&!ln)return Ci(h),null}else 2*jn()-b.renderingStartTime>z_&&_!==1073741824&&(h.flags|=128,E=!0,yh(b,!1),h.lanes=4194304);b.isBackwards?(A.sibling=h.child,h.child=A):((c=b.last)!==null?c.sibling=A:h.child=A,b.last=A)}return b.tail!==null?(h=b.tail,b.rendering=h,b.tail=h.sibling,b.renderingStartTime=jn(),h.sibling=null,c=Sn.current,We(Sn,E?1&c|2:1&c),h):(Ci(h),null);case 22:case 23:return X_(),_=h.memoizedState!==null,c!==null&&c.memoizedState!==null!==_&&(h.flags|=8192),_&&1&h.mode?1073741824&er&&(Ci(h),Ie&&6&h.subtreeFlags&&(h.flags|=8192)):Ci(h),null;case 24:case 25:return null}throw Error(s(156,h.tag))}function $3(c,h){switch(Z0(h),h.tag){case 1:return oi(h.type)&&Pn(),65536&(c=h.flags)?(h.flags=-65537&c|128,h):null;case 3:return du(),dt(xn),dt(bt),d_(),65536&(c=h.flags)&&!(128&c)?(h.flags=-65537&c|128,h):null;case 5:return c_(h),null;case 13:if(dt(Sn),(c=h.memoizedState)!==null&&c.dehydrated!==null){if(h.alternate===null)throw Error(s(340));au()}return 65536&(c=h.flags)?(h.flags=-65537&c|128,h):null;case 19:return dt(Sn),null;case 4:return du(),null;case 10:return i_(h.type._context),null;case 22:case 23:return X_(),null;default:return null}}var Gf=!1,_i=!1,Y3=typeof WeakSet=="function"?WeakSet:Set,Ge=null;function pu(c,h){var _=c.ref;if(_!==null)if(typeof _=="function")try{_(null)}catch(E){un(c,h,E)}else _.current=null}function jT(c,h,_){try{_()}catch(E){un(c,h,E)}}var $T=!1;function xh(c,h,_){var E=h.updateQueue;if((E=E!==null?E.lastEffect:null)!==null){var b=E=E.next;do{if((b.tag&c)===c){var A=b.destroy;b.destroy=void 0,A!==void 0&&jT(h,_,A)}b=b.next}while(b!==E)}}function Hf(c,h){if((h=(h=h.updateQueue)!==null?h.lastEffect:null)!==null){var _=h=h.next;do{if((_.tag&c)===c){var E=_.create;_.destroy=E()}_=_.next}while(_!==h)}}function R_(c){var h=c.ref;if(h!==null){var _=c.stateNode;c.tag===5?c=Z(_):c=_,typeof h=="function"?h(c):h.current=c}}function YT(c){var h=c.alternate;h!==null&&(c.alternate=null,YT(h)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(h=c.stateNode)!==null&&Kt(h),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function qT(c){return c.tag===5||c.tag===3||c.tag===4}function KT(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||qT(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(2&c.flags||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(2&c.flags))return c.stateNode}}function P_(c,h,_){var E=c.tag;if(E===5||E===6)c=c.stateNode,h?be(_,c,h):Qe(_,c);else if(E!==4&&(c=c.child)!==null)for(P_(c,h,_),c=c.sibling;c!==null;)P_(c,h,_),c=c.sibling}function I_(c,h,_){var E=c.tag;if(E===5||E===6)c=c.stateNode,h?Bt(_,c,h):Ae(_,c);else if(E!==4&&(c=c.child)!==null)for(I_(c,h,_),c=c.sibling;c!==null;)I_(c,h,_),c=c.sibling}var Ri=null,Ss=!1;function Es(c,h,_){for(_=_.child;_!==null;)L_(c,h,_),_=_.sibling}function L_(c,h,_){if(ps&&typeof ps.onCommitFiberUnmount=="function")try{ps.onCommitFiberUnmount(yf,_)}catch{}switch(_.tag){case 5:_i||pu(_,h);case 6:if(Ie){var E=Ri,b=Ss;Ri=null,Es(c,h,_),Ss=b,(Ri=E)!==null&&(Ss?yt(Ri,_.stateNode):Ht(Ri,_.stateNode))}else Es(c,h,_);break;case 18:Ie&&Ri!==null&&(Ss?ke(Ri,_.stateNode):se(Ri,_.stateNode));break;case 4:Ie?(E=Ri,b=Ss,Ri=_.stateNode.containerInfo,Ss=!0,Es(c,h,_),Ri=E,Ss=b):(q&&(E=_.stateNode.containerInfo,b=ce(E),Ct(E,b)),Es(c,h,_));break;case 0:case 11:case 14:case 15:if(!_i&&(E=_.updateQueue)!==null&&(E=E.lastEffect)!==null){b=E=E.next;do{var A=b,U=A.destroy;A=A.tag,U!==void 0&&(2&A||4&A)&&jT(_,h,U),b=b.next}while(b!==E)}Es(c,h,_);break;case 1:if(!_i&&(pu(_,h),typeof(E=_.stateNode).componentWillUnmount=="function"))try{E.props=_.memoizedProps,E.state=_.memoizedState,E.componentWillUnmount()}catch(V){un(_,h,V)}Es(c,h,_);break;case 21:Es(c,h,_);break;case 22:1&_.mode?(_i=(E=_i)||_.memoizedState!==null,Es(c,h,_),_i=E):Es(c,h,_);break;default:Es(c,h,_)}}function ZT(c){var h=c.updateQueue;if(h!==null){c.updateQueue=null;var _=c.stateNode;_===null&&(_=c.stateNode=new Y3),h.forEach(function(E){var b=tD.bind(null,c,E);_.has(E)||(_.add(E),E.then(b,b))})}}function Vr(c,h){var _=h.deletions;if(_!==null)for(var E=0;E<_.length;E++){var b=_[E];try{var A=c,U=h;if(Ie){var V=U;e:for(;V!==null;){switch(V.tag){case 5:Ri=V.stateNode,Ss=!1;break e;case 3:case 4:Ri=V.stateNode.containerInfo,Ss=!0;break e}V=V.return}if(Ri===null)throw Error(s(160));L_(A,U,b),Ri=null,Ss=!1}else L_(A,U,b);var te=b.alternate;te!==null&&(te.return=null),b.return=null}catch(ue){un(b,h,ue)}}if(12854&h.subtreeFlags)for(h=h.child;h!==null;)QT(h,c),h=h.sibling}function QT(c,h){var _=c.alternate,E=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(Vr(h,c),Ts(c),4&E){try{xh(3,c,c.return),Hf(3,c)}catch(he){un(c,c.return,he)}try{xh(5,c,c.return)}catch(he){un(c,c.return,he)}}break;case 1:Vr(h,c),Ts(c),512&E&&_!==null&&pu(_,_.return);break;case 5:if(Vr(h,c),Ts(c),512&E&&_!==null&&pu(_,_.return),Ie){if(32&c.flags){var b=c.stateNode;try{ht(b)}catch(he){un(c,c.return,he)}}if(4&E&&(b=c.stateNode)!=null){var A=c.memoizedProps;if(_=_!==null?_.memoizedProps:A,E=c.type,h=c.updateQueue,c.updateQueue=null,h!==null)try{ft(b,h,E,_,A,c)}catch(he){un(c,c.return,he)}}}break;case 6:if(Vr(h,c),Ts(c),4&E&&Ie){if(c.stateNode===null)throw Error(s(162));b=c.stateNode,A=c.memoizedProps,_=_!==null?_.memoizedProps:A;try{Re(b,_,A)}catch(he){un(c,c.return,he)}}break;case 3:if(Vr(h,c),Ts(c),4&E){if(Ie&&ct&&_!==null&&_.memoizedState.isDehydrated)try{oe(h.containerInfo)}catch(he){un(c,c.return,he)}if(q){b=h.containerInfo,A=h.pendingChildren;try{Ct(b,A)}catch(he){un(c,c.return,he)}}}break;case 4:if(Vr(h,c),Ts(c),4&E&&q){b=(A=c.stateNode).containerInfo,A=A.pendingChildren;try{Ct(b,A)}catch(he){un(c,c.return,he)}}break;case 13:Vr(h,c),Ts(c),8192&(b=c.child).flags&&(A=b.memoizedState!==null,b.stateNode.isHidden=A,!A||b.alternate!==null&&b.alternate.memoizedState!==null||(k_=jn())),4&E&&ZT(c);break;case 22:var U=_!==null&&_.memoizedState!==null;if(1&c.mode?(_i=(_=_i)||U,Vr(h,c),_i=_):Vr(h,c),Ts(c),8192&E){if(_=c.memoizedState!==null,(c.stateNode.isHidden=_)&&!U&&(1&c.mode)!=0)for(Ge=c,E=c.child;E!==null;){for(h=Ge=E;Ge!==null;){var V=(U=Ge).child;switch(U.tag){case 0:case 11:case 14:case 15:xh(4,U,U.return);break;case 1:pu(U,U.return);var te=U.stateNode;if(typeof te.componentWillUnmount=="function"){var ue=U,de=U.return;try{var De=ue;te.props=De.memoizedProps,te.state=De.memoizedState,te.componentWillUnmount()}catch(he){un(ue,de,he)}}break;case 5:pu(U,U.return);break;case 22:if(U.memoizedState!==null){tb(h);continue}}V!==null?(V.return=U,Ge=V):tb(h)}E=E.sibling}if(Ie){e:if(E=null,Ie)for(h=c;;){if(h.tag===5){if(E===null){E=h;try{b=h.stateNode,_?it(b):wt(h.stateNode,h.memoizedProps)}catch(he){un(c,c.return,he)}}}else if(h.tag===6){if(E===null)try{A=h.stateNode,_?Ve(A):j(A,h.memoizedProps)}catch(he){un(c,c.return,he)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===c)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break e;for(;h.sibling===null;){if(h.return===null||h.return===c)break e;E===h&&(E=null),h=h.return}E===h&&(E=null),h.sibling.return=h.return,h=h.sibling}}}break;case 19:Vr(h,c),Ts(c),4&E&&ZT(c);break;case 21:break;default:Vr(h,c),Ts(c)}}function Ts(c){var h=c.flags;if(2&h){try{if(Ie){e:{for(var _=c.return;_!==null;){if(qT(_)){var E=_;break e}_=_.return}throw Error(s(160))}switch(E.tag){case 5:var b=E.stateNode;32&E.flags&&(ht(b),E.flags&=-33),I_(c,KT(c),b);break;case 3:case 4:var A=E.stateNode.containerInfo;P_(c,KT(c),A);break;default:throw Error(s(161))}}}catch(U){un(c,c.return,U)}c.flags&=-3}4096&h&&(c.flags&=-4097)}function q3(c,h,_){Ge=c,JT(c)}function JT(c,h,_){for(var E=(1&c.mode)!=0;Ge!==null;){var b=Ge,A=b.child;if(b.tag===22&&E){var U=b.memoizedState!==null||Gf;if(!U){var V=b.alternate,te=V!==null&&V.memoizedState!==null||_i;V=Gf;var ue=_i;if(Gf=U,(_i=te)&&!ue)for(Ge=b;Ge!==null;)te=(U=Ge).child,U.tag===22&&U.memoizedState!==null?nb(b):te!==null?(te.return=U,Ge=te):nb(b);for(;A!==null;)Ge=A,JT(A),A=A.sibling;Ge=b,Gf=V,_i=ue}eb(c)}else 8772&b.subtreeFlags&&A!==null?(A.return=b,Ge=A):eb(c)}}function eb(c){for(;Ge!==null;){var h=Ge;if(8772&h.flags){var _=h.alternate;try{if(8772&h.flags)switch(h.tag){case 0:case 11:case 15:_i||Hf(5,h);break;case 1:var E=h.stateNode;if(4&h.flags&&!_i)if(_===null)E.componentDidMount();else{var b=h.elementType===h.type?_.memoizedProps:Hr(h.type,_.memoizedProps);E.componentDidUpdate(b,_.memoizedState,E.__reactInternalSnapshotBeforeUpdate)}var A=h.updateQueue;A!==null&&QE(h,A,E);break;case 3:var U=h.updateQueue;if(U!==null){if(_=null,h.child!==null)switch(h.child.tag){case 5:_=Z(h.child.stateNode);break;case 1:_=h.child.stateNode}QE(h,U,_)}break;case 5:var V=h.stateNode;_===null&&4&h.flags&&Oe(V,h.type,h.memoizedProps,h);break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(ct&&h.memoizedState===null){var te=h.alternate;if(te!==null){var ue=te.memoizedState;if(ue!==null){var de=ue.dehydrated;de!==null&&ae(de)}}}break;default:throw Error(s(163))}_i||512&h.flags&&R_(h)}catch(De){un(h,h.return,De)}}if(h===c){Ge=null;break}if((_=h.sibling)!==null){_.return=h.return,Ge=_;break}Ge=h.return}}function tb(c){for(;Ge!==null;){var h=Ge;if(h===c){Ge=null;break}var _=h.sibling;if(_!==null){_.return=h.return,Ge=_;break}Ge=h.return}}function nb(c){for(;Ge!==null;){var h=Ge;try{switch(h.tag){case 0:case 11:case 15:var _=h.return;try{Hf(4,h)}catch(te){un(h,_,te)}break;case 1:var E=h.stateNode;if(typeof E.componentDidMount=="function"){var b=h.return;try{E.componentDidMount()}catch(te){un(h,b,te)}}var A=h.return;try{R_(h)}catch(te){un(h,A,te)}break;case 5:var U=h.return;try{R_(h)}catch(te){un(h,U,te)}}}catch(te){un(h,h.return,te)}if(h===c){Ge=null;break}var V=h.sibling;if(V!==null){V.return=h.return,Ge=V;break}Ge=h.return}}var Vf=0,Wf=1,Xf=2,jf=3,$f=4;if(typeof Symbol=="function"&&Symbol.for){var Sh=Symbol.for;Vf=Sh("selector.component"),Wf=Sh("selector.has_pseudo_class"),Xf=Sh("selector.role"),jf=Sh("selector.test_id"),$f=Sh("selector.text")}function D_(c){var h=Xe(c);if(h!=null){if(typeof h.memoizedProps["data-testname"]!="string")throw Error(s(364));return h}if((c=Un(c))===null)throw Error(s(362));return c.stateNode.current}function N_(c,h){switch(h.$$typeof){case Vf:if(c.type===h.value)return!0;break;case Wf:e:{h=h.value,c=[c,0];for(var _=0;_<c.length;){var E=c[_++],b=c[_++],A=h[b];if(E.tag!==5||!I(E)){for(;A!=null&&N_(E,A);)A=h[++b];if(b===h.length){h=!0;break e}for(E=E.child;E!==null;)c.push(E,b),E=E.sibling}}h=!1}return h;case Xf:if(c.tag===5&&re(c.stateNode,h.value))return!0;break;case $f:if((c.tag===5||c.tag===6)&&(c=k(c))!==null&&0<=c.indexOf(h.value))return!0;break;case jf:if(c.tag===5&&typeof(c=c.memoizedProps["data-testname"])=="string"&&c.toLowerCase()===h.value.toLowerCase())return!0;break;default:throw Error(s(365))}return!1}function U_(c){switch(c.$$typeof){case Vf:return"<"+(R(c.value)||"Unknown")+">";case Wf:return":has("+(U_(c)||"")+")";case Xf:return'[role="'+c.value+'"]';case $f:return'"'+c.value+'"';case jf:return'[data-testname="'+c.value+'"]';default:throw Error(s(365))}}function ib(c,h){var _=[];c=[c,0];for(var E=0;E<c.length;){var b=c[E++],A=c[E++],U=h[A];if(b.tag!==5||!I(b)){for(;U!=null&&N_(b,U);)U=h[++A];if(A===h.length)_.push(b);else for(b=b.child;b!==null;)c.push(b,A),b=b.sibling}}return _}function F_(c,h){if(!Ft)throw Error(s(363));c=ib(c=D_(c),h),h=[],c=Array.from(c);for(var _=0;_<c.length;){var E=c[_++];if(E.tag===5)I(E)||h.push(E.stateNode);else for(E=E.child;E!==null;)c.push(E),E=E.sibling}return h}var K3=Math.ceil,Yf=o.ReactCurrentDispatcher,O_=o.ReactCurrentOwner,An=o.ReactCurrentBatchConfig,Nt=0,qn=null,In=null,li=0,er=0,mu=Xn(0),On=0,Eh=null,Ya=0,qf=0,B_=0,Th=null,tr=null,k_=0,z_=1/0,Ho=null;function gu(){z_=jn()+500}var rb,Kf=!1,G_=null,Vo=null,Zf=!1,Wo=null,Qf=0,bh=0,H_=null,Jf=-1,ep=0;function vi(){return 6&Nt?jn():Jf!==-1?Jf:Jf=jn()}function Xo(c){return 1&c.mode?2&Nt&&li!==0?li&-li:U3.transition!==null?(ep===0&&(ep=BE()),ep):(c=zt)!==0?c:nt():1}function Tr(c,h,_,E){if(50<bh)throw bh=0,H_=null,Error(s(185));lh(c,_,E),2&Nt&&c===qn||(c===qn&&(!(2&Nt)&&(qf|=_),On===4&&jo(c,li)),Hi(c,E),_===1&&Nt===0&&!(1&h.mode)&&(gu(),xf&&ms()))}function Hi(c,h){var _=c.callbackNode;(function(b,A){for(var U=b.suspendedLanes,V=b.pingedLanes,te=b.expirationTimes,ue=b.pendingLanes;0<ue;){var de=31-Qi(ue),De=1<<de,he=te[de];he===-1?De&U&&!(De&V)||(te[de]=P3(De,A)):he<=A&&(b.expiredLanes|=De),ue&=~De}})(c,h);var E=vf(c,c===qn?li:0);if(E===0)_!==null&&zE(_),c.callbackNode=null,c.callbackPriority=0;else if(h=E&-E,c.callbackPriority!==h){if(_!=null&&zE(_),h===1)c.tag===0?function(b){xf=!0,HE(b)}(ob.bind(null,c)):HE(ob.bind(null,c)),gt?xt(function(){!(6&Nt)&&ms()}):$0(Y0,ms),_=null;else{switch(kE(E)){case 1:_=Y0;break;case 4:_=D3;break;case 16:default:_=GE;break;case 536870912:_=N3}_=pb(_,sb.bind(null,c))}c.callbackPriority=h,c.callbackNode=_}}function sb(c,h){if(Jf=-1,ep=0,(6&Nt)!=0)throw Error(s(327));var _=c.callbackNode;if(Ka()&&c.callbackNode!==_)return null;var E=vf(c,c===qn?li:0);if(E===0)return null;if(30&E||E&c.expiredLanes||h)h=tp(c,E);else{h=E;var b=Nt;Nt|=2;var A=ub();for(qn===c&&li===h||(Ho=null,gu(),qa(c,h));;)try{Q3();break}catch(V){lb(c,V)}n_(),Yf.current=A,Nt=b,In!==null?h=0:(qn=null,li=0,h=On)}if(h!==0){if(h===2&&(b=W0(c))!==0&&(E=b,h=V_(c,b)),h===1)throw _=Eh,qa(c,0),jo(c,E),Hi(c,jn()),_;if(h===6)jo(c,E);else{if(b=c.current.alternate,(30&E)==0&&!function(V){for(var te=V;;){if(16384&te.flags){var ue=te.updateQueue;if(ue!==null&&(ue=ue.stores)!==null)for(var de=0;de<ue.length;de++){var De=ue[de],he=De.getSnapshot;De=De.value;try{if(!zr(he(),De))return!1}catch{return!1}}}if(ue=te.child,16384&te.subtreeFlags&&ue!==null)ue.return=te,te=ue;else{if(te===V)break;for(;te.sibling===null;){if(te.return===null||te.return===V)return!0;te=te.return}te.sibling.return=te.return,te=te.sibling}}return!0}(b)&&((h=tp(c,E))===2&&(A=W0(c))!==0&&(E=A,h=V_(c,A)),h===1))throw _=Eh,qa(c,0),jo(c,E),Hi(c,jn()),_;switch(c.finishedWork=b,c.finishedLanes=E,h){case 0:case 1:throw Error(s(345));case 2:case 5:_u(c,tr,Ho);break;case 3:if(jo(c,E),(130023424&E)===E&&10<(h=k_+500-jn())){if(vf(c,0)!==0)break;if(((b=c.suspendedLanes)&E)!==E){vi(),c.pingedLanes|=c.suspendedLanes&b;break}c.timeoutHandle=Me(_u.bind(null,c,tr,Ho),h);break}_u(c,tr,Ho);break;case 4:if(jo(c,E),(4194240&E)===E)break;for(h=c.eventTimes,b=-1;0<E;){var U=31-Qi(E);A=1<<U,(U=h[U])>b&&(b=U),E&=~A}if(E=b,10<(E=(120>(E=jn()-E)?120:480>E?480:1080>E?1080:1920>E?1920:3e3>E?3e3:4320>E?4320:1960*K3(E/1960))-E)){c.timeoutHandle=Me(_u.bind(null,c,tr,Ho),E);break}_u(c,tr,Ho);break;default:throw Error(s(329))}}}return Hi(c,jn()),c.callbackNode===_?sb.bind(null,c):null}function V_(c,h){var _=Th;return c.current.memoizedState.isDehydrated&&(qa(c,h).flags|=256),(c=tp(c,h))!==2&&(h=tr,tr=_,h!==null&&W_(h)),c}function W_(c){tr===null?tr=c:tr.push.apply(tr,c)}function jo(c,h){for(h&=~B_,h&=~qf,c.suspendedLanes|=h,c.pingedLanes&=~h,c=c.expirationTimes;0<h;){var _=31-Qi(h),E=1<<_;c[_]=-1,h&=~E}}function ob(c){if(6&Nt)throw Error(s(327));Ka();var h=vf(c,0);if(!(1&h))return Hi(c,jn()),null;var _=tp(c,h);if(c.tag!==0&&_===2){var E=W0(c);E!==0&&(h=E,_=V_(c,E))}if(_===1)throw _=Eh,qa(c,0),jo(c,h),Hi(c,jn()),_;if(_===6)throw Error(s(345));return c.finishedWork=c.current.alternate,c.finishedLanes=h,_u(c,tr,Ho),Hi(c,jn()),null}function ab(c){Wo!==null&&Wo.tag===0&&!(6&Nt)&&Ka();var h=Nt;Nt|=1;var _=An.transition,E=zt;try{if(An.transition=null,zt=1,c)return c()}finally{zt=E,An.transition=_,!(6&(Nt=h))&&ms()}}function X_(){er=mu.current,dt(mu)}function qa(c,h){c.finishedWork=null,c.finishedLanes=0;var _=c.timeoutHandle;if(_!==Ye&&(c.timeoutHandle=Ye,Ze(_)),In!==null)for(_=In.return;_!==null;){var E=_;switch(Z0(E),E.tag){case 1:(E=E.type.childContextTypes)!=null&&Pn();break;case 3:du(),dt(xn),dt(bt),d_();break;case 5:c_(E);break;case 4:du();break;case 13:case 19:dt(Sn);break;case 10:i_(E.type._context);break;case 22:case 23:X_()}_=_.return}if(qn=c,In=c=$o(c.current,null),li=er=h,On=0,Eh=null,B_=qf=Ya=0,tr=Th=null,ja!==null){for(h=0;h<ja.length;h++)if((E=(_=ja[h]).interleaved)!==null){_.interleaved=null;var b=E.next,A=_.pending;if(A!==null){var U=A.next;A.next=b,E.next=U}_.pending=E}ja=null}return c}function lb(c,h){for(;;){var _=In;try{if(n_(),Lf.current=Ff,Df){for(var E=fn.memoizedState;E!==null;){var b=E.queue;b!==null&&(b.pending=null),E=E.next}Df=!1}if($a=0,Yn=$n=fn=null,fh=!1,ph=0,O_.current=null,_===null||_.return===null){On=1,Eh=h,In=null;break}e:{var A=c,U=_.return,V=_,te=h;if(h=li,V.flags|=32768,te!==null&&typeof te=="object"&&typeof te.then=="function"){var ue=te,de=V,De=de.tag;if(!(1&de.mode)&&(De===0||De===11||De===15)){var he=de.alternate;he?(de.updateQueue=he.updateQueue,de.memoizedState=he.memoizedState,de.lanes=he.lanes):(de.updateQueue=null,de.memoizedState=null)}var Se=IT(U);if(Se!==null){Se.flags&=-257,LT(Se,U,V,0,h),1&Se.mode&&PT(A,ue,h),te=ue;var je=(h=Se).updateQueue;if(je===null){var Et=new Set;Et.add(te),h.updateQueue=Et}else je.add(te);break e}if(!(1&h)){PT(A,ue,h),j_();break e}te=Error(s(426))}else if(ln&&1&V.mode){var fe=IT(U);if(fe!==null){!(65536&fe.flags)&&(fe.flags|=256),LT(fe,U,V,0,h),e_(fu(te,V));break e}}A=te=fu(te,V),On!==4&&(On=2),Th===null?Th=[A]:Th.push(A),A=U;do{switch(A.tag){case 3:A.flags|=65536,h&=-h,A.lanes|=h,ZE(A,CT(0,te,h));break e;case 1:V=te;var K=A.type,le=A.stateNode;if(!(128&A.flags)&&(typeof K.getDerivedStateFromError=="function"||le!==null&&typeof le.componentDidCatch=="function"&&(Vo===null||!Vo.has(le)))){A.flags|=65536,h&=-h,A.lanes|=h,ZE(A,RT(A,V,h));break e}}A=A.return}while(A!==null)}hb(_)}catch(_e){h=_e,In===_&&_!==null&&(In=_=_.return);continue}break}}function ub(){var c=Yf.current;return Yf.current=Ff,c===null?Ff:c}function j_(){On!==0&&On!==3&&On!==2||(On=4),qn===null||!(268435455&Ya)&&!(268435455&qf)||jo(qn,li)}function tp(c,h){var _=Nt;Nt|=2;var E=ub();for(qn===c&&li===h||(Ho=null,qa(c,h));;)try{Z3();break}catch(b){lb(c,b)}if(n_(),Nt=_,Yf.current=E,In!==null)throw Error(s(261));return qn=null,li=0,On}function Z3(){for(;In!==null;)cb(In)}function Q3(){for(;In!==null&&!I3();)cb(In)}function cb(c){var h=rb(c.alternate,c,er);c.memoizedProps=c.pendingProps,h===null?hb(c):In=h,O_.current=null}function hb(c){var h=c;do{var _=h.alternate;if(c=h.return,(32768&h.flags)==0){if((_=j3(_,h,er))!==null)return void(In=_)}else{if((_=$3(_,h))!==null)return _.flags&=32767,void(In=_);if(c===null)return On=6,void(In=null);c.flags|=32768,c.subtreeFlags=0,c.deletions=null}if((h=h.sibling)!==null)return void(In=h);In=h=c}while(h!==null);On===0&&(On=5)}function _u(c,h,_){var E=zt,b=An.transition;try{An.transition=null,zt=1,function(A,U,V,te){do Ka();while(Wo!==null);if(6&Nt)throw Error(s(327));V=A.finishedWork;var ue=A.finishedLanes;if(V===null)return null;if(A.finishedWork=null,A.finishedLanes=0,V===A.current)throw Error(s(177));A.callbackNode=null,A.callbackPriority=0;var de=V.lanes|V.childLanes;if(function(Se,je){var Et=Se.pendingLanes&~je;Se.pendingLanes=je,Se.suspendedLanes=0,Se.pingedLanes=0,Se.expiredLanes&=je,Se.mutableReadLanes&=je,Se.entangledLanes&=je,je=Se.entanglements;var fe=Se.eventTimes;for(Se=Se.expirationTimes;0<Et;){var K=31-Qi(Et),le=1<<K;je[K]=0,fe[K]=-1,Se[K]=-1,Et&=~le}}(A,de),A===qn&&(In=qn=null,li=0),!(2064&V.subtreeFlags)&&!(2064&V.flags)||Zf||(Zf=!0,pb(GE,function(){return Ka(),null})),de=(15990&V.flags)!=0,(15990&V.subtreeFlags)!=0||de){de=An.transition,An.transition=null;var De=zt;zt=1;var he=Nt;Nt|=4,O_.current=null,function(Se,je){for(H(Se.containerInfo),Ge=je;Ge!==null;)if(je=(Se=Ge).child,(1028&Se.subtreeFlags)!=0&&je!==null)je.return=Se,Ge=je;else for(;Ge!==null;){Se=Ge;try{var Et=Se.alternate;if(1024&Se.flags)switch(Se.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(Et!==null){var fe=Et.memoizedProps,K=Et.memoizedState,le=Se.stateNode,_e=le.getSnapshotBeforeUpdate(Se.elementType===Se.type?fe:Hr(Se.type,fe),K);le.__reactInternalSnapshotBeforeUpdate=_e}break;case 3:Ie&&Be(Se.stateNode.containerInfo);break;default:throw Error(s(163))}}catch(tt){un(Se,Se.return,tt)}if((je=Se.sibling)!==null){je.return=Se.return,Ge=je;break}Ge=Se.return}Et=$T,$T=!1}(A,V),QT(V,A),B(A.containerInfo),A.current=V,q3(V),L3(),Nt=he,zt=De,An.transition=de}else A.current=V;if(Zf&&(Zf=!1,Wo=A,Qf=ue),de=A.pendingLanes,de===0&&(Vo=null),function(Se){if(ps&&typeof ps.onCommitFiberRoot=="function")try{ps.onCommitFiberRoot(yf,Se,void 0,(128&Se.current.flags)==128)}catch{}}(V.stateNode),Hi(A,jn()),U!==null)for(te=A.onRecoverableError,V=0;V<U.length;V++)ue=U[V],te(ue.value,{componentStack:ue.stack,digest:ue.digest});if(Kf)throw Kf=!1,A=G_,G_=null,A;1&Qf&&A.tag!==0&&Ka(),de=A.pendingLanes,1&de?A===H_?bh++:(bh=0,H_=A):bh=0,ms()}(c,h,_,E)}finally{An.transition=b,zt=E}return null}function Ka(){if(Wo!==null){var c=kE(Qf),h=An.transition,_=zt;try{if(An.transition=null,zt=16>c?16:c,Wo===null)var E=!1;else{if(c=Wo,Wo=null,Qf=0,(6&Nt)!=0)throw Error(s(331));var b=Nt;for(Nt|=4,Ge=c.current;Ge!==null;){var A=Ge,U=A.child;if(16&Ge.flags){var V=A.deletions;if(V!==null){for(var te=0;te<V.length;te++){var ue=V[te];for(Ge=ue;Ge!==null;){var de=Ge;switch(de.tag){case 0:case 11:case 15:xh(8,de,A)}var De=de.child;if(De!==null)De.return=de,Ge=De;else for(;Ge!==null;){var he=(de=Ge).sibling,Se=de.return;if(YT(de),de===ue){Ge=null;break}if(he!==null){he.return=Se,Ge=he;break}Ge=Se}}}var je=A.alternate;if(je!==null){var Et=je.child;if(Et!==null){je.child=null;do{var fe=Et.sibling;Et.sibling=null,Et=fe}while(Et!==null)}}Ge=A}}if(2064&A.subtreeFlags&&U!==null)U.return=A,Ge=U;else e:for(;Ge!==null;){if(2048&(A=Ge).flags)switch(A.tag){case 0:case 11:case 15:xh(9,A,A.return)}var K=A.sibling;if(K!==null){K.return=A.return,Ge=K;break e}Ge=A.return}}var le=c.current;for(Ge=le;Ge!==null;){var _e=(U=Ge).child;if(2064&U.subtreeFlags&&_e!==null)_e.return=U,Ge=_e;else e:for(U=le;Ge!==null;){if(2048&(V=Ge).flags)try{switch(V.tag){case 0:case 11:case 15:Hf(9,V)}}catch(Vt){un(V,V.return,Vt)}if(V===U){Ge=null;break e}var tt=V.sibling;if(tt!==null){tt.return=V.return,Ge=tt;break e}Ge=V.return}}if(Nt=b,ms(),ps&&typeof ps.onPostCommitFiberRoot=="function")try{ps.onPostCommitFiberRoot(yf,c)}catch{}E=!0}return E}finally{zt=_,An.transition=h}}return!1}function db(c,h,_){c=Go(c,h=CT(0,h=fu(_,h),1),1),h=vi(),c!==null&&(lh(c,1,h),Hi(c,h))}function un(c,h,_){if(c.tag===3)db(c,c,_);else for(;h!==null;){if(h.tag===3){db(h,c,_);break}if(h.tag===1){var E=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(Vo===null||!Vo.has(E))){h=Go(h,c=RT(h,c=fu(_,c),1),1),c=vi(),h!==null&&(lh(h,1,c),Hi(h,c));break}}h=h.return}}function J3(c,h,_){var E=c.pingCache;E!==null&&E.delete(h),h=vi(),c.pingedLanes|=c.suspendedLanes&_,qn===c&&(li&_)===_&&(On===4||On===3&&(130023424&li)===li&&500>jn()-k_?qa(c,0):B_|=_),Hi(c,h)}function fb(c,h){h===0&&(1&c.mode?(h=V0,!(130023424&(V0<<=1))&&(V0=4194304)):h=1);var _=vi();(c=_s(c,h))!==null&&(lh(c,h,_),Hi(c,_))}function eD(c){var h=c.memoizedState,_=0;h!==null&&(_=h.retryLane),fb(c,_)}function tD(c,h){var _=0;switch(c.tag){case 13:var E=c.stateNode,b=c.memoizedState;b!==null&&(_=b.retryLane);break;case 19:E=c.stateNode;break;default:throw Error(s(314))}E!==null&&E.delete(h),fb(c,_)}function pb(c,h){return $0(c,h)}function nD(c,h,_,E){this.tag=c,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function br(c,h,_,E){return new nD(c,h,_,E)}function $_(c){return!(!(c=c.prototype)||!c.isReactComponent)}function $o(c,h){var _=c.alternate;return _===null?((_=br(c.tag,h,c.key,c.mode)).elementType=c.elementType,_.type=c.type,_.stateNode=c.stateNode,_.alternate=c,c.alternate=_):(_.pendingProps=h,_.type=c.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=14680064&c.flags,_.childLanes=c.childLanes,_.lanes=c.lanes,_.child=c.child,_.memoizedProps=c.memoizedProps,_.memoizedState=c.memoizedState,_.updateQueue=c.updateQueue,h=c.dependencies,_.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},_.sibling=c.sibling,_.index=c.index,_.ref=c.ref,_}function np(c,h,_,E,b,A){var U=2;if(E=c,typeof c=="function")$_(c)&&(U=1);else if(typeof c=="string")U=5;else e:switch(c){case u:return Za(_.children,b,A,h);case d:U=8,b|=8;break;case f:return(c=br(12,_,h,2|b)).elementType=f,c.lanes=A,c;case x:return(c=br(13,_,h,b)).elementType=x,c.lanes=A,c;case y:return(c=br(19,_,h,b)).elementType=y,c.lanes=A,c;case S:return ip(_,b,A,h);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case p:U=10;break e;case m:U=9;break e;case v:U=11;break e;case g:U=14;break e;case T:U=16,E=null;break e}throw Error(s(130,c==null?c:typeof c,""))}return(h=br(U,_,h,b)).elementType=c,h.type=E,h.lanes=A,h}function Za(c,h,_,E){return(c=br(7,c,E,h)).lanes=_,c}function ip(c,h,_,E){return(c=br(22,c,E,h)).elementType=S,c.lanes=_,c.stateNode={isHidden:!1},c}function Y_(c,h,_){return(c=br(6,c,null,h)).lanes=_,c}function q_(c,h,_){return(h=br(4,c.children!==null?c.children:[],c.key,h)).lanes=_,h.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},h}function iD(c,h,_,E,b){this.tag=h,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ye,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=X0(0),this.expirationTimes=X0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=X0(0),this.identifierPrefix=E,this.onRecoverableError=b,ct&&(this.mutableSourceEagerHydrationData=null)}function mb(c,h,_,E,b,A,U,V,te){return c=new iD(c,h,_,V,te),h===1?(h=1,A===!0&&(h|=8)):h=0,A=br(3,null,null,h),c.current=A,A.stateNode=c,A.memoizedState={element:E,isDehydrated:_,cache:null,transitions:null,pendingSuspenseBoundaries:null},o_(A),c}function gb(c){if(!c)return mr;e:{if(N(c=c._reactInternals)!==c||c.tag!==1)throw Error(s(170));var h=c;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(oi(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(s(171))}if(c.tag===1){var _=c.type;if(oi(_))return iu(c,_,h)}return h}function _b(c){var h=c._reactInternals;if(h===void 0)throw typeof c.render=="function"?Error(s(188)):(c=Object.keys(c).join(","),Error(s(268,c)));return(c=Q(h))===null?null:c.stateNode}function vb(c,h){if((c=c.memoizedState)!==null&&c.dehydrated!==null){var _=c.retryLane;c.retryLane=_!==0&&_<h?_:h}}function rp(c,h){vb(c,h),(c=c.alternate)&&vb(c,h)}function rD(c){return(c=Q(c))===null?null:c.stateNode}function sD(){return null}return rb=function(c,h,_){if(c!==null)if(c.memoizedProps!==h.pendingProps||xn.current)zi=!0;else{if(!(c.lanes&_)&&!(128&h.flags))return zi=!1,function(De,he,Se){switch(he.tag){case 3:kT(he),au();break;case 5:oT(he);break;case 1:oi(he.type)&&ai(he);break;case 4:u_(he,he.stateNode.containerInfo);break;case 10:YE(0,he.type._context,he.memoizedProps.value);break;case 13:var je=he.memoizedState;if(je!==null)return je.dehydrated!==null?(We(Sn,1&Sn.current),he.flags|=128,null):Se&he.child.childLanes?GT(De,he,Se):(We(Sn,1&Sn.current),(De=no(De,he,Se))!==null?De.sibling:null);We(Sn,1&Sn.current);break;case 19:if(je=(Se&he.childLanes)!=0,(128&De.flags)!=0){if(je)return VT(De,he,Se);he.flags|=128}var Et=he.memoizedState;if(Et!==null&&(Et.rendering=null,Et.tail=null,Et.lastEffect=null),We(Sn,Sn.current),je)break;return null;case 22:case 23:return he.lanes=0,FT(De,he,Se)}return no(De,he,Se)}(c,h,_);zi=(131072&c.flags)!=0}else zi=!1,ln&&1048576&h.flags&&VE(h,Ef,h.index);switch(h.lanes=0,h.tag){case 2:var E=h.type;zf(c,h),c=h.pendingProps;var b=gr(h,bt.current);uu(h,_),b=m_(null,h,E,c,b,_);var A=g_();return h.flags|=1,typeof b=="object"&&b!==null&&typeof b.render=="function"&&b.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,oi(E)?(A=!0,ai(h)):A=!1,h.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,o_(h),b.updater=Rf,h.stateNode=b,b._reactInternals=h,l_(h,E,c,_),h=b_(null,h,E,!0,A,_)):(h.tag=0,ln&&A&&K0(h),Gi(null,h,b,_),h=h.child),h;case 16:E=h.elementType;e:{switch(zf(c,h),c=h.pendingProps,E=(b=E._init)(E._payload),h.type=E,b=h.tag=function(De){if(typeof De=="function")return $_(De)?1:0;if(De!=null){if((De=De.$$typeof)===v)return 11;if(De===g)return 14}return 2}(E),c=Hr(E,c),b){case 0:h=T_(null,h,E,c,_);break e;case 1:h=BT(null,h,E,c,_);break e;case 11:h=DT(null,h,E,c,_);break e;case 14:h=NT(null,h,E,Hr(E.type,c),_);break e}throw Error(s(306,E,""))}return h;case 0:return E=h.type,b=h.pendingProps,T_(c,h,E,b=h.elementType===E?b:Hr(E,b),_);case 1:return E=h.type,b=h.pendingProps,BT(c,h,E,b=h.elementType===E?b:Hr(E,b),_);case 3:e:{if(kT(h),c===null)throw Error(s(387));E=h.pendingProps,b=(A=h.memoizedState).element,KE(c,h),Cf(h,E,null,_);var U=h.memoizedState;if(E=U.element,ct&&A.isDehydrated){if(A={element:E,isDehydrated:!1,cache:U.cache,pendingSuspenseBoundaries:U.pendingSuspenseBoundaries,transitions:U.transitions},h.updateQueue.baseState=A,h.memoizedState=A,256&h.flags){h=zT(c,h,E,_,b=fu(Error(s(423)),h));break e}if(E!==b){h=zT(c,h,E,_,b=fu(Error(s(424)),h));break e}for(ct&&(yr=gf(h.stateNode.containerInfo),Ji=h,ln=!0,Gr=null,uh=!1),_=sT(h,null,E,_),h.child=_;_;)_.flags=-3&_.flags|4096,_=_.sibling}else{if(au(),E===b){h=no(c,h,_);break e}Gi(c,h,E,_)}h=h.child}return h;case 5:return oT(h),c===null&&J0(h),E=h.type,b=h.pendingProps,A=c!==null?c.memoizedProps:null,U=b.children,pe(E,b)?U=null:A!==null&&pe(E,A)&&(h.flags|=32),OT(c,h),Gi(c,h,U,_),h.child;case 6:return c===null&&J0(h),null;case 13:return GT(c,h,_);case 4:return u_(h,h.stateNode.containerInfo),E=h.pendingProps,c===null?h.child=cu(h,null,E,_):Gi(c,h,E,_),h.child;case 11:return E=h.type,b=h.pendingProps,DT(c,h,E,b=h.elementType===E?b:Hr(E,b),_);case 7:return Gi(c,h,h.pendingProps,_),h.child;case 8:case 12:return Gi(c,h,h.pendingProps.children,_),h.child;case 10:e:{if(E=h.type._context,b=h.pendingProps,A=h.memoizedProps,YE(0,E,U=b.value),A!==null)if(zr(A.value,U)){if(A.children===b.children&&!xn.current){h=no(c,h,_);break e}}else for((A=h.child)!==null&&(A.return=h);A!==null;){var V=A.dependencies;if(V!==null){U=A.child;for(var te=V.firstContext;te!==null;){if(te.context===E){if(A.tag===1){(te=to(-1,_&-_)).tag=2;var ue=A.updateQueue;if(ue!==null){var de=(ue=ue.shared).pending;de===null?te.next=te:(te.next=de.next,de.next=te),ue.pending=te}}A.lanes|=_,(te=A.alternate)!==null&&(te.lanes|=_),r_(A.return,_,h),V.lanes|=_;break}te=te.next}}else if(A.tag===10)U=A.type===h.type?null:A.child;else if(A.tag===18){if((U=A.return)===null)throw Error(s(341));U.lanes|=_,(V=U.alternate)!==null&&(V.lanes|=_),r_(U,_,h),U=A.sibling}else U=A.child;if(U!==null)U.return=A;else for(U=A;U!==null;){if(U===h){U=null;break}if((A=U.sibling)!==null){A.return=U.return,U=A;break}U=U.return}A=U}Gi(c,h,b.children,_),h=h.child}return h;case 9:return b=h.type,E=h.pendingProps.children,uu(h,_),E=E(b=xr(b)),h.flags|=1,Gi(c,h,E,_),h.child;case 14:return b=Hr(E=h.type,h.pendingProps),NT(c,h,E,b=Hr(E.type,b),_);case 15:return UT(c,h,h.type,h.pendingProps,_);case 17:return E=h.type,b=h.pendingProps,b=h.elementType===E?b:Hr(E,b),zf(c,h),h.tag=1,oi(E)?(c=!0,ai(h)):c=!1,uu(h,_),tT(h,E,b),l_(h,E,b,_),b_(null,h,E,!0,c,_);case 19:return VT(c,h,_);case 22:return FT(c,h,_)}throw Error(s(156,h.tag))},e.attemptContinuousHydration=function(c){if(c.tag===13){var h=_s(c,134217728);h!==null&&Tr(h,c,134217728,vi()),rp(c,134217728)}},e.attemptDiscreteHydration=function(c){if(c.tag===13){var h=_s(c,1);h!==null&&Tr(h,c,1,vi()),rp(c,1)}},e.attemptHydrationAtCurrentPriority=function(c){if(c.tag===13){var h=Xo(c),_=_s(c,h);_!==null&&Tr(_,c,h,vi()),rp(c,h)}},e.attemptSynchronousHydration=function(c){switch(c.tag){case 3:var h=c.stateNode;if(h.current.memoizedState.isDehydrated){var _=ah(h.pendingLanes);_!==0&&(j0(h,1|_),Hi(h,jn()),!(6&Nt)&&(gu(),ms()))}break;case 13:ab(function(){var E=_s(c,1);if(E!==null){var b=vi();Tr(E,c,1,b)}}),rp(c,1)}},e.batchedUpdates=function(c,h){var _=Nt;Nt|=1;try{return c(h)}finally{(Nt=_)===0&&(gu(),xf&&ms())}},e.createComponentSelector=function(c){return{$$typeof:Vf,value:c}},e.createContainer=function(c,h,_,E,b,A,U){return mb(c,h,!1,null,0,E,0,A,U)},e.createHasPseudoClassSelector=function(c){return{$$typeof:Wf,value:c}},e.createHydrationContainer=function(c,h,_,E,b,A,U,V,te){return(c=mb(_,E,!0,c,0,A,0,V,te)).context=gb(null),_=c.current,(A=to(E=vi(),b=Xo(_))).callback=h??null,Go(_,A,b),c.current.lanes=b,lh(c,b,E),Hi(c,E),c},e.createPortal=function(c,h,_){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:E==null?null:""+E,children:c,containerInfo:h,implementation:_}},e.createRoleSelector=function(c){return{$$typeof:Xf,value:c}},e.createTestNameSelector=function(c){return{$$typeof:jf,value:c}},e.createTextSelector=function(c){return{$$typeof:$f,value:c}},e.deferredUpdates=function(c){var h=zt,_=An.transition;try{return An.transition=null,zt=16,c()}finally{zt=h,An.transition=_}},e.discreteUpdates=function(c,h,_,E,b){var A=zt,U=An.transition;try{return An.transition=null,zt=1,c(h,_,E,b)}finally{zt=A,An.transition=U,Nt===0&&gu()}},e.findAllNodes=F_,e.findBoundingRects=function(c,h){if(!Ft)throw Error(s(363));h=F_(c,h),c=[];for(var _=0;_<h.length;_++)c.push(Fn(h[_]));for(h=c.length-1;0<h;h--)for(var E=(_=c[h]).x,b=E+_.width,A=_.y,U=A+_.height,V=h-1;0<=V;V--)if(h!==V){var te=c[V],ue=te.x,de=ue+te.width,De=te.y,he=De+te.height;if(E>=ue&&A>=De&&b<=de&&U<=he){c.splice(h,1);break}if(!(E!==ue||_.width!==te.width||he<A||De>U)){De>A&&(te.height+=De-A,te.y=A),he<U&&(te.height=U-De),c.splice(h,1);break}if(!(A!==De||_.height!==te.height||de<E||ue>b)){ue>E&&(te.width+=ue-E,te.x=E),de<b&&(te.width=b-ue),c.splice(h,1);break}}return c},e.findHostInstance=_b,e.findHostInstanceWithNoPortals=function(c){return(c=(c=L(c))!==null?z(c):null)===null?null:c.stateNode},e.findHostInstanceWithWarning=function(c){return _b(c)},e.flushControlled=function(c){var h=Nt;Nt|=1;var _=An.transition,E=zt;try{An.transition=null,zt=1,c()}finally{zt=E,An.transition=_,(Nt=h)===0&&(gu(),ms())}},e.flushPassiveEffects=Ka,e.flushSync=ab,e.focusWithin=function(c,h){if(!Ft)throw Error(s(363));for(h=ib(c=D_(c),h),h=Array.from(h),c=0;c<h.length;){var _=h[c++];if(!I(_)){if(_.tag===5&&we(_.stateNode))return!0;for(_=_.child;_!==null;)h.push(_),_=_.sibling}}return!1},e.getCurrentUpdatePriority=function(){return zt},e.getFindAllNodesFailureDescription=function(c,h){if(!Ft)throw Error(s(363));var _=0,E=[];c=[D_(c),0];for(var b=0;b<c.length;){var A=c[b++],U=c[b++],V=h[U];if((A.tag!==5||!I(A))&&(N_(A,V)&&(E.push(U_(V)),++U>_&&(_=U)),U<h.length))for(A=A.child;A!==null;)c.push(A,U),A=A.sibling}if(_<h.length){for(c=[];_<h.length;_++)c.push(U_(h[_]));return`findAllNodes was able to match part of the selector:
  `+E.join(" > ")+`

No matching component was found for:
  `+c.join(" > ")}return null},e.getPublicRootInstance=function(c){return(c=c.current).child?c.child.tag===5?Z(c.child.stateNode):c.child.stateNode:null},e.injectIntoDevTools=function(c){if(c={bundleType:c.bundleType,version:c.version,rendererPackageName:c.rendererPackageName,rendererConfig:c.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:rD,findFiberByHostInstance:c.findFiberByHostInstance||sD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")c=!1;else{var h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(h.isDisabled||!h.supportsFiber)c=!0;else{try{yf=h.inject(c),ps=h}catch{}c=!!h.checkDCE}}return c},e.isAlreadyRendering=function(){return!1},e.observeVisibleRects=function(c,h,_,E){if(!Ft)throw Error(s(363));c=F_(c,h);var b=ye(c,_,E).disconnect;return{disconnect:function(){b()}}},e.registerMutableSourceForHydration=function(c,h){var _=h._getVersion;_=_(h._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[h,_]:c.mutableSourceEagerHydrationData.push(h,_)},e.runWithPriority=function(c,h){var _=zt;try{return zt=c,h()}finally{zt=_}},e.shouldError=function(){return null},e.shouldSuspend=function(){return!1},e.updateContainer=function(c,h,_,E){var b=h.current,A=vi(),U=Xo(b);return _=gb(_),h.context===null?h.context=_:h.pendingContext=_,(h=to(A,U)).payload={element:c},(E=E===void 0?null:E)!==null&&(h.callback=E),(c=Go(b,h,U))!==null&&(Tr(c,b,U,A),Mf(c,b,U)),U},e}),JC}({get exports(){return q1},set exports(n){q1=n}}).exports=tW();var nW=CV(q1),d3={name:"root",private:!0,workspaces:["packages/*"],scripts:{build:"nx run-many --target=build --all --parallel","build:force":"nx run-many --target=build --all --parallel --skip-nx-cache","build:docs":"nx run @pixi/react-docs:deploy",clean:"rimraf packages/*/dist packages/*/build",lint:"eslint .",prepare:"husky install",prerelease:"./scripts/checkReleaseBranch.mjs && npm run lint && npm run test:force && npm run build:force",release:"lerna publish --no-private",test:"nx run-many --target=test --all --parallel","test:force":"nx run-many --target=test --all --parallel --skip-nx-cache","test:ci":"nx run-many --target=test:ci --all --parallel","test:ci:force":"nx run-many --target=test:ci --all --parallel --skip-nx-cache","test:types":"nx run-many --target=test:types --all --parallel","test:types:force":"nx run-many --target=test:types --all --parallel --skip-nx-cache"},husky:{hooks:{"pre-commit":"lint-staged"}},"lint-staged":{"*.{ts,js,mjs}":["eslint --cache --fix"]},resolutions:{"get-pkg-repo":"4.1.1","hosted-git-info":"^2.1.4"},dependencies:{"@babel/runtime":"^7.14.8","@pixi/app":"^7.1.1","@pixi/constants":"^7.1.1","@pixi/core":"^7.1.1","@pixi/display":"^7.1.1","@pixi/extensions":"^7.1.1","@pixi/graphics":"^7.1.1","@pixi/math":"^7.1.1","@pixi/mesh":"^7.1.1","@pixi/mesh-extras":"^7.1.1","@pixi/particle-container":"^7.1.1","@pixi/sprite":"^7.1.1","@pixi/sprite-animated":"^7.1.1","@pixi/sprite-tiling":"^7.1.1","@pixi/text":"^7.1.1","@pixi/text-bitmap":"^7.1.1","@pixi/ticker":"^7.1.1","@react-spring/animated":"^9.6.1","@react-spring/types":"^9.6.1",react:"^18.0.0","react-dom":"^18.0.0","react-reconciler":"0.29.0","react-spring":"^9.6.1"},devDependencies:{"@babel/cli":"^7.20.7","@babel/core":"^7.20.7","@babel/eslint-parser":"^7.19.1","@babel/plugin-transform-runtime":"^7.19.6","@babel/preset-env":"^7.20.2","@babel/preset-react":"^7.18.6","@nrwl/nx-cloud":"latest","@pixi/eslint-config":"^4.0.1","@rollup/plugin-alias":"^4.0.2","@rollup/plugin-babel":"^6.0.3","@rollup/plugin-commonjs":"^24.0.0","@rollup/plugin-json":"^6.0.0","@rollup/plugin-node-resolve":"^15.0.1","@rollup/plugin-replace":"^5.0.2","@rollup/plugin-terser":"^0.2.1","@rollup/plugin-typescript":"^10.0.1","@types/jest":"^29.2.4","@types/react":"17.0.15","@types/react-dom":"17.0.9","@types/react-reconciler":"0.28.2","babel-jest":"^29.3.1","babel-plugin-module-resolver":"4.1.0","cross-env":"^7.0.3",eslint:"^8.29.0","eslint-plugin-react":"^7.31.11",husky:"^8.0.2",jest:"^29.3.1","jest-environment-jsdom":"^29.3.1","jest-extended":"^3.2.0","jest-watch-typeahead":"^2.2.1",lerna:"^6.0.3","lint-staged":"^13.1.0",nx:"15.3.0",rimraf:"^3.0.2",rollup:"^3.7.0","rollup-plugin-filesize":"^9.1.2","rollup-plugin-visualizer":"^5.9.0","ts-jest":"^29.0.3","ts-node":"^10.9.1",typescript:"^4.9.4"}},Z1={},gm={get exports(){return Z1},set exports(n){Z1=n}};(function(){var n,e,t,i,r,s;typeof performance<"u"&&performance!==null&&performance.now?gm.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(gm.exports=function(){return(n()-r)/1e6},e=process.hrtime,i=(n=function(){var o;return 1e9*(o=e())[0]+o[1]})(),s=1e9*process.uptime(),r=i-s):Date.now?(gm.exports=function(){return Date.now()-t},t=Date.now()):(gm.exports=function(){return new Date().getTime()-t},t=new Date().getTime())}).call(MV);var nR,hc={},sl={};({get exports(){return hc},set exports(n){hc=n}}).exports=(nR||(nR=1,sl.ConcurrentRoot=1,sl.ContinuousEventPriority=4,sl.DefaultEventPriority=16,sl.DiscreteEventPriority=1,sl.IdleEventPriority=536870912,sl.LegacyRoot=0),sl);var iW={};function Vy(n,e){n.addChild&&(n.addChild(e),typeof e.didMount=="function"&&e.didMount(e,n))}function f3(n,e){var t,i,r;(t=n.willUnmount)===null||t===void 0||t.call(n,n,e),((i=n.config)===null||i===void 0?void 0:i.destroyChildren)!==!1&&(r=n.children)!==null&&r!==void 0&&r.length&&Fo(n.children).forEach(function(s){f3(s,n)})}function iR(n,e){var t;f3(e,n),n.removeChild(e);var i=(t=e.config)!==null&&t!==void 0?t:{},r=i.destroy,s=r===void 0||r,o=i.destroyChildren,a=o===void 0||o,l=i.destroyTexture,u=l!==void 0&&l,d=i.destroyBaseTexture,f=d!==void 0&&d;s&&e.destroy({children:a,texture:u,baseTexture:f})}function rR(n,e,t){bn(e!==t,"pixi-react: PixiFiber cannot insert node before itself"),n.children.indexOf(e)!==-1&&n.removeChild(e);var i=n.getChildIndex(t);n.addChildAt(e,i)}var sR=null,rs=nW({getRootHostContext:function(){return iW},getChildHostContext:function(n){return n},getChildHostContextForEventComponent:function(n){return n},getPublicInstance:function(n){return n},getCurrentEventPriority:function(){return function(){var n,e;if(typeof window>"u")return hc.DefaultEventPriority;switch((n=window)===null||n===void 0||(e=n.event)===null||e===void 0?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return hc.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return hc.ContinuousEventPriority;default:return hc.DefaultEventPriority}}()},prepareForCommit:function(){return null},resetAfterCommit:function(){},createInstance:function(n){var e,t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=ZV[n];if(typeof s=="function"&&(e=s(r,i)),!e){var o=h3[n];o&&((e=o.create(i,{root:r})).didMount=o.didMount?o.didMount.bind(e):void 0,e.willUnmount=o.willUnmount?o.willUnmount.bind(e):void 0,e.applyProps=o.applyProps?o.applyProps.bind(e):void 0,e.config=o.config)}return e&&(e.__reactpixi={root:r},(typeof((t=e)===null||t===void 0?void 0:t.applyProps)=="function"?e.applyProps:js)(e,{},i)),e},hideInstance:function(n){n.visible=!1},unhideInstance:function(n,e){var t=e==null||!e.hasOwnProperty("visible")||e.visible;n.visible=t},finalizeInitialChildren:function(n,e,t){return!1},prepareUpdate:function(n,e,t,i,r,s){return sR=function(o,a,l,u){var d=null;for(var f in l)!u.hasOwnProperty(f)&&l.hasOwnProperty(f)&&l[f]!==null&&(f===$1||(d||(d=[]),d.push(f,null)));for(var p in u){var m=u[p],v=l!==null?l[p]:void 0;!u.hasOwnProperty(p)||m===v||m===null&&v===null||p===$1||(d||(d=[]),d.push(p,m))}return d}(0,0,t,i)},shouldSetTextContent:function(n,e){return!1},shouldDeprioritizeSubtree:function(n,e){var t=e.alpha===void 0||e.alpha>0,i=e.renderable===void 0||e.renderable===!0,r=e.visible===void 0||e.visible===!0;return!(t&&i&&r)},createTextInstance:function(n,e,t){bn(!1,'pixi-react: Error trying to add text node "'.concat(n,'"'),"PixiFiber does not support text nodes as children of a Pixi component. To pass a string value to your component, use a property other than children. If you wish to display some text, you can use &lt;Text text={string} /&gt; instead.")},unhideTextInstance:function(n,e){},mountEventComponent:function(){},updateEventComponent:function(){},handleEventTarget:function(){},scheduleTimeout:setTimeout,cancelTimeout:clearTimeout,noTimeout:-1,warnsIfNotActing:!1,now:Z1,isPrimaryRenderer:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,supportsMicrotasks:!0,scheduleMicrotask:queueMicrotask,appendInitialChild:function(){for(var n,e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var s=Vy.apply(null,i);return(n=i[0].__reactpixi)===null||n===void 0||(e=n.root)===null||e===void 0||e.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"appendInitialChild"}),s},appendChild:function(){for(var n,e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var s=Vy.apply(null,i);return(n=i[0].__reactpixi)===null||n===void 0||(e=n.root)===null||e===void 0||e.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"appendChild"}),s},appendChildToContainer:function(){for(var n,e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var s=Vy.apply(null,i);return(n=i[0].__reactpixi)===null||n===void 0||(e=n.root)===null||e===void 0||e.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"appendChildToContainer"}),s},removeChild:function(){for(var n,e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var s=iR.apply(null,i);return(n=i[0].__reactpixi)===null||n===void 0||(e=n.root)===null||e===void 0||e.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"removeChild"}),s},removeChildFromContainer:function(){for(var n,e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var s=iR.apply(null,i);return(n=i[0].__reactpixi)===null||n===void 0||(e=n.root)===null||e===void 0||e.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"removeChildFromContainer"}),s},insertBefore:rR,insertInContainerBefore:function(){for(var n,e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var s=rR.apply(null,i);return(n=i[0].__reactpixi)===null||n===void 0||(e=n.root)===null||e===void 0||e.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"insertInContainerBefore"}),s},commitUpdate:function(n,e,t,i,r){var s,o,a=n&&n.applyProps;typeof a!="function"&&(a=js),(a(n,i,r)||sR)&&((s=n.__reactpixi)===null||s===void 0||(o=s.root)===null||o===void 0||o.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"commitUpdate"}))},commitMount:function(n,e,t,i,r){},commitTextUpdate:function(n,e,t){},resetTextContent:function(n){},clearContainer:function(n){},getFundamentalComponentInstance:function(n){throw new Error("Not yet implemented.")},mountFundamentalComponent:function(n){throw new Error("Not yet implemented.")},shouldUpdateFundamentalComponent:function(n){throw new Error("Not yet implemented.")},unmountFundamentalComponent:function(n){throw new Error("Not yet implemented.")},getInstanceFromNode:function(n){throw new Error("Not yet implemented.")},isOpaqueHydratingObject:function(n){throw new Error("Not yet implemented")},makeOpaqueHydratingObject:function(n){throw new Error("Not yet implemented.")},makeClientIdInDEV:function(n){throw new Error("Not yet implemented")},beforeActiveInstanceBlur:function(n){},afterActiveInstanceBlur:function(){},detachDeletedInstance:function(){},preparePortalMount:function(n){}}),rW=d3.dependencies["react-dom"].replace(/[^0-9.]/g,""),sW=d3.name;rs.injectIntoDevTools({bundleType:0,version:rW,rendererPackageName:sW,findHostInstanceByFiber:rs.findHostInstance});var Pa=new Map;function p3(n){if(bn(Oi.prototype.isPrototypeOf(n),"Invalid argument `container`, expected instance of `PIXI.Container`."),Pa.has(n)){var e=Pa.get(n).pixiFiberContainer;rs.updateContainer(null,e,void 0,function(){Pa.delete(n)})}}function m3(n){bn(Oi.prototype.isPrototypeOf(n),"Invalid argument `container`, expected instance of `PIXI.Container`.");var e=Pa.get(n);if(bn(!e,"Pixi React: createRoot should only be called once"),!e){var t=rs.createContainer(n);e={pixiFiberContainer:t,reactRoot:{render:function(i){return rs.updateContainer(i,t,void 0),rs.getPublicRootInstance(t)},unmount:function(){p3(n),Pa.delete(n)}}},Pa.set(n,e)}return e.reactRoot}function oW(n,e,t){var i;return console.warn("Pixi React Deprecation Warning: render is deprecated, use createRoot instead"),t!==void 0&&console.warn("Pixi React Deprecation Warning: render callback no longer exists in React 18"),Pa.has(e)?i=Pa.get(e).reactRoot:i=m3(e),i.render(n)}function aW(n){p3(n)}function tf(){return tf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},tf.apply(this,arguments)}function lW(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function uW(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,l3(i.key),i)}}function fo(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Zg(n,e){return Zg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},Zg(n,e)}function cW(n,e){if(e&&(ur(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fo(n)}function Qg(n){return Qg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qg(n)}var O0=Bs.createContext(null),g3=O0.Provider,_3=O0.Consumer,hW=function(n){var e=Bs.forwardRef(function(t,i){return Bs.createElement(_3,null,function(r){return Bs.createElement(n,tf({},t,{ref:i,app:r}))})});return e.displayName="withPIXIApp(".concat(n.displayName||n.name,")"),e};function dW(n){var e=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var t,i=Qg(n);if(e){var r=Qg(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return cW(this,t)}}function oR(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function _m(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?oR(Object(t),!0).forEach(function(i){Mn(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):oR(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}var aR=function(){},v3={width:nn.number,height:nn.number,onMount:nn.func,onUnmount:nn.func,raf:nn.bool,renderOnComponentChange:nn.bool,children:nn.node,options:nn.shape({autoStart:nn.bool,width:nn.number,height:nn.number,useContextAlpha:nn.bool,backgroundAlpha:nn.number,autoDensity:nn.bool,antialias:nn.bool,preserveDrawingBuffer:nn.bool,resolution:nn.number,forceCanvas:nn.bool,backgroundColor:nn.number,clearBeforeRender:nn.bool,powerPreference:nn.string,sharedTicker:nn.bool,sharedLoader:nn.bool,resizeTo:function(n,e){var t=n[e];t&&bn(t===window||t instanceof HTMLElement,"Invalid prop `resizeTo` of type ".concat(ur(t),", expect `window` or an `HTMLElement`."))},view:function(n,e,t){var i=n[e];i&&bn(i instanceof HTMLCanvasElement,"Invalid prop `view` of type ".concat(ur(i),", supplied to ").concat(t,", expected `<canvas> Element`"))}})},fW={width:800,height:600,onMount:aR,onUnmount:aR,raf:!0,renderOnComponentChange:!0},Q1=function(n){(function(s,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(o&&o.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),o&&Zg(s,o)})(r,Bs.Component);var e,t,i=dW(r);function r(){var s;lW(this,r);for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return Mn(fo(s=i.call.apply(i,[this].concat(a))),"_canvas",null),Mn(fo(s),"_mediaQuery",null),Mn(fo(s),"_ticker",null),Mn(fo(s),"_needsUpdate",!0),Mn(fo(s),"app",null),Mn(fo(s),"updateSize",function(){var u=s.props,d=u.width,f=u.height,p=u.options;p!=null&&p.resolution||(s.app.renderer.resolution=window.devicePixelRatio,s.resetInteractionManager()),s.app.renderer.resize(d,f)}),Mn(fo(s),"needsRenderUpdate",function(){s._needsUpdate=!0}),Mn(fo(s),"renderStage",function(){var u=s.props,d=u.renderOnComponentChange;!u.raf&&d&&s._needsUpdate&&(s._needsUpdate=!1,s.app.renderer.render(s.app.stage))}),s}return e=r,(t=[{key:"componentDidMount",value:function(){var s=this.props,o=s.onMount,a=s.width,l=s.height,u=s.options,d=s.raf,f=s.renderOnComponentChange;this.app=new F0(_m(_m({width:a,height:l,view:this._canvas},u),{},{autoDensity:(u==null?void 0:u.autoDensity)!==!1})),this.app.ticker.autoStart=!1,this.app.ticker[d?"start":"stop"](),this.app.stage.__reactpixi={root:this.app.stage},this.mountNode=rs.createContainer(this.app.stage),rs.updateContainer(this.getChildren(),this.mountNode,this),o(this.app),u!=null&&u.autoDensity&&window.matchMedia&&(u==null?void 0:u.resolution)===void 0&&(this._mediaQuery=window.matchMedia("(-webkit-min-device-pixel-ratio: 1.3), (min-resolution: 120dpi)"),this._mediaQuery.addListener(this.updateSize)),f&&!d&&(this._ticker=new ni,this._ticker.autoStart=!0,this._ticker.add(this.renderStage),this.app.stage.on("__REACT_PIXI_REQUEST_RENDER__",this.needsRenderUpdate)),this.updateSize(),this.renderStage()}},{key:"componentDidUpdate",value:function(s,o,a){var l,u=this.props,d=u.width,f=u.height,p=u.raf,m=u.renderOnComponentChange,v=u.options;(v==null?void 0:v.resolution)!==void 0&&(s==null?void 0:s.options.resolution)!==(v==null?void 0:v.resolution)&&(this.app.renderer.resolution=v.resolution,this.resetInteractionManager()),s.height===f&&s.width===d&&((l=s.options)===null||l===void 0?void 0:l.resolution)===(v==null?void 0:v.resolution)||this.updateSize(),s.raf!==p&&this.app.ticker[p?"start":"stop"](),rs.updateContainer(this.getChildren(),this.mountNode,this),s.width===d&&s.height===f&&s.raf===p&&s.renderOnComponentChange===m&&s.options===v||(this._needsUpdate=!0,this.renderStage())}},{key:"resetInteractionManager",value:function(){var s=this.app.renderer.plugins.interaction;s!=null&&s.resolution&&(s.resolution=this.app.renderer.resolution)}},{key:"getChildren",value:function(){var s=this.props.children;return Bs.createElement(g3,{value:this.app},s)}},{key:"componentDidCatch",value:function(s,o){console.error("Error occurred in `Stage`."),console.error(s),console.error(o)}},{key:"componentWillUnmount",value:function(){this.props.onUnmount(this.app),this._ticker&&(this._ticker.remove(this.renderStage),this._ticker.destroy()),this.app.stage.off("__REACT_PIXI_REQUEST_RENDER__",this.needsRenderUpdate),rs.updateContainer(null,this.mountNode,this),this._mediaQuery&&(this._mediaQuery.removeListener(this.updateSize),this._mediaQuery=null),this.app.destroy()}},{key:"render",value:function(){var s,o,a=this,l=this.props.options;return l&&l.view?(bn(l.view instanceof HTMLCanvasElement,"options.view needs to be a `HTMLCanvasElement`"),null):Bs.createElement("canvas",tf({},(s=this.props,o=[].concat(Fo(Object.keys(v3)),Fo(Object.keys(Y1))),Object.keys(s).filter(function(u){return!o.includes(u)}).reduce(function(u,d){return _m(_m({},u),{},Mn({},d,s[d]))},{})),{ref:function(u){return a._canvas=u}}))}}])&&uW(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),r}();Q1.propTypes=v3,Q1.defaultProps=fW;var pW=Q1;function y3(){var n=ge.useContext(O0);return bn(n instanceof F0,"No Context found with `%s`. Make sure to wrap component with `%s`","PIXI.Application","AppProvider"),n}function mW(n){var e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],t=y3();bn(typeof n=="function","`useTick` needs a callback function."),bn(t instanceof F0,"No Context found with `%s`. Make sure to wrap component with `%s`","PIXI.Application","AppProvider");var i=ge.useRef(null);ge.useEffect(function(){i.current=n},[n]),ge.useEffect(function(){if(e){var r=function(s){return i.current.apply(t.ticker,[s,t.ticker])};return t.ticker.add(r),function(){t.ticker&&t.ticker.remove(r)}}},[e])}function gW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function J1(n,e,t){return J1=gW()?Reflect.construct.bind():function(i,r,s){var o=[null];o.push.apply(o,r);var a=new(Function.bind.apply(i,o));return s&&Zg(a,s.prototype),a},J1.apply(null,arguments)}var _W=["children","apply"];function lR(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function vm(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?lR(Object(t),!0).forEach(function(i){Mn(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):lR(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}var vW=function(n,e){bn(ur(e)==="object","Second argument needs to be an indexed object with { prop: Filter }");var t=Object.keys(e),i=function(r){var s=r.children,o=r.apply,a=Va(r,_W),l=ge.useRef(ge.useMemo(function(){return t.map(function(f){var p,m=(a==null||(p=a[f])===null||p===void 0?void 0:p.construct)||[];return J1(e[f],Fo(m))})},[t])),u=ge.useMemo(function(){return t.reduce(function(f,p,m){return vm(vm({},f),{},Mn({},p,l.current[m]))},{})},[t]),d=ge.useMemo(function(){return Object.keys(a).filter(c3(u3(t))).reduce(function(f,p){return vm(vm({},f),{},Mn({},p,a[p]))},{})},[a,t]);return t.forEach(function(f,p){return Object.assign(l.current[p],a[f])}),o&&function(){for(var f=arguments.length,p=new Array(f),m=0;m<f;m++)p[m]=arguments[m];return p.every(function(v){return typeof v=="function"})}(o)&&o.call(n,u),Bs.createElement(n,tf({},d,{filters:l.current}),s)};return i.displayName="FilterWrapper",i.propTypes={children:nn.node,apply:nn.func},i},yW=Zi.BitmapText,xW=Zi.Container,SW=Zi.Graphics,EW=Zi.NineSlicePlane,TW=Zi.ParticleContainer,bW=Zi.Sprite,wW=Zi.AnimatedSprite,AW=Zi.Text,MW=Zi.TilingSprite,CW=Zi.SimpleMesh,RW=Zi.SimpleRope;const PW=Object.freeze(Object.defineProperty({__proto__:null,AnimatedSprite:wW,AppConsumer:_3,AppContext:O0,AppProvider:g3,BitmapText:yW,Container:xW,Graphics:SW,NineSlicePlane:EW,ParticleContainer:TW,PixiComponent:QV,PixiFiber:rs,SimpleMesh:CW,SimpleRope:RW,Sprite:bW,Stage:pW,TYPES:Zi,Text:AW,TilingSprite:MW,applyDefaultProps:js,createRoot:m3,eventHandlers:Kg,render:oW,unmountComponentAtNode:aW,useApp:y3,useTick:mW,withFilters:vW,withPixiApp:hW},Symbol.toStringTag,{value:"Module"})),IW=wR(PW);T0.exports=IW;var Ot=T0.exports;const eu="/website-frontend/assets/sprite-880d590b.png",OE=window.innerWidth||document.documentElement.clientWidth,xl=OE/2,rd=95,ym=92,uR=1,cR=1,hR=1,LW=({gameSpeed:n})=>{const[e,t]=ge.useState(-1);return Ot.useTick(()=>{t(e-n*2)},n>0),me(Ot.Container,{position:[0,300],children:me(Ot.TilingSprite,{width:OE,height:25,image:eu,tilePosition:{x:e,y:158}})})},x3=new an;hn.prototype._cacheAsBitmap=!1;hn.prototype._cacheData=null;hn.prototype._cacheAsBitmapResolution=null;hn.prototype._cacheAsBitmapMultisample=null;class DW{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(hn.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(n){n!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=n,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(n){n!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=n,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(n){if(this._cacheAsBitmap===n)return;this._cacheAsBitmap=n;let e;n?(this._cacheData||(this._cacheData=new DW),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});hn.prototype._renderCached=function(n){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(n),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(n))};hn.prototype._initCachedDisplayObject=function(n){var p,m;if((p=this._cacheData)!=null&&p.sprite)return;const e=this.alpha;this.alpha=1,n.batch.flush();const t=this.getLocalBounds(new ut,!0);if((m=this.filters)!=null&&m.length){const v=this.filters[0].padding;t.pad(v)}const i=this.cacheAsBitmapResolution||n.resolution;t.ceil(i),t.width=Math.max(t.width,1/i),t.height=Math.max(t.height,1/i);const r=n.renderTexture.current,s=n.renderTexture.sourceFrame.clone(),o=n.renderTexture.destinationFrame.clone(),a=n.projection.transform,l=Jl.create({width:t.width,height:t.height,resolution:i,multisample:this.cacheAsBitmapMultisample??n.multisample}),u=`cacheAsBitmap_${Yl()}`;this._cacheData.textureCacheId=u,lt.addToCache(l.baseTexture,u),Pe.addToCache(l,u);const d=this.transform.localTransform.copyTo(x3).invert().translate(-t.x,-t.y);this.render=this._cacheData.originalRender,n.render(this,{renderTexture:l,clear:!0,transform:d,skipUpdateTransform:!1}),n.framebuffer.blit(),n.projection.transform=a,n.renderTexture.bind(r,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const f=new Zs(l);f.transform.worldTransform=this.transform.worldTransform,f.anchor.x=-(t.x/t.width),f.anchor.y=-(t.y/t.height),f.alpha=e,f._bounds=this._bounds,this._cacheData.sprite=f,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=f.containsPoint.bind(f)};hn.prototype._renderCachedCanvas=function(n){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(n),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(n))};hn.prototype._initCachedDisplayObjectCanvas=function(n){var d;if((d=this._cacheData)!=null&&d.sprite)return;const e=this.getLocalBounds(new ut,!0),t=this.alpha;this.alpha=1;const i=n.canvasContext.activeContext,r=n._projTransform,s=this.cacheAsBitmapResolution||n.resolution;e.ceil(s),e.width=Math.max(e.width,1/s),e.height=Math.max(e.height,1/s);const o=Jl.create({width:e.width,height:e.height,resolution:s}),a=`cacheAsBitmap_${Yl()}`;this._cacheData.textureCacheId=a,lt.addToCache(o.baseTexture,a),Pe.addToCache(o,a);const l=x3;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=e.x,l.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,n.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),n.canvasContext.activeContext=i,n._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const u=new Zs(o);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(e.x/e.width),u.anchor.y=-(e.y/e.height),u.alpha=t,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=n._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)};hn.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};hn.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};hn.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,lt.removeFromCache(this._cacheData.textureCacheId),Pe.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};hn.prototype._cacheAsBitmapDestroy=function(n){this.cacheAsBitmap=!1,this.destroy(n)};hn.prototype.name=null;Oi.prototype.getChildByName=function(n,e){for(let t=0,i=this.children.length;t<i;t++)if(this.children[t].name===n)return this.children[t];if(e)for(let t=0,i=this.children.length;t<i;t++){const r=this.children[t];if(!r.getChildByName)continue;const s=r.getChildByName(n,!0);if(s)return s}return null};hn.prototype.getGlobalPosition=function(n=new Lt,e=!1){return this.parent?this.parent.toGlobal(this.position,n,e):(n.x=this.position.x,n.y=this.position.y),n};var NW=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class UW extends Ni{constructor(e=1){super(X7,NW,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const FW={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},OW=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function BW(n){const e=FW[n],t=e.length;let i=OW,r="";const s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<n;a++){let l=s.replace("%index%",a.toString());o=a,a>=t&&(o=n-a-1),l=l.replace("%value%",e[o].toString()),r+=l,r+=`
`}return i=i.replace("%blur%",r),i=i.replace("%size%",n.toString()),i}const kW=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function zW(n,e){const t=Math.ceil(n/2);let i=kW,r="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<n;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(t-1)}.0`),r+=a,r+=`
`}return i=i.replace("%blur%",r),i=i.replace("%size%",n.toString()),i}class eS extends Ni{constructor(e,t=8,i=4,r=Ni.defaultResolution,s=5){const o=zW(s,e),a=BW(s);super(o,a),this.horizontal=e,this.resolution=r,this._quality=0,this.quality=i,this.blur=t}apply(e,t,i,r){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/t.width):this.uniforms.strength=1/i.height*(i.height/t.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/t.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/t.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,t,i,r);else{const s=e.getFilterTexture(),o=e.renderer;let a=t,l=s;this.state.blend=!1,e.applyFilter(this,a,l,Ls.CLEAR);for(let u=1;u<this.passes-1;u++){e.bindAndClear(a,Ls.BLIT),this.uniforms.uSampler=l;const d=l;l=a,a=d,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,l,i,r),e.returnFilterTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class GW extends Ni{constructor(e=8,t=4,i=Ni.defaultResolution,r=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new eS(!0,e,t,i,r),this.blurYFilter=new eS(!1,e,t,i,r),this.resolution=i,this.quality=t,this.blur=e,this.repeatEdgePixels=!1}apply(e,t,i,r){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const a=e.getFilterTexture();this.blurXFilter.apply(e,t,a,Ls.CLEAR),this.blurYFilter.apply(e,a,i,r),e.returnFilterTexture(a)}else o?this.blurYFilter.apply(e,t,i,r):this.blurXFilter.apply(e,t,i,r)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var HW=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class tS extends Ni{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(UL,HW,e),this.alpha=1}_loadMatrix(e,t=!1){let i=e;t&&(this._multiply(i,this.uniforms.m,e),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(e,t,i){return e[0]=t[0]*i[0]+t[1]*i[5]+t[2]*i[10]+t[3]*i[15],e[1]=t[0]*i[1]+t[1]*i[6]+t[2]*i[11]+t[3]*i[16],e[2]=t[0]*i[2]+t[1]*i[7]+t[2]*i[12]+t[3]*i[17],e[3]=t[0]*i[3]+t[1]*i[8]+t[2]*i[13]+t[3]*i[18],e[4]=t[0]*i[4]+t[1]*i[9]+t[2]*i[14]+t[3]*i[19]+t[4],e[5]=t[5]*i[0]+t[6]*i[5]+t[7]*i[10]+t[8]*i[15],e[6]=t[5]*i[1]+t[6]*i[6]+t[7]*i[11]+t[8]*i[16],e[7]=t[5]*i[2]+t[6]*i[7]+t[7]*i[12]+t[8]*i[17],e[8]=t[5]*i[3]+t[6]*i[8]+t[7]*i[13]+t[8]*i[18],e[9]=t[5]*i[4]+t[6]*i[9]+t[7]*i[14]+t[8]*i[19]+t[9],e[10]=t[10]*i[0]+t[11]*i[5]+t[12]*i[10]+t[13]*i[15],e[11]=t[10]*i[1]+t[11]*i[6]+t[12]*i[11]+t[13]*i[16],e[12]=t[10]*i[2]+t[11]*i[7]+t[12]*i[12]+t[13]*i[17],e[13]=t[10]*i[3]+t[11]*i[8]+t[12]*i[13]+t[13]*i[18],e[14]=t[10]*i[4]+t[11]*i[9]+t[12]*i[14]+t[13]*i[19]+t[14],e[15]=t[15]*i[0]+t[16]*i[5]+t[17]*i[10]+t[18]*i[15],e[16]=t[15]*i[1]+t[16]*i[6]+t[17]*i[11]+t[18]*i[16],e[17]=t[15]*i[2]+t[16]*i[7]+t[17]*i[12]+t[18]*i[17],e[18]=t[15]*i[3]+t[16]*i[8]+t[17]*i[13]+t[18]*i[18],e[19]=t[15]*i[4]+t[16]*i[9]+t[17]*i[14]+t[18]*i[19]+t[19],e}_colorMatrix(e){const t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t}brightness(e,t){const i=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(i,t)}tint(e,t){const[i,r,s]=Jt.shared.setValue(e).toArray(),o=[i,0,0,0,0,0,r,0,0,0,0,0,s,0,0,0,0,0,1,0];this._loadMatrix(o,t)}greyscale(e,t){const i=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(i,t)}blackAndWhite(e){const t=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(t,e)}hue(e,t){e=(e||0)/180*Math.PI;const i=Math.cos(e),r=Math.sin(e),s=Math.sqrt,o=1/3,a=s(o),l=i+(1-i)*o,u=o*(1-i)-a*r,d=o*(1-i)+a*r,f=o*(1-i)+a*r,p=i+o*(1-i),m=o*(1-i)-a*r,v=o*(1-i)-a*r,x=o*(1-i)+a*r,y=i+o*(1-i),g=[l,u,d,0,0,f,p,m,0,0,v,x,y,0,0,0,0,0,1,0];this._loadMatrix(g,t)}contrast(e,t){const i=(e||0)+1,r=-.5*(i-1),s=[i,0,0,0,r,0,i,0,0,r,0,0,i,0,r,0,0,0,1,0];this._loadMatrix(s,t)}saturate(e=0,t){const i=e*2/3+1,r=(i-1)*-.5,s=[i,r,r,0,0,r,i,r,0,0,r,r,i,0,0,0,0,0,1,0];this._loadMatrix(s,t)}desaturate(){this.saturate(-1)}negative(e){const t=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(t,e)}sepia(e){const t=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(t,e)}technicolor(e){const t=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(t,e)}polaroid(e){const t=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(t,e)}toBGR(e){const t=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(t,e)}kodachrome(e){const t=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(t,e)}browni(e){const t=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(t,e)}vintage(e){const t=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(t,e)}colorTone(e,t,i,r,s){e=e||.2,t=t||.15,i=i||16770432,r=r||3375104;const o=Jt.shared,[a,l,u]=o.setValue(i).toArray(),[d,f,p]=o.setValue(r).toArray(),m=[.3,.59,.11,0,0,a,l,u,e,0,d,f,p,t,0,a-d,l-f,u-p,0,0];this._loadMatrix(m,s)}night(e,t){e=e||.1;const i=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(i,t)}predator(e,t){const i=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(i,t)}lsd(e){const t=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(t,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}tS.prototype.grayscale=tS.prototype.greyscale;var VW=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,WW=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class XW extends Ni{constructor(e,t){const i=new an;e.renderable=!1,super(WW,VW,{mapSampler:e._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=i,t==null&&(t=20),this.scale=new Lt(t,t)}apply(e,t,i,r){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const s=this.maskSprite.worldTransform,o=Math.sqrt(s.a*s.a+s.b*s.b),a=Math.sqrt(s.c*s.c+s.d*s.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=s.a/o,this.uniforms.rotation[1]=s.b/o,this.uniforms.rotation[2]=s.c/a,this.uniforms.rotation[3]=s.d/a),e.applyFilter(this,t,i,r)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var jW=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,$W=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class YW extends Ni{constructor(){super($W,jW)}}var qW=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class KW extends Ni{constructor(e=.5,t=Math.random()){super(UL,qW,{uNoise:0,uSeed:0}),this.noise=e,this.seed=t}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const dR={AlphaFilter:UW,BlurFilter:GW,BlurFilterPass:eS,ColorMatrixFilter:tS,DisplacementFilter:XW,FXAAFilter:YW,NoiseFilter:KW};Object.entries(dR).forEach(([n,e])=>{Object.defineProperty(dR,n,{get(){return Rt("7.1.0",`filters.${n} has moved to ${n}`),e}})});class ZW{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(ni.system.add(this.tickerUpdate,this,Ua.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(ni.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const da=new ZW;class ff{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=ff.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Lt,this.page=new Lt,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,t,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,t,i,r,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Jg extends ff{constructor(){super(...arguments),this.client=new Lt,this.movement=new Lt,this.offset=new Lt,this.global=new Lt,this.screen=new Lt}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,t,i){return e.worldTransform.applyInverse(i||this.global,t)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,t,i,r,s,o,a,l,u,d,f,p,m,v,x){throw new Error("Method not implemented.")}}class Zr extends Jg{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Ac extends Jg{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Ac.DOM_DELTA_PIXEL=0,Ac.DOM_DELTA_LINE=1,Ac.DOM_DELTA_PAGE=2;const QW=2048,JW=new Lt,Wy=new Lt;class eX{constructor(e){this.dispatch=new cf,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort((i,r)=>i.priority-r.priority)}dispatchEvent(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const t=this.mappingTable[e.type];if(t)for(let i=0,r=t.length;i<r;i++)t[i].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,t){da.pauseUpdate=!0;const i=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",r=this[i](this.rootTarget,this.rootTarget.eventMode,JW.set(e,t),this.hitTestFn,this.hitPruneFn);return r&&r[0]}propagate(e,t){if(!e.target)return;const i=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let r=0,s=i.length-1;r<s;r++)if(e.currentTarget=i[r],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let r=i.length-2;r>=0;r--)if(e.currentTarget=i[r],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,t,i=this._allInteractiveElements){if(i.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const r=Array.isArray(t)?t:[t];for(let s=i.length-1;s>=0;s--)r.forEach(o=>{e.currentTarget=i[s],this.notifyTarget(e,o)})}propagationPath(e){const t=[e];for(let i=0;i<QW&&e!==this.rootTarget;i++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");t.push(e.parent),e=e.parent}return t.reverse(),t}hitTestMoveRecursive(e,t,i,r,s,o=!1){let a=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||t==="dynamic")&&(da.pauseUpdate=!1),e.interactiveChildren&&e.children){const d=e.children;for(let f=d.length-1;f>=0;f--){const p=d[f],m=this.hitTestMoveRecursive(p,this._isInteractive(t)?t:p.eventMode,i,r,s,o||s(e,i));if(m){if(m.length>0&&!m[m.length-1].parent)continue;const v=e.isInteractive();(m.length>0||v)&&(v&&this._allInteractiveElements.push(e),m.push(e)),this._hitElements.length===0&&(this._hitElements=m),a=!0}}}const l=this._isInteractive(t),u=e.isInteractive();return l&&u&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:l&&!s(e,i)&&r(e,i)?u?[e]:[]:null}hitTestRecursive(e,t,i,r,s){if(this._interactivePrune(e)||s(e,i))return null;if((e.eventMode==="dynamic"||t==="dynamic")&&(da.pauseUpdate=!1),e.interactiveChildren&&e.children){const l=e.children;for(let u=l.length-1;u>=0;u--){const d=l[u],f=this.hitTestRecursive(d,this._isInteractive(t)?t:d.eventMode,i,r,s);if(f){if(f.length>0&&!f[f.length-1].parent)continue;const p=e.isInteractive();return(f.length>0||p)&&f.push(e),f}}}const o=this._isInteractive(t),a=e.isInteractive();return o&&r(e,i)?a?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,t){var i;if(e.hitArea&&(e.worldTransform.applyInverse(t,Wy),!e.hitArea.contains(Wy.x,Wy.y)))return!0;if(e._mask){const r=e._mask.isMaskData?e._mask.maskObject:e._mask;if(r&&!((i=r.containsPoint)!=null&&i.call(r,t)))return!0}return!1}hitTestFn(e,t){return e.eventMode==="passive"?!1:e.hitArea?!0:e.containsPoint?e.containsPoint(t):!1}notifyTarget(e,t){var s,o;t=t??e.type;const i=`on${t}`;(o=(s=e.currentTarget)[i])==null||o.call(s,e);const r=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${t}capture`:t;this.notifyListeners(e,r),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)}mapPointerDown(e){if(!(e instanceof Zr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.createPointerEvent(e);if(this.dispatchEvent(t,"pointerdown"),t.pointerType==="touch")this.dispatchEvent(t,"touchstart");else if(t.pointerType==="mouse"||t.pointerType==="pen"){const r=t.button===2;this.dispatchEvent(t,r?"rightdown":"mousedown")}const i=this.trackingData(e.pointerId);i.pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t)}mapPointerMove(e){var l,u;if(!(e instanceof Zr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const t=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const i=t.pointerType==="mouse"||t.pointerType==="pen",r=this.trackingData(e.pointerId),s=this.findMountedTarget(r.overTargets);if(((l=r.overTargets)==null?void 0:l.length)>0&&s!==t.target){const d=e.type==="mousemove"?"mouseout":"pointerout",f=this.createPointerEvent(e,d,s);if(this.dispatchEvent(f,"pointerout"),i&&this.dispatchEvent(f,"mouseout"),!t.composedPath().includes(s)){const p=this.createPointerEvent(e,"pointerleave",s);for(p.eventPhase=p.AT_TARGET;p.target&&!t.composedPath().includes(p.target);)p.currentTarget=p.target,this.notifyTarget(p),i&&this.notifyTarget(p,"mouseleave"),p.target=p.target.parent;this.freeEvent(p)}this.freeEvent(f)}if(s!==t.target){const d=e.type==="mousemove"?"mouseover":"pointerover",f=this.clonePointerEvent(t,d);this.dispatchEvent(f,"pointerover"),i&&this.dispatchEvent(f,"mouseover");let p=s==null?void 0:s.parent;for(;p&&p!==this.rootTarget.parent&&p!==t.target;)p=p.parent;if(!p||p===this.rootTarget.parent){const m=this.clonePointerEvent(t,"pointerenter");for(m.eventPhase=m.AT_TARGET;m.target&&m.target!==s&&m.target!==this.rootTarget.parent;)m.currentTarget=m.target,this.notifyTarget(m),i&&this.notifyTarget(m,"mouseenter"),m.target=m.target.parent;this.freeEvent(m)}this.freeEvent(f)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(t,"pointermove"),a&&o.push("globalpointermove"),t.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(t,"touchmove"),a&&o.push("globaltouchmove")),i&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(t,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(u=t.target)==null?void 0:u.cursor),o.length>0&&this.all(t,o),this._allInteractiveElements.length=0,this._hitElements.length=0,r.overTargets=t.composedPath(),this.freeEvent(t)}mapPointerOver(e){var o;if(!(e instanceof Zr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId),i=this.createPointerEvent(e),r=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),r&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=(o=i.target)==null?void 0:o.cursor);const s=this.clonePointerEvent(i,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),r&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;t.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof Zr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId);if(t.overTargets){const i=e.pointerType==="mouse"||e.pointerType==="pen",r=this.findMountedTarget(t.overTargets),s=this.createPointerEvent(e,"pointerout",r);this.dispatchEvent(s),i&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(e,"pointerleave",r);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),i&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;t.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof Zr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=performance.now(),i=this.createPointerEvent(e);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const a=i.button===2;this.dispatchEvent(i,a?"rightup":"mouseup")}const r=this.trackingData(e.pointerId),s=this.findMountedTarget(r.pressTargetsByButton[e.button]);let o=s;if(s&&!i.composedPath().includes(s)){let a=s;for(;a&&!i.composedPath().includes(a);){if(i.currentTarget=a,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const l=i.button===2;this.notifyTarget(i,l?"rightupoutside":"mouseupoutside")}a=a.parent}delete r.pressTargetsByButton[e.button],o=a}if(o){const a=this.clonePointerEvent(i,"click");a.target=o,a.path=null,r.clicksByButton[e.button]||(r.clicksByButton[e.button]={clickCount:0,target:a.target,timeStamp:t});const l=r.clicksByButton[e.button];if(l.target===a.target&&t-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=t,a.detail=l.clickCount,a.pointerType==="mouse"){const u=a.button===2;this.dispatchEvent(a,u?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(i)}mapPointerUpOutside(e){if(!(e instanceof Zr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId),i=this.findMountedTarget(t.pressTargetsByButton[e.button]),r=this.createPointerEvent(e);if(i){let s=i;for(;s;)r.currentTarget=s,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch"?this.notifyTarget(r,"touchendoutside"):(r.pointerType==="mouse"||r.pointerType==="pen")&&this.notifyTarget(r,r.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete t.pressTargetsByButton[e.button]}this.freeEvent(r)}mapWheel(e){if(!(e instanceof Ac)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const t=this.createWheelEvent(e);this.dispatchEvent(t),this.freeEvent(t)}findMountedTarget(e){if(!e)return null;let t=e[0];for(let i=1;i<e.length&&e[i].parent===t;i++)t=e[i];return t}createPointerEvent(e,t,i){const r=this.allocateEvent(Zr);return this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,r.target=i??this.hitTest(r.global.x,r.global.y)??this._hitElements[0],typeof t=="string"&&(r.type=t),r}createWheelEvent(e){const t=this.allocateEvent(Ac);return this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,t.target=this.hitTest(t.global.x,t.global.y),t}clonePointerEvent(e,t){const i=this.allocateEvent(Zr);return i.nativeEvent=e.nativeEvent,i.originalEvent=e.originalEvent,this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.target=e.target,i.path=e.composedPath().slice(),i.type=t??i.type,i}copyWheelData(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}copyPointerData(e,t){e instanceof Zr&&t instanceof Zr&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)}copyMouseData(e,t){e instanceof Jg&&t instanceof Jg&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.copyFrom(e.client),t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.copyFrom(e.movement),t.screen.copyFrom(e.screen),t.shiftKey=e.shiftKey,t.global.copyFrom(e.global))}copyData(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.copyFrom(e.layer),t.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=null,t.target=null,t}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}notifyListeners(e,t){const i=e.currentTarget._events[t];if(i&&e.currentTarget.isInteractive())if("fn"in i)i.once&&e.currentTarget.removeListener(t,i.fn,void 0,!0),i.fn.call(i.context,e);else for(let r=0,s=i.length;r<s&&!e.propagationImmediatelyStopped;r++)i[r].once&&e.currentTarget.removeListener(t,i[r].fn,void 0,!0),i[r].fn.call(i[r].context,e)}}const tX=1,nX={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},nS=class iS{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new eX(null),da.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Zr(null),this.rootWheelEvent=new Ac(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...iS.defaultEventFeatures},{set:(t,i,r)=>(i==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=r),t[i]=r,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:t,resolution:i}=this.renderer;this.setTargetElement(t),this.resolution=i,iS._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===e)return;this.currentCursor=e;const i=this.cursorStyles[e];if(i)switch(typeof i){case"string":t&&(this.domElement.style.cursor=i);break;case"function":i(e);break;case"object":t&&Object.assign(this.domElement.style,i);break}else t&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let i=0,r=t.length;i<r;i++){const s=t[i],o=this.bootstrapEvent(this.rootPointerEvent,s);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,da.pointerMoved();const t=this.normalizeToPointerData(e);for(let i=0,r=t.length;i<r;i++){const s=this.bootstrapEvent(this.rootPointerEvent,t[i]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);const i=t!==this.domElement?"outside":"",r=this.normalizeToPointerData(e);for(let s=0,o=r.length;s<o;s++){const a=this.bootstrapEvent(this.rootPointerEvent,r[s]);a.type+=i,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this.normalizeToPointerData(e);for(let i=0,r=t.length;i<r;i++){const s=this.bootstrapEvent(this.rootPointerEvent,t[i]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this.removeEvents(),this.domElement=e,da.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;da.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;da.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,t,i){const r=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;e.x=(t-r.left)*(this.domElement.width/r.width)*s,e.y=(i-r.top)*(this.domElement.height/r.height)*s}normalizeToPointerData(e){const t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let i=0,r=e.changedTouches.length;i<r;i++){const s=e.changedTouches[i];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=e.type,t.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const i=e;typeof i.isPrimary>"u"&&(i.isPrimary=!0),typeof i.width>"u"&&(i.width=1),typeof i.height>"u"&&(i.height=1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="mouse"),typeof i.pointerId>"u"&&(i.pointerId=tX),typeof i.pressure>"u"&&(i.pressure=.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),i.isNormalized=!0,t.push(i)}else t.push(e);return t}normalizeWheelEvent(e){const t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=nX[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}};nS.extension={name:"events",type:[Ne.RendererSystem,Ne.CanvasRendererSystem]},nS.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let rS=nS;$e.add(rS);function fR(n){return n==="dynamic"||n==="static"}const iX={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??fR(rS.defaultEventMode)},set interactive(n){Rt("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=n,this.eventMode=n?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??rS.defaultEventMode},set eventMode(n){this._internalInteractive=fR(n),this._internalEventMode=n},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(n,e,t){const i=typeof t=="boolean"&&t||typeof t=="object"&&t.capture,r=typeof e=="function"?void 0:e;n=i?`${n}capture`:n,e=typeof e=="function"?e:e.handleEvent,this.on(n,e,r)},removeEventListener(n,e,t){const i=typeof t=="boolean"&&t||typeof t=="object"&&t.capture,r=typeof e=="function"?void 0:e;n=i?`${n}capture`:n,e=typeof e=="function"?e:e.handleEvent,this.off(n,e,r)},dispatchEvent(n){if(!(n instanceof ff))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return n.defaultPrevented=!1,n.path=null,n.target=this,n.manager.dispatchEvent(n),!n.defaultPrevented}};hn.mixin(iX);const rX={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};hn.mixin(rX);const sX=9,xm=100,oX=0,aX=0,pR=2,mR=1,lX=-1e3,uX=-1e3,cX=2;class S3{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(bo.tablet||bo.phone)&&this.createTouchHook();const t=document.createElement("div");t.style.width=`${xm}px`,t.style.height=`${xm}px`,t.style.position="absolute",t.style.top=`${oX}px`,t.style.left=`${aX}px`,t.style.zIndex=pR.toString(),this.div=t,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${mR}px`,e.style.height=`${mR}px`,e.style.position="absolute",e.style.top=`${lX}px`,e.style.left=`${uX}px`,e.style.zIndex=cX.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const t=e.children;if(t)for(let i=0;i<t.length;i++)this.updateAccessibleObjects(t[i])}update(){const e=performance.now();if(bo.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:t,y:i,width:r,height:s}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:l}=this.renderer,u=r/o*l,d=s/a*l;let f=this.div;f.style.left=`${t}px`,f.style.top=`${i}px`,f.style.width=`${o}px`,f.style.height=`${a}px`;for(let p=0;p<this.children.length;p++){const m=this.children[p];if(m.renderId!==this.renderId)m._accessibleActive=!1,bc(this.children,p,1),this.div.removeChild(m._accessibleDiv),this.pool.push(m._accessibleDiv),m._accessibleDiv=null,p--;else{f=m._accessibleDiv;let v=m.hitArea;const x=m.worldTransform;m.hitArea?(f.style.left=`${(x.tx+v.x*x.a)*u}px`,f.style.top=`${(x.ty+v.y*x.d)*d}px`,f.style.width=`${v.width*x.a*u}px`,f.style.height=`${v.height*x.d*d}px`):(v=m.getBounds(),this.capHitArea(v),f.style.left=`${v.x*u}px`,f.style.top=`${v.y*d}px`,f.style.width=`${v.width*u}px`,f.style.height=`${v.height*d}px`,f.title!==m.accessibleTitle&&m.accessibleTitle!==null&&(f.title=m.accessibleTitle),f.getAttribute("aria-label")!==m.accessibleHint&&m.accessibleHint!==null&&f.setAttribute("aria-label",m.accessibleHint)),(m.accessibleTitle!==f.title||m.tabIndex!==f.tabIndex)&&(f.title=m.accessibleTitle,f.tabIndex=m.tabIndex,this.debug&&this.updateDebugHTML(f))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:t,height:i}=this.renderer;e.x+e.width>t&&(e.width=t-e.x),e.y+e.height>i&&(e.height=i-e.y)}addChild(e){let t=this.pool.pop();t||(t=document.createElement("button"),t.style.width=`${xm}px`,t.style.height=`${xm}px`,t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=pR.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?t.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(t.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,t){const{displayObject:i}=e.target,r=this.renderer.events.rootBoundary,s=Object.assign(new ff(r),{target:i});r.rootTarget=this.renderer.lastObjectRendered,t.forEach(o=>r.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===sX&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}S3.extension={name:"accessibility",type:[Ne.RendererPlugin,Ne.CanvasRendererPlugin]};$e.add(S3);var sr=(n=>(n[n.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",n[n.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",n[n.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",n[n.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",n[n.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",n[n.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",n[n.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",n[n.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",n[n.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",n[n.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",n[n.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",n[n.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",n))(sr||{});const e0={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1};let po,ju;function gR(){ju={s3tc:po.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:po.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:po.getExtension("WEBGL_compressed_texture_etc"),etc1:po.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:po.getExtension("WEBGL_compressed_texture_pvrtc")||po.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:po.getExtension("WEBGL_compressed_texture_atc"),astc:po.getExtension("WEBGL_compressed_texture_astc")}}const hX={extension:{type:Ne.DetectionParser,priority:2},test:async()=>{const n=Fe.ADAPTER.createCanvas().getContext("webgl");return n?(po=n,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async n=>{ju||gR();const e=[];for(const t in ju)ju[t]&&e.push(t);return[...e,...n]},remove:async n=>(ju||gR(),n.filter(e=>!(e in ju)))};$e.add(hX);class dX extends A0{constructor(e,t={width:1,height:1,autoLoad:!0}){let i,r;typeof e=="string"?(i=e,r=new Uint8Array):(i=null,r=e),super(r,t),this.origin=i,this.buffer=r?new b1(r):null,this._load=null,this.loaded=!1,this.origin!==null&&t.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new b1(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}}class Fl extends dX{constructor(e,t){super(e,t),this.format=t.format,this.levels=t.levels||1,this._width=t.width,this._height=t.height,this._extension=Fl._formatToExtension(this.format),(t.levelBuffers||this.buffer)&&(this._levelBuffers=t.levelBuffers||Fl._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,t,i){const r=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;r.pixelStorei(r.UNPACK_ALIGNMENT,4);for(let s=0,o=this.levels;s<o;s++){const{levelID:a,levelWidth:l,levelHeight:u,levelBuffer:d}=this._levelBuffers[s];r.compressedTexImage2D(r.TEXTURE_2D,a,this.format,l,u,0,d)}return!0}onBlobLoaded(){this._levelBuffers=Fl._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(e,t,i,r,s,o,a){const l=new Array(i);let u=e.byteOffset,d=o,f=a,p=d+r-1&~(r-1),m=f+s-1&~(s-1),v=p*m*e0[t];for(let x=0;x<i;x++)l[x]={levelID:x,levelWidth:i>1?d:p,levelHeight:i>1?f:m,levelBuffer:new Uint8Array(e.buffer,u,v)},u+=v,d=d>>1||1,f=f>>1||1,p=d+r-1&~(r-1),m=f+s-1&~(s-1),v=p*m*e0[t];return l}}const Xy=4,Sm=124,fX=32,_R=20,pX=542327876,Em={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},mX={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Tm={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},gX=1,_X=2,vX=4,yX=64,xX=512,SX=131072,EX=827611204,TX=861165636,bX=894720068,wX=808540228,AX=4,MX={[EX]:sr.COMPRESSED_RGBA_S3TC_DXT1_EXT,[TX]:sr.COMPRESSED_RGBA_S3TC_DXT3_EXT,[bX]:sr.COMPRESSED_RGBA_S3TC_DXT5_EXT},CX={70:sr.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:sr.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:sr.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:sr.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:sr.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:sr.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:sr.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:sr.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:sr.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function RX(n){const e=new Uint32Array(n);if(e[0]!==pX)throw new Error("Invalid DDS file magic word");const t=new Uint32Array(n,0,Sm/Uint32Array.BYTES_PER_ELEMENT),i=t[Em.HEIGHT],r=t[Em.WIDTH],s=t[Em.MIPMAP_COUNT],o=new Uint32Array(n,Em.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,fX/Uint32Array.BYTES_PER_ELEMENT),a=o[gX];if(a&vX){const l=o[mX.FOURCC];if(l!==wX){const T=MX[l],S=Xy+Sm,w=new Uint8Array(n,S);return[new Fl(w,{format:T,width:r,height:i,levels:s})]}const u=Xy+Sm,d=new Uint32Array(e.buffer,u,_R/Uint32Array.BYTES_PER_ELEMENT),f=d[Tm.DXGI_FORMAT],p=d[Tm.RESOURCE_DIMENSION],m=d[Tm.MISC_FLAG],v=d[Tm.ARRAY_SIZE],x=CX[f];if(x===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${f}`);if(m===AX)throw new Error("DDSParser does not support cubemap textures");if(p===6)throw new Error("DDSParser does not supported 3D texture data");const y=new Array,g=Xy+Sm+_R;if(v===1)y.push(new Uint8Array(n,g));else{const T=e0[x];let S=0,w=r,M=i;for(let P=0;P<s;P++){const N=Math.max(1,w+3&-4),C=Math.max(1,M+3&-4),L=N*C*T;S+=L,w=w>>>1,M=M>>>1}let R=g;for(let P=0;P<v;P++)y.push(new Uint8Array(n,R,S)),R+=S}return y.map(T=>new Fl(T,{format:x,width:r,height:i,levels:s}))}throw a&yX?new Error("DDSParser does not support uncompressed texture data."):a&xX?new Error("DDSParser does not supported YUV uncompressed texture data."):a&SX?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&_X?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const vR=[171,75,84,88,32,49,49,187,13,10,26,10],PX=67305985,qr={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},sS=64,yR={[et.UNSIGNED_BYTE]:1,[et.UNSIGNED_SHORT]:2,[et.INT]:4,[et.UNSIGNED_INT]:4,[et.FLOAT]:4,[et.HALF_FLOAT]:8},IX={[Ee.RGBA]:4,[Ee.RGB]:3,[Ee.RG]:2,[Ee.RED]:1,[Ee.LUMINANCE]:1,[Ee.LUMINANCE_ALPHA]:2,[Ee.ALPHA]:1},LX={[et.UNSIGNED_SHORT_4_4_4_4]:2,[et.UNSIGNED_SHORT_5_5_5_1]:2,[et.UNSIGNED_SHORT_5_6_5]:2};function DX(n,e,t=!1){const i=new DataView(e);if(!NX(n,i))return null;const r=i.getUint32(qr.ENDIANNESS,!0)===PX,s=i.getUint32(qr.GL_TYPE,r),o=i.getUint32(qr.GL_FORMAT,r),a=i.getUint32(qr.GL_INTERNAL_FORMAT,r),l=i.getUint32(qr.PIXEL_WIDTH,r),u=i.getUint32(qr.PIXEL_HEIGHT,r)||1,d=i.getUint32(qr.PIXEL_DEPTH,r)||1,f=i.getUint32(qr.NUMBER_OF_ARRAY_ELEMENTS,r)||1,p=i.getUint32(qr.NUMBER_OF_FACES,r),m=i.getUint32(qr.NUMBER_OF_MIPMAP_LEVELS,r),v=i.getUint32(qr.BYTES_OF_KEY_VALUE_DATA,r);if(u===0||d!==1)throw new Error("Only 2D textures are supported");if(p!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(f!==1)throw new Error("WebGL does not support array textures");const x=4,y=4,g=l+3&-4,T=u+3&-4,S=new Array(f);let w=l*u;s===0&&(w=g*T);let M;if(s!==0?yR[s]?M=yR[s]*IX[o]:M=LX[s]:M=e0[a],M===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const R=t?FX(i,v,r):null;let P=w*M,N=l,C=u,L=g,Q=T,W=sS+v;for(let z=0;z<m;z++){const F=i.getUint32(W,r);let X=W+4;for(let Z=0;Z<f;Z++){let $=S[Z];$||($=S[Z]=new Array(m)),$[z]={levelID:z,levelWidth:m>1||s!==0?N:L,levelHeight:m>1||s!==0?C:Q,levelBuffer:new Uint8Array(e,X,P)},X+=P}W+=F+4,W=W%4!==0?W+4-W%4:W,N=N>>1||1,C=C>>1||1,L=N+x-1&~(x-1),Q=C+y-1&~(y-1),P=L*Q*M}return s!==0?{uncompressed:S.map(z=>{let F=z[0].levelBuffer,X=!1;return s===et.FLOAT?F=new Float32Array(z[0].levelBuffer.buffer,z[0].levelBuffer.byteOffset,z[0].levelBuffer.byteLength/4):s===et.UNSIGNED_INT?(X=!0,F=new Uint32Array(z[0].levelBuffer.buffer,z[0].levelBuffer.byteOffset,z[0].levelBuffer.byteLength/4)):s===et.INT&&(X=!0,F=new Int32Array(z[0].levelBuffer.buffer,z[0].levelBuffer.byteOffset,z[0].levelBuffer.byteLength/4)),{resource:new A0(F,{width:z[0].levelWidth,height:z[0].levelHeight}),type:s,format:X?UX(o):o}}),kvData:R}:{compressed:S.map(z=>new Fl(null,{format:a,width:l,height:u,levels:m,levelBuffers:z})),kvData:R}}function NX(n,e){for(let t=0;t<vR.length;t++)if(e.getUint8(t)!==vR[t])return console.error(`${n} is not a valid *.ktx file!`),!1;return!0}function UX(n){switch(n){case Ee.RGBA:return Ee.RGBA_INTEGER;case Ee.RGB:return Ee.RGB_INTEGER;case Ee.RG:return Ee.RG_INTEGER;case Ee.RED:return Ee.RED_INTEGER;default:return n}}function FX(n,e,t){const i=new Map;let r=0;for(;r<e;){const s=n.getUint32(sS+r,t),o=sS+r+4,a=3-(s+3)%4;if(s===0||s>e-r){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<s&&n.getUint8(o+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const u=new TextDecoder().decode(new Uint8Array(n.buffer,o,l)),d=new DataView(n.buffer,o+l+1,s-l-1);i.set(u,d),r+=4+s+a}return i}const OX={extension:{type:Ne.LoadParser,priority:hs.High},name:"loadDDS",test(n){return Ha(n,".dds")},async load(n,e,t){const i=await(await Fe.ADAPTER.fetch(n)).arrayBuffer(),r=RX(i).map(s=>{const o=new lt(s,{mipmap:Ws.OFF,alphaMode:ji.NO_PREMULTIPLIED_ALPHA,resolution:Uo(n),...e.data});return df(o,t,n)});return r.length===1?r[0]:r},unload(n){Array.isArray(n)?n.forEach(e=>e.destroy(!0)):n.destroy(!0)}};$e.add(OX);const BX={extension:{type:Ne.LoadParser,priority:hs.High},name:"loadKTX",test(n){return Ha(n,".ktx")},async load(n,e,t){const i=await(await Fe.ADAPTER.fetch(n)).arrayBuffer(),{compressed:r,uncompressed:s,kvData:o}=DX(n,i),a=r??s,l={mipmap:Ws.OFF,alphaMode:ji.NO_PREMULTIPLIED_ALPHA,resolution:Uo(n),...e.data},u=a.map(d=>{a===s&&Object.assign(l,{type:d.type,format:d.format});const f=d.resource??d,p=new lt(f,l);return p.ktxKeyValueData=o,df(p,t,n)});return u.length===1?u[0]:u},unload(n){Array.isArray(n)?n.forEach(e=>e.destroy(!0)):n.destroy(!0)}};$e.add(BX);const kX={extension:Ne.ResolveParser,test:n=>{const e=Gn.extname(n).slice(1);return["basis","ktx","dds"].includes(e)},parse:n=>{var t,i;const e=Gn.extname(n).slice(1);if(e==="ktx"){const r=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(r.some(s=>n.endsWith(s)))return{resolution:parseFloat(((t=Fe.RETINA_PREFIX.exec(n))==null?void 0:t[1])??"1"),format:r.find(s=>n.endsWith(s)),src:n}}return{resolution:parseFloat(((i=Fe.RETINA_PREFIX.exec(n))==null?void 0:i[1])??"1"),format:e,src:n}}};$e.add(kX);const bm=new ut,zX=4,E3=class sd{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){var t;const e=(t=this.renderer)==null?void 0:t.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,t,i,r){const s=new Image;return s.src=await this.base64(e,t,i,r),s}async base64(e,t,i,r){const s=this.canvas(e,r);if(s.toBlob!==void 0)return new Promise((o,a)=>{s.toBlob(l=>{if(!l){a(new Error("ICanvas.toBlob failed!"));return}const u=new FileReader;u.onload=()=>o(u.result),u.onerror=a,u.readAsDataURL(l)},t,i)});if(s.toDataURL!==void 0)return s.toDataURL(t,i);if(s.convertToBlob!==void 0){const o=await s.convertToBlob({type:t,quality:i});return new Promise((a,l)=>{const u=new FileReader;u.onload=()=>a(u.result),u.onerror=l,u.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,t){const{pixels:i,width:r,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,t);o&&sd._flipY(i,r,s),a&&sd._unpremultiplyAlpha(i);const l=new PH(r,s,1),u=new ImageData(new Uint8ClampedArray(i.buffer),r,s);return l.context.putImageData(u,0,0),l.canvas}pixels(e,t){const{pixels:i,width:r,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,t);return o&&sd._flipY(i,r,s),a&&sd._unpremultiplyAlpha(i),i}_rawPixels(e,t){const i=this.renderer;if(!i)throw new Error("The Extract has already been destroyed");let r,s=!1,o=!1,a,l=!1;e&&(e instanceof Jl?a=e:(a=i.generateTexture(e,{region:t,resolution:i.resolution,multisample:i.multisample}),l=!0,t&&(bm.width=t.width,bm.height=t.height,t=bm)));const u=i.gl;if(a){if(r=a.baseTexture.resolution,t=t??a.frame,s=!1,o=a.baseTexture.alphaMode>0&&a.baseTexture.format===Ee.RGBA,!l){i.renderTexture.bind(a);const m=a.framebuffer.glFramebuffers[i.CONTEXT_UID];m.blitFramebuffer&&i.framebuffer.bind(m.blitFramebuffer)}}else r=i.resolution,t||(t=bm,t.width=i.width/r,t.height=i.height/r),s=!0,o=this._rendererPremultipliedAlpha,i.renderTexture.bind();const d=Math.max(Math.round(t.width*r),1),f=Math.max(Math.round(t.height*r),1),p=new Uint8Array(zX*d*f);return u.readPixels(Math.round(t.x*r),Math.round(t.y*r),d,f,u.RGBA,u.UNSIGNED_BYTE,p),l&&(a==null||a.destroy(!0)),{pixels:p,width:d,height:f,flipY:s,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(e,t,i){const r=t<<2,s=i>>1,o=new Uint8Array(r);for(let a=0;a<s;a++){const l=a*r,u=(i-a-1)*r;o.set(e.subarray(l,l+r)),e.copyWithin(l,u,u+r),e.set(o,u)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const t=e.length;for(let i=0;i<t;i+=4){const r=e[i+3];if(r!==0){const s=255.001/r;e[i]=e[i]*s+.5,e[i+1]=e[i+1]*s+.5,e[i+2]=e[i+2]*s+.5}}}};E3.extension={name:"extract",type:Ne.RendererSystem};let GX=E3;$e.add(GX);class HX{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function VX(n,e){var i;let t=!1;if((i=n==null?void 0:n._textures)!=null&&i.length){for(let r=0;r<n._textures.length;r++)if(n._textures[r]instanceof Pe){const s=n._textures[r].baseTexture;e.includes(s)||(e.push(s),t=!0)}}return t}function WX(n,e){if(n.baseTexture instanceof lt){const t=n.baseTexture;return e.includes(t)||e.push(t),!0}return!1}function XX(n,e){if(n._texture&&n._texture instanceof Pe){const t=n._texture.baseTexture;return e.includes(t)||e.push(t),!0}return!1}function jX(n,e){return e instanceof IE?(e.updateText(!0),!0):!1}function $X(n,e){if(e instanceof Fa){const t=e.toFontString();return ua.measureFont(t),!0}return!1}function YX(n,e){if(n instanceof IE){e.includes(n.style)||e.push(n.style),e.includes(n)||e.push(n);const t=n._texture.baseTexture;return e.includes(t)||e.push(t),!0}return!1}function qX(n,e){return n instanceof Fa?(e.includes(n)||e.push(n),!0):!1}const T3=class b3{constructor(e){this.limiter=new HX(b3.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(YX),this.registerFindHook(qX),this.registerFindHook(VX),this.registerFindHook(WX),this.registerFindHook(XX),this.registerUploadHook(jX),this.registerUploadHook($X)}upload(e){return new Promise(t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,ni.system.addOnce(this.tick,this,Ua.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let t=!1;if(e&&!e._destroyed){for(let i=0,r=this.uploadHooks.length;i<r;i++)if(this.uploadHooks[i](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)ni.system.addOnce(this.tick,this,Ua.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let t=0,i=e.length;t<i;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,i=this.addHooks.length;t<i&&!this.addHooks[t](e,this.queue);t++);if(e instanceof Oi)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&ni.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};T3.uploadsPerFrame=4;let oS=T3;Object.defineProperties(Fe,{UPLOADS_PER_FRAME:{get(){return oS.uploadsPerFrame},set(n){Rt("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),oS.uploadsPerFrame=n}}});function w3(n,e){return e instanceof lt?(e._glTextures[n.CONTEXT_UID]||n.texture.bind(e),!0):!1}function KX(n,e){if(!(e instanceof Ad))return!1;const{geometry:t}=e;e.finishPoly(),t.updateBatches();const{batches:i}=t;for(let r=0;r<i.length;r++){const{texture:s}=i[r].style;s&&w3(n,s.baseTexture)}return t.batchable||n.geometry.bind(t,e._resolveDirectShader(n)),!0}function ZX(n,e){return n instanceof Ad?(e.push(n),!0):!1}class A3 extends oS{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(ZX),this.registerUploadHook(w3),this.registerUploadHook(KX)}}A3.extension={name:"prepare",type:Ne.RendererSystem};$e.add(A3);const M3=class od{constructor(e,t,i=null){this.linkedSheets=[],this._texture=e instanceof Pe?e:null,this.baseTexture=e instanceof lt?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;const r=this.baseTexture.resource;this.resolution=this._updateResolution(i||(r?r.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:t}=this.data.meta;let i=Uo(e,null);return i===null&&(i=typeof t=="number"?t:parseFloat(t??"1")),i!==1&&this.baseTexture.setResolution(i),i}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=od.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;const i=od.BATCH_SIZE;for(;t-e<i&&t<this._frameKeys.length;){const r=this._frameKeys[t],s=this._frames[r],o=s.frame;if(o){let a=null,l=null;const u=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,d=new ut(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);s.rotated?a=new ut(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new ut(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new ut(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[r]=new Pe(this.baseTexture,a,d,l,s.rotated?2:0,s.anchor,s.borders),Pe.addToCache(this.textures[r],r.toString())}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let i=0;i<e[t].length;i++){const r=e[t][i];this.animations[t].push(this.textures[r])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*od.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*od.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var t;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};M3.BATCH_SIZE=1e3;let xR=M3;const QX=["jpg","png","jpeg","avif","webp"];function C3(n,e,t){const i={};if(n.forEach(r=>{i[r]=e}),Object.keys(e.textures).forEach(r=>{i[r]=e.textures[r]}),!t){const r=Gn.dirname(n[0]);e.linkedSheets.forEach((s,o)=>{const a=C3([`${r}/${e.data.meta.related_multi_packs[o]}`],s,!0);Object.assign(i,a)})}return i}const JX={extension:Ne.Asset,cache:{test:n=>n instanceof xR,getCacheableAssets:(n,e)=>C3(n,e,!1)},resolver:{test:n=>{const e=n.split("?")[0].split("."),t=e.pop(),i=e.pop();return t==="json"&&QX.includes(i)},parse:n=>{var t;const e=n.split(".");return{resolution:parseFloat(((t=Fe.RETINA_PREFIX.exec(n))==null?void 0:t[1])??"1"),format:e[e.length-2],src:n}}},loader:{name:"spritesheetLoader",extension:{type:Ne.LoadParser,priority:hs.Normal},async testParse(n,e){return Gn.extname(e.src).toLowerCase()===".json"&&!!n.frames},async parse(n,e,t){var l,u;let i=Gn.dirname(e.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let r=i+n.meta.image;r=W1(r,e.src);const s=(await t.load([r]))[r],o=new xR(s.baseTexture,n,e.src);await o.parse();const a=(l=n==null?void 0:n.meta)==null?void 0:l.related_multi_packs;if(Array.isArray(a)){const d=[];for(const p of a){if(typeof p!="string")continue;let m=i+p;(u=e.data)!=null&&u.ignoreMultiPack||(m=W1(m,e.src),d.push(t.load({src:m,data:{ignoreMultiPack:!0}})))}const f=await Promise.all(d);o.linkedSheets=f,f.forEach(p=>{p.linkedSheets=[o].concat(o.linkedSheets.filter(m=>m!==p))})}return o},unload(n){n.destroy(!0)}}};$e.add(JX);const aS=class $u extends Fa{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new $u(Object.keys($u.defaultOptions).reduce((t,i)=>({...t,[i]:e[i]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete $u.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,t={}){const{availableFonts:i}=$u;if(i[e]){const r=i[e];return this._fonts.push(r),r.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return Fe.ADAPTER.fetch(e).then(r=>r.blob()).then(async r=>new Promise((s,o)=>{const a=URL.createObjectURL(r),l=new FileReader;l.onload=()=>s([a,l.result]),l.onerror=o,l.readAsDataURL(r)})).then(async([r,s])=>{const o=Object.assign({family:Gn.basename(e,Gn.extname(e)),weight:"normal",style:"normal",display:"auto",src:r,dataSrc:s,refs:1,originalUrl:e,fontFace:null},t);i[e]=o,this._fonts.push(o),this.styleID++;const a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const t=e.filter(i=>!this._overrides.includes(i));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...e){const t=e.filter(i=>this._overrides.includes(i));t.length>0&&(this._overrides=this._overrides.filter(i=>!t.includes(i)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,t)=>`${e}
            @font-face {
                font-family: "${t.family}";
                src: url('${t.dataSrc}');
                font-weight: ${t.weight};
                font-style: ${t.style};
                font-display: ${t.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=AH(e)),typeof e=="number"?wH(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const t=this.dropShadowAlpha,i=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),r=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&t<1&&(e+=(t*255|0).toString(16).padStart(2,"0"));const s=`${i}px ${r}px`;return this.dropShadowBlur>0?`text-shadow: ${s} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${s} ${e}`}reset(){Object.assign(this,$u.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(t=>setTimeout(t,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=Fe.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};aS.availableFonts={},aS.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let jy=aS;const wm=class Yu extends Zs{constructor(e="",t={}){super(Pe.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const i=new Image,r=Pe.from(i,{scaleMode:Fe.SCALE_MODE,resourceOptions:{autoLoad:!1}});r.orig=new ut,r.trim=new ut,this.texture=r;const s="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject"),u=document.createElementNS(o,"div"),d=document.createElementNS(o,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",a.appendChild(l),this.maxWidth=Yu.defaultMaxWidth,this.maxHeight=Yu.defaultMaxHeight,this._domElement=u,this._styleElement=d,this._svgRoot=a,this._foreignObject=l,this._foreignObject.appendChild(d),this._foreignObject.appendChild(u),this._image=i,this._loadImage=new Image,this._autoResolution=Yu.defaultAutoResolution,this._resolution=Yu.defaultResolution??Fe.RESOLUTION,this.text=e,this.style=t}measureText(e){var d,f;const{text:t,style:i,resolution:r}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:t,style:i.toCSS(r)}),this._styleElement.textContent=i.toGlobalCSS(),document.body.appendChild(this._svgRoot);const s=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=s;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const l=Math.min(this.maxWidth,Math.ceil(o)),u=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",l.toString()),this._svgRoot.setAttribute("height",u.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),i!==this._style&&(Object.assign(this._domElement,{style:(d=this._style)==null?void 0:d.toCSS(r)}),this._styleElement.textContent=(f=this._style)==null?void 0:f.toGlobalCSS()),{width:l+i.padding*2,height:u+i.padding*2}}async updateText(e=!0){const{style:t,_image:i,_loadImage:r}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;const{width:s,height:o}=this.measureText();i.width=r.width=Math.ceil(Math.max(1,s)),i.height=r.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise(l=>{r.onload=async()=>{if(a<this._updateID){l();return}await t.onBeforeDraw(),i.src=r.src,r.onload=null,r.src="",this.updateTexture(),l()};const u=new XMLSerializer().serializeToString(this._svgRoot);r.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(u)}`})}get source(){return this._image}updateTexture(){const{style:e,texture:t,_image:i,resolution:r}=this,{padding:s}=e,{baseTexture:o}=t;t.trim.width=t._frame.width=i.width/r,t.trim.height=t._frame.height=i.height/r,t.trim.x=-s,t.trim.y=-s,t.orig.width=t._frame.width-s*2,t.orig.height=t._frame.height-s*2,this._onTextureUpdate(),o.setRealSize(i.width,i.height,r),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var i,r,s,o,a;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},Yu.defaultDestroyOptions,e),super.destroy(e);const t=null;this.ownsStyle&&((i=this._style)==null||i.cleanFonts()),this._style=t,(r=this._svgRoot)==null||r.remove(),this._svgRoot=t,(s=this._domElement)==null||s.remove(),this._domElement=t,(o=this._foreignObject)==null||o.remove(),this._foreignObject=t,(a=this._styleElement)==null||a.remove(),this._styleElement=t,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=t,this._image.src="",this._image=t}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const t=_a(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const t=_a(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof jy?(this.ownsStyle=!1,this._style=e):e instanceof Fa?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=jy.from(e)):(this.ownsStyle=!0,this._style=new jy(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};wm.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},wm.defaultMaxWidth=2024,wm.defaultMaxHeight=2024,wm.defaultAutoResolution=!0;const ej=new lt(eu),tj=new ut(162,0,rd,100),nj=new Pe(ej,tj),ij=({x:n,y:e})=>me(Ot.Sprite,{texture:nj,x:n,y:e});function tg(n,e=0){return Math.random()*(n-e)+e}function Ol(n,e,t,i){let r=tg(t,e);if(n.length===2){const[s,o]=n;s>o?r=s+i:r=o+i}return n.push(r),r}function SR(n){sessionStorage.setItem("gameSpeed",n.toString())}function B0(){const n=sessionStorage.getItem("gameSpeed");return n===null?0:parseInt(n)}function ER(){sessionStorage.removeItem("gameSpeed")}function rj(n){localStorage.setItem("gameHighScore",n.toString())}function sj(){const n=localStorage.getItem("gameHighScore");return n===null?0:parseInt(n)}const tu=ge.createContext(void 0),Am=200,oj=({xPos:n,update:e})=>{const[t,i]=ge.useState(n),[r,s]=ge.useState([]),[o,a]=ge.useState([]),[l,u]=ge.useState(0),d=ge.useContext(tu),f=(d==null?void 0:d.store.cloudXPositions)||[],p=f.length>0?f[f.length-1]:n;return ge.useEffect(()=>{const m=setInterval(()=>{const v=B0();u(v)},100);return()=>{clearInterval(m)}},[]),ge.useEffect(()=>{const m=[],v=[],x=Array.from({length:uR},(y,g)=>{const T=Ol(m,p,p+100,rd),S=Ol(v,0,Am,rd)>Am?Am:Ol(v,0,Am,rd);if(g===uR-1){const w=m.sort((M,R)=>M-R);d&&d.dispatch({type:"UPDATE_CLOUD_X_POSITIONS",payload:w}),a(w)}return me(ij,{x:T,y:S},T)});s(x.sort((y,g)=>y.props.x-g.props.x))},[]),Ot.useTick(()=>{i(t-l)},l>0),ge.useEffect(()=>{if(o.length===0)return;t+o.at(-1)+rd>0||e()},[t]),me(Ot.Container,{position:[t,0],children:r})};let Mm;const aj=new Uint8Array(16);function lj(){if(!Mm&&(Mm=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Mm))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Mm(aj)}const ci=[];for(let n=0;n<256;++n)ci.push((n+256).toString(16).slice(1));function uj(n,e=0){return ci[n[e+0]]+ci[n[e+1]]+ci[n[e+2]]+ci[n[e+3]]+"-"+ci[n[e+4]]+ci[n[e+5]]+"-"+ci[n[e+6]]+ci[n[e+7]]+"-"+ci[n[e+8]]+ci[n[e+9]]+"-"+ci[n[e+10]]+ci[n[e+11]]+ci[n[e+12]]+ci[n[e+13]]+ci[n[e+14]]+ci[n[e+15]]}let TR,$y,Yy=0,qy=0;function bR(n,e,t){let i=e&&t||0;const r=e||new Array(16);n=n||{};let s=n.node||TR,o=n.clockseq!==void 0?n.clockseq:$y;if(s==null||o==null){const p=n.random||(n.rng||lj)();s==null&&(s=TR=[p[0]|1,p[1],p[2],p[3],p[4],p[5]]),o==null&&(o=$y=(p[6]<<8|p[7])&16383)}let a=n.msecs!==void 0?n.msecs:Date.now(),l=n.nsecs!==void 0?n.nsecs:qy+1;const u=a-Yy+(l-qy)/1e4;if(u<0&&n.clockseq===void 0&&(o=o+1&16383),(u<0||a>Yy)&&n.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Yy=a,qy=l,$y=o,a+=122192928e5;const d=((a&268435455)*1e4+l)%4294967296;r[i++]=d>>>24&255,r[i++]=d>>>16&255,r[i++]=d>>>8&255,r[i++]=d&255;const f=a/4294967296*1e4&268435455;r[i++]=f>>>8&255,r[i++]=f&255,r[i++]=f>>>24&15|16,r[i++]=f>>>16&255,r[i++]=o>>>8|128,r[i++]=o&255;for(let p=0;p<6;++p)r[i+p]=s[p];return e||uj(r)}const Ky=({componentBuilder:n,total:e,width:t,skipFirstElement:i})=>{const[r,s]=ge.useState(!1),[o,a]=ge.useState([]);return ge.useEffect(()=>{a(Array.from({length:e},(l,u)=>{let d=i?u+1:u;return n({key:bR(),xPos:t*d,update:()=>s(!0)})}))},[]),ge.useEffect(()=>{if(r){o.shift();const l=o,u=n({key:bR(),xPos:t+o.at(-1).props.xPos/2,update:()=>s(!0)});l.push(u),a(l),s(!1)}},[r]),me(ad,{children:o.map(l=>l)})},cj=({visible:n,gameSpeed:e})=>{const[t,i]=ge.useState([]),[r,s]=ge.useState(-.1);return ge.useEffect(()=>{Al.load("./walking-dino.json").then(o=>{const a=o.textures;i(Object.keys(a).map(l=>a[l]))})},[]),ge.useEffect(()=>{e%2===0&&s(r+.1)},[e]),t.length===0?null:me(Ot.Container,{visible:n,children:me(Ot.AnimatedSprite,{animationSpeed:r,isPlaying:!0,textures:t})})},hj=({visible:n})=>{const e=new lt(eu),t=new ut(1335,0,88,94),i=new Pe(e,t);return me(Ot.Container,{visible:n,children:me(Ot.Sprite,{texture:i})})},dj=({visible:n})=>{const e=new lt(eu),t=new ut(1775,0,89,94),i=new Pe(e,t);return me(Ot.Container,{visible:n,children:me(Ot.Sprite,{texture:i})})},fj=({visible:n,gameSpeed:e})=>{const[t,i]=ge.useState([]),[r,s]=ge.useState(-.1);return ge.useEffect(()=>{Al.load("./running-dino.json").then(o=>{const a=o.textures;i(Object.keys(a).map(l=>a[l]))})},[]),ge.useEffect(()=>{e%2===0&&s(r+.1)},[e]),t.length===0?null:me(Ot.Container,{visible:n,children:me(Ot.AnimatedSprite,{animationSpeed:r,isPlaying:!0,textures:t})})};let Zy=0;const pj=({gameSpeed:n,setRef:e})=>{const[t,i]=ge.useState(0),[r,s]=ge.useState(!1),[o,a]=ge.useState(230),l=ge.useRef(t),u=ge.useRef(r),d=ge.useRef(n),f=ge.useRef(null),p=ge.useContext(tu),m=(p==null?void 0:p.gameOver)||!1,v=y=>{const g=y.code;l.current===0&&((g==="Space"||g==="ArrowUp")&&!u.current?i(1):g==="ArrowDown"&&d.current>0&&s(!0))},x=y=>{y.code==="ArrowDown"&&s(!1)};return ge.useEffect(()=>{l.current=t},[t]),ge.useEffect(()=>{u.current=r},[r]),ge.useEffect(()=>{d.current=n},[n]),ge.useEffect(()=>{n===0&&(document.removeEventListener("keydown",v),document.removeEventListener("keyup",x))},[n]),ge.useEffect(()=>{f.current&&e(f.current)},[f]),ge.useEffect(()=>{document.addEventListener("keydown",v),document.addEventListener("keyup",x)},[]),ge.useEffect(()=>{t==0&&a(r?265:230)},[r,t]),Ot.useTick(()=>{if(n>0){if(t===1){const y=o-15;a(y),y<=10&&i(2)}else if(t===2){Zy+=.6;const y=o+Zy;a(y),y>=240&&(a(230),i(0),Zy=0)}}}),sn(Ot.Container,{ref:f,position:[50,o],zIndex:2,children:[me(hj,{visible:n===0||t!==0||!!m}),me(cj,{visible:n>0&&t===0&&!r,gameSpeed:n}),me(fj,{visible:r&&t===0,gameSpeed:n}),me(dj,{visible:m===!0})]})};var vo=(n=>(n[n.TYPE_0=0]="TYPE_0",n[n.TYPE_1=1]="TYPE_1",n[n.TYPE_2=2]="TYPE_2",n[n.TYPE_3=3]="TYPE_3",n))(vo||{}),Md=(n=>(n[n.SMALL=0]="SMALL",n[n.BIG=1]="BIG",n))(Md||{}),Ml=(n=>(n[n.WIDTH_35=35]="WIDTH_35",n[n.WIDTH_37=37]="WIDTH_37",n))(Ml||{}),Mc=(n=>(n[n.WIDTH_50=50]="WIDTH_50",n[n.WIDTH_104=104]="WIDTH_104",n))(Mc||{}),qu=(n=>(n[n.DEFAULT=0]="DEFAULT",n[n.START=6]="START",n))(qu||{});const mj=(n,e)=>{const t={rectX:650,rectY:0,rectW:Mc.WIDTH_50,rectH:100};return n===vo.TYPE_1?(t.rectX=750,t.rectW=Mc.WIDTH_50):n===vo.TYPE_2&&(t.rectX=847,t.rectW=Mc.WIDTH_104),e===Md.SMALL&&(t.rectX=440,t.rectW=Ml.WIDTH_37,n===vo.TYPE_1?(t.rectX=511,t.rectW=Ml.WIDTH_35):n===vo.TYPE_2?(t.rectX=580,t.rectW=Ml.WIDTH_35):n===vo.TYPE_3&&(t.rectX=613,t.rectW=Ml.WIDTH_37)),t},gj=new lt(eu),_j=({x:n,y:e,treeType:t,isSmallTree:i})=>{const r=ge.useMemo(()=>{const l=mj(t,i);return new ut(l.rectX,l.rectY,l.rectW,l.rectH)},[t,i]),s=ge.useMemo(()=>new Pe(gj,r),[r]),o=ge.useRef(null),a=ge.useContext(tu);return Ot.useTick(()=>{o.current&&a&&a.detectCollision(o.current)}),me(Ot.Sprite,{texture:s,x:n,y:e,ref:o})},vj=({xPos:n,update:e})=>{const[t]=ge.useState(Math.floor(tg(2))),[i,r]=ge.useState(n),[s,o]=ge.useState([]),[a,l]=ge.useState([]),[u,d]=ge.useState(0),f=ge.useContext(tu),p=(f==null?void 0:f.store.treeXPositions)||[],m=p.length>0?p[p.length-1]:n,v=ge.useMemo(()=>t===Md.SMALL?Math.floor(tg(4)):Math.floor(tg(3)),[]),x=ge.useMemo(()=>t===Md.SMALL?v===vo.TYPE_0||v===vo.TYPE_3?Ml.WIDTH_37:Ml.WIDTH_35:v===vo.TYPE_2?Mc.WIDTH_104:Mc.WIDTH_50,[]);return ge.useEffect(()=>{const y=setInterval(()=>{const g=B0();d(g)},100);return()=>{clearInterval(y)}},[]),ge.useEffect(()=>{const y=[],g=Array.from({length:cR},(T,S)=>{const w=Ol(y,m||100,m+100,x);if(S===cR-1){const M=y.sort((R,P)=>R-P);f&&f.dispatch({type:"UPDATE_TREE_X_POSITIONS",payload:M}),l(M)}return me(_j,{x:w,y:t===Md.SMALL?250:225,treeType:v,isSmallTree:t},w)});o(g.sort((T,S)=>T.props.x-S.props.x))},[]),Ot.useTick(()=>{r(i-u*2)},u>0),ge.useEffect(()=>{if(a.length===0)return;i+a.at(-1)+x>0||e()},[i]),me(Ot.Container,{position:[i,0],children:s})},yj=(n,e)=>{switch(e.type){case"UPDATE_CLOUD_X_POSITIONS":return{...n,cloudXPositions:e.payload};case"UPDATE_TREE_X_POSITIONS":return{...n,treeXPositions:e.payload};case"UPDATE_BIRD_X_POSITIONS":return{...n,birdXPositions:e.payload};default:return n}},xj={cloudXPositions:[],treeXPositions:[],birdXPositions:[]},Sj=()=>{const[n,e]=ge.useReducer(yj,xj);return{state:n,dispatch:e}},Ej=({restartGame:n})=>{const[e,t]=ge.useState(0),[i,r]=ge.useState(null),[s,o]=ge.useState(!1),[a,l]=ge.useState(0),[u]=ge.useState(sj()),d=Sj(),{state:f,dispatch:p}=d,m=({key:S,xPos:w,update:M})=>me(oj,{xPos:w,update:M},S),v=({key:S,xPos:w,update:M})=>me(vj,{xPos:w,update:M},S),x=({key:S,xPos:w,update:M})=>me(Aj,{xPos:w,update:M},S),y=ge.useCallback(S=>{if(S&&i){const w=S.getBounds(),M=i.getBounds();w.x<M.x+M.width&&w.x+w.width>M.x&&w.y<M.y+M.height-30&&w.y+w.height-30>M.y&&(t(qu.DEFAULT),ER(),o(!0))}},[i]),g=S=>{const w=S.code;(w==="Space"||w==="ArrowUp")&&(s?T():(t(qu.START),SR(qu.START)))},T=()=>{document.removeEventListener("keydown",g),n()};return ge.useEffect(()=>{B0()>qu.DEFAULT&&ER(),document.addEventListener("keydown",g),s&&a>u&&rj(a)},[s]),ge.useEffect(()=>{if(a>0&&a%200===0){const S=e+1;t(S),SR(S)}},[a]),ge.useEffect(()=>{let S;return e>qu.DEFAULT&&!s&&(S=setInterval(()=>{const w=a+1;l(w)},100)),()=>{clearInterval(S)}},[e,s,a]),sn(Ot.Stage,{width:OE,height:400,options:{antialias:!0,background:"#ffffff"},children:[me(Ot.Container,{sortableChildren:!0,children:sn(tu.Provider,{value:{detectCollision:y,gameOver:s,store:f,dispatch:p},children:[a>=100&&me(Ky,{componentBuilder:x,total:2,width:xl,skipFirstElement:!0}),me(Ky,{componentBuilder:m,total:3,width:xl}),me(pj,{gameSpeed:e,setRef:r}),me(Ky,{componentBuilder:v,total:2,width:xl/2,skipFirstElement:!0}),me(LW,{gameSpeed:e})]})}),sn(Ot.Container,{children:[me(Ot.Text,{text:`Score: ${a}`,x:xl/4,y:370}),me(Ot.Text,{text:`Highest Score: ${u}`,x:xl,y:370})]}),sn(Ot.Container,{visible:s,children:[me(Tj,{}),me(bj,{restartGame:T})]})]})},Tj=({})=>{const e=new lt(eu),t=new ut(950,25,385,30),i=new Pe(e,t);return me(Ot.Container,{position:[xl-385/2,0],children:me(Ot.Sprite,{texture:i})})},bj=({restartGame:n})=>{const t=new lt(eu),i=new ut(0,0,70,65),r=new Pe(t,i);return me(Ot.Container,{position:[xl-70/2,50],children:me(Ot.Sprite,{interactive:!0,texture:r,cursor:"pointer",onclick:n})})},wj=({x:n,y:e,gameSpeed:t})=>{const[i,r]=ge.useState([]),[s,o]=ge.useState(-.15);ge.useEffect(()=>{Al.load("./flying-bird.json").then(u=>{const d=u.textures;r(Object.keys(d).map(f=>d[f]))})},[]);const a=ge.useRef(null),l=ge.useContext(tu);return Ot.useTick(()=>{a.current&&l&&l.detectCollision(a.current)}),ge.useEffect(()=>{l&&l.gameOver&&o(0)},[l]),i.length===0?null:me(Ot.AnimatedSprite,{animationSpeed:s,isPlaying:!0,textures:i,position:[n,e],ref:a})},Cm=250,Aj=({xPos:n,update:e})=>{const[t,i]=ge.useState(n),[r,s]=ge.useState([]),[o,a]=ge.useState([]),[l,u]=ge.useState(0),d=ge.useContext(tu),f=(d==null?void 0:d.store.birdXPositions)||[],p=f.length>0?f[f.length-1]:n;return ge.useEffect(()=>{const m=setInterval(()=>{const v=B0();u(v)},100);return()=>{clearInterval(m)}},[]),ge.useEffect(()=>{const m=[],v=[],x=Array.from({length:hR},(y,g)=>{const T=Ol(m,p,p+100,ym),S=Ol(v,0,Cm,ym)>Cm?Cm:Ol(v,0,Cm,ym);if(g===hR-1){const w=m.sort((M,R)=>M-R);d&&d.dispatch({type:"UPDATE_BIRD_X_POSITIONS",payload:w}),a(w)}return me(wj,{x:T,y:S,gameSpeed:l},T)});s(x.sort((y,g)=>y.props.x-g.props.x))},[]),Ot.useTick(()=>{i(t-l*3)},l>0),ge.useEffect(()=>{if(o.length===0)return;t+o.at(-1)+ym>0||e()},[t]),me(Ot.Container,{position:[t,0],children:r})},Mj=()=>{const[n,e]=ge.useState(!1);return sn("div",{className:"page w-full flex flex-col items-center",children:[me("p",{children:"Hack the Burgh X"}),me("p",{children:"2-3rd March | Edinburgh, The Nucleus Building"}),sn("div",{className:"flex gap-2",children:[me("a",{target:"_blank",href:"https://google.com",children:"Register"}),me("a",{target:"_blank",href:"https://google.com",children:"Join the team"})]}),me(Ej,{restartGame:()=>e(!0)})]})},Cj=()=>sn("div",{className:"page",children:[me("h1",{className:"title",children:"Here are some of our previous standouts:"}),sn("ul",{className:"past-projects",children:[me("li",{children:sn("div",{className:"project",children:[me("div",{className:"project-img",children:me("img",{src:"./src/assets/past-project-imgs/pixeleconomy.png",alt:"Pixel Economy",className:"project-img"})}),sn("div",{className:"project-text",children:[me("h2",{className:"project-title",children:me("a",{href:"https://devpost.com/software/pixeleconomy",children:"Pixel Economy"})}),sn("p",{children:["PixelEconomy is an online, virtual marketplace for creating, selling and buying pixel art that makes learning the fundamentals of trading fun and accessible.",me("br",{}),"Best of Show in 2020."]})]})]})}),me("li",{children:sn("div",{className:"project",children:[me("div",{className:"project-img",children:me("img",{src:"./src/assets/past-project-imgs/edna.png",alt:"Edna",className:"project-img"})}),sn("div",{className:"project-text",children:[me("h2",{className:"project-title",children:me("a",{href:"https://devpost.com/software/edna-a-writing-chat-bot",children:"Edna"})}),sn("p",{children:["Writing is hard! Having no one to talk to about it makes it harder. Worry no more, Edna is here to listen to your writing woes.",me("br",{}),"Runner-Up in 2020."]})]})]})}),me("li",{children:sn("div",{className:"project",children:[me("div",{className:"project-img",children:me("img",{src:"./src/assets/past-project-imgs/bread.png",alt:"Is it bread?",className:"project-img"})}),sn("div",{className:"project-text",children:[me("h2",{className:"project-title",children:me("a",{href:"https://devpost.com/software/is-it-bread",children:"Is it bread?"})}),me("p",{children:'Have you ever looked at an item and thought, "Is that bread?". Can you really trust yourself to make that judgement? Fear not, we have an intelligent app to decide that for you.'})]})]})}),me("li",{children:sn("div",{className:"project",children:[me("div",{className:"project-img",children:me("img",{src:"./src/assets/past-project-imgs/minepi.png",alt:"MinePi",className:"project-img"})}),sn("div",{className:"project-text",children:[me("h2",{className:"project-title",children:me("a",{href:"https://devpost.com/software/minepi.png",children:"MinePi"})}),sn("p",{children:["A mod to let you control your Raspberry pi from Minecraft.",me("br",{}),"Runner-Up for best hardware hack in 2020."]})]})]})})]})]}),Rj=()=>me("div",{className:"page",children:"This is the FAQ page"});function Pj(){const[n,e]=ge.useState(!0),[t,i]=ge.useState("Home");return ge.useEffect(()=>{const r=window.innerHeight*.01,s=window.innerWidth*.01;document.documentElement.style.setProperty("--vh",`${r}px`),document.documentElement.style.setProperty("--vw",`${s}px`)},[]),me("div",{className:"App",children:n?me(S6,{setInScene:e}):me(ad,{children:sn(b6,{children:[me(T6,{page:t,setPage:i,setInScene:e}),t==="Home"?me(ad,{children:me(Mj,{})}):t==="Past Projects"?me(Cj,{}):t==="Information"?me(Rj,{}):me(ad,{children:" Error Page Not Found"})]})})})}Qy.createRoot(document.getElementById("root")).render(me(Bs.StrictMode,{children:me(Pj,{})}))});export default Ij();
