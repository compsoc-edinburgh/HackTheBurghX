var lD=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var Vj=lD((qj,T0)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var Rm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function t0(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function AR(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),t}var MR={exports:{}},n0={},CR={exports:{}},Nt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nf=Symbol.for("react.element"),uD=Symbol.for("react.portal"),cD=Symbol.for("react.fragment"),hD=Symbol.for("react.strict_mode"),dD=Symbol.for("react.profiler"),fD=Symbol.for("react.provider"),pD=Symbol.for("react.context"),mD=Symbol.for("react.forward_ref"),gD=Symbol.for("react.suspense"),_D=Symbol.for("react.memo"),vD=Symbol.for("react.lazy"),xb=Symbol.iterator;function yD(n){return n===null||typeof n!="object"?null:(n=xb&&n[xb]||n["@@iterator"],typeof n=="function"?n:null)}var RR={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},PR=Object.assign,IR={};function Kc(n,e,t){this.props=n,this.context=e,this.refs=IR,this.updater=t||RR}Kc.prototype.isReactComponent={};Kc.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Kc.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function LR(){}LR.prototype=Kc.prototype;function lS(n,e,t){this.props=n,this.context=e,this.refs=IR,this.updater=t||RR}var uS=lS.prototype=new LR;uS.constructor=lS;PR(uS,Kc.prototype);uS.isPureReactComponent=!0;var Sb=Array.isArray,DR=Object.prototype.hasOwnProperty,cS={current:null},NR={key:!0,ref:!0,__self:!0,__source:!0};function UR(n,e,t){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)DR.call(e,i)&&!NR.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:nf,type:n,key:s,ref:o,props:r,_owner:cS.current}}function xD(n,e){return{$$typeof:nf,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function hS(n){return typeof n=="object"&&n!==null&&n.$$typeof===nf}function SD(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Eb=/\/+/g;function K_(n,e){return typeof n=="object"&&n!==null&&n.key!=null?SD(""+n.key):e.toString(36)}function Pm(n,e,t,i,r){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case nf:case uD:o=!0}}if(o)return o=n,r=r(o),n=i===""?"."+K_(o,0):i,Sb(r)?(t="",n!=null&&(t=n.replace(Eb,"$&/")+"/"),Pm(r,e,t,"",function(u){return u})):r!=null&&(hS(r)&&(r=xD(r,t+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(Eb,"$&/")+"/")+n)),e.push(r)),1;if(o=0,i=i===""?".":i+":",Sb(n))for(var a=0;a<n.length;a++){s=n[a];var l=i+K_(s,a);o+=Pm(s,e,t,l,r)}else if(l=yD(n),typeof l=="function")for(n=l.call(n),a=0;!(s=n.next()).done;)s=s.value,l=i+K_(s,a++),o+=Pm(s,e,t,l,r);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function sp(n,e,t){if(n==null)return n;var i=[],r=0;return Pm(n,i,"","",function(s){return e.call(t,s,r++)}),i}function ED(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var ki={current:null},Im={transition:null},TD={ReactCurrentDispatcher:ki,ReactCurrentBatchConfig:Im,ReactCurrentOwner:cS};Nt.Children={map:sp,forEach:function(n,e,t){sp(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return sp(n,function(){e++}),e},toArray:function(n){return sp(n,function(e){return e})||[]},only:function(n){if(!hS(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Nt.Component=Kc;Nt.Fragment=cD;Nt.Profiler=dD;Nt.PureComponent=lS;Nt.StrictMode=hD;Nt.Suspense=gD;Nt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TD;Nt.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=PR({},n.props),r=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=cS.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)DR.call(e,l)&&!NR.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:nf,type:n.type,key:r,ref:s,props:i,_owner:o}};Nt.createContext=function(n){return n={$$typeof:pD,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:fD,_context:n},n.Consumer=n};Nt.createElement=UR;Nt.createFactory=function(n){var e=UR.bind(null,n);return e.type=n,e};Nt.createRef=function(){return{current:null}};Nt.forwardRef=function(n){return{$$typeof:mD,render:n}};Nt.isValidElement=hS;Nt.lazy=function(n){return{$$typeof:vD,_payload:{_status:-1,_result:n},_init:ED}};Nt.memo=function(n,e){return{$$typeof:_D,type:n,compare:e===void 0?null:e}};Nt.startTransition=function(n){var e=Im.transition;Im.transition={};try{n()}finally{Im.transition=e}};Nt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Nt.useCallback=function(n,e){return ki.current.useCallback(n,e)};Nt.useContext=function(n){return ki.current.useContext(n)};Nt.useDebugValue=function(){};Nt.useDeferredValue=function(n){return ki.current.useDeferredValue(n)};Nt.useEffect=function(n,e){return ki.current.useEffect(n,e)};Nt.useId=function(){return ki.current.useId()};Nt.useImperativeHandle=function(n,e,t){return ki.current.useImperativeHandle(n,e,t)};Nt.useInsertionEffect=function(n,e){return ki.current.useInsertionEffect(n,e)};Nt.useLayoutEffect=function(n,e){return ki.current.useLayoutEffect(n,e)};Nt.useMemo=function(n,e){return ki.current.useMemo(n,e)};Nt.useReducer=function(n,e,t){return ki.current.useReducer(n,e,t)};Nt.useRef=function(n){return ki.current.useRef(n)};Nt.useState=function(n){return ki.current.useState(n)};Nt.useSyncExternalStore=function(n,e,t){return ki.current.useSyncExternalStore(n,e,t)};Nt.useTransition=function(){return ki.current.useTransition()};Nt.version="18.2.0";CR.exports=Nt;var me=CR.exports;const ks=t0(me);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bD=me,wD=Symbol.for("react.element"),AD=Symbol.for("react.fragment"),MD=Object.prototype.hasOwnProperty,CD=bD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,RD={key:!0,ref:!0,__self:!0,__source:!0};function FR(n,e,t){var i,r={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)MD.call(e,i)&&!RD.hasOwnProperty(i)&&(r[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:wD,type:n,key:s,ref:o,props:r,_owner:CD.current}}n0.Fragment=AD;n0.jsx=FR;n0.jsxs=FR;MR.exports=n0;var dS=MR.exports;const dc=dS.Fragment,ie=dS.jsx,Et=dS.jsxs;var Qy={},OR={exports:{}},dr={},kR={exports:{}},BR={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(O,G){var k=O.length;O.push(G);e:for(;0<k;){var H=k-1>>>1,te=O[H];if(0<r(te,G))O[H]=G,O[k]=te,k=H;else break e}}function t(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var G=O[0],k=O.pop();if(k!==G){O[0]=k;e:for(var H=0,te=O.length,ee=te>>>1;H<ee;){var re=2*(H+1)-1,ge=O[re],ve=re+1,Me=O[ve];if(0>r(ge,k))ve<te&&0>r(Me,ge)?(O[H]=Me,O[ve]=k,H=ve):(O[H]=ge,O[re]=k,H=re);else if(ve<te&&0>r(Me,k))O[H]=Me,O[ve]=k,H=ve;else break e}}return G}function r(O,G){var k=O.sortIndex-G.sortIndex;return k!==0?k:O.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,f=null,p=3,m=!1,v=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(O){for(var G=t(u);G!==null;){if(G.callback===null)i(u);else if(G.startTime<=O)i(u),G.sortIndex=G.expirationTime,e(l,G);else break;G=t(u)}}function w(O){if(x=!1,S(O),!v)if(t(l)!==null)v=!0,Q(M);else{var G=t(u);G!==null&&$(w,G.startTime-O)}}function M(O,G){v=!1,x&&(x=!1,g(D),D=-1),m=!0;var k=p;try{for(S(G),f=t(l);f!==null&&(!(f.expirationTime>G)||O&&!Z());){var H=f.callback;if(typeof H=="function"){f.callback=null,p=f.priorityLevel;var te=H(f.expirationTime<=G);G=n.unstable_now(),typeof te=="function"?f.callback=te:f===t(l)&&i(l),S(G)}else i(l);f=t(l)}if(f!==null)var ee=!0;else{var re=t(u);re!==null&&$(w,re.startTime-G),ee=!1}return ee}finally{f=null,p=k,m=!1}}var P=!1,R=null,D=-1,C=5,L=-1;function Z(){return!(n.unstable_now()-L<C)}function V(){if(R!==null){var O=n.unstable_now();L=O;var G=!0;try{G=R(!0,O)}finally{G?z():(P=!1,R=null)}}else P=!1}var z;if(typeof T=="function")z=function(){T(V)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,j=F.port2;F.port1.onmessage=V,z=function(){j.postMessage(null)}}else z=function(){y(V,0)};function Q(O){R=O,P||(P=!0,z())}function $(O,G){D=y(function(){O(n.unstable_now())},G)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(O){O.callback=null},n.unstable_continueExecution=function(){v||m||(v=!0,Q(M))},n.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<O?Math.floor(1e3/O):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(O){switch(p){case 1:case 2:case 3:var G=3;break;default:G=p}var k=p;p=G;try{return O()}finally{p=k}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(O,G){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var k=p;p=O;try{return G()}finally{p=k}},n.unstable_scheduleCallback=function(O,G,k){var H=n.unstable_now();switch(typeof k=="object"&&k!==null?(k=k.delay,k=typeof k=="number"&&0<k?H+k:H):k=H,O){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=k+te,O={id:d++,callback:G,priorityLevel:O,startTime:k,expirationTime:te,sortIndex:-1},k>H?(O.sortIndex=k,e(u,O),t(l)===null&&O===t(u)&&(x?(g(D),D=-1):x=!0,$(w,k-H))):(O.sortIndex=te,e(l,O),v||m||(v=!0,Q(M))),O},n.unstable_shouldYield=Z,n.unstable_wrapCallback=function(O){var G=p;return function(){var k=p;p=G;try{return O.apply(this,arguments)}finally{p=k}}}})(BR);kR.exports=BR;var PD=kR.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zR=me,cr=PD;function xe(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var GR=new Set,Cd={};function ql(n,e){Rc(n,e),Rc(n+"Capture",e)}function Rc(n,e){for(Cd[n]=e,n=0;n<e.length;n++)GR.add(e[n])}var Po=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jy=Object.prototype.hasOwnProperty,ID=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Tb={},bb={};function LD(n){return Jy.call(bb,n)?!0:Jy.call(Tb,n)?!1:ID.test(n)?bb[n]=!0:(Tb[n]=!0,!1)}function DD(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function ND(n,e,t,i){if(e===null||typeof e>"u"||DD(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Bi(n,e,t,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var pi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){pi[n]=new Bi(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];pi[e]=new Bi(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){pi[n]=new Bi(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){pi[n]=new Bi(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){pi[n]=new Bi(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){pi[n]=new Bi(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){pi[n]=new Bi(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){pi[n]=new Bi(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){pi[n]=new Bi(n,5,!1,n.toLowerCase(),null,!1,!1)});var fS=/[\-:]([a-z])/g;function pS(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(fS,pS);pi[e]=new Bi(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(fS,pS);pi[e]=new Bi(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(fS,pS);pi[e]=new Bi(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){pi[n]=new Bi(n,1,!1,n.toLowerCase(),null,!1,!1)});pi.xlinkHref=new Bi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){pi[n]=new Bi(n,1,!1,n.toLowerCase(),null,!0,!0)});function mS(n,e,t,i){var r=pi.hasOwnProperty(e)?pi[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(ND(e,t,r,i)&&(t=null),i||r===null?LD(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,i=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var Oo=zR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,op=Symbol.for("react.element"),Ku=Symbol.for("react.portal"),Zu=Symbol.for("react.fragment"),gS=Symbol.for("react.strict_mode"),ex=Symbol.for("react.profiler"),HR=Symbol.for("react.provider"),VR=Symbol.for("react.context"),_S=Symbol.for("react.forward_ref"),tx=Symbol.for("react.suspense"),nx=Symbol.for("react.suspense_list"),vS=Symbol.for("react.memo"),sa=Symbol.for("react.lazy"),WR=Symbol.for("react.offscreen"),wb=Symbol.iterator;function Ah(n){return n===null||typeof n!="object"?null:(n=wb&&n[wb]||n["@@iterator"],typeof n=="function"?n:null)}var yn=Object.assign,Z_;function Yh(n){if(Z_===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Z_=e&&e[1]||""}return`
`+Z_+n}var Q_=!1;function J_(n,e){if(!n||Q_)return"";Q_=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){i=u}n.call(e.prototype)}else{try{throw Error()}catch(u){i=u}n()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{Q_=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Yh(n):""}function UD(n){switch(n.tag){case 5:return Yh(n.type);case 16:return Yh("Lazy");case 13:return Yh("Suspense");case 19:return Yh("SuspenseList");case 0:case 2:case 15:return n=J_(n.type,!1),n;case 11:return n=J_(n.type.render,!1),n;case 1:return n=J_(n.type,!0),n;default:return""}}function ix(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Zu:return"Fragment";case Ku:return"Portal";case ex:return"Profiler";case gS:return"StrictMode";case tx:return"Suspense";case nx:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case VR:return(n.displayName||"Context")+".Consumer";case HR:return(n._context.displayName||"Context")+".Provider";case _S:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case vS:return e=n.displayName||null,e!==null?e:ix(n.type)||"Memo";case sa:e=n._payload,n=n._init;try{return ix(n(e))}catch{}}return null}function FD(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ix(e);case 8:return e===gS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ia(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function XR(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function OD(n){var e=XR(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function ap(n){n._valueTracker||(n._valueTracker=OD(n))}function jR(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=XR(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function ng(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function rx(n,e){var t=e.checked;return yn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function Ab(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=Ia(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function $R(n,e){e=e.checked,e!=null&&mS(n,"checked",e,!1)}function sx(n,e){$R(n,e);var t=Ia(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?ox(n,e.type,t):e.hasOwnProperty("defaultValue")&&ox(n,e.type,Ia(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Mb(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function ox(n,e,t){(e!=="number"||ng(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var qh=Array.isArray;function fc(n,e,t,i){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&i&&(n[t].defaultSelected=!0)}else{for(t=""+Ia(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,i&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function ax(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(xe(91));return yn({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Cb(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(xe(92));if(qh(t)){if(1<t.length)throw Error(xe(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Ia(t)}}function YR(n,e){var t=Ia(e.value),i=Ia(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function Rb(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function qR(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lx(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?qR(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var lp,KR=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(lp=lp||document.createElement("div"),lp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=lp.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Rd(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var ld={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kD=["Webkit","ms","Moz","O"];Object.keys(ld).forEach(function(n){kD.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),ld[e]=ld[n]})});function ZR(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||ld.hasOwnProperty(n)&&ld[n]?(""+e).trim():e+"px"}function QR(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,r=ZR(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,r):n[t]=r}}var BD=yn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ux(n,e){if(e){if(BD[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(xe(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(xe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(xe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(xe(62))}}function cx(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hx=null;function yS(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var dx=null,pc=null,mc=null;function Pb(n){if(n=of(n)){if(typeof dx!="function")throw Error(xe(280));var e=n.stateNode;e&&(e=a0(e),dx(n.stateNode,n.type,e))}}function JR(n){pc?mc?mc.push(n):mc=[n]:pc=n}function e2(){if(pc){var n=pc,e=mc;if(mc=pc=null,Pb(n),e)for(n=0;n<e.length;n++)Pb(e[n])}}function t2(n,e){return n(e)}function n2(){}var ev=!1;function i2(n,e,t){if(ev)return n(e,t);ev=!0;try{return t2(n,e,t)}finally{ev=!1,(pc!==null||mc!==null)&&(n2(),e2())}}function Pd(n,e){var t=n.stateNode;if(t===null)return null;var i=a0(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(xe(231,e,typeof t));return t}var fx=!1;if(Po)try{var Mh={};Object.defineProperty(Mh,"passive",{get:function(){fx=!0}}),window.addEventListener("test",Mh,Mh),window.removeEventListener("test",Mh,Mh)}catch{fx=!1}function zD(n,e,t,i,r,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(d){this.onError(d)}}var ud=!1,ig=null,rg=!1,px=null,GD={onError:function(n){ud=!0,ig=n}};function HD(n,e,t,i,r,s,o,a,l){ud=!1,ig=null,zD.apply(GD,arguments)}function VD(n,e,t,i,r,s,o,a,l){if(HD.apply(this,arguments),ud){if(ud){var u=ig;ud=!1,ig=null}else throw Error(xe(198));rg||(rg=!0,px=u)}}function Kl(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function r2(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Ib(n){if(Kl(n)!==n)throw Error(xe(188))}function WD(n){var e=n.alternate;if(!e){if(e=Kl(n),e===null)throw Error(xe(188));return e!==n?null:n}for(var t=n,i=e;;){var r=t.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){t=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===t)return Ib(r),n;if(s===i)return Ib(r),e;s=s.sibling}throw Error(xe(188))}if(t.return!==i.return)t=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===t){o=!0,t=r,i=s;break}if(a===i){o=!0,i=r,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,i=r;break}if(a===i){o=!0,i=s,t=r;break}a=a.sibling}if(!o)throw Error(xe(189))}}if(t.alternate!==i)throw Error(xe(190))}if(t.tag!==3)throw Error(xe(188));return t.stateNode.current===t?n:e}function s2(n){return n=WD(n),n!==null?o2(n):null}function o2(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=o2(n);if(e!==null)return e;n=n.sibling}return null}var a2=cr.unstable_scheduleCallback,Lb=cr.unstable_cancelCallback,XD=cr.unstable_shouldYield,jD=cr.unstable_requestPaint,Rn=cr.unstable_now,$D=cr.unstable_getCurrentPriorityLevel,xS=cr.unstable_ImmediatePriority,l2=cr.unstable_UserBlockingPriority,sg=cr.unstable_NormalPriority,YD=cr.unstable_LowPriority,u2=cr.unstable_IdlePriority,i0=null,Bs=null;function qD(n){if(Bs&&typeof Bs.onCommitFiberRoot=="function")try{Bs.onCommitFiberRoot(i0,n,void 0,(n.current.flags&128)===128)}catch{}}var ss=Math.clz32?Math.clz32:QD,KD=Math.log,ZD=Math.LN2;function QD(n){return n>>>=0,n===0?32:31-(KD(n)/ZD|0)|0}var up=64,cp=4194304;function Kh(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function og(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,r=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~r;a!==0?i=Kh(a):(s&=o,s!==0&&(i=Kh(s)))}else o=t&~r,o!==0?i=Kh(o):s!==0&&(i=Kh(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-ss(e),r=1<<t,i|=n[t],e&=~r;return i}function JD(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function eN(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,r=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-ss(s),a=1<<o,l=r[o];l===-1?(!(a&t)||a&i)&&(r[o]=JD(a,e)):l<=e&&(n.expiredLanes|=a),s&=~a}}function mx(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function c2(){var n=up;return up<<=1,!(up&4194240)&&(up=64),n}function tv(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function rf(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-ss(e),n[e]=t}function tN(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-ss(t),s=1<<r;e[r]=0,i[r]=-1,n[r]=-1,t&=~s}}function SS(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-ss(t),r=1<<i;r&e|n[i]&e&&(n[i]|=e),t&=~r}}var Yt=0;function h2(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var d2,ES,f2,p2,m2,gx=!1,hp=[],ya=null,xa=null,Sa=null,Id=new Map,Ld=new Map,ca=[],nN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Db(n,e){switch(n){case"focusin":case"focusout":ya=null;break;case"dragenter":case"dragleave":xa=null;break;case"mouseover":case"mouseout":Sa=null;break;case"pointerover":case"pointerout":Id.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ld.delete(e.pointerId)}}function Ch(n,e,t,i,r,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=of(e),e!==null&&ES(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function iN(n,e,t,i,r){switch(e){case"focusin":return ya=Ch(ya,n,e,t,i,r),!0;case"dragenter":return xa=Ch(xa,n,e,t,i,r),!0;case"mouseover":return Sa=Ch(Sa,n,e,t,i,r),!0;case"pointerover":var s=r.pointerId;return Id.set(s,Ch(Id.get(s)||null,n,e,t,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Ld.set(s,Ch(Ld.get(s)||null,n,e,t,i,r)),!0}return!1}function g2(n){var e=Sl(n.target);if(e!==null){var t=Kl(e);if(t!==null){if(e=t.tag,e===13){if(e=r2(t),e!==null){n.blockedOn=e,m2(n.priority,function(){f2(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Lm(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=_x(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);hx=i,t.target.dispatchEvent(i),hx=null}else return e=of(t),e!==null&&ES(e),n.blockedOn=t,!1;e.shift()}return!0}function Nb(n,e,t){Lm(n)&&t.delete(e)}function rN(){gx=!1,ya!==null&&Lm(ya)&&(ya=null),xa!==null&&Lm(xa)&&(xa=null),Sa!==null&&Lm(Sa)&&(Sa=null),Id.forEach(Nb),Ld.forEach(Nb)}function Rh(n,e){n.blockedOn===e&&(n.blockedOn=null,gx||(gx=!0,cr.unstable_scheduleCallback(cr.unstable_NormalPriority,rN)))}function Dd(n){function e(r){return Rh(r,n)}if(0<hp.length){Rh(hp[0],n);for(var t=1;t<hp.length;t++){var i=hp[t];i.blockedOn===n&&(i.blockedOn=null)}}for(ya!==null&&Rh(ya,n),xa!==null&&Rh(xa,n),Sa!==null&&Rh(Sa,n),Id.forEach(e),Ld.forEach(e),t=0;t<ca.length;t++)i=ca[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<ca.length&&(t=ca[0],t.blockedOn===null);)g2(t),t.blockedOn===null&&ca.shift()}var gc=Oo.ReactCurrentBatchConfig,ag=!0;function sN(n,e,t,i){var r=Yt,s=gc.transition;gc.transition=null;try{Yt=1,TS(n,e,t,i)}finally{Yt=r,gc.transition=s}}function oN(n,e,t,i){var r=Yt,s=gc.transition;gc.transition=null;try{Yt=4,TS(n,e,t,i)}finally{Yt=r,gc.transition=s}}function TS(n,e,t,i){if(ag){var r=_x(n,e,t,i);if(r===null)hv(n,e,i,lg,t),Db(n,i);else if(iN(r,n,e,t,i))i.stopPropagation();else if(Db(n,i),e&4&&-1<nN.indexOf(n)){for(;r!==null;){var s=of(r);if(s!==null&&d2(s),s=_x(n,e,t,i),s===null&&hv(n,e,i,lg,t),s===r)break;r=s}r!==null&&i.stopPropagation()}else hv(n,e,i,null,t)}}var lg=null;function _x(n,e,t,i){if(lg=null,n=yS(i),n=Sl(n),n!==null)if(e=Kl(n),e===null)n=null;else if(t=e.tag,t===13){if(n=r2(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return lg=n,null}function _2(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($D()){case xS:return 1;case l2:return 4;case sg:case YD:return 16;case u2:return 536870912;default:return 16}default:return 16}}var fa=null,bS=null,Dm=null;function v2(){if(Dm)return Dm;var n,e=bS,t=e.length,i,r="value"in fa?fa.value:fa.textContent,s=r.length;for(n=0;n<t&&e[n]===r[n];n++);var o=t-n;for(i=1;i<=o&&e[t-i]===r[s-i];i++);return Dm=r.slice(n,1<i?1-i:void 0)}function Nm(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function dp(){return!0}function Ub(){return!1}function fr(n){function e(t,i,r,s,o){this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?dp:Ub,this.isPropagationStopped=Ub,this}return yn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=dp)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=dp)},persist:function(){},isPersistent:dp}),e}var Zc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wS=fr(Zc),sf=yn({},Zc,{view:0,detail:0}),aN=fr(sf),nv,iv,Ph,r0=yn({},sf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:AS,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ph&&(Ph&&n.type==="mousemove"?(nv=n.screenX-Ph.screenX,iv=n.screenY-Ph.screenY):iv=nv=0,Ph=n),nv)},movementY:function(n){return"movementY"in n?n.movementY:iv}}),Fb=fr(r0),lN=yn({},r0,{dataTransfer:0}),uN=fr(lN),cN=yn({},sf,{relatedTarget:0}),rv=fr(cN),hN=yn({},Zc,{animationName:0,elapsedTime:0,pseudoElement:0}),dN=fr(hN),fN=yn({},Zc,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),pN=fr(fN),mN=yn({},Zc,{data:0}),Ob=fr(mN),gN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_N={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yN(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=vN[n])?!!e[n]:!1}function AS(){return yN}var xN=yn({},sf,{key:function(n){if(n.key){var e=gN[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Nm(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?_N[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:AS,charCode:function(n){return n.type==="keypress"?Nm(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Nm(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),SN=fr(xN),EN=yn({},r0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kb=fr(EN),TN=yn({},sf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:AS}),bN=fr(TN),wN=yn({},Zc,{propertyName:0,elapsedTime:0,pseudoElement:0}),AN=fr(wN),MN=yn({},r0,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),CN=fr(MN),RN=[9,13,27,32],MS=Po&&"CompositionEvent"in window,cd=null;Po&&"documentMode"in document&&(cd=document.documentMode);var PN=Po&&"TextEvent"in window&&!cd,y2=Po&&(!MS||cd&&8<cd&&11>=cd),Bb=String.fromCharCode(32),zb=!1;function x2(n,e){switch(n){case"keyup":return RN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function S2(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Qu=!1;function IN(n,e){switch(n){case"compositionend":return S2(e);case"keypress":return e.which!==32?null:(zb=!0,Bb);case"textInput":return n=e.data,n===Bb&&zb?null:n;default:return null}}function LN(n,e){if(Qu)return n==="compositionend"||!MS&&x2(n,e)?(n=v2(),Dm=bS=fa=null,Qu=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return y2&&e.locale!=="ko"?null:e.data;default:return null}}var DN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gb(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!DN[n.type]:e==="textarea"}function E2(n,e,t,i){JR(i),e=ug(e,"onChange"),0<e.length&&(t=new wS("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var hd=null,Nd=null;function NN(n){D2(n,0)}function s0(n){var e=tc(n);if(jR(e))return n}function UN(n,e){if(n==="change")return e}var T2=!1;if(Po){var sv;if(Po){var ov="oninput"in document;if(!ov){var Hb=document.createElement("div");Hb.setAttribute("oninput","return;"),ov=typeof Hb.oninput=="function"}sv=ov}else sv=!1;T2=sv&&(!document.documentMode||9<document.documentMode)}function Vb(){hd&&(hd.detachEvent("onpropertychange",b2),Nd=hd=null)}function b2(n){if(n.propertyName==="value"&&s0(Nd)){var e=[];E2(e,Nd,n,yS(n)),i2(NN,e)}}function FN(n,e,t){n==="focusin"?(Vb(),hd=e,Nd=t,hd.attachEvent("onpropertychange",b2)):n==="focusout"&&Vb()}function ON(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return s0(Nd)}function kN(n,e){if(n==="click")return s0(e)}function BN(n,e){if(n==="input"||n==="change")return s0(e)}function zN(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var cs=typeof Object.is=="function"?Object.is:zN;function Ud(n,e){if(cs(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var r=t[i];if(!Jy.call(e,r)||!cs(n[r],e[r]))return!1}return!0}function Wb(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Xb(n,e){var t=Wb(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Wb(t)}}function w2(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?w2(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function A2(){for(var n=window,e=ng();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=ng(n.document)}return e}function CS(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function GN(n){var e=A2(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&w2(t.ownerDocument.documentElement,t)){if(i!==null&&CS(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!n.extend&&s>i&&(r=i,i=s,s=r),r=Xb(t,s);var o=Xb(t,i);r&&o&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),s>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var HN=Po&&"documentMode"in document&&11>=document.documentMode,Ju=null,vx=null,dd=null,yx=!1;function jb(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;yx||Ju==null||Ju!==ng(i)||(i=Ju,"selectionStart"in i&&CS(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),dd&&Ud(dd,i)||(dd=i,i=ug(vx,"onSelect"),0<i.length&&(e=new wS("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=Ju)))}function fp(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var ec={animationend:fp("Animation","AnimationEnd"),animationiteration:fp("Animation","AnimationIteration"),animationstart:fp("Animation","AnimationStart"),transitionend:fp("Transition","TransitionEnd")},av={},M2={};Po&&(M2=document.createElement("div").style,"AnimationEvent"in window||(delete ec.animationend.animation,delete ec.animationiteration.animation,delete ec.animationstart.animation),"TransitionEvent"in window||delete ec.transitionend.transition);function o0(n){if(av[n])return av[n];if(!ec[n])return n;var e=ec[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in M2)return av[n]=e[t];return n}var C2=o0("animationend"),R2=o0("animationiteration"),P2=o0("animationstart"),I2=o0("transitionend"),L2=new Map,$b="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oa(n,e){L2.set(n,e),ql(e,[n])}for(var lv=0;lv<$b.length;lv++){var uv=$b[lv],VN=uv.toLowerCase(),WN=uv[0].toUpperCase()+uv.slice(1);Oa(VN,"on"+WN)}Oa(C2,"onAnimationEnd");Oa(R2,"onAnimationIteration");Oa(P2,"onAnimationStart");Oa("dblclick","onDoubleClick");Oa("focusin","onFocus");Oa("focusout","onBlur");Oa(I2,"onTransitionEnd");Rc("onMouseEnter",["mouseout","mouseover"]);Rc("onMouseLeave",["mouseout","mouseover"]);Rc("onPointerEnter",["pointerout","pointerover"]);Rc("onPointerLeave",["pointerout","pointerover"]);ql("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ql("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ql("onBeforeInput",["compositionend","keypress","textInput","paste"]);ql("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ql("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ql("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XN=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zh));function Yb(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,VD(i,e,void 0,n),n.currentTarget=null}function D2(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;Yb(r,a,u),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;Yb(r,a,u),s=l}}}if(rg)throw n=px,rg=!1,px=null,n}function nn(n,e){var t=e[bx];t===void 0&&(t=e[bx]=new Set);var i=n+"__bubble";t.has(i)||(N2(e,n,2,!1),t.add(i))}function cv(n,e,t){var i=0;e&&(i|=4),N2(t,n,i,e)}var pp="_reactListening"+Math.random().toString(36).slice(2);function Fd(n){if(!n[pp]){n[pp]=!0,GR.forEach(function(t){t!=="selectionchange"&&(XN.has(t)||cv(t,!1,n),cv(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[pp]||(e[pp]=!0,cv("selectionchange",!1,e))}}function N2(n,e,t,i){switch(_2(e)){case 1:var r=sN;break;case 4:r=oN;break;default:r=TS}t=r.bind(null,e,t,n),r=void 0,!fx||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function hv(n,e,t,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Sl(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}i2(function(){var u=s,d=yS(t),f=[];e:{var p=L2.get(n);if(p!==void 0){var m=wS,v=n;switch(n){case"keypress":if(Nm(t)===0)break e;case"keydown":case"keyup":m=SN;break;case"focusin":v="focus",m=rv;break;case"focusout":v="blur",m=rv;break;case"beforeblur":case"afterblur":m=rv;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Fb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=uN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=bN;break;case C2:case R2:case P2:m=dN;break;case I2:m=AN;break;case"scroll":m=aN;break;case"wheel":m=CN;break;case"copy":case"cut":case"paste":m=pN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=kb}var x=(e&4)!==0,y=!x&&n==="scroll",g=x?p!==null?p+"Capture":null:p;x=[];for(var T=u,S;T!==null;){S=T;var w=S.stateNode;if(S.tag===5&&w!==null&&(S=w,g!==null&&(w=Pd(T,g),w!=null&&x.push(Od(T,w,S)))),y)break;T=T.return}0<x.length&&(p=new m(p,v,null,t,d),f.push({event:p,listeners:x}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",p&&t!==hx&&(v=t.relatedTarget||t.fromElement)&&(Sl(v)||v[Io]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(v=t.relatedTarget||t.toElement,m=u,v=v?Sl(v):null,v!==null&&(y=Kl(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=u),m!==v)){if(x=Fb,w="onMouseLeave",g="onMouseEnter",T="mouse",(n==="pointerout"||n==="pointerover")&&(x=kb,w="onPointerLeave",g="onPointerEnter",T="pointer"),y=m==null?p:tc(m),S=v==null?p:tc(v),p=new x(w,T+"leave",m,t,d),p.target=y,p.relatedTarget=S,w=null,Sl(d)===u&&(x=new x(g,T+"enter",v,t,d),x.target=S,x.relatedTarget=y,w=x),y=w,m&&v)t:{for(x=m,g=v,T=0,S=x;S;S=vu(S))T++;for(S=0,w=g;w;w=vu(w))S++;for(;0<T-S;)x=vu(x),T--;for(;0<S-T;)g=vu(g),S--;for(;T--;){if(x===g||g!==null&&x===g.alternate)break t;x=vu(x),g=vu(g)}x=null}else x=null;m!==null&&qb(f,p,m,x,!1),v!==null&&y!==null&&qb(f,y,v,x,!0)}}e:{if(p=u?tc(u):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var M=UN;else if(Gb(p))if(T2)M=BN;else{M=ON;var P=FN}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(M=kN);if(M&&(M=M(n,u))){E2(f,M,t,d);break e}P&&P(n,p,u),n==="focusout"&&(P=p._wrapperState)&&P.controlled&&p.type==="number"&&ox(p,"number",p.value)}switch(P=u?tc(u):window,n){case"focusin":(Gb(P)||P.contentEditable==="true")&&(Ju=P,vx=u,dd=null);break;case"focusout":dd=vx=Ju=null;break;case"mousedown":yx=!0;break;case"contextmenu":case"mouseup":case"dragend":yx=!1,jb(f,t,d);break;case"selectionchange":if(HN)break;case"keydown":case"keyup":jb(f,t,d)}var R;if(MS)e:{switch(n){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else Qu?x2(n,t)&&(D="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(D="onCompositionStart");D&&(y2&&t.locale!=="ko"&&(Qu||D!=="onCompositionStart"?D==="onCompositionEnd"&&Qu&&(R=v2()):(fa=d,bS="value"in fa?fa.value:fa.textContent,Qu=!0)),P=ug(u,D),0<P.length&&(D=new Ob(D,n,null,t,d),f.push({event:D,listeners:P}),R?D.data=R:(R=S2(t),R!==null&&(D.data=R)))),(R=PN?IN(n,t):LN(n,t))&&(u=ug(u,"onBeforeInput"),0<u.length&&(d=new Ob("onBeforeInput","beforeinput",null,t,d),f.push({event:d,listeners:u}),d.data=R))}D2(f,e)})}function Od(n,e,t){return{instance:n,listener:e,currentTarget:t}}function ug(n,e){for(var t=e+"Capture",i=[];n!==null;){var r=n,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Pd(n,t),s!=null&&i.unshift(Od(n,s,r)),s=Pd(n,e),s!=null&&i.push(Od(n,s,r))),n=n.return}return i}function vu(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function qb(n,e,t,i,r){for(var s=e._reactName,o=[];t!==null&&t!==i;){var a=t,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,r?(l=Pd(t,s),l!=null&&o.unshift(Od(t,l,a))):r||(l=Pd(t,s),l!=null&&o.push(Od(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var jN=/\r\n?/g,$N=/\u0000|\uFFFD/g;function Kb(n){return(typeof n=="string"?n:""+n).replace(jN,`
`).replace($N,"")}function mp(n,e,t){if(e=Kb(e),Kb(n)!==e&&t)throw Error(xe(425))}function cg(){}var xx=null,Sx=null;function Ex(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Tx=typeof setTimeout=="function"?setTimeout:void 0,YN=typeof clearTimeout=="function"?clearTimeout:void 0,Zb=typeof Promise=="function"?Promise:void 0,qN=typeof queueMicrotask=="function"?queueMicrotask:typeof Zb<"u"?function(n){return Zb.resolve(null).then(n).catch(KN)}:Tx;function KN(n){setTimeout(function(){throw n})}function dv(n,e){var t=e,i=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(i===0){n.removeChild(r),Dd(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=r}while(t);Dd(e)}function Ea(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function Qb(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Qc=Math.random().toString(36).slice(2),Ns="__reactFiber$"+Qc,kd="__reactProps$"+Qc,Io="__reactContainer$"+Qc,bx="__reactEvents$"+Qc,ZN="__reactListeners$"+Qc,QN="__reactHandles$"+Qc;function Sl(n){var e=n[Ns];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Io]||t[Ns]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=Qb(n);n!==null;){if(t=n[Ns])return t;n=Qb(n)}return e}n=t,t=n.parentNode}return null}function of(n){return n=n[Ns]||n[Io],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function tc(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(xe(33))}function a0(n){return n[kd]||null}var wx=[],nc=-1;function ka(n){return{current:n}}function on(n){0>nc||(n.current=wx[nc],wx[nc]=null,nc--)}function Jt(n,e){nc++,wx[nc]=n.current,n.current=e}var La={},Ai=ka(La),$i=ka(!1),kl=La;function Pc(n,e){var t=n.type.contextTypes;if(!t)return La;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in t)r[s]=e[s];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function Yi(n){return n=n.childContextTypes,n!=null}function hg(){on($i),on(Ai)}function Jb(n,e,t){if(Ai.current!==La)throw Error(xe(168));Jt(Ai,e),Jt($i,t)}function U2(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(xe(108,FD(n)||"Unknown",r));return yn({},t,i)}function dg(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||La,kl=Ai.current,Jt(Ai,n),Jt($i,$i.current),!0}function ew(n,e,t){var i=n.stateNode;if(!i)throw Error(xe(169));t?(n=U2(n,e,kl),i.__reactInternalMemoizedMergedChildContext=n,on($i),on(Ai),Jt(Ai,n)):on($i),Jt($i,t)}var go=null,l0=!1,fv=!1;function F2(n){go===null?go=[n]:go.push(n)}function JN(n){l0=!0,F2(n)}function Ba(){if(!fv&&go!==null){fv=!0;var n=0,e=Yt;try{var t=go;for(Yt=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}go=null,l0=!1}catch(r){throw go!==null&&(go=go.slice(n+1)),a2(xS,Ba),r}finally{Yt=e,fv=!1}}return null}var ic=[],rc=0,fg=null,pg=0,Cr=[],Rr=0,Bl=null,yo=1,xo="";function ol(n,e){ic[rc++]=pg,ic[rc++]=fg,fg=n,pg=e}function O2(n,e,t){Cr[Rr++]=yo,Cr[Rr++]=xo,Cr[Rr++]=Bl,Bl=n;var i=yo;n=xo;var r=32-ss(i)-1;i&=~(1<<r),t+=1;var s=32-ss(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,yo=1<<32-ss(e)+r|t<<r|i,xo=s+n}else yo=1<<s|t<<r|i,xo=n}function RS(n){n.return!==null&&(ol(n,1),O2(n,1,0))}function PS(n){for(;n===fg;)fg=ic[--rc],ic[rc]=null,pg=ic[--rc],ic[rc]=null;for(;n===Bl;)Bl=Cr[--Rr],Cr[Rr]=null,xo=Cr[--Rr],Cr[Rr]=null,yo=Cr[--Rr],Cr[Rr]=null}var lr=null,ar=null,cn=!1,es=null;function k2(n,e){var t=Dr(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function tw(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,lr=n,ar=Ea(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,lr=n,ar=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Bl!==null?{id:yo,overflow:xo}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Dr(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,lr=n,ar=null,!0):!1;default:return!1}}function Ax(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Mx(n){if(cn){var e=ar;if(e){var t=e;if(!tw(n,e)){if(Ax(n))throw Error(xe(418));e=Ea(t.nextSibling);var i=lr;e&&tw(n,e)?k2(i,t):(n.flags=n.flags&-4097|2,cn=!1,lr=n)}}else{if(Ax(n))throw Error(xe(418));n.flags=n.flags&-4097|2,cn=!1,lr=n}}}function nw(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;lr=n}function gp(n){if(n!==lr)return!1;if(!cn)return nw(n),cn=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Ex(n.type,n.memoizedProps)),e&&(e=ar)){if(Ax(n))throw B2(),Error(xe(418));for(;e;)k2(n,e),e=Ea(e.nextSibling)}if(nw(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(xe(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){ar=Ea(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}ar=null}}else ar=lr?Ea(n.stateNode.nextSibling):null;return!0}function B2(){for(var n=ar;n;)n=Ea(n.nextSibling)}function Ic(){ar=lr=null,cn=!1}function IS(n){es===null?es=[n]:es.push(n)}var eU=Oo.ReactCurrentBatchConfig;function Qr(n,e){if(n&&n.defaultProps){e=yn({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var mg=ka(null),gg=null,sc=null,LS=null;function DS(){LS=sc=gg=null}function NS(n){var e=mg.current;on(mg),n._currentValue=e}function Cx(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function _c(n,e){gg=n,LS=sc=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Xi=!0),n.firstContext=null)}function kr(n){var e=n._currentValue;if(LS!==n)if(n={context:n,memoizedValue:e,next:null},sc===null){if(gg===null)throw Error(xe(308));sc=n,gg.dependencies={lanes:0,firstContext:n}}else sc=sc.next=n;return e}var El=null;function US(n){El===null?El=[n]:El.push(n)}function z2(n,e,t,i){var r=e.interleaved;return r===null?(t.next=t,US(e)):(t.next=r.next,r.next=t),e.interleaved=t,Lo(n,i)}function Lo(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var oa=!1;function FS(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function G2(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ao(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Ta(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,zt&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Lo(n,t)}return r=i.interleaved,r===null?(e.next=e,US(i)):(e.next=r.next,r.next=e),i.interleaved=e,Lo(n,t)}function Um(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,SS(n,t)}}function iw(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var r=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?r=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?r=s=e:s=s.next=e}else r=s=e;t={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function _g(n,e,t,i){var r=n.updateQueue;oa=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var d=n.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(s!==null){var f=r.baseState;o=0,d=u=l=null,a=s;do{var p=a.lane,m=a.eventTime;if((i&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var v=n,x=a;switch(p=e,m=t,x.tag){case 1:if(v=x.payload,typeof v=="function"){f=v.call(m,f,p);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,p=typeof v=="function"?v.call(m,f,p):v,p==null)break e;f=yn({},f,p);break e;case 2:oa=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,p=r.effects,p===null?r.effects=[a]:p.push(a))}else m={eventTime:m,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=m,l=f):d=d.next=m,o|=p;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;p=a,a=p.next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}while(1);if(d===null&&(l=f),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=d,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Gl|=o,n.lanes=o,n.memoizedState=f}}function rw(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],r=i.callback;if(r!==null){if(i.callback=null,i=t,typeof r!="function")throw Error(xe(191,r));r.call(i)}}}var H2=new zR.Component().refs;function Rx(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:yn({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var u0={isMounted:function(n){return(n=n._reactInternals)?Kl(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=Ui(),r=wa(n),s=Ao(i,r);s.payload=e,t!=null&&(s.callback=t),e=Ta(n,s,r),e!==null&&(os(e,n,r,i),Um(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=Ui(),r=wa(n),s=Ao(i,r);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Ta(n,s,r),e!==null&&(os(e,n,r,i),Um(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Ui(),i=wa(n),r=Ao(t,i);r.tag=2,e!=null&&(r.callback=e),e=Ta(n,r,i),e!==null&&(os(e,n,i,t),Um(e,n,i))}};function sw(n,e,t,i,r,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!Ud(t,i)||!Ud(r,s):!0}function V2(n,e,t){var i=!1,r=La,s=e.contextType;return typeof s=="object"&&s!==null?s=kr(s):(r=Yi(e)?kl:Ai.current,i=e.contextTypes,s=(i=i!=null)?Pc(n,r):La),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=u0,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=s),e}function ow(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&u0.enqueueReplaceState(e,e.state,null)}function Px(n,e,t,i){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs=H2,FS(n);var s=e.contextType;typeof s=="object"&&s!==null?r.context=kr(s):(s=Yi(e)?kl:Ai.current,r.context=Pc(n,s)),r.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Rx(n,e,s,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&u0.enqueueReplaceState(r,r.state,null),_g(n,t,r,i),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function Ih(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(xe(309));var i=t.stateNode}if(!i)throw Error(xe(147,n));var r=i,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;a===H2&&(a=r.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(xe(284));if(!t._owner)throw Error(xe(290,n))}return n}function _p(n,e){throw n=Object.prototype.toString.call(e),Error(xe(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function aw(n){var e=n._init;return e(n._payload)}function W2(n){function e(g,T){if(n){var S=g.deletions;S===null?(g.deletions=[T],g.flags|=16):S.push(T)}}function t(g,T){if(!n)return null;for(;T!==null;)e(g,T),T=T.sibling;return null}function i(g,T){for(g=new Map;T!==null;)T.key!==null?g.set(T.key,T):g.set(T.index,T),T=T.sibling;return g}function r(g,T){return g=Aa(g,T),g.index=0,g.sibling=null,g}function s(g,T,S){return g.index=S,n?(S=g.alternate,S!==null?(S=S.index,S<T?(g.flags|=2,T):S):(g.flags|=2,T)):(g.flags|=1048576,T)}function o(g){return n&&g.alternate===null&&(g.flags|=2),g}function a(g,T,S,w){return T===null||T.tag!==6?(T=xv(S,g.mode,w),T.return=g,T):(T=r(T,S),T.return=g,T)}function l(g,T,S,w){var M=S.type;return M===Zu?d(g,T,S.props.children,w,S.key):T!==null&&(T.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===sa&&aw(M)===T.type)?(w=r(T,S.props),w.ref=Ih(g,T,S),w.return=g,w):(w=Gm(S.type,S.key,S.props,null,g.mode,w),w.ref=Ih(g,T,S),w.return=g,w)}function u(g,T,S,w){return T===null||T.tag!==4||T.stateNode.containerInfo!==S.containerInfo||T.stateNode.implementation!==S.implementation?(T=Sv(S,g.mode,w),T.return=g,T):(T=r(T,S.children||[]),T.return=g,T)}function d(g,T,S,w,M){return T===null||T.tag!==7?(T=Rl(S,g.mode,w,M),T.return=g,T):(T=r(T,S),T.return=g,T)}function f(g,T,S){if(typeof T=="string"&&T!==""||typeof T=="number")return T=xv(""+T,g.mode,S),T.return=g,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case op:return S=Gm(T.type,T.key,T.props,null,g.mode,S),S.ref=Ih(g,null,T),S.return=g,S;case Ku:return T=Sv(T,g.mode,S),T.return=g,T;case sa:var w=T._init;return f(g,w(T._payload),S)}if(qh(T)||Ah(T))return T=Rl(T,g.mode,S,null),T.return=g,T;_p(g,T)}return null}function p(g,T,S,w){var M=T!==null?T.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return M!==null?null:a(g,T,""+S,w);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case op:return S.key===M?l(g,T,S,w):null;case Ku:return S.key===M?u(g,T,S,w):null;case sa:return M=S._init,p(g,T,M(S._payload),w)}if(qh(S)||Ah(S))return M!==null?null:d(g,T,S,w,null);_p(g,S)}return null}function m(g,T,S,w,M){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(S)||null,a(T,g,""+w,M);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case op:return g=g.get(w.key===null?S:w.key)||null,l(T,g,w,M);case Ku:return g=g.get(w.key===null?S:w.key)||null,u(T,g,w,M);case sa:var P=w._init;return m(g,T,S,P(w._payload),M)}if(qh(w)||Ah(w))return g=g.get(S)||null,d(T,g,w,M,null);_p(T,w)}return null}function v(g,T,S,w){for(var M=null,P=null,R=T,D=T=0,C=null;R!==null&&D<S.length;D++){R.index>D?(C=R,R=null):C=R.sibling;var L=p(g,R,S[D],w);if(L===null){R===null&&(R=C);break}n&&R&&L.alternate===null&&e(g,R),T=s(L,T,D),P===null?M=L:P.sibling=L,P=L,R=C}if(D===S.length)return t(g,R),cn&&ol(g,D),M;if(R===null){for(;D<S.length;D++)R=f(g,S[D],w),R!==null&&(T=s(R,T,D),P===null?M=R:P.sibling=R,P=R);return cn&&ol(g,D),M}for(R=i(g,R);D<S.length;D++)C=m(R,g,D,S[D],w),C!==null&&(n&&C.alternate!==null&&R.delete(C.key===null?D:C.key),T=s(C,T,D),P===null?M=C:P.sibling=C,P=C);return n&&R.forEach(function(Z){return e(g,Z)}),cn&&ol(g,D),M}function x(g,T,S,w){var M=Ah(S);if(typeof M!="function")throw Error(xe(150));if(S=M.call(S),S==null)throw Error(xe(151));for(var P=M=null,R=T,D=T=0,C=null,L=S.next();R!==null&&!L.done;D++,L=S.next()){R.index>D?(C=R,R=null):C=R.sibling;var Z=p(g,R,L.value,w);if(Z===null){R===null&&(R=C);break}n&&R&&Z.alternate===null&&e(g,R),T=s(Z,T,D),P===null?M=Z:P.sibling=Z,P=Z,R=C}if(L.done)return t(g,R),cn&&ol(g,D),M;if(R===null){for(;!L.done;D++,L=S.next())L=f(g,L.value,w),L!==null&&(T=s(L,T,D),P===null?M=L:P.sibling=L,P=L);return cn&&ol(g,D),M}for(R=i(g,R);!L.done;D++,L=S.next())L=m(R,g,D,L.value,w),L!==null&&(n&&L.alternate!==null&&R.delete(L.key===null?D:L.key),T=s(L,T,D),P===null?M=L:P.sibling=L,P=L);return n&&R.forEach(function(V){return e(g,V)}),cn&&ol(g,D),M}function y(g,T,S,w){if(typeof S=="object"&&S!==null&&S.type===Zu&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case op:e:{for(var M=S.key,P=T;P!==null;){if(P.key===M){if(M=S.type,M===Zu){if(P.tag===7){t(g,P.sibling),T=r(P,S.props.children),T.return=g,g=T;break e}}else if(P.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===sa&&aw(M)===P.type){t(g,P.sibling),T=r(P,S.props),T.ref=Ih(g,P,S),T.return=g,g=T;break e}t(g,P);break}else e(g,P);P=P.sibling}S.type===Zu?(T=Rl(S.props.children,g.mode,w,S.key),T.return=g,g=T):(w=Gm(S.type,S.key,S.props,null,g.mode,w),w.ref=Ih(g,T,S),w.return=g,g=w)}return o(g);case Ku:e:{for(P=S.key;T!==null;){if(T.key===P)if(T.tag===4&&T.stateNode.containerInfo===S.containerInfo&&T.stateNode.implementation===S.implementation){t(g,T.sibling),T=r(T,S.children||[]),T.return=g,g=T;break e}else{t(g,T);break}else e(g,T);T=T.sibling}T=Sv(S,g.mode,w),T.return=g,g=T}return o(g);case sa:return P=S._init,y(g,T,P(S._payload),w)}if(qh(S))return v(g,T,S,w);if(Ah(S))return x(g,T,S,w);_p(g,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,T!==null&&T.tag===6?(t(g,T.sibling),T=r(T,S),T.return=g,g=T):(t(g,T),T=xv(S,g.mode,w),T.return=g,g=T),o(g)):t(g,T)}return y}var Lc=W2(!0),X2=W2(!1),af={},zs=ka(af),Bd=ka(af),zd=ka(af);function Tl(n){if(n===af)throw Error(xe(174));return n}function OS(n,e){switch(Jt(zd,e),Jt(Bd,n),Jt(zs,af),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lx(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=lx(e,n)}on(zs),Jt(zs,e)}function Dc(){on(zs),on(Bd),on(zd)}function j2(n){Tl(zd.current);var e=Tl(zs.current),t=lx(e,n.type);e!==t&&(Jt(Bd,n),Jt(zs,t))}function kS(n){Bd.current===n&&(on(zs),on(Bd))}var mn=ka(0);function vg(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var pv=[];function BS(){for(var n=0;n<pv.length;n++)pv[n]._workInProgressVersionPrimary=null;pv.length=0}var Fm=Oo.ReactCurrentDispatcher,mv=Oo.ReactCurrentBatchConfig,zl=0,_n=null,Bn=null,Jn=null,yg=!1,fd=!1,Gd=0,tU=0;function yi(){throw Error(xe(321))}function zS(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!cs(n[t],e[t]))return!1;return!0}function GS(n,e,t,i,r,s){if(zl=s,_n=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Fm.current=n===null||n.memoizedState===null?sU:oU,n=t(i,r),fd){s=0;do{if(fd=!1,Gd=0,25<=s)throw Error(xe(301));s+=1,Jn=Bn=null,e.updateQueue=null,Fm.current=aU,n=t(i,r)}while(fd)}if(Fm.current=xg,e=Bn!==null&&Bn.next!==null,zl=0,Jn=Bn=_n=null,yg=!1,e)throw Error(xe(300));return n}function HS(){var n=Gd!==0;return Gd=0,n}function Ps(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jn===null?_n.memoizedState=Jn=n:Jn=Jn.next=n,Jn}function Br(){if(Bn===null){var n=_n.alternate;n=n!==null?n.memoizedState:null}else n=Bn.next;var e=Jn===null?_n.memoizedState:Jn.next;if(e!==null)Jn=e,Bn=n;else{if(n===null)throw Error(xe(310));Bn=n,n={memoizedState:Bn.memoizedState,baseState:Bn.baseState,baseQueue:Bn.baseQueue,queue:Bn.queue,next:null},Jn===null?_n.memoizedState=Jn=n:Jn=Jn.next=n}return Jn}function Hd(n,e){return typeof e=="function"?e(n):e}function gv(n){var e=Br(),t=e.queue;if(t===null)throw Error(xe(311));t.lastRenderedReducer=n;var i=Bn,r=i.baseQueue,s=t.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,t.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,u=s;do{var d=u.lane;if((zl&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:n(i,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=f,o=i):l=l.next=f,_n.lanes|=d,Gl|=d}u=u.next}while(u!==null&&u!==s);l===null?o=i:l.next=a,cs(i,e.memoizedState)||(Xi=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,t.lastRenderedState=i}if(n=t.interleaved,n!==null){r=n;do s=r.lane,_n.lanes|=s,Gl|=s,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function _v(n){var e=Br(),t=e.queue;if(t===null)throw Error(xe(311));t.lastRenderedReducer=n;var i=t.dispatch,r=t.pending,s=e.memoizedState;if(r!==null){t.pending=null;var o=r=r.next;do s=n(s,o.action),o=o.next;while(o!==r);cs(s,e.memoizedState)||(Xi=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,i]}function $2(){}function Y2(n,e){var t=_n,i=Br(),r=e(),s=!cs(i.memoizedState,r);if(s&&(i.memoizedState=r,Xi=!0),i=i.queue,VS(Z2.bind(null,t,i,n),[n]),i.getSnapshot!==e||s||Jn!==null&&Jn.memoizedState.tag&1){if(t.flags|=2048,Vd(9,K2.bind(null,t,i,r,e),void 0,null),ii===null)throw Error(xe(349));zl&30||q2(t,e,r)}return r}function q2(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=_n.updateQueue,e===null?(e={lastEffect:null,stores:null},_n.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function K2(n,e,t,i){e.value=t,e.getSnapshot=i,Q2(e)&&J2(n)}function Z2(n,e,t){return t(function(){Q2(e)&&J2(n)})}function Q2(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!cs(n,t)}catch{return!0}}function J2(n){var e=Lo(n,1);e!==null&&os(e,n,1,-1)}function lw(n){var e=Ps();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hd,lastRenderedState:n},e.queue=n,n=n.dispatch=rU.bind(null,_n,n),[e.memoizedState,n]}function Vd(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=_n.updateQueue,e===null?(e={lastEffect:null,stores:null},_n.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function eP(){return Br().memoizedState}function Om(n,e,t,i){var r=Ps();_n.flags|=n,r.memoizedState=Vd(1|e,t,void 0,i===void 0?null:i)}function c0(n,e,t,i){var r=Br();i=i===void 0?null:i;var s=void 0;if(Bn!==null){var o=Bn.memoizedState;if(s=o.destroy,i!==null&&zS(i,o.deps)){r.memoizedState=Vd(e,t,s,i);return}}_n.flags|=n,r.memoizedState=Vd(1|e,t,s,i)}function uw(n,e){return Om(8390656,8,n,e)}function VS(n,e){return c0(2048,8,n,e)}function tP(n,e){return c0(4,2,n,e)}function nP(n,e){return c0(4,4,n,e)}function iP(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function rP(n,e,t){return t=t!=null?t.concat([n]):null,c0(4,4,iP.bind(null,e,n),t)}function WS(){}function sP(n,e){var t=Br();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&zS(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function oP(n,e){var t=Br();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&zS(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function aP(n,e,t){return zl&21?(cs(t,e)||(t=c2(),_n.lanes|=t,Gl|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Xi=!0),n.memoizedState=t)}function nU(n,e){var t=Yt;Yt=t!==0&&4>t?t:4,n(!0);var i=mv.transition;mv.transition={};try{n(!1),e()}finally{Yt=t,mv.transition=i}}function lP(){return Br().memoizedState}function iU(n,e,t){var i=wa(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},uP(n))cP(e,t);else if(t=z2(n,e,t,i),t!==null){var r=Ui();os(t,n,i,r),hP(t,e,i)}}function rU(n,e,t){var i=wa(n),r={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(uP(n))cP(e,r);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(r.hasEagerState=!0,r.eagerState=a,cs(a,o)){var l=e.interleaved;l===null?(r.next=r,US(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}t=z2(n,e,r,i),t!==null&&(r=Ui(),os(t,n,i,r),hP(t,e,i))}}function uP(n){var e=n.alternate;return n===_n||e!==null&&e===_n}function cP(n,e){fd=yg=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function hP(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,SS(n,t)}}var xg={readContext:kr,useCallback:yi,useContext:yi,useEffect:yi,useImperativeHandle:yi,useInsertionEffect:yi,useLayoutEffect:yi,useMemo:yi,useReducer:yi,useRef:yi,useState:yi,useDebugValue:yi,useDeferredValue:yi,useTransition:yi,useMutableSource:yi,useSyncExternalStore:yi,useId:yi,unstable_isNewReconciler:!1},sU={readContext:kr,useCallback:function(n,e){return Ps().memoizedState=[n,e===void 0?null:e],n},useContext:kr,useEffect:uw,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Om(4194308,4,iP.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Om(4194308,4,n,e)},useInsertionEffect:function(n,e){return Om(4,2,n,e)},useMemo:function(n,e){var t=Ps();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=Ps();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=iU.bind(null,_n,n),[i.memoizedState,n]},useRef:function(n){var e=Ps();return n={current:n},e.memoizedState=n},useState:lw,useDebugValue:WS,useDeferredValue:function(n){return Ps().memoizedState=n},useTransition:function(){var n=lw(!1),e=n[0];return n=nU.bind(null,n[1]),Ps().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=_n,r=Ps();if(cn){if(t===void 0)throw Error(xe(407));t=t()}else{if(t=e(),ii===null)throw Error(xe(349));zl&30||q2(i,e,t)}r.memoizedState=t;var s={value:t,getSnapshot:e};return r.queue=s,uw(Z2.bind(null,i,s,n),[n]),i.flags|=2048,Vd(9,K2.bind(null,i,s,t,e),void 0,null),t},useId:function(){var n=Ps(),e=ii.identifierPrefix;if(cn){var t=xo,i=yo;t=(i&~(1<<32-ss(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=Gd++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=tU++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},oU={readContext:kr,useCallback:sP,useContext:kr,useEffect:VS,useImperativeHandle:rP,useInsertionEffect:tP,useLayoutEffect:nP,useMemo:oP,useReducer:gv,useRef:eP,useState:function(){return gv(Hd)},useDebugValue:WS,useDeferredValue:function(n){var e=Br();return aP(e,Bn.memoizedState,n)},useTransition:function(){var n=gv(Hd)[0],e=Br().memoizedState;return[n,e]},useMutableSource:$2,useSyncExternalStore:Y2,useId:lP,unstable_isNewReconciler:!1},aU={readContext:kr,useCallback:sP,useContext:kr,useEffect:VS,useImperativeHandle:rP,useInsertionEffect:tP,useLayoutEffect:nP,useMemo:oP,useReducer:_v,useRef:eP,useState:function(){return _v(Hd)},useDebugValue:WS,useDeferredValue:function(n){var e=Br();return Bn===null?e.memoizedState=n:aP(e,Bn.memoizedState,n)},useTransition:function(){var n=_v(Hd)[0],e=Br().memoizedState;return[n,e]},useMutableSource:$2,useSyncExternalStore:Y2,useId:lP,unstable_isNewReconciler:!1};function Nc(n,e){try{var t="",i=e;do t+=UD(i),i=i.return;while(i);var r=t}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:r,digest:null}}function vv(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Ix(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var lU=typeof WeakMap=="function"?WeakMap:Map;function dP(n,e,t){t=Ao(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){Eg||(Eg=!0,Gx=i),Ix(n,e)},t}function fP(n,e,t){t=Ao(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;t.payload=function(){return i(r)},t.callback=function(){Ix(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){Ix(n,e),typeof i!="function"&&(ba===null?ba=new Set([this]):ba.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function cw(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new lU;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(t)||(r.add(t),n=EU.bind(null,n,e,t),e.then(n,n))}function hw(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function dw(n,e,t,i,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Ao(-1,1),e.tag=2,Ta(t,e,1))),t.lanes|=1),n)}var uU=Oo.ReactCurrentOwner,Xi=!1;function Li(n,e,t,i){e.child=n===null?X2(e,null,t,i):Lc(e,n.child,t,i)}function fw(n,e,t,i,r){t=t.render;var s=e.ref;return _c(e,r),i=GS(n,e,t,i,s,r),t=HS(),n!==null&&!Xi?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Do(n,e,r)):(cn&&t&&RS(e),e.flags|=1,Li(n,e,i,r),e.child)}function pw(n,e,t,i,r){if(n===null){var s=t.type;return typeof s=="function"&&!QS(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,pP(n,e,s,i,r)):(n=Gm(t.type,null,i,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&r)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:Ud,t(o,i)&&n.ref===e.ref)return Do(n,e,r)}return e.flags|=1,n=Aa(s,i),n.ref=e.ref,n.return=e,e.child=n}function pP(n,e,t,i,r){if(n!==null){var s=n.memoizedProps;if(Ud(s,i)&&n.ref===e.ref)if(Xi=!1,e.pendingProps=i=s,(n.lanes&r)!==0)n.flags&131072&&(Xi=!0);else return e.lanes=n.lanes,Do(n,e,r)}return Lx(n,e,t,i,r)}function mP(n,e,t){var i=e.pendingProps,r=i.children,s=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jt(ac,or),or|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Jt(ac,or),or|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:t,Jt(ac,or),or|=i}else s!==null?(i=s.baseLanes|t,e.memoizedState=null):i=t,Jt(ac,or),or|=i;return Li(n,e,r,t),e.child}function gP(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Lx(n,e,t,i,r){var s=Yi(t)?kl:Ai.current;return s=Pc(e,s),_c(e,r),t=GS(n,e,t,i,s,r),i=HS(),n!==null&&!Xi?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Do(n,e,r)):(cn&&i&&RS(e),e.flags|=1,Li(n,e,t,r),e.child)}function mw(n,e,t,i,r){if(Yi(t)){var s=!0;dg(e)}else s=!1;if(_c(e,r),e.stateNode===null)km(n,e),V2(e,t,i),Px(e,t,i,r),i=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=kr(u):(u=Yi(t)?kl:Ai.current,u=Pc(e,u));var d=t.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&ow(e,o,i,u),oa=!1;var p=e.memoizedState;o.state=p,_g(e,i,o,r),l=e.memoizedState,a!==i||p!==l||$i.current||oa?(typeof d=="function"&&(Rx(e,t,d,i),l=e.memoizedState),(a=oa||sw(e,t,a,i,p,l,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,G2(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:Qr(e.type,a),o.props=u,f=e.pendingProps,p=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=kr(l):(l=Yi(t)?kl:Ai.current,l=Pc(e,l));var m=t.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||p!==l)&&ow(e,o,i,l),oa=!1,p=e.memoizedState,o.state=p,_g(e,i,o,r);var v=e.memoizedState;a!==f||p!==v||$i.current||oa?(typeof m=="function"&&(Rx(e,t,m,i),v=e.memoizedState),(u=oa||sw(e,t,u,i,p,v,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,v,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,v,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=v),o.props=i,o.state=v,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),i=!1)}return Dx(n,e,t,i,s,r)}function Dx(n,e,t,i,r,s){gP(n,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&ew(e,t,!1),Do(n,e,s);i=e.stateNode,uU.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&o?(e.child=Lc(e,n.child,null,s),e.child=Lc(e,null,a,s)):Li(n,e,a,s),e.memoizedState=i.state,r&&ew(e,t,!0),e.child}function _P(n){var e=n.stateNode;e.pendingContext?Jb(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Jb(n,e.context,!1),OS(n,e.containerInfo)}function gw(n,e,t,i,r){return Ic(),IS(r),e.flags|=256,Li(n,e,t,i),e.child}var Nx={dehydrated:null,treeContext:null,retryLane:0};function Ux(n){return{baseLanes:n,cachePool:null,transitions:null}}function vP(n,e,t){var i=e.pendingProps,r=mn.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),Jt(mn,r&1),n===null)return Mx(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,n=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=f0(o,i,0,null),n=Rl(n,i,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=Ux(t),e.memoizedState=Nx,n):XS(e,o));if(r=n.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return cU(n,e,o,i,a,r,t);if(s){s=i.fallback,o=e.mode,r=n.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=Aa(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Aa(a,s):(s=Rl(s,o,t,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=n.child.memoizedState,o=o===null?Ux(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=Nx,i}return s=n.child,n=s.sibling,i=Aa(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function XS(n,e){return e=f0({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function vp(n,e,t,i){return i!==null&&IS(i),Lc(e,n.child,null,t),n=XS(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function cU(n,e,t,i,r,s,o){if(t)return e.flags&256?(e.flags&=-257,i=vv(Error(xe(422))),vp(n,e,o,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=f0({mode:"visible",children:i.children},r,0,null),s=Rl(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&Lc(e,n.child,null,o),e.child.memoizedState=Ux(o),e.memoizedState=Nx,s);if(!(e.mode&1))return vp(n,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(xe(419)),i=vv(s,i,void 0),vp(n,e,o,i)}if(a=(o&n.childLanes)!==0,Xi||a){if(i=ii,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Lo(n,r),os(i,n,r,-1))}return ZS(),i=vv(Error(xe(421))),vp(n,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=TU.bind(null,n),r._reactRetry=e,null):(n=s.treeContext,ar=Ea(r.nextSibling),lr=e,cn=!0,es=null,n!==null&&(Cr[Rr++]=yo,Cr[Rr++]=xo,Cr[Rr++]=Bl,yo=n.id,xo=n.overflow,Bl=e),e=XS(e,i.children),e.flags|=4096,e)}function _w(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),Cx(n.return,e,t)}function yv(n,e,t,i,r){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=t,s.tailMode=r)}function yP(n,e,t){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(Li(n,e,i.children,t),i=mn.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&_w(n,t,e);else if(n.tag===19)_w(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(Jt(mn,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&vg(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),yv(e,!1,r,t,s);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&vg(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}yv(e,!0,t,null,s);break;case"together":yv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function km(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Do(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Gl|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(xe(153));if(e.child!==null){for(n=e.child,t=Aa(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Aa(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function hU(n,e,t){switch(e.tag){case 3:_P(e),Ic();break;case 5:j2(e);break;case 1:Yi(e.type)&&dg(e);break;case 4:OS(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Jt(mg,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Jt(mn,mn.current&1),e.flags|=128,null):t&e.child.childLanes?vP(n,e,t):(Jt(mn,mn.current&1),n=Do(n,e,t),n!==null?n.sibling:null);Jt(mn,mn.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return yP(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Jt(mn,mn.current),i)break;return null;case 22:case 23:return e.lanes=0,mP(n,e,t)}return Do(n,e,t)}var xP,Fx,SP,EP;xP=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Fx=function(){};SP=function(n,e,t,i){var r=n.memoizedProps;if(r!==i){n=e.stateNode,Tl(zs.current);var s=null;switch(t){case"input":r=rx(n,r),i=rx(n,i),s=[];break;case"select":r=yn({},r,{value:void 0}),i=yn({},i,{value:void 0}),s=[];break;case"textarea":r=ax(n,r),i=ax(n,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=cg)}ux(t,i);var o;t=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Cd.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var l=i[u];if(a=r!=null?r[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Cd.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&nn("scroll",n),s||a===l||(s=[])):(s=s||[]).push(u,l))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};EP=function(n,e,t,i){t!==i&&(e.flags|=4)};function Lh(n,e){if(!cn)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function xi(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function dU(n,e,t){var i=e.pendingProps;switch(PS(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xi(e),null;case 1:return Yi(e.type)&&hg(),xi(e),null;case 3:return i=e.stateNode,Dc(),on($i),on(Ai),BS(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(gp(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,es!==null&&(Wx(es),es=null))),Fx(n,e),xi(e),null;case 5:kS(e);var r=Tl(zd.current);if(t=e.type,n!==null&&e.stateNode!=null)SP(n,e,t,i,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(xe(166));return xi(e),null}if(n=Tl(zs.current),gp(e)){i=e.stateNode,t=e.type;var s=e.memoizedProps;switch(i[Ns]=e,i[kd]=s,n=(e.mode&1)!==0,t){case"dialog":nn("cancel",i),nn("close",i);break;case"iframe":case"object":case"embed":nn("load",i);break;case"video":case"audio":for(r=0;r<Zh.length;r++)nn(Zh[r],i);break;case"source":nn("error",i);break;case"img":case"image":case"link":nn("error",i),nn("load",i);break;case"details":nn("toggle",i);break;case"input":Ab(i,s),nn("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},nn("invalid",i);break;case"textarea":Cb(i,s),nn("invalid",i)}ux(t,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&mp(i.textContent,a,n),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&mp(i.textContent,a,n),r=["children",""+a]):Cd.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&nn("scroll",i)}switch(t){case"input":ap(i),Mb(i,s,!0);break;case"textarea":ap(i),Rb(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=cg)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=qR(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=o.createElement(t,{is:i.is}):(n=o.createElement(t),t==="select"&&(o=n,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):n=o.createElementNS(n,t),n[Ns]=e,n[kd]=i,xP(n,e,!1,!1),e.stateNode=n;e:{switch(o=cx(t,i),t){case"dialog":nn("cancel",n),nn("close",n),r=i;break;case"iframe":case"object":case"embed":nn("load",n),r=i;break;case"video":case"audio":for(r=0;r<Zh.length;r++)nn(Zh[r],n);r=i;break;case"source":nn("error",n),r=i;break;case"img":case"image":case"link":nn("error",n),nn("load",n),r=i;break;case"details":nn("toggle",n),r=i;break;case"input":Ab(n,i),r=rx(n,i),nn("invalid",n);break;case"option":r=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},r=yn({},i,{value:void 0}),nn("invalid",n);break;case"textarea":Cb(n,i),r=ax(n,i),nn("invalid",n);break;default:r=i}ux(t,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?QR(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&KR(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Rd(n,l):typeof l=="number"&&Rd(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Cd.hasOwnProperty(s)?l!=null&&s==="onScroll"&&nn("scroll",n):l!=null&&mS(n,s,l,o))}switch(t){case"input":ap(n),Mb(n,i,!1);break;case"textarea":ap(n),Rb(n);break;case"option":i.value!=null&&n.setAttribute("value",""+Ia(i.value));break;case"select":n.multiple=!!i.multiple,s=i.value,s!=null?fc(n,!!i.multiple,s,!1):i.defaultValue!=null&&fc(n,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=cg)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return xi(e),null;case 6:if(n&&e.stateNode!=null)EP(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(xe(166));if(t=Tl(zd.current),Tl(zs.current),gp(e)){if(i=e.stateNode,t=e.memoizedProps,i[Ns]=e,(s=i.nodeValue!==t)&&(n=lr,n!==null))switch(n.tag){case 3:mp(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&mp(i.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[Ns]=e,e.stateNode=i}return xi(e),null;case 13:if(on(mn),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(cn&&ar!==null&&e.mode&1&&!(e.flags&128))B2(),Ic(),e.flags|=98560,s=!1;else if(s=gp(e),i!==null&&i.dehydrated!==null){if(n===null){if(!s)throw Error(xe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(xe(317));s[Ns]=e}else Ic(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;xi(e),s=!1}else es!==null&&(Wx(es),es=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||mn.current&1?zn===0&&(zn=3):ZS())),e.updateQueue!==null&&(e.flags|=4),xi(e),null);case 4:return Dc(),Fx(n,e),n===null&&Fd(e.stateNode.containerInfo),xi(e),null;case 10:return NS(e.type._context),xi(e),null;case 17:return Yi(e.type)&&hg(),xi(e),null;case 19:if(on(mn),s=e.memoizedState,s===null)return xi(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)Lh(s,!1);else{if(zn!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=vg(n),o!==null){for(e.flags|=128,Lh(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)s=t,n=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Jt(mn,mn.current&1|2),e.child}n=n.sibling}s.tail!==null&&Rn()>Uc&&(e.flags|=128,i=!0,Lh(s,!1),e.lanes=4194304)}else{if(!i)if(n=vg(o),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Lh(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!cn)return xi(e),null}else 2*Rn()-s.renderingStartTime>Uc&&t!==1073741824&&(e.flags|=128,i=!0,Lh(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Rn(),e.sibling=null,t=mn.current,Jt(mn,i?t&1|2:t&1),e):(xi(e),null);case 22:case 23:return KS(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?or&1073741824&&(xi(e),e.subtreeFlags&6&&(e.flags|=8192)):xi(e),null;case 24:return null;case 25:return null}throw Error(xe(156,e.tag))}function fU(n,e){switch(PS(e),e.tag){case 1:return Yi(e.type)&&hg(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Dc(),on($i),on(Ai),BS(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return kS(e),null;case 13:if(on(mn),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(xe(340));Ic()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return on(mn),null;case 4:return Dc(),null;case 10:return NS(e.type._context),null;case 22:case 23:return KS(),null;case 24:return null;default:return null}}var yp=!1,bi=!1,pU=typeof WeakSet=="function"?WeakSet:Set,He=null;function oc(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){En(n,e,i)}else t.current=null}function Ox(n,e,t){try{t()}catch(i){En(n,e,i)}}var vw=!1;function mU(n,e){if(xx=ag,n=A2(),CS(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,u=0,d=0,f=n,p=null;t:for(;;){for(var m;f!==t||r!==0&&f.nodeType!==3||(a=o+r),f!==s||i!==0&&f.nodeType!==3||(l=o+i),f.nodeType===3&&(o+=f.nodeValue.length),(m=f.firstChild)!==null;)p=f,f=m;for(;;){if(f===n)break t;if(p===t&&++u===r&&(a=o),p===s&&++d===i&&(l=o),(m=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=m}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Sx={focusedElem:n,selectionRange:t},ag=!1,He=e;He!==null;)if(e=He,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,He=n;else for(;He!==null;){e=He;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,y=v.memoizedState,g=e.stateNode,T=g.getSnapshotBeforeUpdate(e.elementType===e.type?x:Qr(e.type,x),y);g.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(xe(163))}}catch(w){En(e,e.return,w)}if(n=e.sibling,n!==null){n.return=e.return,He=n;break}He=e.return}return v=vw,vw=!1,v}function pd(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&n)===n){var s=r.destroy;r.destroy=void 0,s!==void 0&&Ox(e,t,s)}r=r.next}while(r!==i)}}function h0(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function kx(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function TP(n){var e=n.alternate;e!==null&&(n.alternate=null,TP(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Ns],delete e[kd],delete e[bx],delete e[ZN],delete e[QN])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function bP(n){return n.tag===5||n.tag===3||n.tag===4}function yw(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||bP(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Bx(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=cg));else if(i!==4&&(n=n.child,n!==null))for(Bx(n,e,t),n=n.sibling;n!==null;)Bx(n,e,t),n=n.sibling}function zx(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(zx(n,e,t),n=n.sibling;n!==null;)zx(n,e,t),n=n.sibling}var hi=null,Jr=!1;function qo(n,e,t){for(t=t.child;t!==null;)wP(n,e,t),t=t.sibling}function wP(n,e,t){if(Bs&&typeof Bs.onCommitFiberUnmount=="function")try{Bs.onCommitFiberUnmount(i0,t)}catch{}switch(t.tag){case 5:bi||oc(t,e);case 6:var i=hi,r=Jr;hi=null,qo(n,e,t),hi=i,Jr=r,hi!==null&&(Jr?(n=hi,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):hi.removeChild(t.stateNode));break;case 18:hi!==null&&(Jr?(n=hi,t=t.stateNode,n.nodeType===8?dv(n.parentNode,t):n.nodeType===1&&dv(n,t),Dd(n)):dv(hi,t.stateNode));break;case 4:i=hi,r=Jr,hi=t.stateNode.containerInfo,Jr=!0,qo(n,e,t),hi=i,Jr=r;break;case 0:case 11:case 14:case 15:if(!bi&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Ox(t,e,o),r=r.next}while(r!==i)}qo(n,e,t);break;case 1:if(!bi&&(oc(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){En(t,e,a)}qo(n,e,t);break;case 21:qo(n,e,t);break;case 22:t.mode&1?(bi=(i=bi)||t.memoizedState!==null,qo(n,e,t),bi=i):qo(n,e,t);break;default:qo(n,e,t)}}function xw(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new pU),e.forEach(function(i){var r=bU.bind(null,n,i);t.has(i)||(t.add(i),i.then(r,r))})}}function Wr(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var r=t[i];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:hi=a.stateNode,Jr=!1;break e;case 3:hi=a.stateNode.containerInfo,Jr=!0;break e;case 4:hi=a.stateNode.containerInfo,Jr=!0;break e}a=a.return}if(hi===null)throw Error(xe(160));wP(s,o,r),hi=null,Jr=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){En(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)AP(e,n),e=e.sibling}function AP(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Wr(e,n),bs(n),i&4){try{pd(3,n,n.return),h0(3,n)}catch(x){En(n,n.return,x)}try{pd(5,n,n.return)}catch(x){En(n,n.return,x)}}break;case 1:Wr(e,n),bs(n),i&512&&t!==null&&oc(t,t.return);break;case 5:if(Wr(e,n),bs(n),i&512&&t!==null&&oc(t,t.return),n.flags&32){var r=n.stateNode;try{Rd(r,"")}catch(x){En(n,n.return,x)}}if(i&4&&(r=n.stateNode,r!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&$R(r,s),cx(a,o);var u=cx(a,s);for(o=0;o<l.length;o+=2){var d=l[o],f=l[o+1];d==="style"?QR(r,f):d==="dangerouslySetInnerHTML"?KR(r,f):d==="children"?Rd(r,f):mS(r,d,f,u)}switch(a){case"input":sx(r,s);break;case"textarea":YR(r,s);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?fc(r,!!s.multiple,m,!1):p!==!!s.multiple&&(s.defaultValue!=null?fc(r,!!s.multiple,s.defaultValue,!0):fc(r,!!s.multiple,s.multiple?[]:"",!1))}r[kd]=s}catch(x){En(n,n.return,x)}}break;case 6:if(Wr(e,n),bs(n),i&4){if(n.stateNode===null)throw Error(xe(162));r=n.stateNode,s=n.memoizedProps;try{r.nodeValue=s}catch(x){En(n,n.return,x)}}break;case 3:if(Wr(e,n),bs(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{Dd(e.containerInfo)}catch(x){En(n,n.return,x)}break;case 4:Wr(e,n),bs(n);break;case 13:Wr(e,n),bs(n),r=n.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(YS=Rn())),i&4&&xw(n);break;case 22:if(d=t!==null&&t.memoizedState!==null,n.mode&1?(bi=(u=bi)||d,Wr(e,n),bi=u):Wr(e,n),bs(n),i&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!d&&n.mode&1)for(He=n,d=n.child;d!==null;){for(f=He=d;He!==null;){switch(p=He,m=p.child,p.tag){case 0:case 11:case 14:case 15:pd(4,p,p.return);break;case 1:oc(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){i=p,t=p.return;try{e=i,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(x){En(i,t,x)}}break;case 5:oc(p,p.return);break;case 22:if(p.memoizedState!==null){Ew(f);continue}}m!==null?(m.return=p,He=m):Ew(f)}d=d.sibling}e:for(d=null,f=n;;){if(f.tag===5){if(d===null){d=f;try{r=f.stateNode,u?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=ZR("display",o))}catch(x){En(n,n.return,x)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(x){En(n,n.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Wr(e,n),bs(n),i&4&&xw(n);break;case 21:break;default:Wr(e,n),bs(n)}}function bs(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(bP(t)){var i=t;break e}t=t.return}throw Error(xe(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Rd(r,""),i.flags&=-33);var s=yw(n);zx(n,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=yw(n);Bx(n,a,o);break;default:throw Error(xe(161))}}catch(l){En(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function gU(n,e,t){He=n,MP(n)}function MP(n,e,t){for(var i=(n.mode&1)!==0;He!==null;){var r=He,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||yp;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||bi;a=yp;var u=bi;if(yp=o,(bi=l)&&!u)for(He=r;He!==null;)o=He,l=o.child,o.tag===22&&o.memoizedState!==null?Tw(r):l!==null?(l.return=o,He=l):Tw(r);for(;s!==null;)He=s,MP(s),s=s.sibling;He=r,yp=a,bi=u}Sw(n)}else r.subtreeFlags&8772&&s!==null?(s.return=r,He=s):Sw(n)}}function Sw(n){for(;He!==null;){var e=He;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:bi||h0(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!bi)if(t===null)i.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:Qr(e.type,t.memoizedProps);i.componentDidUpdate(r,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&rw(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}rw(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Dd(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(xe(163))}bi||e.flags&512&&kx(e)}catch(p){En(e,e.return,p)}}if(e===n){He=null;break}if(t=e.sibling,t!==null){t.return=e.return,He=t;break}He=e.return}}function Ew(n){for(;He!==null;){var e=He;if(e===n){He=null;break}var t=e.sibling;if(t!==null){t.return=e.return,He=t;break}He=e.return}}function Tw(n){for(;He!==null;){var e=He;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{h0(4,e)}catch(l){En(e,t,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){En(e,r,l)}}var s=e.return;try{kx(e)}catch(l){En(e,s,l)}break;case 5:var o=e.return;try{kx(e)}catch(l){En(e,o,l)}}}catch(l){En(e,e.return,l)}if(e===n){He=null;break}var a=e.sibling;if(a!==null){a.return=e.return,He=a;break}He=e.return}}var _U=Math.ceil,Sg=Oo.ReactCurrentDispatcher,jS=Oo.ReactCurrentOwner,Or=Oo.ReactCurrentBatchConfig,zt=0,ii=null,Nn=null,fi=0,or=0,ac=ka(0),zn=0,Wd=null,Gl=0,d0=0,$S=0,md=null,Vi=null,YS=0,Uc=1/0,mo=null,Eg=!1,Gx=null,ba=null,xp=!1,pa=null,Tg=0,gd=0,Hx=null,Bm=-1,zm=0;function Ui(){return zt&6?Rn():Bm!==-1?Bm:Bm=Rn()}function wa(n){return n.mode&1?zt&2&&fi!==0?fi&-fi:eU.transition!==null?(zm===0&&(zm=c2()),zm):(n=Yt,n!==0||(n=window.event,n=n===void 0?16:_2(n.type)),n):1}function os(n,e,t,i){if(50<gd)throw gd=0,Hx=null,Error(xe(185));rf(n,t,i),(!(zt&2)||n!==ii)&&(n===ii&&(!(zt&2)&&(d0|=t),zn===4&&ha(n,fi)),qi(n,i),t===1&&zt===0&&!(e.mode&1)&&(Uc=Rn()+500,l0&&Ba()))}function qi(n,e){var t=n.callbackNode;eN(n,e);var i=og(n,n===ii?fi:0);if(i===0)t!==null&&Lb(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&Lb(t),e===1)n.tag===0?JN(bw.bind(null,n)):F2(bw.bind(null,n)),qN(function(){!(zt&6)&&Ba()}),t=null;else{switch(h2(i)){case 1:t=xS;break;case 4:t=l2;break;case 16:t=sg;break;case 536870912:t=u2;break;default:t=sg}t=UP(t,CP.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function CP(n,e){if(Bm=-1,zm=0,zt&6)throw Error(xe(327));var t=n.callbackNode;if(vc()&&n.callbackNode!==t)return null;var i=og(n,n===ii?fi:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=bg(n,i);else{e=i;var r=zt;zt|=2;var s=PP();(ii!==n||fi!==e)&&(mo=null,Uc=Rn()+500,Cl(n,e));do try{xU();break}catch(a){RP(n,a)}while(1);DS(),Sg.current=s,zt=r,Nn!==null?e=0:(ii=null,fi=0,e=zn)}if(e!==0){if(e===2&&(r=mx(n),r!==0&&(i=r,e=Vx(n,r))),e===1)throw t=Wd,Cl(n,0),ha(n,i),qi(n,Rn()),t;if(e===6)ha(n,i);else{if(r=n.current.alternate,!(i&30)&&!vU(r)&&(e=bg(n,i),e===2&&(s=mx(n),s!==0&&(i=s,e=Vx(n,s))),e===1))throw t=Wd,Cl(n,0),ha(n,i),qi(n,Rn()),t;switch(n.finishedWork=r,n.finishedLanes=i,e){case 0:case 1:throw Error(xe(345));case 2:al(n,Vi,mo);break;case 3:if(ha(n,i),(i&130023424)===i&&(e=YS+500-Rn(),10<e)){if(og(n,0)!==0)break;if(r=n.suspendedLanes,(r&i)!==i){Ui(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=Tx(al.bind(null,n,Vi,mo),e);break}al(n,Vi,mo);break;case 4:if(ha(n,i),(i&4194240)===i)break;for(e=n.eventTimes,r=-1;0<i;){var o=31-ss(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=Rn()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*_U(i/1960))-i,10<i){n.timeoutHandle=Tx(al.bind(null,n,Vi,mo),i);break}al(n,Vi,mo);break;case 5:al(n,Vi,mo);break;default:throw Error(xe(329))}}}return qi(n,Rn()),n.callbackNode===t?CP.bind(null,n):null}function Vx(n,e){var t=md;return n.current.memoizedState.isDehydrated&&(Cl(n,e).flags|=256),n=bg(n,e),n!==2&&(e=Vi,Vi=t,e!==null&&Wx(e)),n}function Wx(n){Vi===null?Vi=n:Vi.push.apply(Vi,n)}function vU(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var r=t[i],s=r.getSnapshot;r=r.value;try{if(!cs(s(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ha(n,e){for(e&=~$S,e&=~d0,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-ss(e),i=1<<t;n[t]=-1,e&=~i}}function bw(n){if(zt&6)throw Error(xe(327));vc();var e=og(n,0);if(!(e&1))return qi(n,Rn()),null;var t=bg(n,e);if(n.tag!==0&&t===2){var i=mx(n);i!==0&&(e=i,t=Vx(n,i))}if(t===1)throw t=Wd,Cl(n,0),ha(n,e),qi(n,Rn()),t;if(t===6)throw Error(xe(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,al(n,Vi,mo),qi(n,Rn()),null}function qS(n,e){var t=zt;zt|=1;try{return n(e)}finally{zt=t,zt===0&&(Uc=Rn()+500,l0&&Ba())}}function Hl(n){pa!==null&&pa.tag===0&&!(zt&6)&&vc();var e=zt;zt|=1;var t=Or.transition,i=Yt;try{if(Or.transition=null,Yt=1,n)return n()}finally{Yt=i,Or.transition=t,zt=e,!(zt&6)&&Ba()}}function KS(){or=ac.current,on(ac)}function Cl(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,YN(t)),Nn!==null)for(t=Nn.return;t!==null;){var i=t;switch(PS(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&hg();break;case 3:Dc(),on($i),on(Ai),BS();break;case 5:kS(i);break;case 4:Dc();break;case 13:on(mn);break;case 19:on(mn);break;case 10:NS(i.type._context);break;case 22:case 23:KS()}t=t.return}if(ii=n,Nn=n=Aa(n.current,null),fi=or=e,zn=0,Wd=null,$S=d0=Gl=0,Vi=md=null,El!==null){for(e=0;e<El.length;e++)if(t=El[e],i=t.interleaved,i!==null){t.interleaved=null;var r=i.next,s=t.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}t.pending=i}El=null}return n}function RP(n,e){do{var t=Nn;try{if(DS(),Fm.current=xg,yg){for(var i=_n.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}yg=!1}if(zl=0,Jn=Bn=_n=null,fd=!1,Gd=0,jS.current=null,t===null||t.return===null){zn=1,Wd=e,Nn=null;break}e:{var s=n,o=t.return,a=t,l=e;if(e=fi,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=hw(o);if(m!==null){m.flags&=-257,dw(m,o,a,s,e),m.mode&1&&cw(s,u,e),e=m,l=u;var v=e.updateQueue;if(v===null){var x=new Set;x.add(l),e.updateQueue=x}else v.add(l);break e}else{if(!(e&1)){cw(s,u,e),ZS();break e}l=Error(xe(426))}}else if(cn&&a.mode&1){var y=hw(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),dw(y,o,a,s,e),IS(Nc(l,a));break e}}s=l=Nc(l,a),zn!==4&&(zn=2),md===null?md=[s]:md.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=dP(s,l,e);iw(s,g);break e;case 1:a=l;var T=s.type,S=s.stateNode;if(!(s.flags&128)&&(typeof T.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(ba===null||!ba.has(S)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=fP(s,a,e);iw(s,w);break e}}s=s.return}while(s!==null)}LP(t)}catch(M){e=M,Nn===t&&t!==null&&(Nn=t=t.return);continue}break}while(1)}function PP(){var n=Sg.current;return Sg.current=xg,n===null?xg:n}function ZS(){(zn===0||zn===3||zn===2)&&(zn=4),ii===null||!(Gl&268435455)&&!(d0&268435455)||ha(ii,fi)}function bg(n,e){var t=zt;zt|=2;var i=PP();(ii!==n||fi!==e)&&(mo=null,Cl(n,e));do try{yU();break}catch(r){RP(n,r)}while(1);if(DS(),zt=t,Sg.current=i,Nn!==null)throw Error(xe(261));return ii=null,fi=0,zn}function yU(){for(;Nn!==null;)IP(Nn)}function xU(){for(;Nn!==null&&!XD();)IP(Nn)}function IP(n){var e=NP(n.alternate,n,or);n.memoizedProps=n.pendingProps,e===null?LP(n):Nn=e,jS.current=null}function LP(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=fU(t,e),t!==null){t.flags&=32767,Nn=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{zn=6,Nn=null;return}}else if(t=dU(t,e,or),t!==null){Nn=t;return}if(e=e.sibling,e!==null){Nn=e;return}Nn=e=n}while(e!==null);zn===0&&(zn=5)}function al(n,e,t){var i=Yt,r=Or.transition;try{Or.transition=null,Yt=1,SU(n,e,t,i)}finally{Or.transition=r,Yt=i}return null}function SU(n,e,t,i){do vc();while(pa!==null);if(zt&6)throw Error(xe(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(xe(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(tN(n,s),n===ii&&(Nn=ii=null,fi=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||xp||(xp=!0,UP(sg,function(){return vc(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=Or.transition,Or.transition=null;var o=Yt;Yt=1;var a=zt;zt|=4,jS.current=null,mU(n,t),AP(t,n),GN(Sx),ag=!!xx,Sx=xx=null,n.current=t,gU(t),jD(),zt=a,Yt=o,Or.transition=s}else n.current=t;if(xp&&(xp=!1,pa=n,Tg=r),s=n.pendingLanes,s===0&&(ba=null),qD(t.stateNode),qi(n,Rn()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],i(r.value,{componentStack:r.stack,digest:r.digest});if(Eg)throw Eg=!1,n=Gx,Gx=null,n;return Tg&1&&n.tag!==0&&vc(),s=n.pendingLanes,s&1?n===Hx?gd++:(gd=0,Hx=n):gd=0,Ba(),null}function vc(){if(pa!==null){var n=h2(Tg),e=Or.transition,t=Yt;try{if(Or.transition=null,Yt=16>n?16:n,pa===null)var i=!1;else{if(n=pa,pa=null,Tg=0,zt&6)throw Error(xe(331));var r=zt;for(zt|=4,He=n.current;He!==null;){var s=He,o=s.child;if(He.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(He=u;He!==null;){var d=He;switch(d.tag){case 0:case 11:case 15:pd(8,d,s)}var f=d.child;if(f!==null)f.return=d,He=f;else for(;He!==null;){d=He;var p=d.sibling,m=d.return;if(TP(d),d===u){He=null;break}if(p!==null){p.return=m,He=p;break}He=m}}}var v=s.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var y=x.sibling;x.sibling=null,x=y}while(x!==null)}}He=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,He=o;else e:for(;He!==null;){if(s=He,s.flags&2048)switch(s.tag){case 0:case 11:case 15:pd(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,He=g;break e}He=s.return}}var T=n.current;for(He=T;He!==null;){o=He;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,He=S;else e:for(o=T;He!==null;){if(a=He,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:h0(9,a)}}catch(M){En(a,a.return,M)}if(a===o){He=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,He=w;break e}He=a.return}}if(zt=r,Ba(),Bs&&typeof Bs.onPostCommitFiberRoot=="function")try{Bs.onPostCommitFiberRoot(i0,n)}catch{}i=!0}return i}finally{Yt=t,Or.transition=e}}return!1}function ww(n,e,t){e=Nc(t,e),e=dP(n,e,1),n=Ta(n,e,1),e=Ui(),n!==null&&(rf(n,1,e),qi(n,e))}function En(n,e,t){if(n.tag===3)ww(n,n,t);else for(;e!==null;){if(e.tag===3){ww(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ba===null||!ba.has(i))){n=Nc(t,n),n=fP(e,n,1),e=Ta(e,n,1),n=Ui(),e!==null&&(rf(e,1,n),qi(e,n));break}}e=e.return}}function EU(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=Ui(),n.pingedLanes|=n.suspendedLanes&t,ii===n&&(fi&t)===t&&(zn===4||zn===3&&(fi&130023424)===fi&&500>Rn()-YS?Cl(n,0):$S|=t),qi(n,e)}function DP(n,e){e===0&&(n.mode&1?(e=cp,cp<<=1,!(cp&130023424)&&(cp=4194304)):e=1);var t=Ui();n=Lo(n,e),n!==null&&(rf(n,e,t),qi(n,t))}function TU(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),DP(n,t)}function bU(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(xe(314))}i!==null&&i.delete(e),DP(n,t)}var NP;NP=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||$i.current)Xi=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Xi=!1,hU(n,e,t);Xi=!!(n.flags&131072)}else Xi=!1,cn&&e.flags&1048576&&O2(e,pg,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;km(n,e),n=e.pendingProps;var r=Pc(e,Ai.current);_c(e,t),r=GS(null,e,i,n,r,t);var s=HS();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Yi(i)?(s=!0,dg(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,FS(e),r.updater=u0,e.stateNode=r,r._reactInternals=e,Px(e,i,n,t),e=Dx(null,e,i,!0,s,t)):(e.tag=0,cn&&s&&RS(e),Li(null,e,r,t),e=e.child),e;case 16:i=e.elementType;e:{switch(km(n,e),n=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=AU(i),n=Qr(i,n),r){case 0:e=Lx(null,e,i,n,t);break e;case 1:e=mw(null,e,i,n,t);break e;case 11:e=fw(null,e,i,n,t);break e;case 14:e=pw(null,e,i,Qr(i.type,n),t);break e}throw Error(xe(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Qr(i,r),Lx(n,e,i,r,t);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Qr(i,r),mw(n,e,i,r,t);case 3:e:{if(_P(e),n===null)throw Error(xe(387));i=e.pendingProps,s=e.memoizedState,r=s.element,G2(n,e),_g(e,i,null,t);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Nc(Error(xe(423)),e),e=gw(n,e,i,t,r);break e}else if(i!==r){r=Nc(Error(xe(424)),e),e=gw(n,e,i,t,r);break e}else for(ar=Ea(e.stateNode.containerInfo.firstChild),lr=e,cn=!0,es=null,t=X2(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Ic(),i===r){e=Do(n,e,t);break e}Li(n,e,i,t)}e=e.child}return e;case 5:return j2(e),n===null&&Mx(e),i=e.type,r=e.pendingProps,s=n!==null?n.memoizedProps:null,o=r.children,Ex(i,r)?o=null:s!==null&&Ex(i,s)&&(e.flags|=32),gP(n,e),Li(n,e,o,t),e.child;case 6:return n===null&&Mx(e),null;case 13:return vP(n,e,t);case 4:return OS(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=Lc(e,null,i,t):Li(n,e,i,t),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Qr(i,r),fw(n,e,i,r,t);case 7:return Li(n,e,e.pendingProps,t),e.child;case 8:return Li(n,e,e.pendingProps.children,t),e.child;case 12:return Li(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,Jt(mg,i._currentValue),i._currentValue=o,s!==null)if(cs(s.value,o)){if(s.children===r.children&&!$i.current){e=Do(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Ao(-1,t&-t),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),Cx(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(xe(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),Cx(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Li(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,_c(e,t),r=kr(r),i=i(r),e.flags|=1,Li(n,e,i,t),e.child;case 14:return i=e.type,r=Qr(i,e.pendingProps),r=Qr(i.type,r),pw(n,e,i,r,t);case 15:return pP(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Qr(i,r),km(n,e),e.tag=1,Yi(i)?(n=!0,dg(e)):n=!1,_c(e,t),V2(e,i,r),Px(e,i,r,t),Dx(null,e,i,!0,n,t);case 19:return yP(n,e,t);case 22:return mP(n,e,t)}throw Error(xe(156,e.tag))};function UP(n,e){return a2(n,e)}function wU(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dr(n,e,t,i){return new wU(n,e,t,i)}function QS(n){return n=n.prototype,!(!n||!n.isReactComponent)}function AU(n){if(typeof n=="function")return QS(n)?1:0;if(n!=null){if(n=n.$$typeof,n===_S)return 11;if(n===vS)return 14}return 2}function Aa(n,e){var t=n.alternate;return t===null?(t=Dr(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Gm(n,e,t,i,r,s){var o=2;if(i=n,typeof n=="function")QS(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Zu:return Rl(t.children,r,s,e);case gS:o=8,r|=8;break;case ex:return n=Dr(12,t,e,r|2),n.elementType=ex,n.lanes=s,n;case tx:return n=Dr(13,t,e,r),n.elementType=tx,n.lanes=s,n;case nx:return n=Dr(19,t,e,r),n.elementType=nx,n.lanes=s,n;case WR:return f0(t,r,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case HR:o=10;break e;case VR:o=9;break e;case _S:o=11;break e;case vS:o=14;break e;case sa:o=16,i=null;break e}throw Error(xe(130,n==null?n:typeof n,""))}return e=Dr(o,t,e,r),e.elementType=n,e.type=i,e.lanes=s,e}function Rl(n,e,t,i){return n=Dr(7,n,i,e),n.lanes=t,n}function f0(n,e,t,i){return n=Dr(22,n,i,e),n.elementType=WR,n.lanes=t,n.stateNode={isHidden:!1},n}function xv(n,e,t){return n=Dr(6,n,null,e),n.lanes=t,n}function Sv(n,e,t){return e=Dr(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function MU(n,e,t,i,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tv(0),this.expirationTimes=tv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tv(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function JS(n,e,t,i,r,s,o,a,l){return n=new MU(n,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Dr(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},FS(s),n}function CU(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ku,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function FP(n){if(!n)return La;n=n._reactInternals;e:{if(Kl(n)!==n||n.tag!==1)throw Error(xe(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Yi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(xe(171))}if(n.tag===1){var t=n.type;if(Yi(t))return U2(n,t,e)}return e}function OP(n,e,t,i,r,s,o,a,l){return n=JS(t,i,!0,n,r,s,o,a,l),n.context=FP(null),t=n.current,i=Ui(),r=wa(t),s=Ao(i,r),s.callback=e??null,Ta(t,s,r),n.current.lanes=r,rf(n,r,i),qi(n,i),n}function p0(n,e,t,i){var r=e.current,s=Ui(),o=wa(r);return t=FP(t),e.context===null?e.context=t:e.pendingContext=t,e=Ao(s,o),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=Ta(r,e,o),n!==null&&(os(n,r,o,s),Um(n,r,o)),o}function wg(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Aw(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function eE(n,e){Aw(n,e),(n=n.alternate)&&Aw(n,e)}function RU(){return null}var kP=typeof reportError=="function"?reportError:function(n){console.error(n)};function tE(n){this._internalRoot=n}m0.prototype.render=tE.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(xe(409));p0(n,e,null,null)};m0.prototype.unmount=tE.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Hl(function(){p0(null,n,null,null)}),e[Io]=null}};function m0(n){this._internalRoot=n}m0.prototype.unstable_scheduleHydration=function(n){if(n){var e=p2();n={blockedOn:null,target:n,priority:e};for(var t=0;t<ca.length&&e!==0&&e<ca[t].priority;t++);ca.splice(t,0,n),t===0&&g2(n)}};function nE(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function g0(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Mw(){}function PU(n,e,t,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var u=wg(o);s.call(u)}}var o=OP(e,i,n,0,null,!1,!1,"",Mw);return n._reactRootContainer=o,n[Io]=o.current,Fd(n.nodeType===8?n.parentNode:n),Hl(),o}for(;r=n.lastChild;)n.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var u=wg(l);a.call(u)}}var l=JS(n,0,!1,null,null,!1,!1,"",Mw);return n._reactRootContainer=l,n[Io]=l.current,Fd(n.nodeType===8?n.parentNode:n),Hl(function(){p0(e,l,t,i)}),l}function _0(n,e,t,i,r){var s=t._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=wg(o);a.call(l)}}p0(e,o,n,r)}else o=PU(t,e,n,r,i);return wg(o)}d2=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Kh(e.pendingLanes);t!==0&&(SS(e,t|1),qi(e,Rn()),!(zt&6)&&(Uc=Rn()+500,Ba()))}break;case 13:Hl(function(){var i=Lo(n,1);if(i!==null){var r=Ui();os(i,n,1,r)}}),eE(n,1)}};ES=function(n){if(n.tag===13){var e=Lo(n,134217728);if(e!==null){var t=Ui();os(e,n,134217728,t)}eE(n,134217728)}};f2=function(n){if(n.tag===13){var e=wa(n),t=Lo(n,e);if(t!==null){var i=Ui();os(t,n,e,i)}eE(n,e)}};p2=function(){return Yt};m2=function(n,e){var t=Yt;try{return Yt=n,e()}finally{Yt=t}};dx=function(n,e,t){switch(e){case"input":if(sx(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var r=a0(i);if(!r)throw Error(xe(90));jR(i),sx(i,r)}}}break;case"textarea":YR(n,t);break;case"select":e=t.value,e!=null&&fc(n,!!t.multiple,e,!1)}};t2=qS;n2=Hl;var IU={usingClientEntryPoint:!1,Events:[of,tc,a0,JR,e2,qS]},Dh={findFiberByHostInstance:Sl,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},LU={bundleType:Dh.bundleType,version:Dh.version,rendererPackageName:Dh.rendererPackageName,rendererConfig:Dh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Oo.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=s2(n),n===null?null:n.stateNode},findFiberByHostInstance:Dh.findFiberByHostInstance||RU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sp.isDisabled&&Sp.supportsFiber)try{i0=Sp.inject(LU),Bs=Sp}catch{}}dr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IU;dr.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nE(e))throw Error(xe(200));return CU(n,e,null,t)};dr.createRoot=function(n,e){if(!nE(n))throw Error(xe(299));var t=!1,i="",r=kP;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=JS(n,1,!1,null,null,t,!1,i,r),n[Io]=e.current,Fd(n.nodeType===8?n.parentNode:n),new tE(e)};dr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(xe(188)):(n=Object.keys(n).join(","),Error(xe(268,n)));return n=s2(e),n=n===null?null:n.stateNode,n};dr.flushSync=function(n){return Hl(n)};dr.hydrate=function(n,e,t){if(!g0(e))throw Error(xe(200));return _0(null,n,e,!0,t)};dr.hydrateRoot=function(n,e,t){if(!nE(n))throw Error(xe(405));var i=t!=null&&t.hydratedSources||null,r=!1,s="",o=kP;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=OP(e,null,n,1,t??null,r,!1,s,o),n[Io]=e.current,Fd(n),i)for(n=0;n<i.length;n++)t=i[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new m0(e)};dr.render=function(n,e,t){if(!g0(e))throw Error(xe(200));return _0(null,n,e,!1,t)};dr.unmountComponentAtNode=function(n){if(!g0(n))throw Error(xe(40));return n._reactRootContainer?(Hl(function(){_0(null,null,n,!1,function(){n._reactRootContainer=null,n[Io]=null})}),!0):!1};dr.unstable_batchedUpdates=qS;dr.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!g0(t))throw Error(xe(200));if(n==null||n._reactInternals===void 0)throw Error(xe(38));return _0(n,e,t,!1,i)};dr.version="18.2.0-next-9e3b772b8-20220608";function BP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(BP)}catch(n){console.error(n)}}BP(),OR.exports=dr;var DU=OR.exports,Cw=DU;Qy.createRoot=Cw.createRoot,Qy.hydrateRoot=Cw.hydrateRoot;/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const iE="159",NU=0,Rw=1,UU=2,zP=1,FU=2,ho=3,No=0,Ki=1,Us=2,Ma=0,yc=1,Pw=2,Iw=3,Lw=4,OU=5,gl=100,kU=101,BU=102,Dw=103,Nw=104,zU=200,GU=201,HU=202,VU=203,Xx=204,jx=205,WU=206,XU=207,jU=208,$U=209,YU=210,qU=211,KU=212,ZU=213,QU=214,JU=0,eF=1,tF=2,Ag=3,nF=4,iF=5,rF=6,sF=7,GP=0,oF=1,aF=2,Ca=0,lF=1,uF=2,cF=3,hF=4,dF=5,Uw="attached",fF="detached",HP=300,Fc=301,Oc=302,$x=303,Yx=304,v0=306,kc=1e3,Pr=1001,Mg=1002,ti=1003,qx=1004,Hm=1005,Wi=1006,VP=1007,Vl=1008,Ra=1009,pF=1010,mF=1011,rE=1012,WP=1013,ma=1014,So=1015,Xd=1016,XP=1017,jP=1018,Pl=1020,gF=1021,Ir=1023,_F=1024,vF=1025,Il=1026,Bc=1027,yF=1028,$P=1029,xF=1030,YP=1031,qP=1033,Ev=33776,Tv=33777,bv=33778,wv=33779,Fw=35840,Ow=35841,kw=35842,Bw=35843,KP=36196,zw=37492,Gw=37496,Hw=37808,Vw=37809,Ww=37810,Xw=37811,jw=37812,$w=37813,Yw=37814,qw=37815,Kw=37816,Zw=37817,Qw=37818,Jw=37819,eA=37820,tA=37821,Av=36492,nA=36494,iA=36495,SF=36283,rA=36284,sA=36285,oA=36286,jd=2300,zc=2301,Mv=2302,aA=2400,lA=2401,uA=2402,EF=2500,TF=0,ZP=1,Kx=2,QP=3e3,Ll=3001,bF=3200,wF=3201,JP=0,AF=1,Lr="",Tn="srgb",mi="srgb-linear",sE="display-p3",y0="display-p3-linear",Cg="linear",sn="srgb",Rg="rec709",Pg="p3",yu=7680,cA=519,MF=512,CF=513,RF=514,eI=515,PF=516,IF=517,LF=518,DF=519,Zx=35044,hA="300 es",Qx=1035,Eo=2e3,Ig=2001;class Jc{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Si=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let dA=1234567;const _d=Math.PI/180,Gc=180/Math.PI;function as(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Si[n&255]+Si[n>>8&255]+Si[n>>16&255]+Si[n>>24&255]+"-"+Si[e&255]+Si[e>>8&255]+"-"+Si[e>>16&15|64]+Si[e>>24&255]+"-"+Si[t&63|128]+Si[t>>8&255]+"-"+Si[t>>16&255]+Si[t>>24&255]+Si[i&255]+Si[i>>8&255]+Si[i>>16&255]+Si[i>>24&255]).toLowerCase()}function wi(n,e,t){return Math.max(e,Math.min(t,n))}function oE(n,e){return(n%e+e)%e}function NF(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function UF(n,e,t){return n!==e?(t-n)/(e-n):0}function vd(n,e,t){return(1-t)*n+t*e}function FF(n,e,t,i){return vd(n,e,1-Math.exp(-t*i))}function OF(n,e=1){return e-Math.abs(oE(n,e*2)-e)}function kF(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function BF(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function zF(n,e){return n+Math.floor(Math.random()*(e-n+1))}function GF(n,e){return n+Math.random()*(e-n)}function HF(n){return n*(.5-Math.random())}function VF(n){n!==void 0&&(dA=n);let e=dA+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function WF(n){return n*_d}function XF(n){return n*Gc}function Jx(n){return(n&n-1)===0&&n!==0}function jF(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Lg(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function $F(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),u=s((e+i)/2),d=o((e+i)/2),f=s((e-i)/2),p=o((e-i)/2),m=s((i-e)/2),v=o((i-e)/2);switch(r){case"XYX":n.set(a*d,l*f,l*p,a*u);break;case"YZY":n.set(l*p,a*d,l*f,a*u);break;case"ZXZ":n.set(l*f,l*p,a*d,a*u);break;case"XZX":n.set(a*d,l*v,l*m,a*u);break;case"YXY":n.set(l*m,a*d,l*v,a*u);break;case"ZYZ":n.set(l*v,l*m,a*d,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Fs(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Kt(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const YF={DEG2RAD:_d,RAD2DEG:Gc,generateUUID:as,clamp:wi,euclideanModulo:oE,mapLinear:NF,inverseLerp:UF,lerp:vd,damp:FF,pingpong:OF,smoothstep:kF,smootherstep:BF,randInt:zF,randFloat:GF,randFloatSpread:HF,seededRandom:VF,degToRad:WF,radToDeg:XF,isPowerOfTwo:Jx,ceilPowerOfTwo:jF,floorPowerOfTwo:Lg,setQuaternionFromProperEuler:$F,normalize:Kt,denormalize:Fs};class Ft{constructor(e=0,t=0){Ft.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(wi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Mt{constructor(e,t,i,r,s,o,a,l,u){Mt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,u)}set(e,t,i,r,s,o,a,l,u){const d=this.elements;return d[0]=e,d[1]=r,d[2]=a,d[3]=t,d[4]=s,d[5]=l,d[6]=i,d[7]=o,d[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],u=i[1],d=i[4],f=i[7],p=i[2],m=i[5],v=i[8],x=r[0],y=r[3],g=r[6],T=r[1],S=r[4],w=r[7],M=r[2],P=r[5],R=r[8];return s[0]=o*x+a*T+l*M,s[3]=o*y+a*S+l*P,s[6]=o*g+a*w+l*R,s[1]=u*x+d*T+f*M,s[4]=u*y+d*S+f*P,s[7]=u*g+d*w+f*R,s[2]=p*x+m*T+v*M,s[5]=p*y+m*S+v*P,s[8]=p*g+m*w+v*R,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],d=e[8];return t*o*d-t*a*u-i*s*d+i*a*l+r*s*u-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],d=e[8],f=d*o-a*u,p=a*l-d*s,m=u*s-o*l,v=t*f+i*p+r*m;if(v===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/v;return e[0]=f*x,e[1]=(r*u-d*i)*x,e[2]=(a*i-r*o)*x,e[3]=p*x,e[4]=(d*t-r*l)*x,e[5]=(r*s-a*t)*x,e[6]=m*x,e[7]=(i*l-u*t)*x,e[8]=(o*t-i*s)*x,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),u=Math.sin(s);return this.set(i*l,i*u,-i*(l*o+u*a)+o+e,-r*u,r*l,-r*(-u*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(Cv.makeScale(e,t)),this}rotate(e){return this.premultiply(Cv.makeRotation(-e)),this}translate(e,t){return this.premultiply(Cv.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Cv=new Mt;function tI(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function $d(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function qF(){const n=$d("canvas");return n.style.display="block",n}const fA={};function yd(n){n in fA||(fA[n]=!0,console.warn(n))}const pA=new Mt().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),mA=new Mt().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Ep={[mi]:{transfer:Cg,primaries:Rg,toReference:n=>n,fromReference:n=>n},[Tn]:{transfer:sn,primaries:Rg,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[y0]:{transfer:Cg,primaries:Pg,toReference:n=>n.applyMatrix3(mA),fromReference:n=>n.applyMatrix3(pA)},[sE]:{transfer:sn,primaries:Pg,toReference:n=>n.convertSRGBToLinear().applyMatrix3(mA),fromReference:n=>n.applyMatrix3(pA).convertLinearToSRGB()}},KF=new Set([mi,y0]),jt={enabled:!0,_workingColorSpace:mi,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!KF.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const i=Ep[e].toReference,r=Ep[t].fromReference;return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return Ep[n].primaries},getTransfer:function(n){return n===Lr?Cg:Ep[n].transfer}};function xc(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Rv(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let xu;class nI{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{xu===void 0&&(xu=$d("canvas")),xu.width=e.width,xu.height=e.height;const i=xu.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=xu}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=$d("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=xc(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(xc(t[i]/255)*255):t[i]=xc(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let ZF=0;class iI{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:ZF++}),this.uuid=as(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(Pv(r[o].image)):s.push(Pv(r[o]))}else s=Pv(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function Pv(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?nI.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let QF=0,hr=class Vm extends Jc{constructor(e=Vm.DEFAULT_IMAGE,t=Vm.DEFAULT_MAPPING,i=Pr,r=Pr,s=Wi,o=Vl,a=Ir,l=Ra,u=Vm.DEFAULT_ANISOTROPY,d=Lr){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:QF++}),this.uuid=as(),this.name="",this.source=new iI(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Ft(0,0),this.repeat=new Ft(1,1),this.center=new Ft(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Mt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof d=="string"?this.colorSpace=d:(yd("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=d===Ll?Tn:Lr),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==HP)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case kc:e.x=e.x-Math.floor(e.x);break;case Pr:e.x=e.x<0?0:1;break;case Mg:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case kc:e.y=e.y-Math.floor(e.y);break;case Pr:e.y=e.y<0?0:1;break;case Mg:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return yd("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Tn?Ll:QP}set encoding(e){yd("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===Ll?Tn:Lr}};hr.DEFAULT_IMAGE=null;hr.DEFAULT_MAPPING=HP;hr.DEFAULT_ANISOTROPY=1;class Qt{constructor(e=0,t=0,i=0,r=1){Qt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,u=l[0],d=l[4],f=l[8],p=l[1],m=l[5],v=l[9],x=l[2],y=l[6],g=l[10];if(Math.abs(d-p)<.01&&Math.abs(f-x)<.01&&Math.abs(v-y)<.01){if(Math.abs(d+p)<.1&&Math.abs(f+x)<.1&&Math.abs(v+y)<.1&&Math.abs(u+m+g-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const S=(u+1)/2,w=(m+1)/2,M=(g+1)/2,P=(d+p)/4,R=(f+x)/4,D=(v+y)/4;return S>w&&S>M?S<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(S),r=P/i,s=R/i):w>M?w<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(w),i=P/r,s=D/r):M<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(M),i=R/s,r=D/s),this.set(i,r,s,t),this}let T=Math.sqrt((y-v)*(y-v)+(f-x)*(f-x)+(p-d)*(p-d));return Math.abs(T)<.001&&(T=1),this.x=(y-v)/T,this.y=(f-x)/T,this.z=(p-d)/T,this.w=Math.acos((u+m+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class JF extends Jc{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Qt(0,0,e,t),this.scissorTest=!1,this.viewport=new Qt(0,0,e,t);const r={width:e,height:t,depth:1};i.encoding!==void 0&&(yd("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Ll?Tn:Lr),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Wi,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new hr(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new iI(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Wl extends JF{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class rI extends hr{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=ti,this.minFilter=ti,this.wrapR=Pr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class eO extends hr{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=ti,this.minFilter=ti,this.wrapR=Pr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class za{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],u=i[r+1],d=i[r+2],f=i[r+3];const p=s[o+0],m=s[o+1],v=s[o+2],x=s[o+3];if(a===0){e[t+0]=l,e[t+1]=u,e[t+2]=d,e[t+3]=f;return}if(a===1){e[t+0]=p,e[t+1]=m,e[t+2]=v,e[t+3]=x;return}if(f!==x||l!==p||u!==m||d!==v){let y=1-a;const g=l*p+u*m+d*v+f*x,T=g>=0?1:-1,S=1-g*g;if(S>Number.EPSILON){const M=Math.sqrt(S),P=Math.atan2(M,g*T);y=Math.sin(y*P)/M,a=Math.sin(a*P)/M}const w=a*T;if(l=l*y+p*w,u=u*y+m*w,d=d*y+v*w,f=f*y+x*w,y===1-a){const M=1/Math.sqrt(l*l+u*u+d*d+f*f);l*=M,u*=M,d*=M,f*=M}}e[t]=l,e[t+1]=u,e[t+2]=d,e[t+3]=f}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],u=i[r+2],d=i[r+3],f=s[o],p=s[o+1],m=s[o+2],v=s[o+3];return e[t]=a*v+d*f+l*m-u*p,e[t+1]=l*v+d*p+u*f-a*m,e[t+2]=u*v+d*m+a*p-l*f,e[t+3]=d*v-a*f-l*p-u*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,u=a(i/2),d=a(r/2),f=a(s/2),p=l(i/2),m=l(r/2),v=l(s/2);switch(o){case"XYZ":this._x=p*d*f+u*m*v,this._y=u*m*f-p*d*v,this._z=u*d*v+p*m*f,this._w=u*d*f-p*m*v;break;case"YXZ":this._x=p*d*f+u*m*v,this._y=u*m*f-p*d*v,this._z=u*d*v-p*m*f,this._w=u*d*f+p*m*v;break;case"ZXY":this._x=p*d*f-u*m*v,this._y=u*m*f+p*d*v,this._z=u*d*v+p*m*f,this._w=u*d*f-p*m*v;break;case"ZYX":this._x=p*d*f-u*m*v,this._y=u*m*f+p*d*v,this._z=u*d*v-p*m*f,this._w=u*d*f+p*m*v;break;case"YZX":this._x=p*d*f+u*m*v,this._y=u*m*f+p*d*v,this._z=u*d*v-p*m*f,this._w=u*d*f-p*m*v;break;case"XZY":this._x=p*d*f-u*m*v,this._y=u*m*f-p*d*v,this._z=u*d*v+p*m*f,this._w=u*d*f+p*m*v;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],u=t[2],d=t[6],f=t[10],p=i+a+f;if(p>0){const m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(d-l)*m,this._y=(s-u)*m,this._z=(o-r)*m}else if(i>a&&i>f){const m=2*Math.sqrt(1+i-a-f);this._w=(d-l)/m,this._x=.25*m,this._y=(r+o)/m,this._z=(s+u)/m}else if(a>f){const m=2*Math.sqrt(1+a-i-f);this._w=(s-u)/m,this._x=(r+o)/m,this._y=.25*m,this._z=(l+d)/m}else{const m=2*Math.sqrt(1+f-i-a);this._w=(o-r)/m,this._x=(s+u)/m,this._y=(l+d)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(wi(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,u=t._z,d=t._w;return this._x=i*d+o*a+r*u-s*l,this._y=r*d+o*l+s*a-i*u,this._z=s*d+o*u+i*l-r*a,this._w=o*d-i*a-r*l-s*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-t;return this._w=m*o+t*this._w,this._x=m*i+t*this._x,this._y=m*r+t*this._y,this._z=m*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(l),d=Math.atan2(u,a),f=Math.sin((1-t)*d)/u,p=Math.sin(t*d)/u;return this._w=o*f+this._w*p,this._x=i*f+this._x*p,this._y=r*f+this._y*p,this._z=s*f+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Y{constructor(e=0,t=0,i=0){Y.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(gA.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(gA.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,u=2*(o*r-a*i),d=2*(a*t-s*r),f=2*(s*i-o*t);return this.x=t+l*u+o*f-a*d,this.y=i+l*d+a*u-s*f,this.z=r+l*f+s*d-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return Iv.copy(this).projectOnVector(e),this.sub(Iv)}reflect(e){return this.sub(Iv.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(wi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Iv=new Y,gA=new za;class ko{constructor(e=new Y(1/0,1/0,1/0),t=new Y(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Xr.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Xr.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Xr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Xr):Xr.fromBufferAttribute(s,o),Xr.applyMatrix4(e.matrixWorld),this.expandByPoint(Xr);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Tp.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),Tp.copy(i.boundingBox)),Tp.applyMatrix4(e.matrixWorld),this.union(Tp)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Xr),Xr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Nh),bp.subVectors(this.max,Nh),Su.subVectors(e.a,Nh),Eu.subVectors(e.b,Nh),Tu.subVectors(e.c,Nh),Ko.subVectors(Eu,Su),Zo.subVectors(Tu,Eu),Qa.subVectors(Su,Tu);let t=[0,-Ko.z,Ko.y,0,-Zo.z,Zo.y,0,-Qa.z,Qa.y,Ko.z,0,-Ko.x,Zo.z,0,-Zo.x,Qa.z,0,-Qa.x,-Ko.y,Ko.x,0,-Zo.y,Zo.x,0,-Qa.y,Qa.x,0];return!Lv(t,Su,Eu,Tu,bp)||(t=[1,0,0,0,1,0,0,0,1],!Lv(t,Su,Eu,Tu,bp))?!1:(wp.crossVectors(Ko,Zo),t=[wp.x,wp.y,wp.z],Lv(t,Su,Eu,Tu,bp))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Xr).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Xr).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(io[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),io[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),io[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),io[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),io[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),io[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),io[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),io[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(io),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const io=[new Y,new Y,new Y,new Y,new Y,new Y,new Y,new Y],Xr=new Y,Tp=new ko,Su=new Y,Eu=new Y,Tu=new Y,Ko=new Y,Zo=new Y,Qa=new Y,Nh=new Y,bp=new Y,wp=new Y,Ja=new Y;function Lv(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Ja.fromArray(n,s);const a=r.x*Math.abs(Ja.x)+r.y*Math.abs(Ja.y)+r.z*Math.abs(Ja.z),l=e.dot(Ja),u=t.dot(Ja),d=i.dot(Ja);if(Math.max(-Math.max(l,u,d),Math.min(l,u,d))>a)return!1}return!0}const tO=new ko,Uh=new Y,Dv=new Y;class $s{constructor(e=new Y,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):tO.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Uh.subVectors(e,this.center);const t=Uh.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector(Uh,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Dv.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Uh.copy(e.center).add(Dv)),this.expandByPoint(Uh.copy(e.center).sub(Dv))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const ro=new Y,Nv=new Y,Ap=new Y,Qo=new Y,Uv=new Y,Mp=new Y,Fv=new Y;class x0{constructor(e=new Y,t=new Y(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ro)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ro.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ro.copy(this.origin).addScaledVector(this.direction,t),ro.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){Nv.copy(e).add(t).multiplyScalar(.5),Ap.copy(t).sub(e).normalize(),Qo.copy(this.origin).sub(Nv);const s=e.distanceTo(t)*.5,o=-this.direction.dot(Ap),a=Qo.dot(this.direction),l=-Qo.dot(Ap),u=Qo.lengthSq(),d=Math.abs(1-o*o);let f,p,m,v;if(d>0)if(f=o*l-a,p=o*a-l,v=s*d,f>=0)if(p>=-v)if(p<=v){const x=1/d;f*=x,p*=x,m=f*(f+o*p+2*a)+p*(o*f+p+2*l)+u}else p=s,f=Math.max(0,-(o*p+a)),m=-f*f+p*(p+2*l)+u;else p=-s,f=Math.max(0,-(o*p+a)),m=-f*f+p*(p+2*l)+u;else p<=-v?(f=Math.max(0,-(-o*s+a)),p=f>0?-s:Math.min(Math.max(-s,-l),s),m=-f*f+p*(p+2*l)+u):p<=v?(f=0,p=Math.min(Math.max(-s,-l),s),m=p*(p+2*l)+u):(f=Math.max(0,-(o*s+a)),p=f>0?s:Math.min(Math.max(-s,-l),s),m=-f*f+p*(p+2*l)+u);else p=o>0?-s:s,f=Math.max(0,-(o*p+a)),m=-f*f+p*(p+2*l)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,f),r&&r.copy(Nv).addScaledVector(Ap,p),m}intersectSphere(e,t){ro.subVectors(e.center,this.origin);const i=ro.dot(this.direction),r=ro.dot(ro)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const u=1/this.direction.x,d=1/this.direction.y,f=1/this.direction.z,p=this.origin;return u>=0?(i=(e.min.x-p.x)*u,r=(e.max.x-p.x)*u):(i=(e.max.x-p.x)*u,r=(e.min.x-p.x)*u),d>=0?(s=(e.min.y-p.y)*d,o=(e.max.y-p.y)*d):(s=(e.max.y-p.y)*d,o=(e.min.y-p.y)*d),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),f>=0?(a=(e.min.z-p.z)*f,l=(e.max.z-p.z)*f):(a=(e.max.z-p.z)*f,l=(e.min.z-p.z)*f),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,ro)!==null}intersectTriangle(e,t,i,r,s){Uv.subVectors(t,e),Mp.subVectors(i,e),Fv.crossVectors(Uv,Mp);let o=this.direction.dot(Fv),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Qo.subVectors(this.origin,e);const l=a*this.direction.dot(Mp.crossVectors(Qo,Mp));if(l<0)return null;const u=a*this.direction.dot(Uv.cross(Qo));if(u<0||l+u>o)return null;const d=-a*Qo.dot(Fv);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ct{constructor(e,t,i,r,s,o,a,l,u,d,f,p,m,v,x,y){Ct.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,u,d,f,p,m,v,x,y)}set(e,t,i,r,s,o,a,l,u,d,f,p,m,v,x,y){const g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=r,g[1]=s,g[5]=o,g[9]=a,g[13]=l,g[2]=u,g[6]=d,g[10]=f,g[14]=p,g[3]=m,g[7]=v,g[11]=x,g[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ct().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/bu.setFromMatrixColumn(e,0).length(),s=1/bu.setFromMatrixColumn(e,1).length(),o=1/bu.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),u=Math.sin(r),d=Math.cos(s),f=Math.sin(s);if(e.order==="XYZ"){const p=o*d,m=o*f,v=a*d,x=a*f;t[0]=l*d,t[4]=-l*f,t[8]=u,t[1]=m+v*u,t[5]=p-x*u,t[9]=-a*l,t[2]=x-p*u,t[6]=v+m*u,t[10]=o*l}else if(e.order==="YXZ"){const p=l*d,m=l*f,v=u*d,x=u*f;t[0]=p+x*a,t[4]=v*a-m,t[8]=o*u,t[1]=o*f,t[5]=o*d,t[9]=-a,t[2]=m*a-v,t[6]=x+p*a,t[10]=o*l}else if(e.order==="ZXY"){const p=l*d,m=l*f,v=u*d,x=u*f;t[0]=p-x*a,t[4]=-o*f,t[8]=v+m*a,t[1]=m+v*a,t[5]=o*d,t[9]=x-p*a,t[2]=-o*u,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const p=o*d,m=o*f,v=a*d,x=a*f;t[0]=l*d,t[4]=v*u-m,t[8]=p*u+x,t[1]=l*f,t[5]=x*u+p,t[9]=m*u-v,t[2]=-u,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const p=o*l,m=o*u,v=a*l,x=a*u;t[0]=l*d,t[4]=x-p*f,t[8]=v*f+m,t[1]=f,t[5]=o*d,t[9]=-a*d,t[2]=-u*d,t[6]=m*f+v,t[10]=p-x*f}else if(e.order==="XZY"){const p=o*l,m=o*u,v=a*l,x=a*u;t[0]=l*d,t[4]=-f,t[8]=u*d,t[1]=p*f+x,t[5]=o*d,t[9]=m*f-v,t[2]=v*f-m,t[6]=a*d,t[10]=x*f+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(nO,e,iO)}lookAt(e,t,i){const r=this.elements;return nr.subVectors(e,t),nr.lengthSq()===0&&(nr.z=1),nr.normalize(),Jo.crossVectors(i,nr),Jo.lengthSq()===0&&(Math.abs(i.z)===1?nr.x+=1e-4:nr.z+=1e-4,nr.normalize(),Jo.crossVectors(i,nr)),Jo.normalize(),Cp.crossVectors(nr,Jo),r[0]=Jo.x,r[4]=Cp.x,r[8]=nr.x,r[1]=Jo.y,r[5]=Cp.y,r[9]=nr.y,r[2]=Jo.z,r[6]=Cp.z,r[10]=nr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],u=i[12],d=i[1],f=i[5],p=i[9],m=i[13],v=i[2],x=i[6],y=i[10],g=i[14],T=i[3],S=i[7],w=i[11],M=i[15],P=r[0],R=r[4],D=r[8],C=r[12],L=r[1],Z=r[5],V=r[9],z=r[13],F=r[2],j=r[6],Q=r[10],$=r[14],O=r[3],G=r[7],k=r[11],H=r[15];return s[0]=o*P+a*L+l*F+u*O,s[4]=o*R+a*Z+l*j+u*G,s[8]=o*D+a*V+l*Q+u*k,s[12]=o*C+a*z+l*$+u*H,s[1]=d*P+f*L+p*F+m*O,s[5]=d*R+f*Z+p*j+m*G,s[9]=d*D+f*V+p*Q+m*k,s[13]=d*C+f*z+p*$+m*H,s[2]=v*P+x*L+y*F+g*O,s[6]=v*R+x*Z+y*j+g*G,s[10]=v*D+x*V+y*Q+g*k,s[14]=v*C+x*z+y*$+g*H,s[3]=T*P+S*L+w*F+M*O,s[7]=T*R+S*Z+w*j+M*G,s[11]=T*D+S*V+w*Q+M*k,s[15]=T*C+S*z+w*$+M*H,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],u=e[13],d=e[2],f=e[6],p=e[10],m=e[14],v=e[3],x=e[7],y=e[11],g=e[15];return v*(+s*l*f-r*u*f-s*a*p+i*u*p+r*a*m-i*l*m)+x*(+t*l*m-t*u*p+s*o*p-r*o*m+r*u*d-s*l*d)+y*(+t*u*f-t*a*m-s*o*f+i*o*m+s*a*d-i*u*d)+g*(-r*a*d-t*l*f+t*a*p+r*o*f-i*o*p+i*l*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],d=e[8],f=e[9],p=e[10],m=e[11],v=e[12],x=e[13],y=e[14],g=e[15],T=f*y*u-x*p*u+x*l*m-a*y*m-f*l*g+a*p*g,S=v*p*u-d*y*u-v*l*m+o*y*m+d*l*g-o*p*g,w=d*x*u-v*f*u+v*a*m-o*x*m-d*a*g+o*f*g,M=v*f*l-d*x*l-v*a*p+o*x*p+d*a*y-o*f*y,P=t*T+i*S+r*w+s*M;if(P===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const R=1/P;return e[0]=T*R,e[1]=(x*p*s-f*y*s-x*r*m+i*y*m+f*r*g-i*p*g)*R,e[2]=(a*y*s-x*l*s+x*r*u-i*y*u-a*r*g+i*l*g)*R,e[3]=(f*l*s-a*p*s-f*r*u+i*p*u+a*r*m-i*l*m)*R,e[4]=S*R,e[5]=(d*y*s-v*p*s+v*r*m-t*y*m-d*r*g+t*p*g)*R,e[6]=(v*l*s-o*y*s-v*r*u+t*y*u+o*r*g-t*l*g)*R,e[7]=(o*p*s-d*l*s+d*r*u-t*p*u-o*r*m+t*l*m)*R,e[8]=w*R,e[9]=(v*f*s-d*x*s-v*i*m+t*x*m+d*i*g-t*f*g)*R,e[10]=(o*x*s-v*a*s+v*i*u-t*x*u-o*i*g+t*a*g)*R,e[11]=(d*a*s-o*f*s-d*i*u+t*f*u+o*i*m-t*a*m)*R,e[12]=M*R,e[13]=(d*x*r-v*f*r+v*i*p-t*x*p-d*i*y+t*f*y)*R,e[14]=(v*a*r-o*x*r-v*i*l+t*x*l+o*i*y-t*a*y)*R,e[15]=(o*f*r-d*a*r+d*i*l-t*f*l-o*i*p+t*a*p)*R,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,u=s*o,d=s*a;return this.set(u*o+i,u*a-r*l,u*l+r*a,0,u*a+r*l,d*a+i,d*l-r*o,0,u*l-r*a,d*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,u=s+s,d=o+o,f=a+a,p=s*u,m=s*d,v=s*f,x=o*d,y=o*f,g=a*f,T=l*u,S=l*d,w=l*f,M=i.x,P=i.y,R=i.z;return r[0]=(1-(x+g))*M,r[1]=(m+w)*M,r[2]=(v-S)*M,r[3]=0,r[4]=(m-w)*P,r[5]=(1-(p+g))*P,r[6]=(y+T)*P,r[7]=0,r[8]=(v+S)*R,r[9]=(y-T)*R,r[10]=(1-(p+x))*R,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=bu.set(r[0],r[1],r[2]).length();const o=bu.set(r[4],r[5],r[6]).length(),a=bu.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],jr.copy(this);const u=1/s,d=1/o,f=1/a;return jr.elements[0]*=u,jr.elements[1]*=u,jr.elements[2]*=u,jr.elements[4]*=d,jr.elements[5]*=d,jr.elements[6]*=d,jr.elements[8]*=f,jr.elements[9]*=f,jr.elements[10]*=f,t.setFromRotationMatrix(jr),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=Eo){const l=this.elements,u=2*s/(t-e),d=2*s/(i-r),f=(t+e)/(t-e),p=(i+r)/(i-r);let m,v;if(a===Eo)m=-(o+s)/(o-s),v=-2*o*s/(o-s);else if(a===Ig)m=-o/(o-s),v=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=d,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=v,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=Eo){const l=this.elements,u=1/(t-e),d=1/(i-r),f=1/(o-s),p=(t+e)*u,m=(i+r)*d;let v,x;if(a===Eo)v=(o+s)*f,x=-2*f;else if(a===Ig)v=s*f,x=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*d,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=x,l[14]=-v,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const bu=new Y,jr=new Ct,nO=new Y(0,0,0),iO=new Y(1,1,1),Jo=new Y,Cp=new Y,nr=new Y,_A=new Ct,vA=new za;class S0{constructor(e=0,t=0,i=0,r=S0.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],u=r[5],d=r[9],f=r[2],p=r[6],m=r[10];switch(t){case"XYZ":this._y=Math.asin(wi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-d,m),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(p,u),this._z=0);break;case"YXZ":this._x=Math.asin(-wi(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-f,s),this._z=0);break;case"ZXY":this._x=Math.asin(wi(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-f,m),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-wi(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(p,m),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(wi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-f,s)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-wi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(p,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-d,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return _A.makeRotationFromQuaternion(e),this.setFromRotationMatrix(_A,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return vA.setFromEuler(this),this.setFromQuaternion(vA,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}S0.DEFAULT_ORDER="XYZ";class sI{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let rO=0;const yA=new Y,wu=new za,so=new Ct,Rp=new Y,Fh=new Y,sO=new Y,oO=new za,xA=new Y(1,0,0),SA=new Y(0,1,0),EA=new Y(0,0,1),aO={type:"added"},lO={type:"removed"};class vn extends Jc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:rO++}),this.uuid=as(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=vn.DEFAULT_UP.clone();const e=new Y,t=new S0,i=new za,r=new Y(1,1,1);function s(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Ct},normalMatrix:{value:new Mt}}),this.matrix=new Ct,this.matrixWorld=new Ct,this.matrixAutoUpdate=vn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=vn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new sI,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return wu.setFromAxisAngle(e,t),this.quaternion.multiply(wu),this}rotateOnWorldAxis(e,t){return wu.setFromAxisAngle(e,t),this.quaternion.premultiply(wu),this}rotateX(e){return this.rotateOnAxis(xA,e)}rotateY(e){return this.rotateOnAxis(SA,e)}rotateZ(e){return this.rotateOnAxis(EA,e)}translateOnAxis(e,t){return yA.copy(e).applyQuaternion(this.quaternion),this.position.add(yA.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(xA,e)}translateY(e){return this.translateOnAxis(SA,e)}translateZ(e){return this.translateOnAxis(EA,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(so.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?Rp.copy(e):Rp.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),Fh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?so.lookAt(Fh,Rp,this.up):so.lookAt(Rp,Fh,this.up),this.quaternion.setFromRotationMatrix(so),r&&(so.extractRotation(r.matrixWorld),wu.setFromRotationMatrix(so),this.quaternion.premultiply(wu.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(aO)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(lO)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),so.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),so.multiply(e.parent.matrixWorld)),e.applyMatrix4(so),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Fh,e,sO),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Fh,oO,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++){const s=t[i];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),r.maxGeometryCount=this._maxGeometryCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,d=l.length;u<d;u++){const f=l[u];s(e.shapes,f)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),u=o(e.textures),d=o(e.images),f=o(e.shapes),p=o(e.skeletons),m=o(e.animations),v=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),u.length>0&&(i.textures=u),d.length>0&&(i.images=d),f.length>0&&(i.shapes=f),p.length>0&&(i.skeletons=p),m.length>0&&(i.animations=m),v.length>0&&(i.nodes=v)}return i.object=r,i;function o(a){const l=[];for(const u in a){const d=a[u];delete d.metadata,l.push(d)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}vn.DEFAULT_UP=new Y(0,1,0);vn.DEFAULT_MATRIX_AUTO_UPDATE=!0;vn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const $r=new Y,oo=new Y,Ov=new Y,ao=new Y,Au=new Y,Mu=new Y,TA=new Y,kv=new Y,Bv=new Y,zv=new Y;let Pp=!1;class ts{constructor(e=new Y,t=new Y,i=new Y){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),$r.subVectors(e,t),r.cross($r);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){$r.subVectors(r,t),oo.subVectors(i,t),Ov.subVectors(e,t);const o=$r.dot($r),a=$r.dot(oo),l=$r.dot(Ov),u=oo.dot(oo),d=oo.dot(Ov),f=o*u-a*a;if(f===0)return s.set(-2,-1,-1);const p=1/f,m=(u*l-a*d)*p,v=(o*d-a*l)*p;return s.set(1-m-v,v,m)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,ao),ao.x>=0&&ao.y>=0&&ao.x+ao.y<=1}static getUV(e,t,i,r,s,o,a,l){return Pp===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Pp=!0),this.getInterpolation(e,t,i,r,s,o,a,l)}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,ao),l.setScalar(0),l.addScaledVector(s,ao.x),l.addScaledVector(o,ao.y),l.addScaledVector(a,ao.z),l}static isFrontFacing(e,t,i,r){return $r.subVectors(i,t),oo.subVectors(e,t),$r.cross(oo).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return $r.subVectors(this.c,this.b),oo.subVectors(this.a,this.b),$r.cross(oo).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ts.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ts.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return Pp===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Pp=!0),ts.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return ts.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return ts.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ts.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Au.subVectors(r,i),Mu.subVectors(s,i),kv.subVectors(e,i);const l=Au.dot(kv),u=Mu.dot(kv);if(l<=0&&u<=0)return t.copy(i);Bv.subVectors(e,r);const d=Au.dot(Bv),f=Mu.dot(Bv);if(d>=0&&f<=d)return t.copy(r);const p=l*f-d*u;if(p<=0&&l>=0&&d<=0)return o=l/(l-d),t.copy(i).addScaledVector(Au,o);zv.subVectors(e,s);const m=Au.dot(zv),v=Mu.dot(zv);if(v>=0&&m<=v)return t.copy(s);const x=m*u-l*v;if(x<=0&&u>=0&&v<=0)return a=u/(u-v),t.copy(i).addScaledVector(Mu,a);const y=d*v-m*f;if(y<=0&&f-d>=0&&m-v>=0)return TA.subVectors(s,r),a=(f-d)/(f-d+(m-v)),t.copy(r).addScaledVector(TA,a);const g=1/(y+x+p);return o=x*g,a=p*g,t.copy(i).addScaledVector(Au,o).addScaledVector(Mu,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const oI={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ea={h:0,s:0,l:0},Ip={h:0,s:0,l:0};function Gv(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}let St=class{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Tn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,jt.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=jt.workingColorSpace){return this.r=e,this.g=t,this.b=i,jt.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=jt.workingColorSpace){if(e=oE(e,1),t=wi(t,0,1),i=wi(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=Gv(o,s,e+1/3),this.g=Gv(o,s,e),this.b=Gv(o,s,e-1/3)}return jt.toWorkingColorSpace(this,r),this}setStyle(e,t=Tn){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Tn){const i=oI[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=xc(e.r),this.g=xc(e.g),this.b=xc(e.b),this}copyLinearToSRGB(e){return this.r=Rv(e.r),this.g=Rv(e.g),this.b=Rv(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Tn){return jt.fromWorkingColorSpace(Ei.copy(this),e),Math.round(wi(Ei.r*255,0,255))*65536+Math.round(wi(Ei.g*255,0,255))*256+Math.round(wi(Ei.b*255,0,255))}getHexString(e=Tn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=jt.workingColorSpace){jt.fromWorkingColorSpace(Ei.copy(this),t);const i=Ei.r,r=Ei.g,s=Ei.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,u;const d=(a+o)/2;if(a===o)l=0,u=0;else{const f=o-a;switch(u=d<=.5?f/(o+a):f/(2-o-a),o){case i:l=(r-s)/f+(r<s?6:0);break;case r:l=(s-i)/f+2;break;case s:l=(i-r)/f+4;break}l/=6}return e.h=l,e.s=u,e.l=d,e}getRGB(e,t=jt.workingColorSpace){return jt.fromWorkingColorSpace(Ei.copy(this),t),e.r=Ei.r,e.g=Ei.g,e.b=Ei.b,e}getStyle(e=Tn){jt.fromWorkingColorSpace(Ei.copy(this),e);const t=Ei.r,i=Ei.g,r=Ei.b;return e!==Tn?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,t,i){return this.getHSL(ea),this.setHSL(ea.h+e,ea.s+t,ea.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(ea),e.getHSL(Ip);const i=vd(ea.h,Ip.h,t),r=vd(ea.s,Ip.s,t),s=vd(ea.l,Ip.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Ei=new St;St.NAMES=oI;let uO=0;class Gs extends Jc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:uO++}),this.uuid=as(),this.name="",this.type="Material",this.blending=yc,this.side=No,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Xx,this.blendDst=jx,this.blendEquation=gl,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new St(0,0,0),this.blendAlpha=0,this.depthFunc=Ag,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=cA,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=yu,this.stencilZFail=yu,this.stencilZPass=yu,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==yc&&(i.blending=this.blending),this.side!==No&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==Xx&&(i.blendSrc=this.blendSrc),this.blendDst!==jx&&(i.blendDst=this.blendDst),this.blendEquation!==gl&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Ag&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==cA&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==yu&&(i.stencilFail=this.stencilFail),this.stencilZFail!==yu&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==yu&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class bl extends Gs{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new St(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=GP,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Ln=new Y,Lp=new Ft;class Fi{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=Zx,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=So,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn('THREE.BufferAttribute: "updateRange" is deprecated and removed in r169. Use "addUpdateRange()" instead.'),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)Lp.fromBufferAttribute(this,t),Lp.applyMatrix3(e),this.setXY(t,Lp.x,Lp.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)Ln.fromBufferAttribute(this,t),Ln.applyMatrix3(e),this.setXYZ(t,Ln.x,Ln.y,Ln.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Ln.fromBufferAttribute(this,t),Ln.applyMatrix4(e),this.setXYZ(t,Ln.x,Ln.y,Ln.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Ln.fromBufferAttribute(this,t),Ln.applyNormalMatrix(e),this.setXYZ(t,Ln.x,Ln.y,Ln.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Ln.fromBufferAttribute(this,t),Ln.transformDirection(e),this.setXYZ(t,Ln.x,Ln.y,Ln.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Fs(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Kt(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Fs(t,this.array)),t}setX(e,t){return this.normalized&&(t=Kt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Fs(t,this.array)),t}setY(e,t){return this.normalized&&(t=Kt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Fs(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Kt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Fs(t,this.array)),t}setW(e,t){return this.normalized&&(t=Kt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Kt(t,this.array),i=Kt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Kt(t,this.array),i=Kt(i,this.array),r=Kt(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Kt(t,this.array),i=Kt(i,this.array),r=Kt(r,this.array),s=Kt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Zx&&(e.usage=this.usage),e}}class aI extends Fi{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class lI extends Fi{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Mo extends Fi{constructor(e,t,i){super(new Float32Array(e),t,i)}}let cO=0;const wr=new Ct,Hv=new vn,Cu=new Y,ir=new ko,Oh=new ko,Kn=new Y;class Ys extends Jc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:cO++}),this.uuid=as(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(tI(e)?lI:aI)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new Mt().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return wr.makeRotationFromQuaternion(e),this.applyMatrix4(wr),this}rotateX(e){return wr.makeRotationX(e),this.applyMatrix4(wr),this}rotateY(e){return wr.makeRotationY(e),this.applyMatrix4(wr),this}rotateZ(e){return wr.makeRotationZ(e),this.applyMatrix4(wr),this}translate(e,t,i){return wr.makeTranslation(e,t,i),this.applyMatrix4(wr),this}scale(e,t,i){return wr.makeScale(e,t,i),this.applyMatrix4(wr),this}lookAt(e){return Hv.lookAt(e),Hv.updateMatrix(),this.applyMatrix4(Hv.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Cu).negate(),this.translate(Cu.x,Cu.y,Cu.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Mo(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ko);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Y(-1/0,-1/0,-1/0),new Y(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const s=t[i];ir.setFromBufferAttribute(s),this.morphTargetsRelative?(Kn.addVectors(this.boundingBox.min,ir.min),this.boundingBox.expandByPoint(Kn),Kn.addVectors(this.boundingBox.max,ir.max),this.boundingBox.expandByPoint(Kn)):(this.boundingBox.expandByPoint(ir.min),this.boundingBox.expandByPoint(ir.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new $s);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Y,1/0);return}if(e){const i=this.boundingSphere.center;if(ir.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];Oh.setFromBufferAttribute(a),this.morphTargetsRelative?(Kn.addVectors(ir.min,Oh.min),ir.expandByPoint(Kn),Kn.addVectors(ir.max,Oh.max),ir.expandByPoint(Kn)):(ir.expandByPoint(Oh.min),ir.expandByPoint(Oh.max))}ir.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Kn.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Kn));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let u=0,d=a.count;u<d;u++)Kn.fromBufferAttribute(a,u),l&&(Cu.fromBufferAttribute(e,u),Kn.add(Cu)),r=Math.max(r,i.distanceToSquared(Kn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Fi(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,u=[],d=[];for(let L=0;L<a;L++)u[L]=new Y,d[L]=new Y;const f=new Y,p=new Y,m=new Y,v=new Ft,x=new Ft,y=new Ft,g=new Y,T=new Y;function S(L,Z,V){f.fromArray(r,L*3),p.fromArray(r,Z*3),m.fromArray(r,V*3),v.fromArray(o,L*2),x.fromArray(o,Z*2),y.fromArray(o,V*2),p.sub(f),m.sub(f),x.sub(v),y.sub(v);const z=1/(x.x*y.y-y.x*x.y);isFinite(z)&&(g.copy(p).multiplyScalar(y.y).addScaledVector(m,-x.y).multiplyScalar(z),T.copy(m).multiplyScalar(x.x).addScaledVector(p,-y.x).multiplyScalar(z),u[L].add(g),u[Z].add(g),u[V].add(g),d[L].add(T),d[Z].add(T),d[V].add(T))}let w=this.groups;w.length===0&&(w=[{start:0,count:i.length}]);for(let L=0,Z=w.length;L<Z;++L){const V=w[L],z=V.start,F=V.count;for(let j=z,Q=z+F;j<Q;j+=3)S(i[j+0],i[j+1],i[j+2])}const M=new Y,P=new Y,R=new Y,D=new Y;function C(L){R.fromArray(s,L*3),D.copy(R);const Z=u[L];M.copy(Z),M.sub(R.multiplyScalar(R.dot(Z))).normalize(),P.crossVectors(D,Z);const z=P.dot(d[L])<0?-1:1;l[L*4]=M.x,l[L*4+1]=M.y,l[L*4+2]=M.z,l[L*4+3]=z}for(let L=0,Z=w.length;L<Z;++L){const V=w[L],z=V.start,F=V.count;for(let j=z,Q=z+F;j<Q;j+=3)C(i[j+0]),C(i[j+1]),C(i[j+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Fi(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let p=0,m=i.count;p<m;p++)i.setXYZ(p,0,0,0);const r=new Y,s=new Y,o=new Y,a=new Y,l=new Y,u=new Y,d=new Y,f=new Y;if(e)for(let p=0,m=e.count;p<m;p+=3){const v=e.getX(p+0),x=e.getX(p+1),y=e.getX(p+2);r.fromBufferAttribute(t,v),s.fromBufferAttribute(t,x),o.fromBufferAttribute(t,y),d.subVectors(o,s),f.subVectors(r,s),d.cross(f),a.fromBufferAttribute(i,v),l.fromBufferAttribute(i,x),u.fromBufferAttribute(i,y),a.add(d),l.add(d),u.add(d),i.setXYZ(v,a.x,a.y,a.z),i.setXYZ(x,l.x,l.y,l.z),i.setXYZ(y,u.x,u.y,u.z)}else for(let p=0,m=t.count;p<m;p+=3)r.fromBufferAttribute(t,p+0),s.fromBufferAttribute(t,p+1),o.fromBufferAttribute(t,p+2),d.subVectors(o,s),f.subVectors(r,s),d.cross(f),i.setXYZ(p+0,d.x,d.y,d.z),i.setXYZ(p+1,d.x,d.y,d.z),i.setXYZ(p+2,d.x,d.y,d.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Kn.fromBufferAttribute(e,t),Kn.normalize(),e.setXYZ(t,Kn.x,Kn.y,Kn.z)}toNonIndexed(){function e(a,l){const u=a.array,d=a.itemSize,f=a.normalized,p=new u.constructor(l.length*d);let m=0,v=0;for(let x=0,y=l.length;x<y;x++){a.isInterleavedBufferAttribute?m=l[x]*a.data.stride+a.offset:m=l[x]*d;for(let g=0;g<d;g++)p[v++]=u[m++]}return new Fi(p,d,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Ys,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],u=e(l,i);t.setAttribute(a,u)}const s=this.morphAttributes;for(const a in s){const l=[],u=s[a];for(let d=0,f=u.length;d<f;d++){const p=u[d],m=e(p,i);l.push(m)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const u=o[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i){const u=i[l];e.data.attributes[l]=u.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],d=[];for(let f=0,p=u.length;f<p;f++){const m=u[f];d.push(m.toJSON(e.data))}d.length>0&&(r[l]=d,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const r=e.attributes;for(const u in r){const d=r[u];this.setAttribute(u,d.clone(t))}const s=e.morphAttributes;for(const u in s){const d=[],f=s[u];for(let p=0,m=f.length;p<m;p++)d.push(f[p].clone(t));this.morphAttributes[u]=d}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,d=o.length;u<d;u++){const f=o[u];this.addGroup(f.start,f.count,f.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const bA=new Ct,el=new x0,Dp=new $s,wA=new Y,Ru=new Y,Pu=new Y,Iu=new Y,Vv=new Y,Np=new Y,Up=new Ft,Fp=new Ft,Op=new Ft,AA=new Y,MA=new Y,CA=new Y,kp=new Y,Bp=new Y;let Nr=class extends vn{constructor(e=new Ys,t=new bl){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){Np.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const d=a[l],f=s[l];d!==0&&(Vv.fromBufferAttribute(f,e),o?Np.addScaledVector(Vv,d):Np.addScaledVector(Vv.sub(t),d))}t.add(Np)}return t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Dp.copy(i.boundingSphere),Dp.applyMatrix4(s),el.copy(e.ray).recast(e.near),!(Dp.containsPoint(el.origin)===!1&&(el.intersectSphere(Dp,wA)===null||el.origin.distanceToSquared(wA)>(e.far-e.near)**2))&&(bA.copy(s).invert(),el.copy(e.ray).applyMatrix4(bA),!(i.boundingBox!==null&&el.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,el)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,u=s.attributes.uv,d=s.attributes.uv1,f=s.attributes.normal,p=s.groups,m=s.drawRange;if(a!==null)if(Array.isArray(o))for(let v=0,x=p.length;v<x;v++){const y=p[v],g=o[y.materialIndex],T=Math.max(y.start,m.start),S=Math.min(a.count,Math.min(y.start+y.count,m.start+m.count));for(let w=T,M=S;w<M;w+=3){const P=a.getX(w),R=a.getX(w+1),D=a.getX(w+2);r=zp(this,g,e,i,u,d,f,P,R,D),r&&(r.faceIndex=Math.floor(w/3),r.face.materialIndex=y.materialIndex,t.push(r))}}else{const v=Math.max(0,m.start),x=Math.min(a.count,m.start+m.count);for(let y=v,g=x;y<g;y+=3){const T=a.getX(y),S=a.getX(y+1),w=a.getX(y+2);r=zp(this,o,e,i,u,d,f,T,S,w),r&&(r.faceIndex=Math.floor(y/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let v=0,x=p.length;v<x;v++){const y=p[v],g=o[y.materialIndex],T=Math.max(y.start,m.start),S=Math.min(l.count,Math.min(y.start+y.count,m.start+m.count));for(let w=T,M=S;w<M;w+=3){const P=w,R=w+1,D=w+2;r=zp(this,g,e,i,u,d,f,P,R,D),r&&(r.faceIndex=Math.floor(w/3),r.face.materialIndex=y.materialIndex,t.push(r))}}else{const v=Math.max(0,m.start),x=Math.min(l.count,m.start+m.count);for(let y=v,g=x;y<g;y+=3){const T=y,S=y+1,w=y+2;r=zp(this,o,e,i,u,d,f,T,S,w),r&&(r.faceIndex=Math.floor(y/3),t.push(r))}}}};function hO(n,e,t,i,r,s,o,a){let l;if(e.side===Ki?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===No,a),l===null)return null;Bp.copy(a),Bp.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(Bp);return u<t.near||u>t.far?null:{distance:u,point:Bp.clone(),object:n}}function zp(n,e,t,i,r,s,o,a,l,u){n.getVertexPosition(a,Ru),n.getVertexPosition(l,Pu),n.getVertexPosition(u,Iu);const d=hO(n,e,t,i,Ru,Pu,Iu,kp);if(d){r&&(Up.fromBufferAttribute(r,a),Fp.fromBufferAttribute(r,l),Op.fromBufferAttribute(r,u),d.uv=ts.getInterpolation(kp,Ru,Pu,Iu,Up,Fp,Op,new Ft)),s&&(Up.fromBufferAttribute(s,a),Fp.fromBufferAttribute(s,l),Op.fromBufferAttribute(s,u),d.uv1=ts.getInterpolation(kp,Ru,Pu,Iu,Up,Fp,Op,new Ft),d.uv2=d.uv1),o&&(AA.fromBufferAttribute(o,a),MA.fromBufferAttribute(o,l),CA.fromBufferAttribute(o,u),d.normal=ts.getInterpolation(kp,Ru,Pu,Iu,AA,MA,CA,new Y),d.normal.dot(i.direction)>0&&d.normal.multiplyScalar(-1));const f={a,b:l,c:u,normal:new Y,materialIndex:0};ts.getNormal(Ru,Pu,Iu,f.normal),d.face=f}return d}class lf extends Ys{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],u=[],d=[],f=[];let p=0,m=0;v("z","y","x",-1,-1,i,t,e,o,s,0),v("z","y","x",1,-1,i,t,-e,o,s,1),v("x","z","y",1,1,e,i,t,r,o,2),v("x","z","y",1,-1,e,i,-t,r,o,3),v("x","y","z",1,-1,e,t,i,r,s,4),v("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new Mo(u,3)),this.setAttribute("normal",new Mo(d,3)),this.setAttribute("uv",new Mo(f,2));function v(x,y,g,T,S,w,M,P,R,D,C){const L=w/R,Z=M/D,V=w/2,z=M/2,F=P/2,j=R+1,Q=D+1;let $=0,O=0;const G=new Y;for(let k=0;k<Q;k++){const H=k*Z-z;for(let te=0;te<j;te++){const ee=te*L-V;G[x]=ee*T,G[y]=H*S,G[g]=F,u.push(G.x,G.y,G.z),G[x]=0,G[y]=0,G[g]=P>0?1:-1,d.push(G.x,G.y,G.z),f.push(te/R),f.push(1-k/D),$+=1}}for(let k=0;k<D;k++)for(let H=0;H<R;H++){const te=p+H+j*k,ee=p+H+j*(k+1),re=p+(H+1)+j*(k+1),ge=p+(H+1)+j*k;l.push(te,ee,ge),l.push(ee,re,ge),O+=6}a.addGroup(m,O,C),m+=O,p+=$}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new lf(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Hc(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function Ii(n){const e={};for(let t=0;t<n.length;t++){const i=Hc(n[t]);for(const r in i)e[r]=i[r]}return e}function dO(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function uI(n){return n.getRenderTarget()===null?n.outputColorSpace:jt.workingColorSpace}const fO={clone:Hc,merge:Ii};var pO=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,mO=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Xl extends Gs{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=pO,this.fragmentShader=mO,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Hc(e.uniforms),this.uniformsGroups=dO(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class cI extends vn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ct,this.projectionMatrix=new Ct,this.projectionMatrixInverse=new Ct,this.coordinateSystem=Eo}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Di extends cI{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Gc*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(_d*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Gc*2*Math.atan(Math.tan(_d*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(_d*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,u=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/u,r*=o.width/l,i*=o.height/u}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Lu=-90,Du=1;class gO extends vn{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Di(Lu,Du,e,t);r.layers=this.layers,this.add(r);const s=new Di(Lu,Du,e,t);s.layers=this.layers,this.add(s);const o=new Di(Lu,Du,e,t);o.layers=this.layers,this.add(o);const a=new Di(Lu,Du,e,t);a.layers=this.layers,this.add(a);const l=new Di(Lu,Du,e,t);l.layers=this.layers,this.add(l);const u=new Di(Lu,Du,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const u of t)this.remove(u);if(e===Eo)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Ig)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,u,d]=this.children,f=e.getRenderTarget(),p=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),v=e.xr.enabled;e.xr.enabled=!1;const x=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,u),i.texture.generateMipmaps=x,e.setRenderTarget(i,5,r),e.render(t,d),e.setRenderTarget(f,p,m),e.xr.enabled=v,i.texture.needsPMREMUpdate=!0}}class hI extends hr{constructor(e,t,i,r,s,o,a,l,u,d){e=e!==void 0?e:[],t=t!==void 0?t:Fc,super(e,t,i,r,s,o,a,l,u,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class _O extends Wl{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];t.encoding!==void 0&&(yd("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Ll?Tn:Lr),this.texture=new hI(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Wi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new lf(5,5,5),s=new Xl({name:"CubemapFromEquirect",uniforms:Hc(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Ki,blending:Ma});s.uniforms.tEquirect.value=t;const o=new Nr(r,s),a=t.minFilter;return t.minFilter===Vl&&(t.minFilter=Wi),new gO(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const Wv=new Y,vO=new Y,yO=new Mt;class ll{constructor(e=new Y(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=Wv.subVectors(i,t).cross(vO.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(Wv),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||yO.getNormalMatrix(e),r=this.coplanarPoint(Wv).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const tl=new $s,Gp=new Y;class aE{constructor(e=new ll,t=new ll,i=new ll,r=new ll,s=new ll,o=new ll){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Eo){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],u=r[4],d=r[5],f=r[6],p=r[7],m=r[8],v=r[9],x=r[10],y=r[11],g=r[12],T=r[13],S=r[14],w=r[15];if(i[0].setComponents(l-s,p-u,y-m,w-g).normalize(),i[1].setComponents(l+s,p+u,y+m,w+g).normalize(),i[2].setComponents(l+o,p+d,y+v,w+T).normalize(),i[3].setComponents(l-o,p-d,y-v,w-T).normalize(),i[4].setComponents(l-a,p-f,y-x,w-S).normalize(),t===Eo)i[5].setComponents(l+a,p+f,y+x,w+S).normalize();else if(t===Ig)i[5].setComponents(a,f,x,S).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),tl.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),tl.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(tl)}intersectsSprite(e){return tl.center.set(0,0,0),tl.radius=.7071067811865476,tl.applyMatrix4(e.matrixWorld),this.intersectsSphere(tl)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Gp.x=r.normal.x>0?e.max.x:e.min.x,Gp.y=r.normal.y>0?e.max.y:e.min.y,Gp.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Gp)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function dI(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function xO(n,e){const t=e.isWebGL2,i=new WeakMap;function r(u,d){const f=u.array,p=u.usage,m=f.byteLength,v=n.createBuffer();n.bindBuffer(d,v),n.bufferData(d,f,p),u.onUploadCallback();let x;if(f instanceof Float32Array)x=n.FLOAT;else if(f instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(t)x=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else x=n.UNSIGNED_SHORT;else if(f instanceof Int16Array)x=n.SHORT;else if(f instanceof Uint32Array)x=n.UNSIGNED_INT;else if(f instanceof Int32Array)x=n.INT;else if(f instanceof Int8Array)x=n.BYTE;else if(f instanceof Uint8Array)x=n.UNSIGNED_BYTE;else if(f instanceof Uint8ClampedArray)x=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+f);return{buffer:v,type:x,bytesPerElement:f.BYTES_PER_ELEMENT,version:u.version,size:m}}function s(u,d,f){const p=d.array,m=d._updateRange,v=d.updateRanges;if(n.bindBuffer(f,u),m.count===-1&&v.length===0&&n.bufferSubData(f,0,p),v.length!==0){for(let x=0,y=v.length;x<y;x++){const g=v[x];t?n.bufferSubData(f,g.start*p.BYTES_PER_ELEMENT,p,g.start,g.count):n.bufferSubData(f,g.start*p.BYTES_PER_ELEMENT,p.subarray(g.start,g.start+g.count))}d.clearUpdateRanges()}m.count!==-1&&(t?n.bufferSubData(f,m.offset*p.BYTES_PER_ELEMENT,p,m.offset,m.count):n.bufferSubData(f,m.offset*p.BYTES_PER_ELEMENT,p.subarray(m.offset,m.offset+m.count)),m.count=-1),d.onUploadCallback()}function o(u){return u.isInterleavedBufferAttribute&&(u=u.data),i.get(u)}function a(u){u.isInterleavedBufferAttribute&&(u=u.data);const d=i.get(u);d&&(n.deleteBuffer(d.buffer),i.delete(u))}function l(u,d){if(u.isGLBufferAttribute){const p=i.get(u);(!p||p.version<u.version)&&i.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);const f=i.get(u);if(f===void 0)i.set(u,r(u,d));else if(f.version<u.version){if(f.size!==u.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(f.buffer,u,d),f.version=u.version}}return{get:o,remove:a,update:l}}let SO=class fI extends Ys{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),u=a+1,d=l+1,f=e/a,p=t/l,m=[],v=[],x=[],y=[];for(let g=0;g<d;g++){const T=g*p-o;for(let S=0;S<u;S++){const w=S*f-s;v.push(w,-T,0),x.push(0,0,1),y.push(S/a),y.push(1-g/l)}}for(let g=0;g<l;g++)for(let T=0;T<a;T++){const S=T+u*g,w=T+u*(g+1),M=T+1+u*(g+1),P=T+1+u*g;m.push(S,w,P),m.push(w,M,P)}this.setIndex(m),this.setAttribute("position",new Mo(v,3)),this.setAttribute("normal",new Mo(x,3)),this.setAttribute("uv",new Mo(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fI(e.width,e.height,e.widthSegments,e.heightSegments)}};var EO=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,TO=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,bO=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,wO=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,AO=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,MO=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,CO=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,RO=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,PO=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,IO=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,LO=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,DO=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,NO=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,UO=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,FO=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,OO=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,kO=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,BO=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,zO=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,GO=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,HO=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,VO=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,WO=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,XO=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,jO=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,$O=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,YO=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,qO=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,KO=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,ZO=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,QO="gl_FragColor = linearToOutputTexel( gl_FragColor );",JO=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,ek=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,tk=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,nk=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,ik=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,rk=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,sk=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,ok=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,ak=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,lk=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,uk=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,ck=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,hk=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,dk=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,fk=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,pk=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,mk=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,gk=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,_k=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,vk=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,yk=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,xk=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Sk=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Ek=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Tk=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,bk=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,wk=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Ak=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Mk=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Ck=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Rk=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Pk=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Ik=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Lk=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Dk=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Nk=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Uk=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Fk=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Ok=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,kk=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Bk=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,zk=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Gk=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Hk=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Vk=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Wk=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Xk=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,jk=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,$k=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Yk=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,qk=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Kk=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Zk=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Qk=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Jk=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,eB=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,tB=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,nB=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,iB=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,rB=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,sB=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,oB=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,aB=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,lB=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,uB=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,cB=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,hB=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,dB=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,fB=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,pB=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,mB=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,gB=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,_B=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,vB=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,yB=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,xB=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const SB=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,EB=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,TB=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,bB=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,wB=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,AB=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,MB=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,CB=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,RB=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,PB=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,IB=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,LB=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,DB=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,NB=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,UB=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,FB=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,OB=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,kB=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,BB=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,zB=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,GB=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,HB=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,VB=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,WB=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,XB=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,jB=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$B=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,YB=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,qB=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,KB=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,ZB=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,QB=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,JB=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,e4=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,bt={alphahash_fragment:EO,alphahash_pars_fragment:TO,alphamap_fragment:bO,alphamap_pars_fragment:wO,alphatest_fragment:AO,alphatest_pars_fragment:MO,aomap_fragment:CO,aomap_pars_fragment:RO,batching_pars_vertex:PO,batching_vertex:IO,begin_vertex:LO,beginnormal_vertex:DO,bsdfs:NO,iridescence_fragment:UO,bumpmap_pars_fragment:FO,clipping_planes_fragment:OO,clipping_planes_pars_fragment:kO,clipping_planes_pars_vertex:BO,clipping_planes_vertex:zO,color_fragment:GO,color_pars_fragment:HO,color_pars_vertex:VO,color_vertex:WO,common:XO,cube_uv_reflection_fragment:jO,defaultnormal_vertex:$O,displacementmap_pars_vertex:YO,displacementmap_vertex:qO,emissivemap_fragment:KO,emissivemap_pars_fragment:ZO,colorspace_fragment:QO,colorspace_pars_fragment:JO,envmap_fragment:ek,envmap_common_pars_fragment:tk,envmap_pars_fragment:nk,envmap_pars_vertex:ik,envmap_physical_pars_fragment:mk,envmap_vertex:rk,fog_vertex:sk,fog_pars_vertex:ok,fog_fragment:ak,fog_pars_fragment:lk,gradientmap_pars_fragment:uk,lightmap_fragment:ck,lightmap_pars_fragment:hk,lights_lambert_fragment:dk,lights_lambert_pars_fragment:fk,lights_pars_begin:pk,lights_toon_fragment:gk,lights_toon_pars_fragment:_k,lights_phong_fragment:vk,lights_phong_pars_fragment:yk,lights_physical_fragment:xk,lights_physical_pars_fragment:Sk,lights_fragment_begin:Ek,lights_fragment_maps:Tk,lights_fragment_end:bk,logdepthbuf_fragment:wk,logdepthbuf_pars_fragment:Ak,logdepthbuf_pars_vertex:Mk,logdepthbuf_vertex:Ck,map_fragment:Rk,map_pars_fragment:Pk,map_particle_fragment:Ik,map_particle_pars_fragment:Lk,metalnessmap_fragment:Dk,metalnessmap_pars_fragment:Nk,morphcolor_vertex:Uk,morphnormal_vertex:Fk,morphtarget_pars_vertex:Ok,morphtarget_vertex:kk,normal_fragment_begin:Bk,normal_fragment_maps:zk,normal_pars_fragment:Gk,normal_pars_vertex:Hk,normal_vertex:Vk,normalmap_pars_fragment:Wk,clearcoat_normal_fragment_begin:Xk,clearcoat_normal_fragment_maps:jk,clearcoat_pars_fragment:$k,iridescence_pars_fragment:Yk,opaque_fragment:qk,packing:Kk,premultiplied_alpha_fragment:Zk,project_vertex:Qk,dithering_fragment:Jk,dithering_pars_fragment:eB,roughnessmap_fragment:tB,roughnessmap_pars_fragment:nB,shadowmap_pars_fragment:iB,shadowmap_pars_vertex:rB,shadowmap_vertex:sB,shadowmask_pars_fragment:oB,skinbase_vertex:aB,skinning_pars_vertex:lB,skinning_vertex:uB,skinnormal_vertex:cB,specularmap_fragment:hB,specularmap_pars_fragment:dB,tonemapping_fragment:fB,tonemapping_pars_fragment:pB,transmission_fragment:mB,transmission_pars_fragment:gB,uv_pars_fragment:_B,uv_pars_vertex:vB,uv_vertex:yB,worldpos_vertex:xB,background_vert:SB,background_frag:EB,backgroundCube_vert:TB,backgroundCube_frag:bB,cube_vert:wB,cube_frag:AB,depth_vert:MB,depth_frag:CB,distanceRGBA_vert:RB,distanceRGBA_frag:PB,equirect_vert:IB,equirect_frag:LB,linedashed_vert:DB,linedashed_frag:NB,meshbasic_vert:UB,meshbasic_frag:FB,meshlambert_vert:OB,meshlambert_frag:kB,meshmatcap_vert:BB,meshmatcap_frag:zB,meshnormal_vert:GB,meshnormal_frag:HB,meshphong_vert:VB,meshphong_frag:WB,meshphysical_vert:XB,meshphysical_frag:jB,meshtoon_vert:$B,meshtoon_frag:YB,points_vert:qB,points_frag:KB,shadow_vert:ZB,shadow_frag:QB,sprite_vert:JB,sprite_frag:e4},Le={common:{diffuse:{value:new St(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Mt},alphaMap:{value:null},alphaMapTransform:{value:new Mt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Mt}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Mt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Mt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Mt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Mt},normalScale:{value:new Ft(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Mt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Mt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Mt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Mt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new St(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new St(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Mt},alphaTest:{value:0},uvTransform:{value:new Mt}},sprite:{diffuse:{value:new St(16777215)},opacity:{value:1},center:{value:new Ft(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Mt},alphaMap:{value:null},alphaMapTransform:{value:new Mt},alphaTest:{value:0}}},Is={basic:{uniforms:Ii([Le.common,Le.specularmap,Le.envmap,Le.aomap,Le.lightmap,Le.fog]),vertexShader:bt.meshbasic_vert,fragmentShader:bt.meshbasic_frag},lambert:{uniforms:Ii([Le.common,Le.specularmap,Le.envmap,Le.aomap,Le.lightmap,Le.emissivemap,Le.bumpmap,Le.normalmap,Le.displacementmap,Le.fog,Le.lights,{emissive:{value:new St(0)}}]),vertexShader:bt.meshlambert_vert,fragmentShader:bt.meshlambert_frag},phong:{uniforms:Ii([Le.common,Le.specularmap,Le.envmap,Le.aomap,Le.lightmap,Le.emissivemap,Le.bumpmap,Le.normalmap,Le.displacementmap,Le.fog,Le.lights,{emissive:{value:new St(0)},specular:{value:new St(1118481)},shininess:{value:30}}]),vertexShader:bt.meshphong_vert,fragmentShader:bt.meshphong_frag},standard:{uniforms:Ii([Le.common,Le.envmap,Le.aomap,Le.lightmap,Le.emissivemap,Le.bumpmap,Le.normalmap,Le.displacementmap,Le.roughnessmap,Le.metalnessmap,Le.fog,Le.lights,{emissive:{value:new St(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:bt.meshphysical_vert,fragmentShader:bt.meshphysical_frag},toon:{uniforms:Ii([Le.common,Le.aomap,Le.lightmap,Le.emissivemap,Le.bumpmap,Le.normalmap,Le.displacementmap,Le.gradientmap,Le.fog,Le.lights,{emissive:{value:new St(0)}}]),vertexShader:bt.meshtoon_vert,fragmentShader:bt.meshtoon_frag},matcap:{uniforms:Ii([Le.common,Le.bumpmap,Le.normalmap,Le.displacementmap,Le.fog,{matcap:{value:null}}]),vertexShader:bt.meshmatcap_vert,fragmentShader:bt.meshmatcap_frag},points:{uniforms:Ii([Le.points,Le.fog]),vertexShader:bt.points_vert,fragmentShader:bt.points_frag},dashed:{uniforms:Ii([Le.common,Le.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:bt.linedashed_vert,fragmentShader:bt.linedashed_frag},depth:{uniforms:Ii([Le.common,Le.displacementmap]),vertexShader:bt.depth_vert,fragmentShader:bt.depth_frag},normal:{uniforms:Ii([Le.common,Le.bumpmap,Le.normalmap,Le.displacementmap,{opacity:{value:1}}]),vertexShader:bt.meshnormal_vert,fragmentShader:bt.meshnormal_frag},sprite:{uniforms:Ii([Le.sprite,Le.fog]),vertexShader:bt.sprite_vert,fragmentShader:bt.sprite_frag},background:{uniforms:{uvTransform:{value:new Mt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:bt.background_vert,fragmentShader:bt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:bt.backgroundCube_vert,fragmentShader:bt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:bt.cube_vert,fragmentShader:bt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:bt.equirect_vert,fragmentShader:bt.equirect_frag},distanceRGBA:{uniforms:Ii([Le.common,Le.displacementmap,{referencePosition:{value:new Y},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:bt.distanceRGBA_vert,fragmentShader:bt.distanceRGBA_frag},shadow:{uniforms:Ii([Le.lights,Le.fog,{color:{value:new St(0)},opacity:{value:1}}]),vertexShader:bt.shadow_vert,fragmentShader:bt.shadow_frag}};Is.physical={uniforms:Ii([Is.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Mt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Mt},clearcoatNormalScale:{value:new Ft(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Mt},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Mt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Mt},sheen:{value:0},sheenColor:{value:new St(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Mt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Mt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Mt},transmissionSamplerSize:{value:new Ft},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Mt},attenuationDistance:{value:0},attenuationColor:{value:new St(0)},specularColor:{value:new St(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Mt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Mt},anisotropyVector:{value:new Ft},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Mt}}]),vertexShader:bt.meshphysical_vert,fragmentShader:bt.meshphysical_frag};const Hp={r:0,b:0,g:0};function t4(n,e,t,i,r,s,o){const a=new St(0);let l=s===!0?0:1,u,d,f=null,p=0,m=null;function v(y,g){let T=!1,S=g.isScene===!0?g.background:null;S&&S.isTexture&&(S=(g.backgroundBlurriness>0?t:e).get(S)),S===null?x(a,l):S&&S.isColor&&(x(S,1),T=!0);const w=n.xr.getEnvironmentBlendMode();w==="additive"?i.buffers.color.setClear(0,0,0,1,o):w==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||T)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),S&&(S.isCubeTexture||S.mapping===v0)?(d===void 0&&(d=new Nr(new lf(1,1,1),new Xl({name:"BackgroundCubeMaterial",uniforms:Hc(Is.backgroundCube.uniforms),vertexShader:Is.backgroundCube.vertexShader,fragmentShader:Is.backgroundCube.fragmentShader,side:Ki,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(M,P,R){this.matrixWorld.copyPosition(R.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(d)),d.material.uniforms.envMap.value=S,d.material.uniforms.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=g.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,d.material.toneMapped=jt.getTransfer(S.colorSpace)!==sn,(f!==S||p!==S.version||m!==n.toneMapping)&&(d.material.needsUpdate=!0,f=S,p=S.version,m=n.toneMapping),d.layers.enableAll(),y.unshift(d,d.geometry,d.material,0,0,null)):S&&S.isTexture&&(u===void 0&&(u=new Nr(new SO(2,2),new Xl({name:"BackgroundMaterial",uniforms:Hc(Is.background.uniforms),vertexShader:Is.background.vertexShader,fragmentShader:Is.background.fragmentShader,side:No,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(u)),u.material.uniforms.t2D.value=S,u.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,u.material.toneMapped=jt.getTransfer(S.colorSpace)!==sn,S.matrixAutoUpdate===!0&&S.updateMatrix(),u.material.uniforms.uvTransform.value.copy(S.matrix),(f!==S||p!==S.version||m!==n.toneMapping)&&(u.material.needsUpdate=!0,f=S,p=S.version,m=n.toneMapping),u.layers.enableAll(),y.unshift(u,u.geometry,u.material,0,0,null))}function x(y,g){y.getRGB(Hp,uI(n)),i.buffers.color.setClear(Hp.r,Hp.g,Hp.b,g,o)}return{getClearColor:function(){return a},setClearColor:function(y,g=1){a.set(y),l=g,x(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(y){l=y,x(a,l)},render:v}}function n4(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},l=y(null);let u=l,d=!1;function f(F,j,Q,$,O){let G=!1;if(o){const k=x($,Q,j);u!==k&&(u=k,m(u.object)),G=g(F,$,Q,O),G&&T(F,$,Q,O)}else{const k=j.wireframe===!0;(u.geometry!==$.id||u.program!==Q.id||u.wireframe!==k)&&(u.geometry=$.id,u.program=Q.id,u.wireframe=k,G=!0)}O!==null&&t.update(O,n.ELEMENT_ARRAY_BUFFER),(G||d)&&(d=!1,D(F,j,Q,$),O!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(O).buffer))}function p(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function m(F){return i.isWebGL2?n.bindVertexArray(F):s.bindVertexArrayOES(F)}function v(F){return i.isWebGL2?n.deleteVertexArray(F):s.deleteVertexArrayOES(F)}function x(F,j,Q){const $=Q.wireframe===!0;let O=a[F.id];O===void 0&&(O={},a[F.id]=O);let G=O[j.id];G===void 0&&(G={},O[j.id]=G);let k=G[$];return k===void 0&&(k=y(p()),G[$]=k),k}function y(F){const j=[],Q=[],$=[];for(let O=0;O<r;O++)j[O]=0,Q[O]=0,$[O]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:j,enabledAttributes:Q,attributeDivisors:$,object:F,attributes:{},index:null}}function g(F,j,Q,$){const O=u.attributes,G=j.attributes;let k=0;const H=Q.getAttributes();for(const te in H)if(H[te].location>=0){const re=O[te];let ge=G[te];if(ge===void 0&&(te==="instanceMatrix"&&F.instanceMatrix&&(ge=F.instanceMatrix),te==="instanceColor"&&F.instanceColor&&(ge=F.instanceColor)),re===void 0||re.attribute!==ge||ge&&re.data!==ge.data)return!0;k++}return u.attributesNum!==k||u.index!==$}function T(F,j,Q,$){const O={},G=j.attributes;let k=0;const H=Q.getAttributes();for(const te in H)if(H[te].location>=0){let re=G[te];re===void 0&&(te==="instanceMatrix"&&F.instanceMatrix&&(re=F.instanceMatrix),te==="instanceColor"&&F.instanceColor&&(re=F.instanceColor));const ge={};ge.attribute=re,re&&re.data&&(ge.data=re.data),O[te]=ge,k++}u.attributes=O,u.attributesNum=k,u.index=$}function S(){const F=u.newAttributes;for(let j=0,Q=F.length;j<Q;j++)F[j]=0}function w(F){M(F,0)}function M(F,j){const Q=u.newAttributes,$=u.enabledAttributes,O=u.attributeDivisors;Q[F]=1,$[F]===0&&(n.enableVertexAttribArray(F),$[F]=1),O[F]!==j&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](F,j),O[F]=j)}function P(){const F=u.newAttributes,j=u.enabledAttributes;for(let Q=0,$=j.length;Q<$;Q++)j[Q]!==F[Q]&&(n.disableVertexAttribArray(Q),j[Q]=0)}function R(F,j,Q,$,O,G,k){k===!0?n.vertexAttribIPointer(F,j,Q,O,G):n.vertexAttribPointer(F,j,Q,$,O,G)}function D(F,j,Q,$){if(i.isWebGL2===!1&&(F.isInstancedMesh||$.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;S();const O=$.attributes,G=Q.getAttributes(),k=j.defaultAttributeValues;for(const H in G){const te=G[H];if(te.location>=0){let ee=O[H];if(ee===void 0&&(H==="instanceMatrix"&&F.instanceMatrix&&(ee=F.instanceMatrix),H==="instanceColor"&&F.instanceColor&&(ee=F.instanceColor)),ee!==void 0){const re=ee.normalized,ge=ee.itemSize,ve=t.get(ee);if(ve===void 0)continue;const Me=ve.buffer,Ze=ve.type,Ye=ve.bytesPerElement,ze=i.isWebGL2===!0&&(Ze===n.INT||Ze===n.UNSIGNED_INT||ee.gpuType===WP);if(ee.isInterleavedBufferAttribute){const Ie=ee.data,q=Ie.stride,ct=ee.offset;if(Ie.isInstancedInterleavedBuffer){for(let Xe=0;Xe<te.locationSize;Xe++)M(te.location+Xe,Ie.meshPerAttribute);F.isInstancedMesh!==!0&&$._maxInstanceCount===void 0&&($._maxInstanceCount=Ie.meshPerAttribute*Ie.count)}else for(let Xe=0;Xe<te.locationSize;Xe++)w(te.location+Xe);n.bindBuffer(n.ARRAY_BUFFER,Me);for(let Xe=0;Xe<te.locationSize;Xe++)R(te.location+Xe,ge/te.locationSize,Ze,re,q*Ye,(ct+ge/te.locationSize*Xe)*Ye,ze)}else{if(ee.isInstancedBufferAttribute){for(let Ie=0;Ie<te.locationSize;Ie++)M(te.location+Ie,ee.meshPerAttribute);F.isInstancedMesh!==!0&&$._maxInstanceCount===void 0&&($._maxInstanceCount=ee.meshPerAttribute*ee.count)}else for(let Ie=0;Ie<te.locationSize;Ie++)w(te.location+Ie);n.bindBuffer(n.ARRAY_BUFFER,Me);for(let Ie=0;Ie<te.locationSize;Ie++)R(te.location+Ie,ge/te.locationSize,Ze,re,ge*Ye,ge/te.locationSize*Ie*Ye,ze)}}else if(k!==void 0){const re=k[H];if(re!==void 0)switch(re.length){case 2:n.vertexAttrib2fv(te.location,re);break;case 3:n.vertexAttrib3fv(te.location,re);break;case 4:n.vertexAttrib4fv(te.location,re);break;default:n.vertexAttrib1fv(te.location,re)}}}}P()}function C(){V();for(const F in a){const j=a[F];for(const Q in j){const $=j[Q];for(const O in $)v($[O].object),delete $[O];delete j[Q]}delete a[F]}}function L(F){if(a[F.id]===void 0)return;const j=a[F.id];for(const Q in j){const $=j[Q];for(const O in $)v($[O].object),delete $[O];delete j[Q]}delete a[F.id]}function Z(F){for(const j in a){const Q=a[j];if(Q[F.id]===void 0)continue;const $=Q[F.id];for(const O in $)v($[O].object),delete $[O];delete Q[F.id]}}function V(){z(),d=!0,u!==l&&(u=l,m(u.object))}function z(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:f,reset:V,resetDefaultState:z,dispose:C,releaseStatesOfGeometry:L,releaseStatesOfProgram:Z,initAttributes:S,enableAttribute:w,disableUnusedAttributes:P}}function i4(n,e,t,i){const r=i.isWebGL2;let s;function o(d){s=d}function a(d,f){n.drawArrays(s,d,f),t.update(f,s,1)}function l(d,f,p){if(p===0)return;let m,v;if(r)m=n,v="drawArraysInstanced";else if(m=e.get("ANGLE_instanced_arrays"),v="drawArraysInstancedANGLE",m===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[v](s,d,f,p),t.update(f,s,p)}function u(d,f,p){if(p===0)return;const m=e.get("WEBGL_multi_draw");if(m===null)for(let v=0;v<p;v++)this.render(d[v],f[v]);else{m.multiDrawArraysWEBGL(s,d,0,f,0,p);let v=0;for(let x=0;x<p;x++)v+=f[x];t.update(v,s,1)}}this.setMode=o,this.render=a,this.renderInstances=l,this.renderMultiDraw=u}function r4(n,e,t){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const R=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(R.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(R){if(R==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";R="mediump"}return R==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let a=t.precision!==void 0?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const u=o||e.has("WEBGL_draw_buffers"),d=t.logarithmicDepthBuffer===!0,f=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=n.getParameter(n.MAX_TEXTURE_SIZE),v=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),x=n.getParameter(n.MAX_VERTEX_ATTRIBS),y=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),g=n.getParameter(n.MAX_VARYING_VECTORS),T=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),S=p>0,w=o||e.has("OES_texture_float"),M=S&&w,P=o?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:d,maxTextures:f,maxVertexTextures:p,maxTextureSize:m,maxCubemapSize:v,maxAttributes:x,maxVertexUniforms:y,maxVaryings:g,maxFragmentUniforms:T,vertexTextures:S,floatFragmentTextures:w,floatVertexTextures:M,maxSamples:P}}function s4(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new ll,a=new Mt,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(f,p){const m=f.length!==0||p||i!==0||r;return r=p,i=f.length,m},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(f,p){t=d(f,p,0)},this.setState=function(f,p,m){const v=f.clippingPlanes,x=f.clipIntersection,y=f.clipShadows,g=n.get(f);if(!r||v===null||v.length===0||s&&!y)s?d(null):u();else{const T=s?0:i,S=T*4;let w=g.clippingState||null;l.value=w,w=d(v,p,S,m);for(let M=0;M!==S;++M)w[M]=t[M];g.clippingState=w,this.numIntersection=x?this.numPlanes:0,this.numPlanes+=T}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function d(f,p,m,v){const x=f!==null?f.length:0;let y=null;if(x!==0){if(y=l.value,v!==!0||y===null){const g=m+x*4,T=p.matrixWorldInverse;a.getNormalMatrix(T),(y===null||y.length<g)&&(y=new Float32Array(g));for(let S=0,w=m;S!==x;++S,w+=4)o.copy(f[S]).applyMatrix4(T,a),o.normal.toArray(y,w),y[w+3]=o.constant}l.value=y,l.needsUpdate=!0}return e.numPlanes=x,e.numIntersection=0,y}}function o4(n){let e=new WeakMap;function t(o,a){return a===$x?o.mapping=Fc:a===Yx&&(o.mapping=Oc),o}function i(o){if(o&&o.isTexture){const a=o.mapping;if(a===$x||a===Yx)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const u=new _O(l.height/2);return u.fromEquirectangularTexture(n,o),e.set(o,u),o.addEventListener("dispose",r),t(u.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}class lE extends cI{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=d*this.view.offsetY,l=a-d*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const lc=4,RA=[.125,.215,.35,.446,.526,.582],_l=20,Xv=new lE,PA=new St;let jv=null,$v=0,Yv=0;const ul=(1+Math.sqrt(5))/2,Nu=1/ul,IA=[new Y(1,1,1),new Y(-1,1,1),new Y(1,1,-1),new Y(-1,1,-1),new Y(0,ul,Nu),new Y(0,ul,-Nu),new Y(Nu,0,ul),new Y(-Nu,0,ul),new Y(ul,Nu,0),new Y(-ul,Nu,0)];class LA{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){jv=this._renderer.getRenderTarget(),$v=this._renderer.getActiveCubeFace(),Yv=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=UA(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=NA(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(jv,$v,Yv),e.scissorTest=!1,Vp(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Fc||e.mapping===Oc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),jv=this._renderer.getRenderTarget(),$v=this._renderer.getActiveCubeFace(),Yv=this._renderer.getActiveMipmapLevel();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Wi,minFilter:Wi,generateMipmaps:!1,type:Xd,format:Ir,colorSpace:mi,depthBuffer:!1},r=DA(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=DA(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=a4(s)),this._blurMaterial=l4(s,e,t)}return r}_compileMaterial(e){const t=new Nr(this._lodPlanes[0],e);this._renderer.compile(t,Xv)}_sceneToCubeUV(e,t,i,r){const a=new Di(90,1,t,i),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],d=this._renderer,f=d.autoClear,p=d.toneMapping;d.getClearColor(PA),d.toneMapping=Ca,d.autoClear=!1;const m=new bl({name:"PMREM.Background",side:Ki,depthWrite:!1,depthTest:!1}),v=new Nr(new lf,m);let x=!1;const y=e.background;y?y.isColor&&(m.color.copy(y),e.background=null,x=!0):(m.color.copy(PA),x=!0);for(let g=0;g<6;g++){const T=g%3;T===0?(a.up.set(0,l[g],0),a.lookAt(u[g],0,0)):T===1?(a.up.set(0,0,l[g]),a.lookAt(0,u[g],0)):(a.up.set(0,l[g],0),a.lookAt(0,0,u[g]));const S=this._cubeSize;Vp(r,T*S,g>2?S:0,S,S),d.setRenderTarget(r),x&&d.render(v,a),d.render(e,a)}v.geometry.dispose(),v.material.dispose(),d.toneMapping=p,d.autoClear=f,e.background=y}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===Fc||e.mapping===Oc;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=UA()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=NA());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Nr(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;Vp(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,Xv)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=IA[(r-1)%IA.length];this._blur(e,r-1,r,s,o)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const d=3,f=new Nr(this._lodPlanes[r],u),p=u.uniforms,m=this._sizeLods[i]-1,v=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*_l-1),x=s/v,y=isFinite(s)?1+Math.floor(d*x):_l;y>_l&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${_l}`);const g=[];let T=0;for(let R=0;R<_l;++R){const D=R/x,C=Math.exp(-D*D/2);g.push(C),R===0?T+=C:R<y&&(T+=2*C)}for(let R=0;R<g.length;R++)g[R]=g[R]/T;p.envMap.value=e.texture,p.samples.value=y,p.weights.value=g,p.latitudinal.value=o==="latitudinal",a&&(p.poleAxis.value=a);const{_lodMax:S}=this;p.dTheta.value=v,p.mipInt.value=S-i;const w=this._sizeLods[r],M=3*w*(r>S-lc?r-S+lc:0),P=4*(this._cubeSize-w);Vp(t,M,P,3*w,2*w),l.setRenderTarget(t),l.render(f,Xv)}}function a4(n){const e=[],t=[],i=[];let r=n;const s=n-lc+1+RA.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-lc?l=RA[o-n+lc-1]:o===0&&(l=0),i.push(l);const u=1/(a-2),d=-u,f=1+u,p=[d,d,f,d,f,f,d,d,f,f,d,f],m=6,v=6,x=3,y=2,g=1,T=new Float32Array(x*v*m),S=new Float32Array(y*v*m),w=new Float32Array(g*v*m);for(let P=0;P<m;P++){const R=P%3*2/3-1,D=P>2?0:-1,C=[R,D,0,R+2/3,D,0,R+2/3,D+1,0,R,D,0,R+2/3,D+1,0,R,D+1,0];T.set(C,x*v*P),S.set(p,y*v*P);const L=[P,P,P,P,P,P];w.set(L,g*v*P)}const M=new Ys;M.setAttribute("position",new Fi(T,x)),M.setAttribute("uv",new Fi(S,y)),M.setAttribute("faceIndex",new Fi(w,g)),e.push(M),r>lc&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function DA(n,e,t){const i=new Wl(n,e,t);return i.texture.mapping=v0,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Vp(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function l4(n,e,t){const i=new Float32Array(_l),r=new Y(0,1,0);return new Xl({name:"SphericalGaussianBlur",defines:{n:_l,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:uE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ma,depthTest:!1,depthWrite:!1})}function NA(){return new Xl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:uE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ma,depthTest:!1,depthWrite:!1})}function UA(){return new Xl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:uE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ma,depthTest:!1,depthWrite:!1})}function uE(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function u4(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){const l=a.mapping,u=l===$x||l===Yx,d=l===Fc||l===Oc;if(u||d)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let f=e.get(a);return t===null&&(t=new LA(n)),f=u?t.fromEquirectangular(a,f):t.fromCubemap(a,f),e.set(a,f),f.texture}else{if(e.has(a))return e.get(a).texture;{const f=a.image;if(u&&f&&f.height>0||d&&f&&r(f)){t===null&&(t=new LA(n));const p=u?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,p),a.addEventListener("dispose",s),p.texture}else return null}}}return a}function r(a){let l=0;const u=6;for(let d=0;d<u;d++)a[d]!==void 0&&l++;return l===u}function s(a){const l=a.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function c4(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function h4(n,e,t,i){const r={},s=new WeakMap;function o(f){const p=f.target;p.index!==null&&e.remove(p.index);for(const v in p.attributes)e.remove(p.attributes[v]);for(const v in p.morphAttributes){const x=p.morphAttributes[v];for(let y=0,g=x.length;y<g;y++)e.remove(x[y])}p.removeEventListener("dispose",o),delete r[p.id];const m=s.get(p);m&&(e.remove(m),s.delete(p)),i.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,t.memory.geometries--}function a(f,p){return r[p.id]===!0||(p.addEventListener("dispose",o),r[p.id]=!0,t.memory.geometries++),p}function l(f){const p=f.attributes;for(const v in p)e.update(p[v],n.ARRAY_BUFFER);const m=f.morphAttributes;for(const v in m){const x=m[v];for(let y=0,g=x.length;y<g;y++)e.update(x[y],n.ARRAY_BUFFER)}}function u(f){const p=[],m=f.index,v=f.attributes.position;let x=0;if(m!==null){const T=m.array;x=m.version;for(let S=0,w=T.length;S<w;S+=3){const M=T[S+0],P=T[S+1],R=T[S+2];p.push(M,P,P,R,R,M)}}else if(v!==void 0){const T=v.array;x=v.version;for(let S=0,w=T.length/3-1;S<w;S+=3){const M=S+0,P=S+1,R=S+2;p.push(M,P,P,R,R,M)}}else return;const y=new(tI(p)?lI:aI)(p,1);y.version=x;const g=s.get(f);g&&e.remove(g),s.set(f,y)}function d(f){const p=s.get(f);if(p){const m=f.index;m!==null&&p.version<m.version&&u(f)}else u(f);return s.get(f)}return{get:a,update:l,getWireframeAttribute:d}}function d4(n,e,t,i){const r=i.isWebGL2;let s;function o(m){s=m}let a,l;function u(m){a=m.type,l=m.bytesPerElement}function d(m,v){n.drawElements(s,v,a,m*l),t.update(v,s,1)}function f(m,v,x){if(x===0)return;let y,g;if(r)y=n,g="drawElementsInstanced";else if(y=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",y===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}y[g](s,v,a,m*l,x),t.update(v,s,x)}function p(m,v,x){if(x===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let g=0;g<x;g++)this.render(m[g]/l,v[g]);else{y.multiDrawElementsWEBGL(s,v,0,a,m,0,x);let g=0;for(let T=0;T<x;T++)g+=v[T];t.update(g,s,1)}}this.setMode=o,this.setIndex=u,this.render=d,this.renderInstances=f,this.renderMultiDraw=p}function f4(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function p4(n,e){return n[0]-e[0]}function m4(n,e){return Math.abs(e[1])-Math.abs(n[1])}function g4(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new Qt,a=[];for(let u=0;u<8;u++)a[u]=[u,0];function l(u,d,f){const p=u.morphTargetInfluences;if(e.isWebGL2===!0){const v=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,x=v!==void 0?v.length:0;let y=s.get(d);if(y===void 0||y.count!==x){let j=function(){z.dispose(),s.delete(d),d.removeEventListener("dispose",j)};var m=j;y!==void 0&&y.texture.dispose();const S=d.morphAttributes.position!==void 0,w=d.morphAttributes.normal!==void 0,M=d.morphAttributes.color!==void 0,P=d.morphAttributes.position||[],R=d.morphAttributes.normal||[],D=d.morphAttributes.color||[];let C=0;S===!0&&(C=1),w===!0&&(C=2),M===!0&&(C=3);let L=d.attributes.position.count*C,Z=1;L>e.maxTextureSize&&(Z=Math.ceil(L/e.maxTextureSize),L=e.maxTextureSize);const V=new Float32Array(L*Z*4*x),z=new rI(V,L,Z,x);z.type=So,z.needsUpdate=!0;const F=C*4;for(let Q=0;Q<x;Q++){const $=P[Q],O=R[Q],G=D[Q],k=L*Z*4*Q;for(let H=0;H<$.count;H++){const te=H*F;S===!0&&(o.fromBufferAttribute($,H),V[k+te+0]=o.x,V[k+te+1]=o.y,V[k+te+2]=o.z,V[k+te+3]=0),w===!0&&(o.fromBufferAttribute(O,H),V[k+te+4]=o.x,V[k+te+5]=o.y,V[k+te+6]=o.z,V[k+te+7]=0),M===!0&&(o.fromBufferAttribute(G,H),V[k+te+8]=o.x,V[k+te+9]=o.y,V[k+te+10]=o.z,V[k+te+11]=G.itemSize===4?o.w:1)}}y={count:x,texture:z,size:new Ft(L,Z)},s.set(d,y),d.addEventListener("dispose",j)}let g=0;for(let S=0;S<p.length;S++)g+=p[S];const T=d.morphTargetsRelative?1:1-g;f.getUniforms().setValue(n,"morphTargetBaseInfluence",T),f.getUniforms().setValue(n,"morphTargetInfluences",p),f.getUniforms().setValue(n,"morphTargetsTexture",y.texture,t),f.getUniforms().setValue(n,"morphTargetsTextureSize",y.size)}else{const v=p===void 0?0:p.length;let x=i[d.id];if(x===void 0||x.length!==v){x=[];for(let w=0;w<v;w++)x[w]=[w,0];i[d.id]=x}for(let w=0;w<v;w++){const M=x[w];M[0]=w,M[1]=p[w]}x.sort(m4);for(let w=0;w<8;w++)w<v&&x[w][1]?(a[w][0]=x[w][0],a[w][1]=x[w][1]):(a[w][0]=Number.MAX_SAFE_INTEGER,a[w][1]=0);a.sort(p4);const y=d.morphAttributes.position,g=d.morphAttributes.normal;let T=0;for(let w=0;w<8;w++){const M=a[w],P=M[0],R=M[1];P!==Number.MAX_SAFE_INTEGER&&R?(y&&d.getAttribute("morphTarget"+w)!==y[P]&&d.setAttribute("morphTarget"+w,y[P]),g&&d.getAttribute("morphNormal"+w)!==g[P]&&d.setAttribute("morphNormal"+w,g[P]),r[w]=R,T+=R):(y&&d.hasAttribute("morphTarget"+w)===!0&&d.deleteAttribute("morphTarget"+w),g&&d.hasAttribute("morphNormal"+w)===!0&&d.deleteAttribute("morphNormal"+w),r[w]=0)}const S=d.morphTargetsRelative?1:1-T;f.getUniforms().setValue(n,"morphTargetBaseInfluence",S),f.getUniforms().setValue(n,"morphTargetInfluences",r)}}return{update:l}}function _4(n,e,t,i){let r=new WeakMap;function s(l){const u=i.render.frame,d=l.geometry,f=e.get(l,d);if(r.get(f)!==u&&(e.update(f),r.set(f,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==u&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,u))),l.isSkinnedMesh){const p=l.skeleton;r.get(p)!==u&&(p.update(),r.set(p,u))}return f}function o(){r=new WeakMap}function a(l){const u=l.target;u.removeEventListener("dispose",a),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:s,dispose:o}}class pI extends hr{constructor(e,t,i,r,s,o,a,l,u,d){if(d=d!==void 0?d:Il,d!==Il&&d!==Bc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&d===Il&&(i=ma),i===void 0&&d===Bc&&(i=Pl),super(null,r,s,o,a,l,d,i,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:ti,this.minFilter=l!==void 0?l:ti,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const mI=new hr,gI=new pI(1,1);gI.compareFunction=eI;const _I=new rI,vI=new eO,yI=new hI,FA=[],OA=[],kA=new Float32Array(16),BA=new Float32Array(9),zA=new Float32Array(4);function eh(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=FA[r];if(s===void 0&&(s=new Float32Array(r),FA[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Hn(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Vn(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function E0(n,e){let t=OA[e];t===void 0&&(t=new Int32Array(e),OA[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function v4(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function y4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Hn(t,e))return;n.uniform2fv(this.addr,e),Vn(t,e)}}function x4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Hn(t,e))return;n.uniform3fv(this.addr,e),Vn(t,e)}}function S4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Hn(t,e))return;n.uniform4fv(this.addr,e),Vn(t,e)}}function E4(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Hn(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Vn(t,e)}else{if(Hn(t,i))return;zA.set(i),n.uniformMatrix2fv(this.addr,!1,zA),Vn(t,i)}}function T4(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Hn(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Vn(t,e)}else{if(Hn(t,i))return;BA.set(i),n.uniformMatrix3fv(this.addr,!1,BA),Vn(t,i)}}function b4(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Hn(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Vn(t,e)}else{if(Hn(t,i))return;kA.set(i),n.uniformMatrix4fv(this.addr,!1,kA),Vn(t,i)}}function w4(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function A4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Hn(t,e))return;n.uniform2iv(this.addr,e),Vn(t,e)}}function M4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Hn(t,e))return;n.uniform3iv(this.addr,e),Vn(t,e)}}function C4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Hn(t,e))return;n.uniform4iv(this.addr,e),Vn(t,e)}}function R4(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function P4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Hn(t,e))return;n.uniform2uiv(this.addr,e),Vn(t,e)}}function I4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Hn(t,e))return;n.uniform3uiv(this.addr,e),Vn(t,e)}}function L4(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Hn(t,e))return;n.uniform4uiv(this.addr,e),Vn(t,e)}}function D4(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r);const s=this.type===n.SAMPLER_2D_SHADOW?gI:mI;t.setTexture2D(e||s,r)}function N4(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||vI,r)}function U4(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||yI,r)}function F4(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||_I,r)}function O4(n){switch(n){case 5126:return v4;case 35664:return y4;case 35665:return x4;case 35666:return S4;case 35674:return E4;case 35675:return T4;case 35676:return b4;case 5124:case 35670:return w4;case 35667:case 35671:return A4;case 35668:case 35672:return M4;case 35669:case 35673:return C4;case 5125:return R4;case 36294:return P4;case 36295:return I4;case 36296:return L4;case 35678:case 36198:case 36298:case 36306:case 35682:return D4;case 35679:case 36299:case 36307:return N4;case 35680:case 36300:case 36308:case 36293:return U4;case 36289:case 36303:case 36311:case 36292:return F4}}function k4(n,e){n.uniform1fv(this.addr,e)}function B4(n,e){const t=eh(e,this.size,2);n.uniform2fv(this.addr,t)}function z4(n,e){const t=eh(e,this.size,3);n.uniform3fv(this.addr,t)}function G4(n,e){const t=eh(e,this.size,4);n.uniform4fv(this.addr,t)}function H4(n,e){const t=eh(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function V4(n,e){const t=eh(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function W4(n,e){const t=eh(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function X4(n,e){n.uniform1iv(this.addr,e)}function j4(n,e){n.uniform2iv(this.addr,e)}function $4(n,e){n.uniform3iv(this.addr,e)}function Y4(n,e){n.uniform4iv(this.addr,e)}function q4(n,e){n.uniform1uiv(this.addr,e)}function K4(n,e){n.uniform2uiv(this.addr,e)}function Z4(n,e){n.uniform3uiv(this.addr,e)}function Q4(n,e){n.uniform4uiv(this.addr,e)}function J4(n,e,t){const i=this.cache,r=e.length,s=E0(t,r);Hn(i,s)||(n.uniform1iv(this.addr,s),Vn(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||mI,s[o])}function e5(n,e,t){const i=this.cache,r=e.length,s=E0(t,r);Hn(i,s)||(n.uniform1iv(this.addr,s),Vn(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||vI,s[o])}function t5(n,e,t){const i=this.cache,r=e.length,s=E0(t,r);Hn(i,s)||(n.uniform1iv(this.addr,s),Vn(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||yI,s[o])}function n5(n,e,t){const i=this.cache,r=e.length,s=E0(t,r);Hn(i,s)||(n.uniform1iv(this.addr,s),Vn(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||_I,s[o])}function i5(n){switch(n){case 5126:return k4;case 35664:return B4;case 35665:return z4;case 35666:return G4;case 35674:return H4;case 35675:return V4;case 35676:return W4;case 5124:case 35670:return X4;case 35667:case 35671:return j4;case 35668:case 35672:return $4;case 35669:case 35673:return Y4;case 5125:return q4;case 36294:return K4;case 36295:return Z4;case 36296:return Q4;case 35678:case 36198:case 36298:case 36306:case 35682:return J4;case 35679:case 36299:case 36307:return e5;case 35680:case 36300:case 36308:case 36293:return t5;case 36289:case 36303:case 36311:case 36292:return n5}}class r5{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=O4(t.type)}}class s5{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=i5(t.type)}}class o5{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const qv=/(\w+)(\])?(\[|\.)?/g;function GA(n,e){n.seq.push(e),n.map[e.id]=e}function a5(n,e,t){const i=n.name,r=i.length;for(qv.lastIndex=0;;){const s=qv.exec(i),o=qv.lastIndex;let a=s[1];const l=s[2]==="]",u=s[3];if(l&&(a=a|0),u===void 0||u==="["&&o+2===r){GA(t,u===void 0?new r5(a,n,e):new s5(a,n,e));break}else{let f=t.map[a];f===void 0&&(f=new o5(a),GA(t,f)),t=f}}}class Wm{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);a5(s,o,this)}}setValue(e,t,i,r){const s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function HA(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const l5=37297;let u5=0;function c5(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join(`
`)}function h5(n){const e=jt.getPrimaries(jt.workingColorSpace),t=jt.getPrimaries(n);let i;switch(e===t?i="":e===Pg&&t===Rg?i="LinearDisplayP3ToLinearSRGB":e===Rg&&t===Pg&&(i="LinearSRGBToLinearDisplayP3"),n){case mi:case y0:return[i,"LinearTransferOETF"];case Tn:case sE:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}function VA(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+c5(n.getShaderSource(e),o)}else return r}function d5(n,e){const t=h5(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function f5(n,e){let t;switch(e){case lF:t="Linear";break;case uF:t="Reinhard";break;case cF:t="OptimizedCineon";break;case hF:t="ACESFilmic";break;case dF:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function p5(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Qh).join(`
`)}function m5(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function g5(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function Qh(n){return n!==""}function WA(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function XA(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const _5=/^[ \t]*#include +<([\w\d./]+)>/gm;function e1(n){return n.replace(_5,y5)}const v5=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function y5(n,e){let t=bt[e];if(t===void 0){const i=v5.get(e);if(i!==void 0)t=bt[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return e1(t)}const x5=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function jA(n){return n.replace(x5,S5)}function S5(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function $A(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function E5(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===zP?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===FU?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===ho&&(e="SHADOWMAP_TYPE_VSM"),e}function T5(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Fc:case Oc:e="ENVMAP_TYPE_CUBE";break;case v0:e="ENVMAP_TYPE_CUBE_UV";break}return e}function b5(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Oc:e="ENVMAP_MODE_REFRACTION";break}return e}function w5(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case GP:e="ENVMAP_BLENDING_MULTIPLY";break;case oF:e="ENVMAP_BLENDING_MIX";break;case aF:e="ENVMAP_BLENDING_ADD";break}return e}function A5(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function M5(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=E5(t),u=T5(t),d=b5(t),f=w5(t),p=A5(t),m=t.isWebGL2?"":p5(t),v=m5(s),x=r.createProgram();let y,g,T=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(y=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v].filter(Qh).join(`
`),y.length>0&&(y+=`
`),g=[m,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v].filter(Qh).join(`
`),g.length>0&&(g+=`
`)):(y=[$A(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v,t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Qh).join(`
`),g=[m,$A(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",t.envMap?"#define "+f:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Ca?"#define TONE_MAPPING":"",t.toneMapping!==Ca?bt.tonemapping_pars_fragment:"",t.toneMapping!==Ca?f5("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",bt.colorspace_pars_fragment,d5("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Qh).join(`
`)),o=e1(o),o=WA(o,t),o=XA(o,t),a=e1(a),a=WA(a,t),a=XA(a,t),o=jA(o),a=jA(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(T=`#version 300 es
`,y=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,g=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===hA?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===hA?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+g);const S=T+y+o,w=T+g+a,M=HA(r,r.VERTEX_SHADER,S),P=HA(r,r.FRAGMENT_SHADER,w);r.attachShader(x,M),r.attachShader(x,P),t.index0AttributeName!==void 0?r.bindAttribLocation(x,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(x,0,"position"),r.linkProgram(x);function R(Z){if(n.debug.checkShaderErrors){const V=r.getProgramInfoLog(x).trim(),z=r.getShaderInfoLog(M).trim(),F=r.getShaderInfoLog(P).trim();let j=!0,Q=!0;if(r.getProgramParameter(x,r.LINK_STATUS)===!1)if(j=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,x,M,P);else{const $=VA(r,M,"vertex"),O=VA(r,P,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(x,r.VALIDATE_STATUS)+`

Program Info Log: `+V+`
`+$+`
`+O)}else V!==""?console.warn("THREE.WebGLProgram: Program Info Log:",V):(z===""||F==="")&&(Q=!1);Q&&(Z.diagnostics={runnable:j,programLog:V,vertexShader:{log:z,prefix:y},fragmentShader:{log:F,prefix:g}})}r.deleteShader(M),r.deleteShader(P),D=new Wm(r,x),C=g5(r,x)}let D;this.getUniforms=function(){return D===void 0&&R(this),D};let C;this.getAttributes=function(){return C===void 0&&R(this),C};let L=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return L===!1&&(L=r.getProgramParameter(x,l5)),L},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(x),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=u5++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=M,this.fragmentShader=P,this}let C5=0;class R5{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new P5(e),t.set(e,i)),i}}class P5{constructor(e){this.id=C5++,this.code=e,this.usedTimes=0}}function I5(n,e,t,i,r,s,o){const a=new sI,l=new R5,u=[],d=r.isWebGL2,f=r.logarithmicDepthBuffer,p=r.vertexTextures;let m=r.precision;const v={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function x(C){return C===0?"uv":`uv${C}`}function y(C,L,Z,V,z){const F=V.fog,j=z.geometry,Q=C.isMeshStandardMaterial?V.environment:null,$=(C.isMeshStandardMaterial?t:e).get(C.envMap||Q),O=$&&$.mapping===v0?$.image.height:null,G=v[C.type];C.precision!==null&&(m=r.getMaxPrecision(C.precision),m!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",m,"instead."));const k=j.morphAttributes.position||j.morphAttributes.normal||j.morphAttributes.color,H=k!==void 0?k.length:0;let te=0;j.morphAttributes.position!==void 0&&(te=1),j.morphAttributes.normal!==void 0&&(te=2),j.morphAttributes.color!==void 0&&(te=3);let ee,re,ge,ve;if(G){const Wn=Is[G];ee=Wn.vertexShader,re=Wn.fragmentShader}else ee=C.vertexShader,re=C.fragmentShader,l.update(C),ge=l.getVertexShaderID(C),ve=l.getFragmentShaderID(C);const Me=n.getRenderTarget(),Ze=z.isInstancedMesh===!0,Ye=z.isBatchedMesh===!0,ze=!!C.map,Ie=!!C.matcap,q=!!$,ct=!!C.aoMap,Xe=!!C.lightMap,st=!!C.bumpMap,nt=!!C.normalMap,Zt=!!C.displacementMap,gt=!!C.emissiveMap,xt=!!C.metalnessMap,Ot=!!C.roughnessMap,Un=C.anisotropy>0,Fn=C.clearcoat>0,B=C.iridescence>0,I=C.sheen>0,se=C.transmission>0,we=Un&&!!C.anisotropyMap,ye=Fn&&!!C.clearcoatMap,Ae=Fn&&!!C.clearcoatNormalMap,Qe=Fn&&!!C.clearcoatRoughnessMap,Re=B&&!!C.iridescenceMap,Oe=B&&!!C.iridescenceThicknessMap,ft=I&&!!C.sheenColorMap,Bt=I&&!!C.sheenRoughnessMap,be=!!C.specularMap,Vt=!!C.specularColorMap,yt=!!C.specularIntensityMap,ht=se&&!!C.transmissionMap,it=se&&!!C.thicknessMap,Ve=!!C.gradientMap,At=!!C.alphaMap,X=C.alphaTest>0,ke=!!C.alphaHash,Te=!!C.extensions,he=!!j.attributes.uv1,Ce=!!j.attributes.uv2,at=!!j.attributes.uv3;let Rt=Ca;return C.toneMapped&&(Me===null||Me.isXRRenderTarget===!0)&&(Rt=n.toneMapping),{isWebGL2:d,shaderID:G,shaderType:C.type,shaderName:C.name,vertexShader:ee,fragmentShader:re,defines:C.defines,customVertexShaderID:ge,customFragmentShaderID:ve,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:m,batching:Ye,instancing:Ze,instancingColor:Ze&&z.instanceColor!==null,supportsVertexTextures:p,outputColorSpace:Me===null?n.outputColorSpace:Me.isXRRenderTarget===!0?Me.texture.colorSpace:mi,map:ze,matcap:Ie,envMap:q,envMapMode:q&&$.mapping,envMapCubeUVHeight:O,aoMap:ct,lightMap:Xe,bumpMap:st,normalMap:nt,displacementMap:p&&Zt,emissiveMap:gt,normalMapObjectSpace:nt&&C.normalMapType===AF,normalMapTangentSpace:nt&&C.normalMapType===JP,metalnessMap:xt,roughnessMap:Ot,anisotropy:Un,anisotropyMap:we,clearcoat:Fn,clearcoatMap:ye,clearcoatNormalMap:Ae,clearcoatRoughnessMap:Qe,iridescence:B,iridescenceMap:Re,iridescenceThicknessMap:Oe,sheen:I,sheenColorMap:ft,sheenRoughnessMap:Bt,specularMap:be,specularColorMap:Vt,specularIntensityMap:yt,transmission:se,transmissionMap:ht,thicknessMap:it,gradientMap:Ve,opaque:C.transparent===!1&&C.blending===yc,alphaMap:At,alphaTest:X,alphaHash:ke,combine:C.combine,mapUv:ze&&x(C.map.channel),aoMapUv:ct&&x(C.aoMap.channel),lightMapUv:Xe&&x(C.lightMap.channel),bumpMapUv:st&&x(C.bumpMap.channel),normalMapUv:nt&&x(C.normalMap.channel),displacementMapUv:Zt&&x(C.displacementMap.channel),emissiveMapUv:gt&&x(C.emissiveMap.channel),metalnessMapUv:xt&&x(C.metalnessMap.channel),roughnessMapUv:Ot&&x(C.roughnessMap.channel),anisotropyMapUv:we&&x(C.anisotropyMap.channel),clearcoatMapUv:ye&&x(C.clearcoatMap.channel),clearcoatNormalMapUv:Ae&&x(C.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Qe&&x(C.clearcoatRoughnessMap.channel),iridescenceMapUv:Re&&x(C.iridescenceMap.channel),iridescenceThicknessMapUv:Oe&&x(C.iridescenceThicknessMap.channel),sheenColorMapUv:ft&&x(C.sheenColorMap.channel),sheenRoughnessMapUv:Bt&&x(C.sheenRoughnessMap.channel),specularMapUv:be&&x(C.specularMap.channel),specularColorMapUv:Vt&&x(C.specularColorMap.channel),specularIntensityMapUv:yt&&x(C.specularIntensityMap.channel),transmissionMapUv:ht&&x(C.transmissionMap.channel),thicknessMapUv:it&&x(C.thicknessMap.channel),alphaMapUv:At&&x(C.alphaMap.channel),vertexTangents:!!j.attributes.tangent&&(nt||Un),vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!j.attributes.color&&j.attributes.color.itemSize===4,vertexUv1s:he,vertexUv2s:Ce,vertexUv3s:at,pointsUvs:z.isPoints===!0&&!!j.attributes.uv&&(ze||At),fog:!!F,useFog:C.fog===!0,fogExp2:F&&F.isFogExp2,flatShading:C.flatShading===!0,sizeAttenuation:C.sizeAttenuation===!0,logarithmicDepthBuffer:f,skinning:z.isSkinnedMesh===!0,morphTargets:j.morphAttributes.position!==void 0,morphNormals:j.morphAttributes.normal!==void 0,morphColors:j.morphAttributes.color!==void 0,morphTargetsCount:H,morphTextureStride:te,numDirLights:L.directional.length,numPointLights:L.point.length,numSpotLights:L.spot.length,numSpotLightMaps:L.spotLightMap.length,numRectAreaLights:L.rectArea.length,numHemiLights:L.hemi.length,numDirLightShadows:L.directionalShadowMap.length,numPointLightShadows:L.pointShadowMap.length,numSpotLightShadows:L.spotShadowMap.length,numSpotLightShadowsWithMaps:L.numSpotLightShadowsWithMaps,numLightProbes:L.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:n.shadowMap.enabled&&Z.length>0,shadowMapType:n.shadowMap.type,toneMapping:Rt,useLegacyLights:n._useLegacyLights,decodeVideoTexture:ze&&C.map.isVideoTexture===!0&&jt.getTransfer(C.map.colorSpace)===sn,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===Us,flipSided:C.side===Ki,useDepthPacking:C.depthPacking>=0,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionDerivatives:Te&&C.extensions.derivatives===!0,extensionFragDepth:Te&&C.extensions.fragDepth===!0,extensionDrawBuffers:Te&&C.extensions.drawBuffers===!0,extensionShaderTextureLOD:Te&&C.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:d||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:C.customProgramCacheKey()}}function g(C){const L=[];if(C.shaderID?L.push(C.shaderID):(L.push(C.customVertexShaderID),L.push(C.customFragmentShaderID)),C.defines!==void 0)for(const Z in C.defines)L.push(Z),L.push(C.defines[Z]);return C.isRawShaderMaterial===!1&&(T(L,C),S(L,C),L.push(n.outputColorSpace)),L.push(C.customProgramCacheKey),L.join()}function T(C,L){C.push(L.precision),C.push(L.outputColorSpace),C.push(L.envMapMode),C.push(L.envMapCubeUVHeight),C.push(L.mapUv),C.push(L.alphaMapUv),C.push(L.lightMapUv),C.push(L.aoMapUv),C.push(L.bumpMapUv),C.push(L.normalMapUv),C.push(L.displacementMapUv),C.push(L.emissiveMapUv),C.push(L.metalnessMapUv),C.push(L.roughnessMapUv),C.push(L.anisotropyMapUv),C.push(L.clearcoatMapUv),C.push(L.clearcoatNormalMapUv),C.push(L.clearcoatRoughnessMapUv),C.push(L.iridescenceMapUv),C.push(L.iridescenceThicknessMapUv),C.push(L.sheenColorMapUv),C.push(L.sheenRoughnessMapUv),C.push(L.specularMapUv),C.push(L.specularColorMapUv),C.push(L.specularIntensityMapUv),C.push(L.transmissionMapUv),C.push(L.thicknessMapUv),C.push(L.combine),C.push(L.fogExp2),C.push(L.sizeAttenuation),C.push(L.morphTargetsCount),C.push(L.morphAttributeCount),C.push(L.numDirLights),C.push(L.numPointLights),C.push(L.numSpotLights),C.push(L.numSpotLightMaps),C.push(L.numHemiLights),C.push(L.numRectAreaLights),C.push(L.numDirLightShadows),C.push(L.numPointLightShadows),C.push(L.numSpotLightShadows),C.push(L.numSpotLightShadowsWithMaps),C.push(L.numLightProbes),C.push(L.shadowMapType),C.push(L.toneMapping),C.push(L.numClippingPlanes),C.push(L.numClipIntersection),C.push(L.depthPacking)}function S(C,L){a.disableAll(),L.isWebGL2&&a.enable(0),L.supportsVertexTextures&&a.enable(1),L.instancing&&a.enable(2),L.instancingColor&&a.enable(3),L.matcap&&a.enable(4),L.envMap&&a.enable(5),L.normalMapObjectSpace&&a.enable(6),L.normalMapTangentSpace&&a.enable(7),L.clearcoat&&a.enable(8),L.iridescence&&a.enable(9),L.alphaTest&&a.enable(10),L.vertexColors&&a.enable(11),L.vertexAlphas&&a.enable(12),L.vertexUv1s&&a.enable(13),L.vertexUv2s&&a.enable(14),L.vertexUv3s&&a.enable(15),L.vertexTangents&&a.enable(16),L.anisotropy&&a.enable(17),L.alphaHash&&a.enable(18),L.batching&&a.enable(19),C.push(a.mask),a.disableAll(),L.fog&&a.enable(0),L.useFog&&a.enable(1),L.flatShading&&a.enable(2),L.logarithmicDepthBuffer&&a.enable(3),L.skinning&&a.enable(4),L.morphTargets&&a.enable(5),L.morphNormals&&a.enable(6),L.morphColors&&a.enable(7),L.premultipliedAlpha&&a.enable(8),L.shadowMapEnabled&&a.enable(9),L.useLegacyLights&&a.enable(10),L.doubleSided&&a.enable(11),L.flipSided&&a.enable(12),L.useDepthPacking&&a.enable(13),L.dithering&&a.enable(14),L.transmission&&a.enable(15),L.sheen&&a.enable(16),L.opaque&&a.enable(17),L.pointsUvs&&a.enable(18),L.decodeVideoTexture&&a.enable(19),C.push(a.mask)}function w(C){const L=v[C.type];let Z;if(L){const V=Is[L];Z=fO.clone(V.uniforms)}else Z=C.uniforms;return Z}function M(C,L){let Z;for(let V=0,z=u.length;V<z;V++){const F=u[V];if(F.cacheKey===L){Z=F,++Z.usedTimes;break}}return Z===void 0&&(Z=new M5(n,L,C,s),u.push(Z)),Z}function P(C){if(--C.usedTimes===0){const L=u.indexOf(C);u[L]=u[u.length-1],u.pop(),C.destroy()}}function R(C){l.remove(C)}function D(){l.dispose()}return{getParameters:y,getProgramCacheKey:g,getUniforms:w,acquireProgram:M,releaseProgram:P,releaseShaderCache:R,programs:u,dispose:D}}function L5(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function i(s,o,a){n.get(s)[o]=a}function r(){n=new WeakMap}return{get:e,remove:t,update:i,dispose:r}}function D5(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function YA(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function qA(){const n=[];let e=0;const t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function o(f,p,m,v,x,y){let g=n[e];return g===void 0?(g={id:f.id,object:f,geometry:p,material:m,groupOrder:v,renderOrder:f.renderOrder,z:x,group:y},n[e]=g):(g.id=f.id,g.object=f,g.geometry=p,g.material=m,g.groupOrder=v,g.renderOrder=f.renderOrder,g.z=x,g.group=y),e++,g}function a(f,p,m,v,x,y){const g=o(f,p,m,v,x,y);m.transmission>0?i.push(g):m.transparent===!0?r.push(g):t.push(g)}function l(f,p,m,v,x,y){const g=o(f,p,m,v,x,y);m.transmission>0?i.unshift(g):m.transparent===!0?r.unshift(g):t.unshift(g)}function u(f,p){t.length>1&&t.sort(f||D5),i.length>1&&i.sort(p||YA),r.length>1&&r.sort(p||YA)}function d(){for(let f=e,p=n.length;f<p;f++){const m=n[f];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:d,sort:u}}function N5(){let n=new WeakMap;function e(i,r){const s=n.get(i);let o;return s===void 0?(o=new qA,n.set(i,[o])):r>=s.length?(o=new qA,s.push(o)):o=s[r],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function U5(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Y,color:new St};break;case"SpotLight":t={position:new Y,direction:new Y,color:new St,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Y,color:new St,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Y,skyColor:new St,groundColor:new St};break;case"RectAreaLight":t={color:new St,position:new Y,halfWidth:new Y,halfHeight:new Y};break}return n[e.id]=t,t}}}function F5(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ft};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ft};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ft,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let O5=0;function k5(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function B5(n,e){const t=new U5,i=F5(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let d=0;d<9;d++)r.probe.push(new Y);const s=new Y,o=new Ct,a=new Ct;function l(d,f){let p=0,m=0,v=0;for(let V=0;V<9;V++)r.probe[V].set(0,0,0);let x=0,y=0,g=0,T=0,S=0,w=0,M=0,P=0,R=0,D=0,C=0;d.sort(k5);const L=f===!0?Math.PI:1;for(let V=0,z=d.length;V<z;V++){const F=d[V],j=F.color,Q=F.intensity,$=F.distance,O=F.shadow&&F.shadow.map?F.shadow.map.texture:null;if(F.isAmbientLight)p+=j.r*Q*L,m+=j.g*Q*L,v+=j.b*Q*L;else if(F.isLightProbe){for(let G=0;G<9;G++)r.probe[G].addScaledVector(F.sh.coefficients[G],Q);C++}else if(F.isDirectionalLight){const G=t.get(F);if(G.color.copy(F.color).multiplyScalar(F.intensity*L),F.castShadow){const k=F.shadow,H=i.get(F);H.shadowBias=k.bias,H.shadowNormalBias=k.normalBias,H.shadowRadius=k.radius,H.shadowMapSize=k.mapSize,r.directionalShadow[x]=H,r.directionalShadowMap[x]=O,r.directionalShadowMatrix[x]=F.shadow.matrix,w++}r.directional[x]=G,x++}else if(F.isSpotLight){const G=t.get(F);G.position.setFromMatrixPosition(F.matrixWorld),G.color.copy(j).multiplyScalar(Q*L),G.distance=$,G.coneCos=Math.cos(F.angle),G.penumbraCos=Math.cos(F.angle*(1-F.penumbra)),G.decay=F.decay,r.spot[g]=G;const k=F.shadow;if(F.map&&(r.spotLightMap[R]=F.map,R++,k.updateMatrices(F),F.castShadow&&D++),r.spotLightMatrix[g]=k.matrix,F.castShadow){const H=i.get(F);H.shadowBias=k.bias,H.shadowNormalBias=k.normalBias,H.shadowRadius=k.radius,H.shadowMapSize=k.mapSize,r.spotShadow[g]=H,r.spotShadowMap[g]=O,P++}g++}else if(F.isRectAreaLight){const G=t.get(F);G.color.copy(j).multiplyScalar(Q),G.halfWidth.set(F.width*.5,0,0),G.halfHeight.set(0,F.height*.5,0),r.rectArea[T]=G,T++}else if(F.isPointLight){const G=t.get(F);if(G.color.copy(F.color).multiplyScalar(F.intensity*L),G.distance=F.distance,G.decay=F.decay,F.castShadow){const k=F.shadow,H=i.get(F);H.shadowBias=k.bias,H.shadowNormalBias=k.normalBias,H.shadowRadius=k.radius,H.shadowMapSize=k.mapSize,H.shadowCameraNear=k.camera.near,H.shadowCameraFar=k.camera.far,r.pointShadow[y]=H,r.pointShadowMap[y]=O,r.pointShadowMatrix[y]=F.shadow.matrix,M++}r.point[y]=G,y++}else if(F.isHemisphereLight){const G=t.get(F);G.skyColor.copy(F.color).multiplyScalar(Q*L),G.groundColor.copy(F.groundColor).multiplyScalar(Q*L),r.hemi[S]=G,S++}}T>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=Le.LTC_FLOAT_1,r.rectAreaLTC2=Le.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=Le.LTC_HALF_1,r.rectAreaLTC2=Le.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=p,r.ambient[1]=m,r.ambient[2]=v;const Z=r.hash;(Z.directionalLength!==x||Z.pointLength!==y||Z.spotLength!==g||Z.rectAreaLength!==T||Z.hemiLength!==S||Z.numDirectionalShadows!==w||Z.numPointShadows!==M||Z.numSpotShadows!==P||Z.numSpotMaps!==R||Z.numLightProbes!==C)&&(r.directional.length=x,r.spot.length=g,r.rectArea.length=T,r.point.length=y,r.hemi.length=S,r.directionalShadow.length=w,r.directionalShadowMap.length=w,r.pointShadow.length=M,r.pointShadowMap.length=M,r.spotShadow.length=P,r.spotShadowMap.length=P,r.directionalShadowMatrix.length=w,r.pointShadowMatrix.length=M,r.spotLightMatrix.length=P+R-D,r.spotLightMap.length=R,r.numSpotLightShadowsWithMaps=D,r.numLightProbes=C,Z.directionalLength=x,Z.pointLength=y,Z.spotLength=g,Z.rectAreaLength=T,Z.hemiLength=S,Z.numDirectionalShadows=w,Z.numPointShadows=M,Z.numSpotShadows=P,Z.numSpotMaps=R,Z.numLightProbes=C,r.version=O5++)}function u(d,f){let p=0,m=0,v=0,x=0,y=0;const g=f.matrixWorldInverse;for(let T=0,S=d.length;T<S;T++){const w=d[T];if(w.isDirectionalLight){const M=r.directional[p];M.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(g),p++}else if(w.isSpotLight){const M=r.spot[v];M.position.setFromMatrixPosition(w.matrixWorld),M.position.applyMatrix4(g),M.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(g),v++}else if(w.isRectAreaLight){const M=r.rectArea[x];M.position.setFromMatrixPosition(w.matrixWorld),M.position.applyMatrix4(g),a.identity(),o.copy(w.matrixWorld),o.premultiply(g),a.extractRotation(o),M.halfWidth.set(w.width*.5,0,0),M.halfHeight.set(0,w.height*.5,0),M.halfWidth.applyMatrix4(a),M.halfHeight.applyMatrix4(a),x++}else if(w.isPointLight){const M=r.point[m];M.position.setFromMatrixPosition(w.matrixWorld),M.position.applyMatrix4(g),m++}else if(w.isHemisphereLight){const M=r.hemi[y];M.direction.setFromMatrixPosition(w.matrixWorld),M.direction.transformDirection(g),y++}}}return{setup:l,setupView:u,state:r}}function KA(n,e){const t=new B5(n,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(f){i.push(f)}function a(f){r.push(f)}function l(f){t.setup(i,f)}function u(f){t.setupView(i,f)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:l,setupLightsView:u,pushLight:o,pushShadow:a}}function z5(n,e){let t=new WeakMap;function i(s,o=0){const a=t.get(s);let l;return a===void 0?(l=new KA(n,e),t.set(s,[l])):o>=a.length?(l=new KA(n,e),a.push(l)):l=a[o],l}function r(){t=new WeakMap}return{get:i,dispose:r}}class G5 extends Gs{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=bF,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class H5 extends Gs{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const V5=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,W5=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function X5(n,e,t){let i=new aE;const r=new Ft,s=new Ft,o=new Qt,a=new G5({depthPacking:wF}),l=new H5,u={},d=t.maxTextureSize,f={[No]:Ki,[Ki]:No,[Us]:Us},p=new Xl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ft},radius:{value:4}},vertexShader:V5,fragmentShader:W5}),m=p.clone();m.defines.HORIZONTAL_PASS=1;const v=new Ys;v.setAttribute("position",new Fi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const x=new Nr(v,p),y=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=zP;let g=this.type;this.render=function(M,P,R){if(y.enabled===!1||y.autoUpdate===!1&&y.needsUpdate===!1||M.length===0)return;const D=n.getRenderTarget(),C=n.getActiveCubeFace(),L=n.getActiveMipmapLevel(),Z=n.state;Z.setBlending(Ma),Z.buffers.color.setClear(1,1,1,1),Z.buffers.depth.setTest(!0),Z.setScissorTest(!1);const V=g!==ho&&this.type===ho,z=g===ho&&this.type!==ho;for(let F=0,j=M.length;F<j;F++){const Q=M[F],$=Q.shadow;if($===void 0){console.warn("THREE.WebGLShadowMap:",Q,"has no shadow.");continue}if($.autoUpdate===!1&&$.needsUpdate===!1)continue;r.copy($.mapSize);const O=$.getFrameExtents();if(r.multiply(O),s.copy($.mapSize),(r.x>d||r.y>d)&&(r.x>d&&(s.x=Math.floor(d/O.x),r.x=s.x*O.x,$.mapSize.x=s.x),r.y>d&&(s.y=Math.floor(d/O.y),r.y=s.y*O.y,$.mapSize.y=s.y)),$.map===null||V===!0||z===!0){const k=this.type!==ho?{minFilter:ti,magFilter:ti}:{};$.map!==null&&$.map.dispose(),$.map=new Wl(r.x,r.y,k),$.map.texture.name=Q.name+".shadowMap",$.camera.updateProjectionMatrix()}n.setRenderTarget($.map),n.clear();const G=$.getViewportCount();for(let k=0;k<G;k++){const H=$.getViewport(k);o.set(s.x*H.x,s.y*H.y,s.x*H.z,s.y*H.w),Z.viewport(o),$.updateMatrices(Q,k),i=$.getFrustum(),w(P,R,$.camera,Q,this.type)}$.isPointLightShadow!==!0&&this.type===ho&&T($,R),$.needsUpdate=!1}g=this.type,y.needsUpdate=!1,n.setRenderTarget(D,C,L)};function T(M,P){const R=e.update(x);p.defines.VSM_SAMPLES!==M.blurSamples&&(p.defines.VSM_SAMPLES=M.blurSamples,m.defines.VSM_SAMPLES=M.blurSamples,p.needsUpdate=!0,m.needsUpdate=!0),M.mapPass===null&&(M.mapPass=new Wl(r.x,r.y)),p.uniforms.shadow_pass.value=M.map.texture,p.uniforms.resolution.value=M.mapSize,p.uniforms.radius.value=M.radius,n.setRenderTarget(M.mapPass),n.clear(),n.renderBufferDirect(P,null,R,p,x,null),m.uniforms.shadow_pass.value=M.mapPass.texture,m.uniforms.resolution.value=M.mapSize,m.uniforms.radius.value=M.radius,n.setRenderTarget(M.map),n.clear(),n.renderBufferDirect(P,null,R,m,x,null)}function S(M,P,R,D){let C=null;const L=R.isPointLight===!0?M.customDistanceMaterial:M.customDepthMaterial;if(L!==void 0)C=L;else if(C=R.isPointLight===!0?l:a,n.localClippingEnabled&&P.clipShadows===!0&&Array.isArray(P.clippingPlanes)&&P.clippingPlanes.length!==0||P.displacementMap&&P.displacementScale!==0||P.alphaMap&&P.alphaTest>0||P.map&&P.alphaTest>0){const Z=C.uuid,V=P.uuid;let z=u[Z];z===void 0&&(z={},u[Z]=z);let F=z[V];F===void 0&&(F=C.clone(),z[V]=F),C=F}if(C.visible=P.visible,C.wireframe=P.wireframe,D===ho?C.side=P.shadowSide!==null?P.shadowSide:P.side:C.side=P.shadowSide!==null?P.shadowSide:f[P.side],C.alphaMap=P.alphaMap,C.alphaTest=P.alphaTest,C.map=P.map,C.clipShadows=P.clipShadows,C.clippingPlanes=P.clippingPlanes,C.clipIntersection=P.clipIntersection,C.displacementMap=P.displacementMap,C.displacementScale=P.displacementScale,C.displacementBias=P.displacementBias,C.wireframeLinewidth=P.wireframeLinewidth,C.linewidth=P.linewidth,R.isPointLight===!0&&C.isMeshDistanceMaterial===!0){const Z=n.properties.get(C);Z.light=R}return C}function w(M,P,R,D,C){if(M.visible===!1)return;if(M.layers.test(P.layers)&&(M.isMesh||M.isLine||M.isPoints)&&(M.castShadow||M.receiveShadow&&C===ho)&&(!M.frustumCulled||i.intersectsObject(M))){M.modelViewMatrix.multiplyMatrices(R.matrixWorldInverse,M.matrixWorld);const V=e.update(M),z=M.material;if(Array.isArray(z)){const F=V.groups;for(let j=0,Q=F.length;j<Q;j++){const $=F[j],O=z[$.materialIndex];if(O&&O.visible){const G=S(M,O,D,C);M.onBeforeShadow(n,M,P,R,V,G,$),n.renderBufferDirect(R,null,V,G,M,$),M.onAfterShadow(n,M,P,R,V,G,$)}}}else if(z.visible){const F=S(M,z,D,C);M.onBeforeShadow(n,M,P,R,V,F,null),n.renderBufferDirect(R,null,V,F,M,null),M.onAfterShadow(n,M,P,R,V,F,null)}}const Z=M.children;for(let V=0,z=Z.length;V<z;V++)w(Z[V],P,R,D,C)}}function j5(n,e,t){const i=t.isWebGL2;function r(){let X=!1;const ke=new Qt;let Te=null;const he=new Qt(0,0,0,0);return{setMask:function(Ce){Te!==Ce&&!X&&(n.colorMask(Ce,Ce,Ce,Ce),Te=Ce)},setLocked:function(Ce){X=Ce},setClear:function(Ce,at,Rt,wn,Wn){Wn===!0&&(Ce*=wn,at*=wn,Rt*=wn),ke.set(Ce,at,Rt,wn),he.equals(ke)===!1&&(n.clearColor(Ce,at,Rt,wn),he.copy(ke))},reset:function(){X=!1,Te=null,he.set(-1,0,0,0)}}}function s(){let X=!1,ke=null,Te=null,he=null;return{setTest:function(Ce){Ce?Ye(n.DEPTH_TEST):ze(n.DEPTH_TEST)},setMask:function(Ce){ke!==Ce&&!X&&(n.depthMask(Ce),ke=Ce)},setFunc:function(Ce){if(Te!==Ce){switch(Ce){case JU:n.depthFunc(n.NEVER);break;case eF:n.depthFunc(n.ALWAYS);break;case tF:n.depthFunc(n.LESS);break;case Ag:n.depthFunc(n.LEQUAL);break;case nF:n.depthFunc(n.EQUAL);break;case iF:n.depthFunc(n.GEQUAL);break;case rF:n.depthFunc(n.GREATER);break;case sF:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Te=Ce}},setLocked:function(Ce){X=Ce},setClear:function(Ce){he!==Ce&&(n.clearDepth(Ce),he=Ce)},reset:function(){X=!1,ke=null,Te=null,he=null}}}function o(){let X=!1,ke=null,Te=null,he=null,Ce=null,at=null,Rt=null,wn=null,Wn=null;return{setTest:function(qt){X||(qt?Ye(n.STENCIL_TEST):ze(n.STENCIL_TEST))},setMask:function(qt){ke!==qt&&!X&&(n.stencilMask(qt),ke=qt)},setFunc:function(qt,ri,pr){(Te!==qt||he!==ri||Ce!==pr)&&(n.stencilFunc(qt,ri,pr),Te=qt,he=ri,Ce=pr)},setOp:function(qt,ri,pr){(at!==qt||Rt!==ri||wn!==pr)&&(n.stencilOp(qt,ri,pr),at=qt,Rt=ri,wn=pr)},setLocked:function(qt){X=qt},setClear:function(qt){Wn!==qt&&(n.clearStencil(qt),Wn=qt)},reset:function(){X=!1,ke=null,Te=null,he=null,Ce=null,at=null,Rt=null,wn=null,Wn=null}}}const a=new r,l=new s,u=new o,d=new WeakMap,f=new WeakMap;let p={},m={},v=new WeakMap,x=[],y=null,g=!1,T=null,S=null,w=null,M=null,P=null,R=null,D=null,C=new St(0,0,0),L=0,Z=!1,V=null,z=null,F=null,j=null,Q=null;const $=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let O=!1,G=0;const k=n.getParameter(n.VERSION);k.indexOf("WebGL")!==-1?(G=parseFloat(/^WebGL (\d)/.exec(k)[1]),O=G>=1):k.indexOf("OpenGL ES")!==-1&&(G=parseFloat(/^OpenGL ES (\d)/.exec(k)[1]),O=G>=2);let H=null,te={};const ee=n.getParameter(n.SCISSOR_BOX),re=n.getParameter(n.VIEWPORT),ge=new Qt().fromArray(ee),ve=new Qt().fromArray(re);function Me(X,ke,Te,he){const Ce=new Uint8Array(4),at=n.createTexture();n.bindTexture(X,at),n.texParameteri(X,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(X,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Rt=0;Rt<Te;Rt++)i&&(X===n.TEXTURE_3D||X===n.TEXTURE_2D_ARRAY)?n.texImage3D(ke,0,n.RGBA,1,1,he,0,n.RGBA,n.UNSIGNED_BYTE,Ce):n.texImage2D(ke+Rt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Ce);return at}const Ze={};Ze[n.TEXTURE_2D]=Me(n.TEXTURE_2D,n.TEXTURE_2D,1),Ze[n.TEXTURE_CUBE_MAP]=Me(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Ze[n.TEXTURE_2D_ARRAY]=Me(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Ze[n.TEXTURE_3D]=Me(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),u.setClear(0),Ye(n.DEPTH_TEST),l.setFunc(Ag),gt(!1),xt(Rw),Ye(n.CULL_FACE),nt(Ma);function Ye(X){p[X]!==!0&&(n.enable(X),p[X]=!0)}function ze(X){p[X]!==!1&&(n.disable(X),p[X]=!1)}function Ie(X,ke){return m[X]!==ke?(n.bindFramebuffer(X,ke),m[X]=ke,i&&(X===n.DRAW_FRAMEBUFFER&&(m[n.FRAMEBUFFER]=ke),X===n.FRAMEBUFFER&&(m[n.DRAW_FRAMEBUFFER]=ke)),!0):!1}function q(X,ke){let Te=x,he=!1;if(X)if(Te=v.get(ke),Te===void 0&&(Te=[],v.set(ke,Te)),X.isWebGLMultipleRenderTargets){const Ce=X.texture;if(Te.length!==Ce.length||Te[0]!==n.COLOR_ATTACHMENT0){for(let at=0,Rt=Ce.length;at<Rt;at++)Te[at]=n.COLOR_ATTACHMENT0+at;Te.length=Ce.length,he=!0}}else Te[0]!==n.COLOR_ATTACHMENT0&&(Te[0]=n.COLOR_ATTACHMENT0,he=!0);else Te[0]!==n.BACK&&(Te[0]=n.BACK,he=!0);he&&(t.isWebGL2?n.drawBuffers(Te):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Te))}function ct(X){return y!==X?(n.useProgram(X),y=X,!0):!1}const Xe={[gl]:n.FUNC_ADD,[kU]:n.FUNC_SUBTRACT,[BU]:n.FUNC_REVERSE_SUBTRACT};if(i)Xe[Dw]=n.MIN,Xe[Nw]=n.MAX;else{const X=e.get("EXT_blend_minmax");X!==null&&(Xe[Dw]=X.MIN_EXT,Xe[Nw]=X.MAX_EXT)}const st={[zU]:n.ZERO,[GU]:n.ONE,[HU]:n.SRC_COLOR,[Xx]:n.SRC_ALPHA,[YU]:n.SRC_ALPHA_SATURATE,[jU]:n.DST_COLOR,[WU]:n.DST_ALPHA,[VU]:n.ONE_MINUS_SRC_COLOR,[jx]:n.ONE_MINUS_SRC_ALPHA,[$U]:n.ONE_MINUS_DST_COLOR,[XU]:n.ONE_MINUS_DST_ALPHA,[qU]:n.CONSTANT_COLOR,[KU]:n.ONE_MINUS_CONSTANT_COLOR,[ZU]:n.CONSTANT_ALPHA,[QU]:n.ONE_MINUS_CONSTANT_ALPHA};function nt(X,ke,Te,he,Ce,at,Rt,wn,Wn,qt){if(X===Ma){g===!0&&(ze(n.BLEND),g=!1);return}if(g===!1&&(Ye(n.BLEND),g=!0),X!==OU){if(X!==T||qt!==Z){if((S!==gl||P!==gl)&&(n.blendEquation(n.FUNC_ADD),S=gl,P=gl),qt)switch(X){case yc:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Pw:n.blendFunc(n.ONE,n.ONE);break;case Iw:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case Lw:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",X);break}else switch(X){case yc:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Pw:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case Iw:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case Lw:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",X);break}w=null,M=null,R=null,D=null,C.set(0,0,0),L=0,T=X,Z=qt}return}Ce=Ce||ke,at=at||Te,Rt=Rt||he,(ke!==S||Ce!==P)&&(n.blendEquationSeparate(Xe[ke],Xe[Ce]),S=ke,P=Ce),(Te!==w||he!==M||at!==R||Rt!==D)&&(n.blendFuncSeparate(st[Te],st[he],st[at],st[Rt]),w=Te,M=he,R=at,D=Rt),(wn.equals(C)===!1||Wn!==L)&&(n.blendColor(wn.r,wn.g,wn.b,Wn),C.copy(wn),L=Wn),T=X,Z=!1}function Zt(X,ke){X.side===Us?ze(n.CULL_FACE):Ye(n.CULL_FACE);let Te=X.side===Ki;ke&&(Te=!Te),gt(Te),X.blending===yc&&X.transparent===!1?nt(Ma):nt(X.blending,X.blendEquation,X.blendSrc,X.blendDst,X.blendEquationAlpha,X.blendSrcAlpha,X.blendDstAlpha,X.blendColor,X.blendAlpha,X.premultipliedAlpha),l.setFunc(X.depthFunc),l.setTest(X.depthTest),l.setMask(X.depthWrite),a.setMask(X.colorWrite);const he=X.stencilWrite;u.setTest(he),he&&(u.setMask(X.stencilWriteMask),u.setFunc(X.stencilFunc,X.stencilRef,X.stencilFuncMask),u.setOp(X.stencilFail,X.stencilZFail,X.stencilZPass)),Un(X.polygonOffset,X.polygonOffsetFactor,X.polygonOffsetUnits),X.alphaToCoverage===!0?Ye(n.SAMPLE_ALPHA_TO_COVERAGE):ze(n.SAMPLE_ALPHA_TO_COVERAGE)}function gt(X){V!==X&&(X?n.frontFace(n.CW):n.frontFace(n.CCW),V=X)}function xt(X){X!==NU?(Ye(n.CULL_FACE),X!==z&&(X===Rw?n.cullFace(n.BACK):X===UU?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):ze(n.CULL_FACE),z=X}function Ot(X){X!==F&&(O&&n.lineWidth(X),F=X)}function Un(X,ke,Te){X?(Ye(n.POLYGON_OFFSET_FILL),(j!==ke||Q!==Te)&&(n.polygonOffset(ke,Te),j=ke,Q=Te)):ze(n.POLYGON_OFFSET_FILL)}function Fn(X){X?Ye(n.SCISSOR_TEST):ze(n.SCISSOR_TEST)}function B(X){X===void 0&&(X=n.TEXTURE0+$-1),H!==X&&(n.activeTexture(X),H=X)}function I(X,ke,Te){Te===void 0&&(H===null?Te=n.TEXTURE0+$-1:Te=H);let he=te[Te];he===void 0&&(he={type:void 0,texture:void 0},te[Te]=he),(he.type!==X||he.texture!==ke)&&(H!==Te&&(n.activeTexture(Te),H=Te),n.bindTexture(X,ke||Ze[X]),he.type=X,he.texture=ke)}function se(){const X=te[H];X!==void 0&&X.type!==void 0&&(n.bindTexture(X.type,null),X.type=void 0,X.texture=void 0)}function we(){try{n.compressedTexImage2D.apply(n,arguments)}catch(X){console.error("THREE.WebGLState:",X)}}function ye(){try{n.compressedTexImage3D.apply(n,arguments)}catch(X){console.error("THREE.WebGLState:",X)}}function Ae(){try{n.texSubImage2D.apply(n,arguments)}catch(X){console.error("THREE.WebGLState:",X)}}function Qe(){try{n.texSubImage3D.apply(n,arguments)}catch(X){console.error("THREE.WebGLState:",X)}}function Re(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(X){console.error("THREE.WebGLState:",X)}}function Oe(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(X){console.error("THREE.WebGLState:",X)}}function ft(){try{n.texStorage2D.apply(n,arguments)}catch(X){console.error("THREE.WebGLState:",X)}}function Bt(){try{n.texStorage3D.apply(n,arguments)}catch(X){console.error("THREE.WebGLState:",X)}}function be(){try{n.texImage2D.apply(n,arguments)}catch(X){console.error("THREE.WebGLState:",X)}}function Vt(){try{n.texImage3D.apply(n,arguments)}catch(X){console.error("THREE.WebGLState:",X)}}function yt(X){ge.equals(X)===!1&&(n.scissor(X.x,X.y,X.z,X.w),ge.copy(X))}function ht(X){ve.equals(X)===!1&&(n.viewport(X.x,X.y,X.z,X.w),ve.copy(X))}function it(X,ke){let Te=f.get(ke);Te===void 0&&(Te=new WeakMap,f.set(ke,Te));let he=Te.get(X);he===void 0&&(he=n.getUniformBlockIndex(ke,X.name),Te.set(X,he))}function Ve(X,ke){const he=f.get(ke).get(X);d.get(ke)!==he&&(n.uniformBlockBinding(ke,he,X.__bindingPointIndex),d.set(ke,he))}function At(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),i===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),p={},H=null,te={},m={},v=new WeakMap,x=[],y=null,g=!1,T=null,S=null,w=null,M=null,P=null,R=null,D=null,C=new St(0,0,0),L=0,Z=!1,V=null,z=null,F=null,j=null,Q=null,ge.set(0,0,n.canvas.width,n.canvas.height),ve.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),u.reset()}return{buffers:{color:a,depth:l,stencil:u},enable:Ye,disable:ze,bindFramebuffer:Ie,drawBuffers:q,useProgram:ct,setBlending:nt,setMaterial:Zt,setFlipSided:gt,setCullFace:xt,setLineWidth:Ot,setPolygonOffset:Un,setScissorTest:Fn,activeTexture:B,bindTexture:I,unbindTexture:se,compressedTexImage2D:we,compressedTexImage3D:ye,texImage2D:be,texImage3D:Vt,updateUBOMapping:it,uniformBlockBinding:Ve,texStorage2D:ft,texStorage3D:Bt,texSubImage2D:Ae,texSubImage3D:Qe,compressedTexSubImage2D:Re,compressedTexSubImage3D:Oe,scissor:yt,viewport:ht,reset:At}}function $5(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,u=r.maxCubemapSize,d=r.maxTextureSize,f=r.maxSamples,p=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,m=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),v=new WeakMap;let x;const y=new WeakMap;let g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function T(B,I){return g?new OffscreenCanvas(B,I):$d("canvas")}function S(B,I,se,we){let ye=1;if((B.width>we||B.height>we)&&(ye=we/Math.max(B.width,B.height)),ye<1||I===!0)if(typeof HTMLImageElement<"u"&&B instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&B instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&B instanceof ImageBitmap){const Ae=I?Lg:Math.floor,Qe=Ae(ye*B.width),Re=Ae(ye*B.height);x===void 0&&(x=T(Qe,Re));const Oe=se?T(Qe,Re):x;return Oe.width=Qe,Oe.height=Re,Oe.getContext("2d").drawImage(B,0,0,Qe,Re),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+B.width+"x"+B.height+") to ("+Qe+"x"+Re+")."),Oe}else return"data"in B&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+B.width+"x"+B.height+")."),B;return B}function w(B){return Jx(B.width)&&Jx(B.height)}function M(B){return a?!1:B.wrapS!==Pr||B.wrapT!==Pr||B.minFilter!==ti&&B.minFilter!==Wi}function P(B,I){return B.generateMipmaps&&I&&B.minFilter!==ti&&B.minFilter!==Wi}function R(B){n.generateMipmap(B)}function D(B,I,se,we,ye=!1){if(a===!1)return I;if(B!==null){if(n[B]!==void 0)return n[B];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+B+"'")}let Ae=I;if(I===n.RED&&(se===n.FLOAT&&(Ae=n.R32F),se===n.HALF_FLOAT&&(Ae=n.R16F),se===n.UNSIGNED_BYTE&&(Ae=n.R8)),I===n.RED_INTEGER&&(se===n.UNSIGNED_BYTE&&(Ae=n.R8UI),se===n.UNSIGNED_SHORT&&(Ae=n.R16UI),se===n.UNSIGNED_INT&&(Ae=n.R32UI),se===n.BYTE&&(Ae=n.R8I),se===n.SHORT&&(Ae=n.R16I),se===n.INT&&(Ae=n.R32I)),I===n.RG&&(se===n.FLOAT&&(Ae=n.RG32F),se===n.HALF_FLOAT&&(Ae=n.RG16F),se===n.UNSIGNED_BYTE&&(Ae=n.RG8)),I===n.RGBA){const Qe=ye?Cg:jt.getTransfer(we);se===n.FLOAT&&(Ae=n.RGBA32F),se===n.HALF_FLOAT&&(Ae=n.RGBA16F),se===n.UNSIGNED_BYTE&&(Ae=Qe===sn?n.SRGB8_ALPHA8:n.RGBA8),se===n.UNSIGNED_SHORT_4_4_4_4&&(Ae=n.RGBA4),se===n.UNSIGNED_SHORT_5_5_5_1&&(Ae=n.RGB5_A1)}return(Ae===n.R16F||Ae===n.R32F||Ae===n.RG16F||Ae===n.RG32F||Ae===n.RGBA16F||Ae===n.RGBA32F)&&e.get("EXT_color_buffer_float"),Ae}function C(B,I,se){return P(B,se)===!0||B.isFramebufferTexture&&B.minFilter!==ti&&B.minFilter!==Wi?Math.log2(Math.max(I.width,I.height))+1:B.mipmaps!==void 0&&B.mipmaps.length>0?B.mipmaps.length:B.isCompressedTexture&&Array.isArray(B.image)?I.mipmaps.length:1}function L(B){return B===ti||B===qx||B===Hm?n.NEAREST:n.LINEAR}function Z(B){const I=B.target;I.removeEventListener("dispose",Z),z(I),I.isVideoTexture&&v.delete(I)}function V(B){const I=B.target;I.removeEventListener("dispose",V),j(I)}function z(B){const I=i.get(B);if(I.__webglInit===void 0)return;const se=B.source,we=y.get(se);if(we){const ye=we[I.__cacheKey];ye.usedTimes--,ye.usedTimes===0&&F(B),Object.keys(we).length===0&&y.delete(se)}i.remove(B)}function F(B){const I=i.get(B);n.deleteTexture(I.__webglTexture);const se=B.source,we=y.get(se);delete we[I.__cacheKey],o.memory.textures--}function j(B){const I=B.texture,se=i.get(B),we=i.get(I);if(we.__webglTexture!==void 0&&(n.deleteTexture(we.__webglTexture),o.memory.textures--),B.depthTexture&&B.depthTexture.dispose(),B.isWebGLCubeRenderTarget)for(let ye=0;ye<6;ye++){if(Array.isArray(se.__webglFramebuffer[ye]))for(let Ae=0;Ae<se.__webglFramebuffer[ye].length;Ae++)n.deleteFramebuffer(se.__webglFramebuffer[ye][Ae]);else n.deleteFramebuffer(se.__webglFramebuffer[ye]);se.__webglDepthbuffer&&n.deleteRenderbuffer(se.__webglDepthbuffer[ye])}else{if(Array.isArray(se.__webglFramebuffer))for(let ye=0;ye<se.__webglFramebuffer.length;ye++)n.deleteFramebuffer(se.__webglFramebuffer[ye]);else n.deleteFramebuffer(se.__webglFramebuffer);if(se.__webglDepthbuffer&&n.deleteRenderbuffer(se.__webglDepthbuffer),se.__webglMultisampledFramebuffer&&n.deleteFramebuffer(se.__webglMultisampledFramebuffer),se.__webglColorRenderbuffer)for(let ye=0;ye<se.__webglColorRenderbuffer.length;ye++)se.__webglColorRenderbuffer[ye]&&n.deleteRenderbuffer(se.__webglColorRenderbuffer[ye]);se.__webglDepthRenderbuffer&&n.deleteRenderbuffer(se.__webglDepthRenderbuffer)}if(B.isWebGLMultipleRenderTargets)for(let ye=0,Ae=I.length;ye<Ae;ye++){const Qe=i.get(I[ye]);Qe.__webglTexture&&(n.deleteTexture(Qe.__webglTexture),o.memory.textures--),i.remove(I[ye])}i.remove(I),i.remove(B)}let Q=0;function $(){Q=0}function O(){const B=Q;return B>=l&&console.warn("THREE.WebGLTextures: Trying to use "+B+" texture units while this GPU supports only "+l),Q+=1,B}function G(B){const I=[];return I.push(B.wrapS),I.push(B.wrapT),I.push(B.wrapR||0),I.push(B.magFilter),I.push(B.minFilter),I.push(B.anisotropy),I.push(B.internalFormat),I.push(B.format),I.push(B.type),I.push(B.generateMipmaps),I.push(B.premultiplyAlpha),I.push(B.flipY),I.push(B.unpackAlignment),I.push(B.colorSpace),I.join()}function k(B,I){const se=i.get(B);if(B.isVideoTexture&&Un(B),B.isRenderTargetTexture===!1&&B.version>0&&se.__version!==B.version){const we=B.image;if(we===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(we.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ye(se,B,I);return}}t.bindTexture(n.TEXTURE_2D,se.__webglTexture,n.TEXTURE0+I)}function H(B,I){const se=i.get(B);if(B.version>0&&se.__version!==B.version){Ye(se,B,I);return}t.bindTexture(n.TEXTURE_2D_ARRAY,se.__webglTexture,n.TEXTURE0+I)}function te(B,I){const se=i.get(B);if(B.version>0&&se.__version!==B.version){Ye(se,B,I);return}t.bindTexture(n.TEXTURE_3D,se.__webglTexture,n.TEXTURE0+I)}function ee(B,I){const se=i.get(B);if(B.version>0&&se.__version!==B.version){ze(se,B,I);return}t.bindTexture(n.TEXTURE_CUBE_MAP,se.__webglTexture,n.TEXTURE0+I)}const re={[kc]:n.REPEAT,[Pr]:n.CLAMP_TO_EDGE,[Mg]:n.MIRRORED_REPEAT},ge={[ti]:n.NEAREST,[qx]:n.NEAREST_MIPMAP_NEAREST,[Hm]:n.NEAREST_MIPMAP_LINEAR,[Wi]:n.LINEAR,[VP]:n.LINEAR_MIPMAP_NEAREST,[Vl]:n.LINEAR_MIPMAP_LINEAR},ve={[MF]:n.NEVER,[DF]:n.ALWAYS,[CF]:n.LESS,[eI]:n.LEQUAL,[RF]:n.EQUAL,[LF]:n.GEQUAL,[PF]:n.GREATER,[IF]:n.NOTEQUAL};function Me(B,I,se){if(se?(n.texParameteri(B,n.TEXTURE_WRAP_S,re[I.wrapS]),n.texParameteri(B,n.TEXTURE_WRAP_T,re[I.wrapT]),(B===n.TEXTURE_3D||B===n.TEXTURE_2D_ARRAY)&&n.texParameteri(B,n.TEXTURE_WRAP_R,re[I.wrapR]),n.texParameteri(B,n.TEXTURE_MAG_FILTER,ge[I.magFilter]),n.texParameteri(B,n.TEXTURE_MIN_FILTER,ge[I.minFilter])):(n.texParameteri(B,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(B,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(B===n.TEXTURE_3D||B===n.TEXTURE_2D_ARRAY)&&n.texParameteri(B,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(I.wrapS!==Pr||I.wrapT!==Pr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(B,n.TEXTURE_MAG_FILTER,L(I.magFilter)),n.texParameteri(B,n.TEXTURE_MIN_FILTER,L(I.minFilter)),I.minFilter!==ti&&I.minFilter!==Wi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),I.compareFunction&&(n.texParameteri(B,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(B,n.TEXTURE_COMPARE_FUNC,ve[I.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const we=e.get("EXT_texture_filter_anisotropic");if(I.magFilter===ti||I.minFilter!==Hm&&I.minFilter!==Vl||I.type===So&&e.has("OES_texture_float_linear")===!1||a===!1&&I.type===Xd&&e.has("OES_texture_half_float_linear")===!1)return;(I.anisotropy>1||i.get(I).__currentAnisotropy)&&(n.texParameterf(B,we.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(I.anisotropy,r.getMaxAnisotropy())),i.get(I).__currentAnisotropy=I.anisotropy)}}function Ze(B,I){let se=!1;B.__webglInit===void 0&&(B.__webglInit=!0,I.addEventListener("dispose",Z));const we=I.source;let ye=y.get(we);ye===void 0&&(ye={},y.set(we,ye));const Ae=G(I);if(Ae!==B.__cacheKey){ye[Ae]===void 0&&(ye[Ae]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,se=!0),ye[Ae].usedTimes++;const Qe=ye[B.__cacheKey];Qe!==void 0&&(ye[B.__cacheKey].usedTimes--,Qe.usedTimes===0&&F(I)),B.__cacheKey=Ae,B.__webglTexture=ye[Ae].texture}return se}function Ye(B,I,se){let we=n.TEXTURE_2D;(I.isDataArrayTexture||I.isCompressedArrayTexture)&&(we=n.TEXTURE_2D_ARRAY),I.isData3DTexture&&(we=n.TEXTURE_3D);const ye=Ze(B,I),Ae=I.source;t.bindTexture(we,B.__webglTexture,n.TEXTURE0+se);const Qe=i.get(Ae);if(Ae.version!==Qe.__version||ye===!0){t.activeTexture(n.TEXTURE0+se);const Re=jt.getPrimaries(jt.workingColorSpace),Oe=I.colorSpace===Lr?null:jt.getPrimaries(I.colorSpace),ft=I.colorSpace===Lr||Re===Oe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,I.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,I.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,I.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,ft);const Bt=M(I)&&w(I.image)===!1;let be=S(I.image,Bt,!1,d);be=Fn(I,be);const Vt=w(be)||a,yt=s.convert(I.format,I.colorSpace);let ht=s.convert(I.type),it=D(I.internalFormat,yt,ht,I.colorSpace,I.isVideoTexture);Me(we,I,Vt);let Ve;const At=I.mipmaps,X=a&&I.isVideoTexture!==!0&&it!==KP,ke=Qe.__version===void 0||ye===!0,Te=C(I,be,Vt);if(I.isDepthTexture)it=n.DEPTH_COMPONENT,a?I.type===So?it=n.DEPTH_COMPONENT32F:I.type===ma?it=n.DEPTH_COMPONENT24:I.type===Pl?it=n.DEPTH24_STENCIL8:it=n.DEPTH_COMPONENT16:I.type===So&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),I.format===Il&&it===n.DEPTH_COMPONENT&&I.type!==rE&&I.type!==ma&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),I.type=ma,ht=s.convert(I.type)),I.format===Bc&&it===n.DEPTH_COMPONENT&&(it=n.DEPTH_STENCIL,I.type!==Pl&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),I.type=Pl,ht=s.convert(I.type))),ke&&(X?t.texStorage2D(n.TEXTURE_2D,1,it,be.width,be.height):t.texImage2D(n.TEXTURE_2D,0,it,be.width,be.height,0,yt,ht,null));else if(I.isDataTexture)if(At.length>0&&Vt){X&&ke&&t.texStorage2D(n.TEXTURE_2D,Te,it,At[0].width,At[0].height);for(let he=0,Ce=At.length;he<Ce;he++)Ve=At[he],X?t.texSubImage2D(n.TEXTURE_2D,he,0,0,Ve.width,Ve.height,yt,ht,Ve.data):t.texImage2D(n.TEXTURE_2D,he,it,Ve.width,Ve.height,0,yt,ht,Ve.data);I.generateMipmaps=!1}else X?(ke&&t.texStorage2D(n.TEXTURE_2D,Te,it,be.width,be.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,be.width,be.height,yt,ht,be.data)):t.texImage2D(n.TEXTURE_2D,0,it,be.width,be.height,0,yt,ht,be.data);else if(I.isCompressedTexture)if(I.isCompressedArrayTexture){X&&ke&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Te,it,At[0].width,At[0].height,be.depth);for(let he=0,Ce=At.length;he<Ce;he++)Ve=At[he],I.format!==Ir?yt!==null?X?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,he,0,0,0,Ve.width,Ve.height,be.depth,yt,Ve.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,he,it,Ve.width,Ve.height,be.depth,0,Ve.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):X?t.texSubImage3D(n.TEXTURE_2D_ARRAY,he,0,0,0,Ve.width,Ve.height,be.depth,yt,ht,Ve.data):t.texImage3D(n.TEXTURE_2D_ARRAY,he,it,Ve.width,Ve.height,be.depth,0,yt,ht,Ve.data)}else{X&&ke&&t.texStorage2D(n.TEXTURE_2D,Te,it,At[0].width,At[0].height);for(let he=0,Ce=At.length;he<Ce;he++)Ve=At[he],I.format!==Ir?yt!==null?X?t.compressedTexSubImage2D(n.TEXTURE_2D,he,0,0,Ve.width,Ve.height,yt,Ve.data):t.compressedTexImage2D(n.TEXTURE_2D,he,it,Ve.width,Ve.height,0,Ve.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):X?t.texSubImage2D(n.TEXTURE_2D,he,0,0,Ve.width,Ve.height,yt,ht,Ve.data):t.texImage2D(n.TEXTURE_2D,he,it,Ve.width,Ve.height,0,yt,ht,Ve.data)}else if(I.isDataArrayTexture)X?(ke&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Te,it,be.width,be.height,be.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,be.width,be.height,be.depth,yt,ht,be.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,it,be.width,be.height,be.depth,0,yt,ht,be.data);else if(I.isData3DTexture)X?(ke&&t.texStorage3D(n.TEXTURE_3D,Te,it,be.width,be.height,be.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,be.width,be.height,be.depth,yt,ht,be.data)):t.texImage3D(n.TEXTURE_3D,0,it,be.width,be.height,be.depth,0,yt,ht,be.data);else if(I.isFramebufferTexture){if(ke)if(X)t.texStorage2D(n.TEXTURE_2D,Te,it,be.width,be.height);else{let he=be.width,Ce=be.height;for(let at=0;at<Te;at++)t.texImage2D(n.TEXTURE_2D,at,it,he,Ce,0,yt,ht,null),he>>=1,Ce>>=1}}else if(At.length>0&&Vt){X&&ke&&t.texStorage2D(n.TEXTURE_2D,Te,it,At[0].width,At[0].height);for(let he=0,Ce=At.length;he<Ce;he++)Ve=At[he],X?t.texSubImage2D(n.TEXTURE_2D,he,0,0,yt,ht,Ve):t.texImage2D(n.TEXTURE_2D,he,it,yt,ht,Ve);I.generateMipmaps=!1}else X?(ke&&t.texStorage2D(n.TEXTURE_2D,Te,it,be.width,be.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,yt,ht,be)):t.texImage2D(n.TEXTURE_2D,0,it,yt,ht,be);P(I,Vt)&&R(we),Qe.__version=Ae.version,I.onUpdate&&I.onUpdate(I)}B.__version=I.version}function ze(B,I,se){if(I.image.length!==6)return;const we=Ze(B,I),ye=I.source;t.bindTexture(n.TEXTURE_CUBE_MAP,B.__webglTexture,n.TEXTURE0+se);const Ae=i.get(ye);if(ye.version!==Ae.__version||we===!0){t.activeTexture(n.TEXTURE0+se);const Qe=jt.getPrimaries(jt.workingColorSpace),Re=I.colorSpace===Lr?null:jt.getPrimaries(I.colorSpace),Oe=I.colorSpace===Lr||Qe===Re?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,I.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,I.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,I.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Oe);const ft=I.isCompressedTexture||I.image[0].isCompressedTexture,Bt=I.image[0]&&I.image[0].isDataTexture,be=[];for(let he=0;he<6;he++)!ft&&!Bt?be[he]=S(I.image[he],!1,!0,u):be[he]=Bt?I.image[he].image:I.image[he],be[he]=Fn(I,be[he]);const Vt=be[0],yt=w(Vt)||a,ht=s.convert(I.format,I.colorSpace),it=s.convert(I.type),Ve=D(I.internalFormat,ht,it,I.colorSpace),At=a&&I.isVideoTexture!==!0,X=Ae.__version===void 0||we===!0;let ke=C(I,Vt,yt);Me(n.TEXTURE_CUBE_MAP,I,yt);let Te;if(ft){At&&X&&t.texStorage2D(n.TEXTURE_CUBE_MAP,ke,Ve,Vt.width,Vt.height);for(let he=0;he<6;he++){Te=be[he].mipmaps;for(let Ce=0;Ce<Te.length;Ce++){const at=Te[Ce];I.format!==Ir?ht!==null?At?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+he,Ce,0,0,at.width,at.height,ht,at.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+he,Ce,Ve,at.width,at.height,0,at.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):At?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+he,Ce,0,0,at.width,at.height,ht,it,at.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+he,Ce,Ve,at.width,at.height,0,ht,it,at.data)}}}else{Te=I.mipmaps,At&&X&&(Te.length>0&&ke++,t.texStorage2D(n.TEXTURE_CUBE_MAP,ke,Ve,be[0].width,be[0].height));for(let he=0;he<6;he++)if(Bt){At?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+he,0,0,0,be[he].width,be[he].height,ht,it,be[he].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+he,0,Ve,be[he].width,be[he].height,0,ht,it,be[he].data);for(let Ce=0;Ce<Te.length;Ce++){const Rt=Te[Ce].image[he].image;At?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+he,Ce+1,0,0,Rt.width,Rt.height,ht,it,Rt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+he,Ce+1,Ve,Rt.width,Rt.height,0,ht,it,Rt.data)}}else{At?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+he,0,0,0,ht,it,be[he]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+he,0,Ve,ht,it,be[he]);for(let Ce=0;Ce<Te.length;Ce++){const at=Te[Ce];At?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+he,Ce+1,0,0,ht,it,at.image[he]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+he,Ce+1,Ve,ht,it,at.image[he])}}}P(I,yt)&&R(n.TEXTURE_CUBE_MAP),Ae.__version=ye.version,I.onUpdate&&I.onUpdate(I)}B.__version=I.version}function Ie(B,I,se,we,ye,Ae){const Qe=s.convert(se.format,se.colorSpace),Re=s.convert(se.type),Oe=D(se.internalFormat,Qe,Re,se.colorSpace);if(!i.get(I).__hasExternalTextures){const Bt=Math.max(1,I.width>>Ae),be=Math.max(1,I.height>>Ae);ye===n.TEXTURE_3D||ye===n.TEXTURE_2D_ARRAY?t.texImage3D(ye,Ae,Oe,Bt,be,I.depth,0,Qe,Re,null):t.texImage2D(ye,Ae,Oe,Bt,be,0,Qe,Re,null)}t.bindFramebuffer(n.FRAMEBUFFER,B),Ot(I)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,we,ye,i.get(se).__webglTexture,0,xt(I)):(ye===n.TEXTURE_2D||ye>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&ye<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,we,ye,i.get(se).__webglTexture,Ae),t.bindFramebuffer(n.FRAMEBUFFER,null)}function q(B,I,se){if(n.bindRenderbuffer(n.RENDERBUFFER,B),I.depthBuffer&&!I.stencilBuffer){let we=a===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(se||Ot(I)){const ye=I.depthTexture;ye&&ye.isDepthTexture&&(ye.type===So?we=n.DEPTH_COMPONENT32F:ye.type===ma&&(we=n.DEPTH_COMPONENT24));const Ae=xt(I);Ot(I)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ae,we,I.width,I.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,Ae,we,I.width,I.height)}else n.renderbufferStorage(n.RENDERBUFFER,we,I.width,I.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,B)}else if(I.depthBuffer&&I.stencilBuffer){const we=xt(I);se&&Ot(I)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,we,n.DEPTH24_STENCIL8,I.width,I.height):Ot(I)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,we,n.DEPTH24_STENCIL8,I.width,I.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,I.width,I.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,B)}else{const we=I.isWebGLMultipleRenderTargets===!0?I.texture:[I.texture];for(let ye=0;ye<we.length;ye++){const Ae=we[ye],Qe=s.convert(Ae.format,Ae.colorSpace),Re=s.convert(Ae.type),Oe=D(Ae.internalFormat,Qe,Re,Ae.colorSpace),ft=xt(I);se&&Ot(I)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,ft,Oe,I.width,I.height):Ot(I)?p.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ft,Oe,I.width,I.height):n.renderbufferStorage(n.RENDERBUFFER,Oe,I.width,I.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function ct(B,I){if(I&&I.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,B),!(I.depthTexture&&I.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(I.depthTexture).__webglTexture||I.depthTexture.image.width!==I.width||I.depthTexture.image.height!==I.height)&&(I.depthTexture.image.width=I.width,I.depthTexture.image.height=I.height,I.depthTexture.needsUpdate=!0),k(I.depthTexture,0);const we=i.get(I.depthTexture).__webglTexture,ye=xt(I);if(I.depthTexture.format===Il)Ot(I)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,we,0,ye):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,we,0);else if(I.depthTexture.format===Bc)Ot(I)?p.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,we,0,ye):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,we,0);else throw new Error("Unknown depthTexture format")}function Xe(B){const I=i.get(B),se=B.isWebGLCubeRenderTarget===!0;if(B.depthTexture&&!I.__autoAllocateDepthBuffer){if(se)throw new Error("target.depthTexture not supported in Cube render targets");ct(I.__webglFramebuffer,B)}else if(se){I.__webglDepthbuffer=[];for(let we=0;we<6;we++)t.bindFramebuffer(n.FRAMEBUFFER,I.__webglFramebuffer[we]),I.__webglDepthbuffer[we]=n.createRenderbuffer(),q(I.__webglDepthbuffer[we],B,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,I.__webglFramebuffer),I.__webglDepthbuffer=n.createRenderbuffer(),q(I.__webglDepthbuffer,B,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function st(B,I,se){const we=i.get(B);I!==void 0&&Ie(we.__webglFramebuffer,B,B.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),se!==void 0&&Xe(B)}function nt(B){const I=B.texture,se=i.get(B),we=i.get(I);B.addEventListener("dispose",V),B.isWebGLMultipleRenderTargets!==!0&&(we.__webglTexture===void 0&&(we.__webglTexture=n.createTexture()),we.__version=I.version,o.memory.textures++);const ye=B.isWebGLCubeRenderTarget===!0,Ae=B.isWebGLMultipleRenderTargets===!0,Qe=w(B)||a;if(ye){se.__webglFramebuffer=[];for(let Re=0;Re<6;Re++)if(a&&I.mipmaps&&I.mipmaps.length>0){se.__webglFramebuffer[Re]=[];for(let Oe=0;Oe<I.mipmaps.length;Oe++)se.__webglFramebuffer[Re][Oe]=n.createFramebuffer()}else se.__webglFramebuffer[Re]=n.createFramebuffer()}else{if(a&&I.mipmaps&&I.mipmaps.length>0){se.__webglFramebuffer=[];for(let Re=0;Re<I.mipmaps.length;Re++)se.__webglFramebuffer[Re]=n.createFramebuffer()}else se.__webglFramebuffer=n.createFramebuffer();if(Ae)if(r.drawBuffers){const Re=B.texture;for(let Oe=0,ft=Re.length;Oe<ft;Oe++){const Bt=i.get(Re[Oe]);Bt.__webglTexture===void 0&&(Bt.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&B.samples>0&&Ot(B)===!1){const Re=Ae?I:[I];se.__webglMultisampledFramebuffer=n.createFramebuffer(),se.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,se.__webglMultisampledFramebuffer);for(let Oe=0;Oe<Re.length;Oe++){const ft=Re[Oe];se.__webglColorRenderbuffer[Oe]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,se.__webglColorRenderbuffer[Oe]);const Bt=s.convert(ft.format,ft.colorSpace),be=s.convert(ft.type),Vt=D(ft.internalFormat,Bt,be,ft.colorSpace,B.isXRRenderTarget===!0),yt=xt(B);n.renderbufferStorageMultisample(n.RENDERBUFFER,yt,Vt,B.width,B.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Oe,n.RENDERBUFFER,se.__webglColorRenderbuffer[Oe])}n.bindRenderbuffer(n.RENDERBUFFER,null),B.depthBuffer&&(se.__webglDepthRenderbuffer=n.createRenderbuffer(),q(se.__webglDepthRenderbuffer,B,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ye){t.bindTexture(n.TEXTURE_CUBE_MAP,we.__webglTexture),Me(n.TEXTURE_CUBE_MAP,I,Qe);for(let Re=0;Re<6;Re++)if(a&&I.mipmaps&&I.mipmaps.length>0)for(let Oe=0;Oe<I.mipmaps.length;Oe++)Ie(se.__webglFramebuffer[Re][Oe],B,I,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Oe);else Ie(se.__webglFramebuffer[Re],B,I,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Re,0);P(I,Qe)&&R(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ae){const Re=B.texture;for(let Oe=0,ft=Re.length;Oe<ft;Oe++){const Bt=Re[Oe],be=i.get(Bt);t.bindTexture(n.TEXTURE_2D,be.__webglTexture),Me(n.TEXTURE_2D,Bt,Qe),Ie(se.__webglFramebuffer,B,Bt,n.COLOR_ATTACHMENT0+Oe,n.TEXTURE_2D,0),P(Bt,Qe)&&R(n.TEXTURE_2D)}t.unbindTexture()}else{let Re=n.TEXTURE_2D;if((B.isWebGL3DRenderTarget||B.isWebGLArrayRenderTarget)&&(a?Re=B.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Re,we.__webglTexture),Me(Re,I,Qe),a&&I.mipmaps&&I.mipmaps.length>0)for(let Oe=0;Oe<I.mipmaps.length;Oe++)Ie(se.__webglFramebuffer[Oe],B,I,n.COLOR_ATTACHMENT0,Re,Oe);else Ie(se.__webglFramebuffer,B,I,n.COLOR_ATTACHMENT0,Re,0);P(I,Qe)&&R(Re),t.unbindTexture()}B.depthBuffer&&Xe(B)}function Zt(B){const I=w(B)||a,se=B.isWebGLMultipleRenderTargets===!0?B.texture:[B.texture];for(let we=0,ye=se.length;we<ye;we++){const Ae=se[we];if(P(Ae,I)){const Qe=B.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Re=i.get(Ae).__webglTexture;t.bindTexture(Qe,Re),R(Qe),t.unbindTexture()}}}function gt(B){if(a&&B.samples>0&&Ot(B)===!1){const I=B.isWebGLMultipleRenderTargets?B.texture:[B.texture],se=B.width,we=B.height;let ye=n.COLOR_BUFFER_BIT;const Ae=[],Qe=B.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Re=i.get(B),Oe=B.isWebGLMultipleRenderTargets===!0;if(Oe)for(let ft=0;ft<I.length;ft++)t.bindFramebuffer(n.FRAMEBUFFER,Re.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ft,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Re.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+ft,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Re.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Re.__webglFramebuffer);for(let ft=0;ft<I.length;ft++){Ae.push(n.COLOR_ATTACHMENT0+ft),B.depthBuffer&&Ae.push(Qe);const Bt=Re.__ignoreDepthValues!==void 0?Re.__ignoreDepthValues:!1;if(Bt===!1&&(B.depthBuffer&&(ye|=n.DEPTH_BUFFER_BIT),B.stencilBuffer&&(ye|=n.STENCIL_BUFFER_BIT)),Oe&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Re.__webglColorRenderbuffer[ft]),Bt===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Qe]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Qe])),Oe){const be=i.get(I[ft]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,be,0)}n.blitFramebuffer(0,0,se,we,0,0,se,we,ye,n.NEAREST),m&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,Ae)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Oe)for(let ft=0;ft<I.length;ft++){t.bindFramebuffer(n.FRAMEBUFFER,Re.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ft,n.RENDERBUFFER,Re.__webglColorRenderbuffer[ft]);const Bt=i.get(I[ft]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Re.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+ft,n.TEXTURE_2D,Bt,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Re.__webglMultisampledFramebuffer)}}function xt(B){return Math.min(f,B.samples)}function Ot(B){const I=i.get(B);return a&&B.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&I.__useRenderToTexture!==!1}function Un(B){const I=o.render.frame;v.get(B)!==I&&(v.set(B,I),B.update())}function Fn(B,I){const se=B.colorSpace,we=B.format,ye=B.type;return B.isCompressedTexture===!0||B.isVideoTexture===!0||B.format===Qx||se!==mi&&se!==Lr&&(jt.getTransfer(se)===sn?a===!1?e.has("EXT_sRGB")===!0&&we===Ir?(B.format=Qx,B.minFilter=Wi,B.generateMipmaps=!1):I=nI.sRGBToLinear(I):(we!==Ir||ye!==Ra)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",se)),I}this.allocateTextureUnit=O,this.resetTextureUnits=$,this.setTexture2D=k,this.setTexture2DArray=H,this.setTexture3D=te,this.setTextureCube=ee,this.rebindTextures=st,this.setupRenderTarget=nt,this.updateRenderTargetMipmap=Zt,this.updateMultisampleRenderTarget=gt,this.setupDepthRenderbuffer=Xe,this.setupFrameBufferTexture=Ie,this.useMultisampledRTT=Ot}function Y5(n,e,t){const i=t.isWebGL2;function r(s,o=Lr){let a;const l=jt.getTransfer(o);if(s===Ra)return n.UNSIGNED_BYTE;if(s===XP)return n.UNSIGNED_SHORT_4_4_4_4;if(s===jP)return n.UNSIGNED_SHORT_5_5_5_1;if(s===pF)return n.BYTE;if(s===mF)return n.SHORT;if(s===rE)return n.UNSIGNED_SHORT;if(s===WP)return n.INT;if(s===ma)return n.UNSIGNED_INT;if(s===So)return n.FLOAT;if(s===Xd)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===gF)return n.ALPHA;if(s===Ir)return n.RGBA;if(s===_F)return n.LUMINANCE;if(s===vF)return n.LUMINANCE_ALPHA;if(s===Il)return n.DEPTH_COMPONENT;if(s===Bc)return n.DEPTH_STENCIL;if(s===Qx)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===yF)return n.RED;if(s===$P)return n.RED_INTEGER;if(s===xF)return n.RG;if(s===YP)return n.RG_INTEGER;if(s===qP)return n.RGBA_INTEGER;if(s===Ev||s===Tv||s===bv||s===wv)if(l===sn)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===Ev)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===Tv)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===bv)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===wv)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===Ev)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===Tv)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===bv)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===wv)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===Fw||s===Ow||s===kw||s===Bw)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===Fw)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===Ow)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===kw)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===Bw)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===KP)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===zw||s===Gw)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===zw)return l===sn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===Gw)return l===sn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===Hw||s===Vw||s===Ww||s===Xw||s===jw||s===$w||s===Yw||s===qw||s===Kw||s===Zw||s===Qw||s===Jw||s===eA||s===tA)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===Hw)return l===sn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===Vw)return l===sn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===Ww)return l===sn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===Xw)return l===sn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===jw)return l===sn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===$w)return l===sn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===Yw)return l===sn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===qw)return l===sn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===Kw)return l===sn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===Zw)return l===sn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===Qw)return l===sn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===Jw)return l===sn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===eA)return l===sn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===tA)return l===sn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===Av||s===nA||s===iA)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===Av)return l===sn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===nA)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===iA)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===SF||s===rA||s===sA||s===oA)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===Av)return a.COMPRESSED_RED_RGTC1_EXT;if(s===rA)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===sA)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===oA)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Pl?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:r}}class q5 extends Di{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class wl extends vn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const K5={type:"move"};class Kv{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new wl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new wl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Y,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Y),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new wl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Y,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Y),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const x of e.hand.values()){const y=t.getJointPose(x,i),g=this._getHandJoint(u,x);y!==null&&(g.matrix.fromArray(y.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,g.jointRadius=y.radius),g.visible=y!==null}const d=u.joints["index-finger-tip"],f=u.joints["thumb-tip"],p=d.position.distanceTo(f.position),m=.02,v=.005;u.inputState.pinching&&p>m+v?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&p<=m-v&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(K5)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new wl;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class Z5 extends Jc{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,u=null,d=null,f=null,p=null,m=null,v=null;const x=t.getContextAttributes();let y=null,g=null;const T=[],S=[],w=new Ft;let M=null;const P=new Di;P.layers.enable(1),P.viewport=new Qt;const R=new Di;R.layers.enable(2),R.viewport=new Qt;const D=[P,R],C=new q5;C.layers.enable(1),C.layers.enable(2);let L=null,Z=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ee){let re=T[ee];return re===void 0&&(re=new Kv,T[ee]=re),re.getTargetRaySpace()},this.getControllerGrip=function(ee){let re=T[ee];return re===void 0&&(re=new Kv,T[ee]=re),re.getGripSpace()},this.getHand=function(ee){let re=T[ee];return re===void 0&&(re=new Kv,T[ee]=re),re.getHandSpace()};function V(ee){const re=S.indexOf(ee.inputSource);if(re===-1)return;const ge=T[re];ge!==void 0&&(ge.update(ee.inputSource,ee.frame,u||o),ge.dispatchEvent({type:ee.type,data:ee.inputSource}))}function z(){r.removeEventListener("select",V),r.removeEventListener("selectstart",V),r.removeEventListener("selectend",V),r.removeEventListener("squeeze",V),r.removeEventListener("squeezestart",V),r.removeEventListener("squeezeend",V),r.removeEventListener("end",z),r.removeEventListener("inputsourceschange",F);for(let ee=0;ee<T.length;ee++){const re=S[ee];re!==null&&(S[ee]=null,T[ee].disconnect(re))}L=null,Z=null,e.setRenderTarget(y),m=null,p=null,f=null,r=null,g=null,te.stop(),i.isPresenting=!1,e.setPixelRatio(M),e.setSize(w.width,w.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ee){s=ee,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ee){a=ee,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(ee){u=ee},this.getBaseLayer=function(){return p!==null?p:m},this.getBinding=function(){return f},this.getFrame=function(){return v},this.getSession=function(){return r},this.setSession=async function(ee){if(r=ee,r!==null){if(y=e.getRenderTarget(),r.addEventListener("select",V),r.addEventListener("selectstart",V),r.addEventListener("selectend",V),r.addEventListener("squeeze",V),r.addEventListener("squeezestart",V),r.addEventListener("squeezeend",V),r.addEventListener("end",z),r.addEventListener("inputsourceschange",F),x.xrCompatible!==!0&&await t.makeXRCompatible(),M=e.getPixelRatio(),e.getSize(w),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const re={antialias:r.renderState.layers===void 0?x.antialias:!0,alpha:!0,depth:x.depth,stencil:x.stencil,framebufferScaleFactor:s};m=new XRWebGLLayer(r,t,re),r.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),g=new Wl(m.framebufferWidth,m.framebufferHeight,{format:Ir,type:Ra,colorSpace:e.outputColorSpace,stencilBuffer:x.stencil})}else{let re=null,ge=null,ve=null;x.depth&&(ve=x.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,re=x.stencil?Bc:Il,ge=x.stencil?Pl:ma);const Me={colorFormat:t.RGBA8,depthFormat:ve,scaleFactor:s};f=new XRWebGLBinding(r,t),p=f.createProjectionLayer(Me),r.updateRenderState({layers:[p]}),e.setPixelRatio(1),e.setSize(p.textureWidth,p.textureHeight,!1),g=new Wl(p.textureWidth,p.textureHeight,{format:Ir,type:Ra,depthTexture:new pI(p.textureWidth,p.textureHeight,ge,void 0,void 0,void 0,void 0,void 0,void 0,re),stencilBuffer:x.stencil,colorSpace:e.outputColorSpace,samples:x.antialias?4:0});const Ze=e.properties.get(g);Ze.__ignoreDepthValues=p.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await r.requestReferenceSpace(a),te.setContext(r),te.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function F(ee){for(let re=0;re<ee.removed.length;re++){const ge=ee.removed[re],ve=S.indexOf(ge);ve>=0&&(S[ve]=null,T[ve].disconnect(ge))}for(let re=0;re<ee.added.length;re++){const ge=ee.added[re];let ve=S.indexOf(ge);if(ve===-1){for(let Ze=0;Ze<T.length;Ze++)if(Ze>=S.length){S.push(ge),ve=Ze;break}else if(S[Ze]===null){S[Ze]=ge,ve=Ze;break}if(ve===-1)break}const Me=T[ve];Me&&Me.connect(ge)}}const j=new Y,Q=new Y;function $(ee,re,ge){j.setFromMatrixPosition(re.matrixWorld),Q.setFromMatrixPosition(ge.matrixWorld);const ve=j.distanceTo(Q),Me=re.projectionMatrix.elements,Ze=ge.projectionMatrix.elements,Ye=Me[14]/(Me[10]-1),ze=Me[14]/(Me[10]+1),Ie=(Me[9]+1)/Me[5],q=(Me[9]-1)/Me[5],ct=(Me[8]-1)/Me[0],Xe=(Ze[8]+1)/Ze[0],st=Ye*ct,nt=Ye*Xe,Zt=ve/(-ct+Xe),gt=Zt*-ct;re.matrixWorld.decompose(ee.position,ee.quaternion,ee.scale),ee.translateX(gt),ee.translateZ(Zt),ee.matrixWorld.compose(ee.position,ee.quaternion,ee.scale),ee.matrixWorldInverse.copy(ee.matrixWorld).invert();const xt=Ye+Zt,Ot=ze+Zt,Un=st-gt,Fn=nt+(ve-gt),B=Ie*ze/Ot*xt,I=q*ze/Ot*xt;ee.projectionMatrix.makePerspective(Un,Fn,B,I,xt,Ot),ee.projectionMatrixInverse.copy(ee.projectionMatrix).invert()}function O(ee,re){re===null?ee.matrixWorld.copy(ee.matrix):ee.matrixWorld.multiplyMatrices(re.matrixWorld,ee.matrix),ee.matrixWorldInverse.copy(ee.matrixWorld).invert()}this.updateCamera=function(ee){if(r===null)return;C.near=R.near=P.near=ee.near,C.far=R.far=P.far=ee.far,(L!==C.near||Z!==C.far)&&(r.updateRenderState({depthNear:C.near,depthFar:C.far}),L=C.near,Z=C.far);const re=ee.parent,ge=C.cameras;O(C,re);for(let ve=0;ve<ge.length;ve++)O(ge[ve],re);ge.length===2?$(C,P,R):C.projectionMatrix.copy(P.projectionMatrix),G(ee,C,re)};function G(ee,re,ge){ge===null?ee.matrix.copy(re.matrixWorld):(ee.matrix.copy(ge.matrixWorld),ee.matrix.invert(),ee.matrix.multiply(re.matrixWorld)),ee.matrix.decompose(ee.position,ee.quaternion,ee.scale),ee.updateMatrixWorld(!0),ee.projectionMatrix.copy(re.projectionMatrix),ee.projectionMatrixInverse.copy(re.projectionMatrixInverse),ee.isPerspectiveCamera&&(ee.fov=Gc*2*Math.atan(1/ee.projectionMatrix.elements[5]),ee.zoom=1)}this.getCamera=function(){return C},this.getFoveation=function(){if(!(p===null&&m===null))return l},this.setFoveation=function(ee){l=ee,p!==null&&(p.fixedFoveation=ee),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=ee)};let k=null;function H(ee,re){if(d=re.getViewerPose(u||o),v=re,d!==null){const ge=d.views;m!==null&&(e.setRenderTargetFramebuffer(g,m.framebuffer),e.setRenderTarget(g));let ve=!1;ge.length!==C.cameras.length&&(C.cameras.length=0,ve=!0);for(let Me=0;Me<ge.length;Me++){const Ze=ge[Me];let Ye=null;if(m!==null)Ye=m.getViewport(Ze);else{const Ie=f.getViewSubImage(p,Ze);Ye=Ie.viewport,Me===0&&(e.setRenderTargetTextures(g,Ie.colorTexture,p.ignoreDepthValues?void 0:Ie.depthStencilTexture),e.setRenderTarget(g))}let ze=D[Me];ze===void 0&&(ze=new Di,ze.layers.enable(Me),ze.viewport=new Qt,D[Me]=ze),ze.matrix.fromArray(Ze.transform.matrix),ze.matrix.decompose(ze.position,ze.quaternion,ze.scale),ze.projectionMatrix.fromArray(Ze.projectionMatrix),ze.projectionMatrixInverse.copy(ze.projectionMatrix).invert(),ze.viewport.set(Ye.x,Ye.y,Ye.width,Ye.height),Me===0&&(C.matrix.copy(ze.matrix),C.matrix.decompose(C.position,C.quaternion,C.scale)),ve===!0&&C.cameras.push(ze)}}for(let ge=0;ge<T.length;ge++){const ve=S[ge],Me=T[ge];ve!==null&&Me!==void 0&&Me.update(ve,re,u||o)}k&&k(ee,re),re.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:re}),v=null}const te=new dI;te.setAnimationLoop(H),this.setAnimationLoop=function(ee){k=ee},this.dispose=function(){}}}function Q5(n,e){function t(y,g){y.matrixAutoUpdate===!0&&y.updateMatrix(),g.value.copy(y.matrix)}function i(y,g){g.color.getRGB(y.fogColor.value,uI(n)),g.isFog?(y.fogNear.value=g.near,y.fogFar.value=g.far):g.isFogExp2&&(y.fogDensity.value=g.density)}function r(y,g,T,S,w){g.isMeshBasicMaterial||g.isMeshLambertMaterial?s(y,g):g.isMeshToonMaterial?(s(y,g),f(y,g)):g.isMeshPhongMaterial?(s(y,g),d(y,g)):g.isMeshStandardMaterial?(s(y,g),p(y,g),g.isMeshPhysicalMaterial&&m(y,g,w)):g.isMeshMatcapMaterial?(s(y,g),v(y,g)):g.isMeshDepthMaterial?s(y,g):g.isMeshDistanceMaterial?(s(y,g),x(y,g)):g.isMeshNormalMaterial?s(y,g):g.isLineBasicMaterial?(o(y,g),g.isLineDashedMaterial&&a(y,g)):g.isPointsMaterial?l(y,g,T,S):g.isSpriteMaterial?u(y,g):g.isShadowMaterial?(y.color.value.copy(g.color),y.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function s(y,g){y.opacity.value=g.opacity,g.color&&y.diffuse.value.copy(g.color),g.emissive&&y.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(y.map.value=g.map,t(g.map,y.mapTransform)),g.alphaMap&&(y.alphaMap.value=g.alphaMap,t(g.alphaMap,y.alphaMapTransform)),g.bumpMap&&(y.bumpMap.value=g.bumpMap,t(g.bumpMap,y.bumpMapTransform),y.bumpScale.value=g.bumpScale,g.side===Ki&&(y.bumpScale.value*=-1)),g.normalMap&&(y.normalMap.value=g.normalMap,t(g.normalMap,y.normalMapTransform),y.normalScale.value.copy(g.normalScale),g.side===Ki&&y.normalScale.value.negate()),g.displacementMap&&(y.displacementMap.value=g.displacementMap,t(g.displacementMap,y.displacementMapTransform),y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias),g.emissiveMap&&(y.emissiveMap.value=g.emissiveMap,t(g.emissiveMap,y.emissiveMapTransform)),g.specularMap&&(y.specularMap.value=g.specularMap,t(g.specularMap,y.specularMapTransform)),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest);const T=e.get(g).envMap;if(T&&(y.envMap.value=T,y.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=g.reflectivity,y.ior.value=g.ior,y.refractionRatio.value=g.refractionRatio),g.lightMap){y.lightMap.value=g.lightMap;const S=n._useLegacyLights===!0?Math.PI:1;y.lightMapIntensity.value=g.lightMapIntensity*S,t(g.lightMap,y.lightMapTransform)}g.aoMap&&(y.aoMap.value=g.aoMap,y.aoMapIntensity.value=g.aoMapIntensity,t(g.aoMap,y.aoMapTransform))}function o(y,g){y.diffuse.value.copy(g.color),y.opacity.value=g.opacity,g.map&&(y.map.value=g.map,t(g.map,y.mapTransform))}function a(y,g){y.dashSize.value=g.dashSize,y.totalSize.value=g.dashSize+g.gapSize,y.scale.value=g.scale}function l(y,g,T,S){y.diffuse.value.copy(g.color),y.opacity.value=g.opacity,y.size.value=g.size*T,y.scale.value=S*.5,g.map&&(y.map.value=g.map,t(g.map,y.uvTransform)),g.alphaMap&&(y.alphaMap.value=g.alphaMap,t(g.alphaMap,y.alphaMapTransform)),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest)}function u(y,g){y.diffuse.value.copy(g.color),y.opacity.value=g.opacity,y.rotation.value=g.rotation,g.map&&(y.map.value=g.map,t(g.map,y.mapTransform)),g.alphaMap&&(y.alphaMap.value=g.alphaMap,t(g.alphaMap,y.alphaMapTransform)),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest)}function d(y,g){y.specular.value.copy(g.specular),y.shininess.value=Math.max(g.shininess,1e-4)}function f(y,g){g.gradientMap&&(y.gradientMap.value=g.gradientMap)}function p(y,g){y.metalness.value=g.metalness,g.metalnessMap&&(y.metalnessMap.value=g.metalnessMap,t(g.metalnessMap,y.metalnessMapTransform)),y.roughness.value=g.roughness,g.roughnessMap&&(y.roughnessMap.value=g.roughnessMap,t(g.roughnessMap,y.roughnessMapTransform)),e.get(g).envMap&&(y.envMapIntensity.value=g.envMapIntensity)}function m(y,g,T){y.ior.value=g.ior,g.sheen>0&&(y.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),y.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(y.sheenColorMap.value=g.sheenColorMap,t(g.sheenColorMap,y.sheenColorMapTransform)),g.sheenRoughnessMap&&(y.sheenRoughnessMap.value=g.sheenRoughnessMap,t(g.sheenRoughnessMap,y.sheenRoughnessMapTransform))),g.clearcoat>0&&(y.clearcoat.value=g.clearcoat,y.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(y.clearcoatMap.value=g.clearcoatMap,t(g.clearcoatMap,y.clearcoatMapTransform)),g.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap,t(g.clearcoatRoughnessMap,y.clearcoatRoughnessMapTransform)),g.clearcoatNormalMap&&(y.clearcoatNormalMap.value=g.clearcoatNormalMap,t(g.clearcoatNormalMap,y.clearcoatNormalMapTransform),y.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),g.side===Ki&&y.clearcoatNormalScale.value.negate())),g.iridescence>0&&(y.iridescence.value=g.iridescence,y.iridescenceIOR.value=g.iridescenceIOR,y.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(y.iridescenceMap.value=g.iridescenceMap,t(g.iridescenceMap,y.iridescenceMapTransform)),g.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=g.iridescenceThicknessMap,t(g.iridescenceThicknessMap,y.iridescenceThicknessMapTransform))),g.transmission>0&&(y.transmission.value=g.transmission,y.transmissionSamplerMap.value=T.texture,y.transmissionSamplerSize.value.set(T.width,T.height),g.transmissionMap&&(y.transmissionMap.value=g.transmissionMap,t(g.transmissionMap,y.transmissionMapTransform)),y.thickness.value=g.thickness,g.thicknessMap&&(y.thicknessMap.value=g.thicknessMap,t(g.thicknessMap,y.thicknessMapTransform)),y.attenuationDistance.value=g.attenuationDistance,y.attenuationColor.value.copy(g.attenuationColor)),g.anisotropy>0&&(y.anisotropyVector.value.set(g.anisotropy*Math.cos(g.anisotropyRotation),g.anisotropy*Math.sin(g.anisotropyRotation)),g.anisotropyMap&&(y.anisotropyMap.value=g.anisotropyMap,t(g.anisotropyMap,y.anisotropyMapTransform))),y.specularIntensity.value=g.specularIntensity,y.specularColor.value.copy(g.specularColor),g.specularColorMap&&(y.specularColorMap.value=g.specularColorMap,t(g.specularColorMap,y.specularColorMapTransform)),g.specularIntensityMap&&(y.specularIntensityMap.value=g.specularIntensityMap,t(g.specularIntensityMap,y.specularIntensityMapTransform))}function v(y,g){g.matcap&&(y.matcap.value=g.matcap)}function x(y,g){const T=e.get(g).light;y.referencePosition.value.setFromMatrixPosition(T.matrixWorld),y.nearDistance.value=T.shadow.camera.near,y.farDistance.value=T.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function J5(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(T,S){const w=S.program;i.uniformBlockBinding(T,w)}function u(T,S){let w=r[T.id];w===void 0&&(v(T),w=d(T),r[T.id]=w,T.addEventListener("dispose",y));const M=S.program;i.updateUBOMapping(T,M);const P=e.render.frame;s[T.id]!==P&&(p(T),s[T.id]=P)}function d(T){const S=f();T.__bindingPointIndex=S;const w=n.createBuffer(),M=T.__size,P=T.usage;return n.bindBuffer(n.UNIFORM_BUFFER,w),n.bufferData(n.UNIFORM_BUFFER,M,P),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,S,w),w}function f(){for(let T=0;T<a;T++)if(o.indexOf(T)===-1)return o.push(T),T;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function p(T){const S=r[T.id],w=T.uniforms,M=T.__cache;n.bindBuffer(n.UNIFORM_BUFFER,S);for(let P=0,R=w.length;P<R;P++){const D=w[P];if(m(D,P,M)===!0){const C=D.__offset,L=Array.isArray(D.value)?D.value:[D.value];let Z=0;for(let V=0;V<L.length;V++){const z=L[V],F=x(z);typeof z=="number"?(D.__data[0]=z,n.bufferSubData(n.UNIFORM_BUFFER,C+Z,D.__data)):z.isMatrix3?(D.__data[0]=z.elements[0],D.__data[1]=z.elements[1],D.__data[2]=z.elements[2],D.__data[3]=z.elements[0],D.__data[4]=z.elements[3],D.__data[5]=z.elements[4],D.__data[6]=z.elements[5],D.__data[7]=z.elements[0],D.__data[8]=z.elements[6],D.__data[9]=z.elements[7],D.__data[10]=z.elements[8],D.__data[11]=z.elements[0]):(z.toArray(D.__data,Z),Z+=F.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,C,D.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function m(T,S,w){const M=T.value;if(w[S]===void 0){if(typeof M=="number")w[S]=M;else{const P=Array.isArray(M)?M:[M],R=[];for(let D=0;D<P.length;D++)R.push(P[D].clone());w[S]=R}return!0}else if(typeof M=="number"){if(w[S]!==M)return w[S]=M,!0}else{const P=Array.isArray(w[S])?w[S]:[w[S]],R=Array.isArray(M)?M:[M];for(let D=0;D<P.length;D++){const C=P[D];if(C.equals(R[D])===!1)return C.copy(R[D]),!0}}return!1}function v(T){const S=T.uniforms;let w=0;const M=16;let P=0;for(let R=0,D=S.length;R<D;R++){const C=S[R],L={boundary:0,storage:0},Z=Array.isArray(C.value)?C.value:[C.value];for(let V=0,z=Z.length;V<z;V++){const F=Z[V],j=x(F);L.boundary+=j.boundary,L.storage+=j.storage}if(C.__data=new Float32Array(L.storage/Float32Array.BYTES_PER_ELEMENT),C.__offset=w,R>0){P=w%M;const V=M-P;P!==0&&V-L.boundary<0&&(w+=M-P,C.__offset=w)}w+=L.storage}return P=w%M,P>0&&(w+=M-P),T.__size=w,T.__cache={},this}function x(T){const S={boundary:0,storage:0};return typeof T=="number"?(S.boundary=4,S.storage=4):T.isVector2?(S.boundary=8,S.storage=8):T.isVector3||T.isColor?(S.boundary=16,S.storage=12):T.isVector4?(S.boundary=16,S.storage=16):T.isMatrix3?(S.boundary=48,S.storage=48):T.isMatrix4?(S.boundary=64,S.storage=64):T.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",T),S}function y(T){const S=T.target;S.removeEventListener("dispose",y);const w=o.indexOf(S.__bindingPointIndex);o.splice(w,1),n.deleteBuffer(r[S.id]),delete r[S.id],delete s[S.id]}function g(){for(const T in r)n.deleteBuffer(r[T]);o=[],r={},s={}}return{bind:l,update:u,dispose:g}}class xI{constructor(e={}){const{canvas:t=qF(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:f=!1}=e;this.isWebGLRenderer=!0;let p;i!==null?p=i.getContextAttributes().alpha:p=o;const m=new Uint32Array(4),v=new Int32Array(4);let x=null,y=null;const g=[],T=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Tn,this._useLegacyLights=!1,this.toneMapping=Ca,this.toneMappingExposure=1;const S=this;let w=!1,M=0,P=0,R=null,D=-1,C=null;const L=new Qt,Z=new Qt;let V=null;const z=new St(0);let F=0,j=t.width,Q=t.height,$=1,O=null,G=null;const k=new Qt(0,0,j,Q),H=new Qt(0,0,j,Q);let te=!1;const ee=new aE;let re=!1,ge=!1,ve=null;const Me=new Ct,Ze=new Ft,Ye=new Y,ze={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ie(){return R===null?$:1}let q=i;function ct(N,J){for(let ae=0;ae<N.length;ae++){const le=N[ae],oe=t.getContext(le,J);if(oe!==null)return oe}return null}try{const N={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:d,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${iE}`),t.addEventListener("webglcontextlost",At,!1),t.addEventListener("webglcontextrestored",X,!1),t.addEventListener("webglcontextcreationerror",ke,!1),q===null){const J=["webgl2","webgl","experimental-webgl"];if(S.isWebGL1Renderer===!0&&J.shift(),q=ct(J,N),q===null)throw ct(J)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&q instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),q.getShaderPrecisionFormat===void 0&&(q.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(N){throw console.error("THREE.WebGLRenderer: "+N.message),N}let Xe,st,nt,Zt,gt,xt,Ot,Un,Fn,B,I,se,we,ye,Ae,Qe,Re,Oe,ft,Bt,be,Vt,yt,ht;function it(){Xe=new c4(q),st=new r4(q,Xe,e),Xe.init(st),Vt=new Y5(q,Xe,st),nt=new j5(q,Xe,st),Zt=new f4(q),gt=new L5,xt=new $5(q,Xe,nt,gt,st,Vt,Zt),Ot=new o4(S),Un=new u4(S),Fn=new xO(q,st),yt=new n4(q,Xe,Fn,st),B=new h4(q,Fn,Zt,yt),I=new _4(q,B,Fn,Zt),ft=new g4(q,st,xt),Qe=new s4(gt),se=new I5(S,Ot,Un,Xe,st,yt,Qe),we=new Q5(S,gt),ye=new N5,Ae=new z5(Xe,st),Oe=new t4(S,Ot,Un,nt,I,p,l),Re=new X5(S,I,st),ht=new J5(q,Zt,st,nt),Bt=new i4(q,Xe,Zt,st),be=new d4(q,Xe,Zt,st),Zt.programs=se.programs,S.capabilities=st,S.extensions=Xe,S.properties=gt,S.renderLists=ye,S.shadowMap=Re,S.state=nt,S.info=Zt}it();const Ve=new Z5(S,q);this.xr=Ve,this.getContext=function(){return q},this.getContextAttributes=function(){return q.getContextAttributes()},this.forceContextLoss=function(){const N=Xe.get("WEBGL_lose_context");N&&N.loseContext()},this.forceContextRestore=function(){const N=Xe.get("WEBGL_lose_context");N&&N.restoreContext()},this.getPixelRatio=function(){return $},this.setPixelRatio=function(N){N!==void 0&&($=N,this.setSize(j,Q,!1))},this.getSize=function(N){return N.set(j,Q)},this.setSize=function(N,J,ae=!0){if(Ve.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}j=N,Q=J,t.width=Math.floor(N*$),t.height=Math.floor(J*$),ae===!0&&(t.style.width=N+"px",t.style.height=J+"px"),this.setViewport(0,0,N,J)},this.getDrawingBufferSize=function(N){return N.set(j*$,Q*$).floor()},this.setDrawingBufferSize=function(N,J,ae){j=N,Q=J,$=ae,t.width=Math.floor(N*ae),t.height=Math.floor(J*ae),this.setViewport(0,0,N,J)},this.getCurrentViewport=function(N){return N.copy(L)},this.getViewport=function(N){return N.copy(k)},this.setViewport=function(N,J,ae,le){N.isVector4?k.set(N.x,N.y,N.z,N.w):k.set(N,J,ae,le),nt.viewport(L.copy(k).multiplyScalar($).floor())},this.getScissor=function(N){return N.copy(H)},this.setScissor=function(N,J,ae,le){N.isVector4?H.set(N.x,N.y,N.z,N.w):H.set(N,J,ae,le),nt.scissor(Z.copy(H).multiplyScalar($).floor())},this.getScissorTest=function(){return te},this.setScissorTest=function(N){nt.setScissorTest(te=N)},this.setOpaqueSort=function(N){O=N},this.setTransparentSort=function(N){G=N},this.getClearColor=function(N){return N.copy(Oe.getClearColor())},this.setClearColor=function(){Oe.setClearColor.apply(Oe,arguments)},this.getClearAlpha=function(){return Oe.getClearAlpha()},this.setClearAlpha=function(){Oe.setClearAlpha.apply(Oe,arguments)},this.clear=function(N=!0,J=!0,ae=!0){let le=0;if(N){let oe=!1;if(R!==null){const Be=R.texture.format;oe=Be===qP||Be===YP||Be===$P}if(oe){const Be=R.texture.type,Je=Be===Ra||Be===ma||Be===rE||Be===Pl||Be===XP||Be===jP,ot=Oe.getClearColor(),pt=Oe.getClearAlpha(),_t=ot.r,mt=ot.g,vt=ot.b;Je?(m[0]=_t,m[1]=mt,m[2]=vt,m[3]=pt,q.clearBufferuiv(q.COLOR,0,m)):(v[0]=_t,v[1]=mt,v[2]=vt,v[3]=pt,q.clearBufferiv(q.COLOR,0,v))}else le|=q.COLOR_BUFFER_BIT}J&&(le|=q.DEPTH_BUFFER_BIT),ae&&(le|=q.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),q.clear(le)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",At,!1),t.removeEventListener("webglcontextrestored",X,!1),t.removeEventListener("webglcontextcreationerror",ke,!1),ye.dispose(),Ae.dispose(),gt.dispose(),Ot.dispose(),Un.dispose(),I.dispose(),yt.dispose(),ht.dispose(),se.dispose(),Ve.dispose(),Ve.removeEventListener("sessionstart",Wn),Ve.removeEventListener("sessionend",qt),ve&&(ve.dispose(),ve=null),ri.stop()};function At(N){N.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),w=!0}function X(){console.log("THREE.WebGLRenderer: Context Restored."),w=!1;const N=Zt.autoReset,J=Re.enabled,ae=Re.autoUpdate,le=Re.needsUpdate,oe=Re.type;it(),Zt.autoReset=N,Re.enabled=J,Re.autoUpdate=ae,Re.needsUpdate=le,Re.type=oe}function ke(N){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",N.statusMessage)}function Te(N){const J=N.target;J.removeEventListener("dispose",Te),he(J)}function he(N){Ce(N),gt.remove(N)}function Ce(N){const J=gt.get(N).programs;J!==void 0&&(J.forEach(function(ae){se.releaseProgram(ae)}),N.isShaderMaterial&&se.releaseShaderCache(N))}this.renderBufferDirect=function(N,J,ae,le,oe,Be){J===null&&(J=ze);const Je=oe.isMesh&&oe.matrixWorld.determinant()<0,ot=B0(N,J,ae,le,oe);nt.setMaterial(le,Je);let pt=ae.index,_t=1;if(le.wireframe===!0){if(pt=B.getWireframeAttribute(ae),pt===void 0)return;_t=2}const mt=ae.drawRange,vt=ae.attributes.position;let dn=mt.start*_t,si=(mt.start+mt.count)*_t;Be!==null&&(dn=Math.max(dn,Be.start*_t),si=Math.min(si,(Be.start+Be.count)*_t)),pt!==null?(dn=Math.max(dn,0),si=Math.min(si,pt.count)):vt!=null&&(dn=Math.max(dn,0),si=Math.min(si,vt.count));const tn=si-dn;if(tn<0||tn===1/0)return;yt.setup(oe,le,ot,ae,pt);let Xn,dt=Bt;if(pt!==null&&(Xn=Fn.get(pt),dt=be,dt.setIndex(Xn)),oe.isMesh)le.wireframe===!0?(nt.setLineWidth(le.wireframeLinewidth*Ie()),dt.setMode(q.LINES)):dt.setMode(q.TRIANGLES);else if(oe.isLine){let We=le.linewidth;We===void 0&&(We=1),nt.setLineWidth(We*Ie()),oe.isLineSegments?dt.setMode(q.LINES):oe.isLineLoop?dt.setMode(q.LINE_LOOP):dt.setMode(q.LINE_STRIP)}else oe.isPoints?dt.setMode(q.POINTS):oe.isSprite&&dt.setMode(q.TRIANGLES);if(oe.isBatchedMesh)dt.renderMultiDraw(oe._multiDrawStarts,oe._multiDrawCounts,oe._multiDrawCount);else if(oe.isInstancedMesh)dt.renderInstances(dn,tn,oe.count);else if(ae.isInstancedBufferGeometry){const We=ae._maxInstanceCount!==void 0?ae._maxInstanceCount:1/0,mr=Math.min(ae.instanceCount,We);dt.renderInstances(dn,tn,mr)}else dt.render(dn,tn)};function at(N,J,ae){N.transparent===!0&&N.side===Us&&N.forceSinglePass===!1?(N.side=Ki,N.needsUpdate=!0,Qs(N,J,ae),N.side=No,N.needsUpdate=!0,Qs(N,J,ae),N.side=Us):Qs(N,J,ae)}this.compile=function(N,J,ae=null){ae===null&&(ae=N),y=Ae.get(ae),y.init(),T.push(y),ae.traverseVisible(function(oe){oe.isLight&&oe.layers.test(J.layers)&&(y.pushLight(oe),oe.castShadow&&y.pushShadow(oe))}),N!==ae&&N.traverseVisible(function(oe){oe.isLight&&oe.layers.test(J.layers)&&(y.pushLight(oe),oe.castShadow&&y.pushShadow(oe))}),y.setupLights(S._useLegacyLights);const le=new Set;return N.traverse(function(oe){const Be=oe.material;if(Be)if(Array.isArray(Be))for(let Je=0;Je<Be.length;Je++){const ot=Be[Je];at(ot,ae,oe),le.add(ot)}else at(Be,ae,oe),le.add(Be)}),T.pop(),y=null,le},this.compileAsync=function(N,J,ae=null){const le=this.compile(N,J,ae);return new Promise(oe=>{function Be(){if(le.forEach(function(Je){gt.get(Je).currentProgram.isReady()&&le.delete(Je)}),le.size===0){oe(N);return}setTimeout(Be,10)}Xe.get("KHR_parallel_shader_compile")!==null?Be():setTimeout(Be,10)})};let Rt=null;function wn(N){Rt&&Rt(N)}function Wn(){ri.stop()}function qt(){ri.start()}const ri=new dI;ri.setAnimationLoop(wn),typeof self<"u"&&ri.setContext(self),this.setAnimationLoop=function(N){Rt=N,Ve.setAnimationLoop(N),N===null?ri.stop():ri.start()},Ve.addEventListener("sessionstart",Wn),Ve.addEventListener("sessionend",qt),this.render=function(N,J){if(J!==void 0&&J.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(w===!0)return;N.matrixWorldAutoUpdate===!0&&N.updateMatrixWorld(),J.parent===null&&J.matrixWorldAutoUpdate===!0&&J.updateMatrixWorld(),Ve.enabled===!0&&Ve.isPresenting===!0&&(Ve.cameraAutoUpdate===!0&&Ve.updateCamera(J),J=Ve.getCamera()),N.isScene===!0&&N.onBeforeRender(S,N,J,R),y=Ae.get(N,T.length),y.init(),T.push(y),Me.multiplyMatrices(J.projectionMatrix,J.matrixWorldInverse),ee.setFromProjectionMatrix(Me),ge=this.localClippingEnabled,re=Qe.init(this.clippingPlanes,ge),x=ye.get(N,g.length),x.init(),g.push(x),pr(N,J,0,S.sortObjects),x.finish(),S.sortObjects===!0&&x.sort(O,G),this.info.render.frame++,re===!0&&Qe.beginShadows();const ae=y.state.shadowsArray;if(Re.render(ae,N,J),re===!0&&Qe.endShadows(),this.info.autoReset===!0&&this.info.reset(),Oe.render(x,N),y.setupLights(S._useLegacyLights),J.isArrayCamera){const le=J.cameras;for(let oe=0,Be=le.length;oe<Be;oe++){const Je=le[oe];oh(x,N,Je,Je.viewport)}}else oh(x,N,J);R!==null&&(xt.updateMultisampleRenderTarget(R),xt.updateRenderTargetMipmap(R)),N.isScene===!0&&N.onAfterRender(S,N,J),yt.resetDefaultState(),D=-1,C=null,T.pop(),T.length>0?y=T[T.length-1]:y=null,g.pop(),g.length>0?x=g[g.length-1]:x=null};function pr(N,J,ae,le){if(N.visible===!1)return;if(N.layers.test(J.layers)){if(N.isGroup)ae=N.renderOrder;else if(N.isLOD)N.autoUpdate===!0&&N.update(J);else if(N.isLight)y.pushLight(N),N.castShadow&&y.pushShadow(N);else if(N.isSprite){if(!N.frustumCulled||ee.intersectsSprite(N)){le&&Ye.setFromMatrixPosition(N.matrixWorld).applyMatrix4(Me);const Je=I.update(N),ot=N.material;ot.visible&&x.push(N,Je,ot,ae,Ye.z,null)}}else if((N.isMesh||N.isLine||N.isPoints)&&(!N.frustumCulled||ee.intersectsObject(N))){const Je=I.update(N),ot=N.material;if(le&&(N.boundingSphere!==void 0?(N.boundingSphere===null&&N.computeBoundingSphere(),Ye.copy(N.boundingSphere.center)):(Je.boundingSphere===null&&Je.computeBoundingSphere(),Ye.copy(Je.boundingSphere.center)),Ye.applyMatrix4(N.matrixWorld).applyMatrix4(Me)),Array.isArray(ot)){const pt=Je.groups;for(let _t=0,mt=pt.length;_t<mt;_t++){const vt=pt[_t],dn=ot[vt.materialIndex];dn&&dn.visible&&x.push(N,Je,dn,ae,Ye.z,vt)}}else ot.visible&&x.push(N,Je,ot,ae,Ye.z,null)}}const Be=N.children;for(let Je=0,ot=Be.length;Je<ot;Je++)pr(Be[Je],J,ae,le)}function oh(N,J,ae,le){const oe=N.opaque,Be=N.transmissive,Je=N.transparent;y.setupLightsView(ae),re===!0&&Qe.setGlobalState(S.clippingPlanes,ae),Be.length>0&&ah(oe,Be,J,ae),le&&nt.viewport(L.copy(le)),oe.length>0&&nu(oe,J,ae),Be.length>0&&nu(Be,J,ae),Je.length>0&&nu(Je,J,ae),nt.buffers.depth.setTest(!0),nt.buffers.depth.setMask(!0),nt.buffers.color.setMask(!0),nt.setPolygonOffset(!1)}function ah(N,J,ae,le){if((ae.isScene===!0?ae.overrideMaterial:null)!==null)return;const Be=st.isWebGL2;ve===null&&(ve=new Wl(1,1,{generateMipmaps:!0,type:Xe.has("EXT_color_buffer_half_float")?Xd:Ra,minFilter:Vl,samples:Be?4:0})),S.getDrawingBufferSize(Ze),Be?ve.setSize(Ze.x,Ze.y):ve.setSize(Lg(Ze.x),Lg(Ze.y));const Je=S.getRenderTarget();S.setRenderTarget(ve),S.getClearColor(z),F=S.getClearAlpha(),F<1&&S.setClearColor(16777215,.5),S.clear();const ot=S.toneMapping;S.toneMapping=Ca,nu(N,ae,le),xt.updateMultisampleRenderTarget(ve),xt.updateRenderTargetMipmap(ve);let pt=!1;for(let _t=0,mt=J.length;_t<mt;_t++){const vt=J[_t],dn=vt.object,si=vt.geometry,tn=vt.material,Xn=vt.group;if(tn.side===Us&&dn.layers.test(le.layers)){const dt=tn.side;tn.side=Ki,tn.needsUpdate=!0,pf(dn,ae,le,si,tn,Xn),tn.side=dt,tn.needsUpdate=!0,pt=!0}}pt===!0&&(xt.updateMultisampleRenderTarget(ve),xt.updateRenderTargetMipmap(ve)),S.setRenderTarget(Je),S.setClearColor(z,F),S.toneMapping=ot}function nu(N,J,ae){const le=J.isScene===!0?J.overrideMaterial:null;for(let oe=0,Be=N.length;oe<Be;oe++){const Je=N[oe],ot=Je.object,pt=Je.geometry,_t=le===null?Je.material:le,mt=Je.group;ot.layers.test(ae.layers)&&pf(ot,J,ae,pt,_t,mt)}}function pf(N,J,ae,le,oe,Be){N.onBeforeRender(S,J,ae,le,oe,Be),N.modelViewMatrix.multiplyMatrices(ae.matrixWorldInverse,N.matrixWorld),N.normalMatrix.getNormalMatrix(N.modelViewMatrix),oe.onBeforeRender(S,J,ae,le,N,Be),oe.transparent===!0&&oe.side===Us&&oe.forceSinglePass===!1?(oe.side=Ki,oe.needsUpdate=!0,S.renderBufferDirect(ae,J,le,oe,N,Be),oe.side=No,oe.needsUpdate=!0,S.renderBufferDirect(ae,J,le,oe,N,Be),oe.side=Us):S.renderBufferDirect(ae,J,le,oe,N,Be),N.onAfterRender(S,J,ae,le,oe,Be)}function Qs(N,J,ae){J.isScene!==!0&&(J=ze);const le=gt.get(N),oe=y.state.lights,Be=y.state.shadowsArray,Je=oe.state.version,ot=se.getParameters(N,oe.state,Be,J,ae),pt=se.getProgramCacheKey(ot);let _t=le.programs;le.environment=N.isMeshStandardMaterial?J.environment:null,le.fog=J.fog,le.envMap=(N.isMeshStandardMaterial?Un:Ot).get(N.envMap||le.environment),_t===void 0&&(N.addEventListener("dispose",Te),_t=new Map,le.programs=_t);let mt=_t.get(pt);if(mt!==void 0){if(le.currentProgram===mt&&le.lightsStateVersion===Je)return gf(N,ot),mt}else ot.uniforms=se.getUniforms(N),N.onBuild(ae,ot,S),N.onBeforeCompile(ot,S),mt=se.acquireProgram(ot,pt),_t.set(pt,mt),le.uniforms=ot.uniforms;const vt=le.uniforms;return(!N.isShaderMaterial&&!N.isRawShaderMaterial||N.clipping===!0)&&(vt.clippingPlanes=Qe.uniform),gf(N,ot),le.needsLights=G0(N),le.lightsStateVersion=Je,le.needsLights&&(vt.ambientLightColor.value=oe.state.ambient,vt.lightProbe.value=oe.state.probe,vt.directionalLights.value=oe.state.directional,vt.directionalLightShadows.value=oe.state.directionalShadow,vt.spotLights.value=oe.state.spot,vt.spotLightShadows.value=oe.state.spotShadow,vt.rectAreaLights.value=oe.state.rectArea,vt.ltc_1.value=oe.state.rectAreaLTC1,vt.ltc_2.value=oe.state.rectAreaLTC2,vt.pointLights.value=oe.state.point,vt.pointLightShadows.value=oe.state.pointShadow,vt.hemisphereLights.value=oe.state.hemi,vt.directionalShadowMap.value=oe.state.directionalShadowMap,vt.directionalShadowMatrix.value=oe.state.directionalShadowMatrix,vt.spotShadowMap.value=oe.state.spotShadowMap,vt.spotLightMatrix.value=oe.state.spotLightMatrix,vt.spotLightMap.value=oe.state.spotLightMap,vt.pointShadowMap.value=oe.state.pointShadowMap,vt.pointShadowMatrix.value=oe.state.pointShadowMatrix),le.currentProgram=mt,le.uniformsList=null,mt}function mf(N){if(N.uniformsList===null){const J=N.currentProgram.getUniforms();N.uniformsList=Wm.seqWithValue(J.seq,N.uniforms)}return N.uniformsList}function gf(N,J){const ae=gt.get(N);ae.outputColorSpace=J.outputColorSpace,ae.batching=J.batching,ae.instancing=J.instancing,ae.instancingColor=J.instancingColor,ae.skinning=J.skinning,ae.morphTargets=J.morphTargets,ae.morphNormals=J.morphNormals,ae.morphColors=J.morphColors,ae.morphTargetsCount=J.morphTargetsCount,ae.numClippingPlanes=J.numClippingPlanes,ae.numIntersection=J.numClipIntersection,ae.vertexAlphas=J.vertexAlphas,ae.vertexTangents=J.vertexTangents,ae.toneMapping=J.toneMapping}function B0(N,J,ae,le,oe){J.isScene!==!0&&(J=ze),xt.resetTextureUnits();const Be=J.fog,Je=le.isMeshStandardMaterial?J.environment:null,ot=R===null?S.outputColorSpace:R.isXRRenderTarget===!0?R.texture.colorSpace:mi,pt=(le.isMeshStandardMaterial?Un:Ot).get(le.envMap||Je),_t=le.vertexColors===!0&&!!ae.attributes.color&&ae.attributes.color.itemSize===4,mt=!!ae.attributes.tangent&&(!!le.normalMap||le.anisotropy>0),vt=!!ae.morphAttributes.position,dn=!!ae.morphAttributes.normal,si=!!ae.morphAttributes.color;let tn=Ca;le.toneMapped&&(R===null||R.isXRRenderTarget===!0)&&(tn=S.toneMapping);const Xn=ae.morphAttributes.position||ae.morphAttributes.normal||ae.morphAttributes.color,dt=Xn!==void 0?Xn.length:0,We=gt.get(le),mr=y.state.lights;if(re===!0&&(ge===!0||N!==C)){const ai=N===C&&le.id===D;Qe.setState(le,N,ai)}let wt=!1;le.version===We.__version?(We.needsLights&&We.lightsStateVersion!==mr.state.version||We.outputColorSpace!==ot||oe.isBatchedMesh&&We.batching===!1||!oe.isBatchedMesh&&We.batching===!0||oe.isInstancedMesh&&We.instancing===!1||!oe.isInstancedMesh&&We.instancing===!0||oe.isSkinnedMesh&&We.skinning===!1||!oe.isSkinnedMesh&&We.skinning===!0||oe.isInstancedMesh&&We.instancingColor===!0&&oe.instanceColor===null||oe.isInstancedMesh&&We.instancingColor===!1&&oe.instanceColor!==null||We.envMap!==pt||le.fog===!0&&We.fog!==Be||We.numClippingPlanes!==void 0&&(We.numClippingPlanes!==Qe.numPlanes||We.numIntersection!==Qe.numIntersection)||We.vertexAlphas!==_t||We.vertexTangents!==mt||We.morphTargets!==vt||We.morphNormals!==dn||We.morphColors!==si||We.toneMapping!==tn||st.isWebGL2===!0&&We.morphTargetsCount!==dt)&&(wt=!0):(wt=!0,We.__version=le.version);let xn=We.currentProgram;wt===!0&&(xn=Qs(le,J,oe));let ds=!1,gr=!1,oi=!1;const Pn=xn.getUniforms(),fs=We.uniforms;if(nt.useProgram(xn.program)&&(ds=!0,gr=!0,oi=!0),le.id!==D&&(D=le.id,gr=!0),ds||C!==N){Pn.setValue(q,"projectionMatrix",N.projectionMatrix),Pn.setValue(q,"viewMatrix",N.matrixWorldInverse);const ai=Pn.map.cameraPosition;ai!==void 0&&ai.setValue(q,Ye.setFromMatrixPosition(N.matrixWorld)),st.logarithmicDepthBuffer&&Pn.setValue(q,"logDepthBufFC",2/(Math.log(N.far+1)/Math.LN2)),(le.isMeshPhongMaterial||le.isMeshToonMaterial||le.isMeshLambertMaterial||le.isMeshBasicMaterial||le.isMeshStandardMaterial||le.isShaderMaterial)&&Pn.setValue(q,"isOrthographic",N.isOrthographicCamera===!0),C!==N&&(C=N,gr=!0,oi=!0)}if(oe.isSkinnedMesh){Pn.setOptional(q,oe,"bindMatrix"),Pn.setOptional(q,oe,"bindMatrixInverse");const ai=oe.skeleton;ai&&(st.floatVertexTextures?(ai.boneTexture===null&&ai.computeBoneTexture(),Pn.setValue(q,"boneTexture",ai.boneTexture,xt)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}oe.isBatchedMesh&&(Pn.setOptional(q,oe,"batchingTexture"),Pn.setValue(q,"batchingTexture",oe._matricesTexture,xt));const iu=ae.morphAttributes;if((iu.position!==void 0||iu.normal!==void 0||iu.color!==void 0&&st.isWebGL2===!0)&&ft.update(oe,ae,xn),(gr||We.receiveShadow!==oe.receiveShadow)&&(We.receiveShadow=oe.receiveShadow,Pn.setValue(q,"receiveShadow",oe.receiveShadow)),le.isMeshGouraudMaterial&&le.envMap!==null&&(fs.envMap.value=pt,fs.flipEnvMap.value=pt.isCubeTexture&&pt.isRenderTargetTexture===!1?-1:1),gr&&(Pn.setValue(q,"toneMappingExposure",S.toneMappingExposure),We.needsLights&&z0(fs,oi),Be&&le.fog===!0&&we.refreshFogUniforms(fs,Be),we.refreshMaterialUniforms(fs,le,$,Q,ve),Wm.upload(q,mf(We),fs,xt)),le.isShaderMaterial&&le.uniformsNeedUpdate===!0&&(Wm.upload(q,mf(We),fs,xt),le.uniformsNeedUpdate=!1),le.isSpriteMaterial&&Pn.setValue(q,"center",oe.center),Pn.setValue(q,"modelViewMatrix",oe.modelViewMatrix),Pn.setValue(q,"normalMatrix",oe.normalMatrix),Pn.setValue(q,"modelMatrix",oe.matrixWorld),le.isShaderMaterial||le.isRawShaderMaterial){const ai=le.uniformsGroups;for(let ru=0,Qi=ai.length;ru<Qi;ru++)if(st.isWebGL2){const _f=ai[ru];ht.update(_f,xn),ht.bind(_f,xn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return xn}function z0(N,J){N.ambientLightColor.needsUpdate=J,N.lightProbe.needsUpdate=J,N.directionalLights.needsUpdate=J,N.directionalLightShadows.needsUpdate=J,N.pointLights.needsUpdate=J,N.pointLightShadows.needsUpdate=J,N.spotLights.needsUpdate=J,N.spotLightShadows.needsUpdate=J,N.rectAreaLights.needsUpdate=J,N.hemisphereLights.needsUpdate=J}function G0(N){return N.isMeshLambertMaterial||N.isMeshToonMaterial||N.isMeshPhongMaterial||N.isMeshStandardMaterial||N.isShadowMaterial||N.isShaderMaterial&&N.lights===!0}this.getActiveCubeFace=function(){return M},this.getActiveMipmapLevel=function(){return P},this.getRenderTarget=function(){return R},this.setRenderTargetTextures=function(N,J,ae){gt.get(N.texture).__webglTexture=J,gt.get(N.depthTexture).__webglTexture=ae;const le=gt.get(N);le.__hasExternalTextures=!0,le.__hasExternalTextures&&(le.__autoAllocateDepthBuffer=ae===void 0,le.__autoAllocateDepthBuffer||Xe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),le.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(N,J){const ae=gt.get(N);ae.__webglFramebuffer=J,ae.__useDefaultFramebuffer=J===void 0},this.setRenderTarget=function(N,J=0,ae=0){R=N,M=J,P=ae;let le=!0,oe=null,Be=!1,Je=!1;if(N){const pt=gt.get(N);pt.__useDefaultFramebuffer!==void 0?(nt.bindFramebuffer(q.FRAMEBUFFER,null),le=!1):pt.__webglFramebuffer===void 0?xt.setupRenderTarget(N):pt.__hasExternalTextures&&xt.rebindTextures(N,gt.get(N.texture).__webglTexture,gt.get(N.depthTexture).__webglTexture);const _t=N.texture;(_t.isData3DTexture||_t.isDataArrayTexture||_t.isCompressedArrayTexture)&&(Je=!0);const mt=gt.get(N).__webglFramebuffer;N.isWebGLCubeRenderTarget?(Array.isArray(mt[J])?oe=mt[J][ae]:oe=mt[J],Be=!0):st.isWebGL2&&N.samples>0&&xt.useMultisampledRTT(N)===!1?oe=gt.get(N).__webglMultisampledFramebuffer:Array.isArray(mt)?oe=mt[ae]:oe=mt,L.copy(N.viewport),Z.copy(N.scissor),V=N.scissorTest}else L.copy(k).multiplyScalar($).floor(),Z.copy(H).multiplyScalar($).floor(),V=te;if(nt.bindFramebuffer(q.FRAMEBUFFER,oe)&&st.drawBuffers&&le&&nt.drawBuffers(N,oe),nt.viewport(L),nt.scissor(Z),nt.setScissorTest(V),Be){const pt=gt.get(N.texture);q.framebufferTexture2D(q.FRAMEBUFFER,q.COLOR_ATTACHMENT0,q.TEXTURE_CUBE_MAP_POSITIVE_X+J,pt.__webglTexture,ae)}else if(Je){const pt=gt.get(N.texture),_t=J||0;q.framebufferTextureLayer(q.FRAMEBUFFER,q.COLOR_ATTACHMENT0,pt.__webglTexture,ae||0,_t)}D=-1},this.readRenderTargetPixels=function(N,J,ae,le,oe,Be,Je){if(!(N&&N.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ot=gt.get(N).__webglFramebuffer;if(N.isWebGLCubeRenderTarget&&Je!==void 0&&(ot=ot[Je]),ot){nt.bindFramebuffer(q.FRAMEBUFFER,ot);try{const pt=N.texture,_t=pt.format,mt=pt.type;if(_t!==Ir&&Vt.convert(_t)!==q.getParameter(q.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const vt=mt===Xd&&(Xe.has("EXT_color_buffer_half_float")||st.isWebGL2&&Xe.has("EXT_color_buffer_float"));if(mt!==Ra&&Vt.convert(mt)!==q.getParameter(q.IMPLEMENTATION_COLOR_READ_TYPE)&&!(mt===So&&(st.isWebGL2||Xe.has("OES_texture_float")||Xe.has("WEBGL_color_buffer_float")))&&!vt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}J>=0&&J<=N.width-le&&ae>=0&&ae<=N.height-oe&&q.readPixels(J,ae,le,oe,Vt.convert(_t),Vt.convert(mt),Be)}finally{const pt=R!==null?gt.get(R).__webglFramebuffer:null;nt.bindFramebuffer(q.FRAMEBUFFER,pt)}}},this.copyFramebufferToTexture=function(N,J,ae=0){const le=Math.pow(2,-ae),oe=Math.floor(J.image.width*le),Be=Math.floor(J.image.height*le);xt.setTexture2D(J,0),q.copyTexSubImage2D(q.TEXTURE_2D,ae,0,0,N.x,N.y,oe,Be),nt.unbindTexture()},this.copyTextureToTexture=function(N,J,ae,le=0){const oe=J.image.width,Be=J.image.height,Je=Vt.convert(ae.format),ot=Vt.convert(ae.type);xt.setTexture2D(ae,0),q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,ae.flipY),q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ae.premultiplyAlpha),q.pixelStorei(q.UNPACK_ALIGNMENT,ae.unpackAlignment),J.isDataTexture?q.texSubImage2D(q.TEXTURE_2D,le,N.x,N.y,oe,Be,Je,ot,J.image.data):J.isCompressedTexture?q.compressedTexSubImage2D(q.TEXTURE_2D,le,N.x,N.y,J.mipmaps[0].width,J.mipmaps[0].height,Je,J.mipmaps[0].data):q.texSubImage2D(q.TEXTURE_2D,le,N.x,N.y,Je,ot,J.image),le===0&&ae.generateMipmaps&&q.generateMipmap(q.TEXTURE_2D),nt.unbindTexture()},this.copyTextureToTexture3D=function(N,J,ae,le,oe=0){if(S.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Be=N.max.x-N.min.x+1,Je=N.max.y-N.min.y+1,ot=N.max.z-N.min.z+1,pt=Vt.convert(le.format),_t=Vt.convert(le.type);let mt;if(le.isData3DTexture)xt.setTexture3D(le,0),mt=q.TEXTURE_3D;else if(le.isDataArrayTexture)xt.setTexture2DArray(le,0),mt=q.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,le.flipY),q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,le.premultiplyAlpha),q.pixelStorei(q.UNPACK_ALIGNMENT,le.unpackAlignment);const vt=q.getParameter(q.UNPACK_ROW_LENGTH),dn=q.getParameter(q.UNPACK_IMAGE_HEIGHT),si=q.getParameter(q.UNPACK_SKIP_PIXELS),tn=q.getParameter(q.UNPACK_SKIP_ROWS),Xn=q.getParameter(q.UNPACK_SKIP_IMAGES),dt=ae.isCompressedTexture?ae.mipmaps[0]:ae.image;q.pixelStorei(q.UNPACK_ROW_LENGTH,dt.width),q.pixelStorei(q.UNPACK_IMAGE_HEIGHT,dt.height),q.pixelStorei(q.UNPACK_SKIP_PIXELS,N.min.x),q.pixelStorei(q.UNPACK_SKIP_ROWS,N.min.y),q.pixelStorei(q.UNPACK_SKIP_IMAGES,N.min.z),ae.isDataTexture||ae.isData3DTexture?q.texSubImage3D(mt,oe,J.x,J.y,J.z,Be,Je,ot,pt,_t,dt.data):ae.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),q.compressedTexSubImage3D(mt,oe,J.x,J.y,J.z,Be,Je,ot,pt,dt.data)):q.texSubImage3D(mt,oe,J.x,J.y,J.z,Be,Je,ot,pt,_t,dt),q.pixelStorei(q.UNPACK_ROW_LENGTH,vt),q.pixelStorei(q.UNPACK_IMAGE_HEIGHT,dn),q.pixelStorei(q.UNPACK_SKIP_PIXELS,si),q.pixelStorei(q.UNPACK_SKIP_ROWS,tn),q.pixelStorei(q.UNPACK_SKIP_IMAGES,Xn),oe===0&&le.generateMipmaps&&q.generateMipmap(mt),nt.unbindTexture()},this.initTexture=function(N){N.isCubeTexture?xt.setTextureCube(N,0):N.isData3DTexture?xt.setTexture3D(N,0):N.isDataArrayTexture||N.isCompressedArrayTexture?xt.setTexture2DArray(N,0):xt.setTexture2D(N,0),nt.unbindTexture()},this.resetState=function(){M=0,P=0,R=null,nt.reset(),yt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Eo}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===sE?"display-p3":"srgb",t.unpackColorSpace=jt.workingColorSpace===y0?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Tn?Ll:QP}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Ll?Tn:mi}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class e8 extends xI{}e8.prototype.isWebGL1Renderer=!0;let t8=class extends vn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}};class n8{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Zx,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=as()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn('THREE.InterleavedBuffer: "updateRange" is deprecated and removed in r169. Use "addUpdateRange()" instead.'),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=as()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=as()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Pi=new Y;class cE{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Pi.fromBufferAttribute(this,t),Pi.applyMatrix4(e),this.setXYZ(t,Pi.x,Pi.y,Pi.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Pi.fromBufferAttribute(this,t),Pi.applyNormalMatrix(e),this.setXYZ(t,Pi.x,Pi.y,Pi.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Pi.fromBufferAttribute(this,t),Pi.transformDirection(e),this.setXYZ(t,Pi.x,Pi.y,Pi.z);return this}setX(e,t){return this.normalized&&(t=Kt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Kt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Kt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Kt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Fs(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Fs(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Fs(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Fs(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Kt(t,this.array),i=Kt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Kt(t,this.array),i=Kt(i,this.array),r=Kt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Kt(t,this.array),i=Kt(i,this.array),r=Kt(r,this.array),s=Kt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Fi(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new cE(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const ZA=new Y,QA=new Qt,JA=new Qt,i8=new Y,eM=new Ct,Wp=new Y,Zv=new $s,tM=new Ct,Qv=new x0;class r8 extends Nr{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Uw,this.bindMatrix=new Ct,this.bindMatrixInverse=new Ct,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new ko),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,Wp),this.boundingBox.expandByPoint(Wp)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new $s),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,Wp),this.boundingSphere.expandByPoint(Wp)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Zv.copy(this.boundingSphere),Zv.applyMatrix4(r),e.ray.intersectsSphere(Zv)!==!1&&(tM.copy(r).invert(),Qv.copy(e.ray).applyMatrix4(tM),!(this.boundingBox!==null&&Qv.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,Qv)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Qt,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===Uw?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===fF?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;QA.fromBufferAttribute(r.attributes.skinIndex,e),JA.fromBufferAttribute(r.attributes.skinWeight,e),ZA.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=JA.getComponent(s);if(o!==0){const a=QA.getComponent(s);eM.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(i8.copy(ZA).applyMatrix4(eM),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class SI extends vn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class s8 extends hr{constructor(e=null,t=1,i=1,r,s,o,a,l,u=ti,d=ti,f,p){super(null,o,a,l,u,d,r,s,f,p),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const nM=new Ct,o8=new Ct;class hE{constructor(e=[],t=[]){this.uuid=as(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Ct)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Ct;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:o8;nM.multiplyMatrices(a,t[s]),nM.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new hE(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new s8(t,e,e,Ir,So);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new SI),this.bones.push(o),this.boneInverses.push(new Ct().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const o=t[r];e.bones.push(o.uuid);const a=i[r];e.boneInverses.push(a.toArray())}return e}}class t1 extends Fi{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Uu=new Ct,iM=new Ct,Xp=[],rM=new ko,a8=new Ct,kh=new Nr,Bh=new $s;class l8 extends Nr{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new t1(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,a8)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new ko),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Uu),rM.copy(e.boundingBox).applyMatrix4(Uu),this.boundingBox.union(rM)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new $s),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Uu),Bh.copy(e.boundingSphere).applyMatrix4(Uu),this.boundingSphere.union(Bh)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(kh.geometry=this.geometry,kh.material=this.material,kh.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Bh.copy(this.boundingSphere),Bh.applyMatrix4(i),e.ray.intersectsSphere(Bh)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,Uu),iM.multiplyMatrices(i,Uu),kh.matrixWorld=iM,kh.raycast(e,Xp);for(let o=0,a=Xp.length;o<a;o++){const l=Xp[o];l.instanceId=s,l.object=this,t.push(l)}Xp.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new t1(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class EI extends Gs{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new St(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const sM=new Y,oM=new Y,aM=new Ct,Jv=new x0,jp=new $s;class dE extends vn{constructor(e=new Ys,t=new EI){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)sM.fromBufferAttribute(t,r-1),oM.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=sM.distanceTo(oM);e.setAttribute("lineDistance",new Mo(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),jp.copy(i.boundingSphere),jp.applyMatrix4(r),jp.radius+=s,e.ray.intersectsSphere(jp)===!1)return;aM.copy(r).invert(),Jv.copy(e.ray).applyMatrix4(aM);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=new Y,d=new Y,f=new Y,p=new Y,m=this.isLineSegments?2:1,v=i.index,y=i.attributes.position;if(v!==null){const g=Math.max(0,o.start),T=Math.min(v.count,o.start+o.count);for(let S=g,w=T-1;S<w;S+=m){const M=v.getX(S),P=v.getX(S+1);if(u.fromBufferAttribute(y,M),d.fromBufferAttribute(y,P),Jv.distanceSqToSegment(u,d,p,f)>l)continue;p.applyMatrix4(this.matrixWorld);const D=e.ray.origin.distanceTo(p);D<e.near||D>e.far||t.push({distance:D,point:f.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}else{const g=Math.max(0,o.start),T=Math.min(y.count,o.start+o.count);for(let S=g,w=T-1;S<w;S+=m){if(u.fromBufferAttribute(y,S),d.fromBufferAttribute(y,S+1),Jv.distanceSqToSegment(u,d,p,f)>l)continue;p.applyMatrix4(this.matrixWorld);const P=e.ray.origin.distanceTo(p);P<e.near||P>e.far||t.push({distance:P,point:f.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const lM=new Y,uM=new Y;class u8 extends dE{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)lM.fromBufferAttribute(t,r),uM.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+lM.distanceTo(uM);e.setAttribute("lineDistance",new Mo(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class c8 extends dE{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class TI extends Gs{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new St(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const cM=new Ct,n1=new x0,$p=new $s,Yp=new Y;class h8 extends vn{constructor(e=new Ys,t=new TI){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),$p.copy(i.boundingSphere),$p.applyMatrix4(r),$p.radius+=s,e.ray.intersectsSphere($p)===!1)return;cM.copy(r).invert(),n1.copy(e.ray).applyMatrix4(cM);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=i.index,f=i.attributes.position;if(u!==null){const p=Math.max(0,o.start),m=Math.min(u.count,o.start+o.count);for(let v=p,x=m;v<x;v++){const y=u.getX(v);Yp.fromBufferAttribute(f,y),hM(Yp,y,l,r,e,t,this)}}else{const p=Math.max(0,o.start),m=Math.min(f.count,o.start+o.count);for(let v=p,x=m;v<x;v++)Yp.fromBufferAttribute(f,v),hM(Yp,v,l,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function hM(n,e,t,i,r,s,o){const a=n1.distanceSqToPoint(n);if(a<t){const l=new Y;n1.closestPointToPoint(n,l),l.applyMatrix4(i);const u=r.ray.origin.distanceTo(l);if(u<r.near||u>r.far)return;s.push({distance:u,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class fE extends Gs{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new St(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=JP,this.normalScale=new Ft(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Bo extends fE{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ft(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return wi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new St(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new St(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new St(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}function qp(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function d8(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function f8(n){function e(r,s){return n[r]-n[s]}const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(e),i}function dM(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r}function bI(n,e,t,i){let r=1,s=n[0];for(;s!==void 0&&s[i]===void 0;)s=n[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),t.push(o)),s=n[r++];while(s!==void 0)}class uf{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class p8 extends uf{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:aA,endingEnd:aA}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case lA:s=e,a=2*t-i;break;case uA:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(l===void 0)switch(this.getSettings_().endingEnd){case lA:o=e,l=2*i-t;break;case uA:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const u=(i-t)*.5,d=this.valueSize;this._weightPrev=u/(t-a),this._weightNext=u/(l-i),this._offsetPrev=s*d,this._offsetNext=o*d}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,d=this._offsetPrev,f=this._offsetNext,p=this._weightPrev,m=this._weightNext,v=(i-t)/(r-t),x=v*v,y=x*v,g=-p*y+2*p*x-p*v,T=(1+p)*y+(-1.5-2*p)*x+(-.5+p)*v+1,S=(-1-m)*y+(1.5+m)*x+.5*v,w=m*y-m*x;for(let M=0;M!==a;++M)s[M]=g*o[d+M]+T*o[u+M]+S*o[l+M]+w*o[f+M];return s}}class m8 extends uf{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,d=(i-t)/(r-t),f=1-d;for(let p=0;p!==a;++p)s[p]=o[u+p]*f+o[l+p]*d;return s}}class g8 extends uf{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class qs{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=qp(t,this.TimeBufferType),this.values=qp(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:qp(e.times,Array),values:qp(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new g8(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new m8(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new p8(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case jd:t=this.InterpolantFactoryMethodDiscrete;break;case zc:t=this.InterpolantFactoryMethodLinear;break;case Mv:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return jd;case this.InterpolantFactoryMethodLinear:return zc;case this.InterpolantFactoryMethodSmooth:return Mv}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&d8(r))for(let a=0,l=r.length;a!==l;++a){const u=r[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===Mv,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const u=e[a],d=e[a+1];if(u!==d&&(a!==1||u!==e[0]))if(r)l=!0;else{const f=a*i,p=f-i,m=f+i;for(let v=0;v!==i;++v){const x=t[f+v];if(x!==t[p+v]||x!==t[m+v]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const f=a*i,p=o*i;for(let m=0;m!==i;++m)t[p+m]=t[f+m]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,u=0;u!==i;++u)t[l+u]=t[a+u];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}qs.prototype.TimeBufferType=Float32Array;qs.prototype.ValueBufferType=Float32Array;qs.prototype.DefaultInterpolation=zc;class th extends qs{}th.prototype.ValueTypeName="bool";th.prototype.ValueBufferType=Array;th.prototype.DefaultInterpolation=jd;th.prototype.InterpolantFactoryMethodLinear=void 0;th.prototype.InterpolantFactoryMethodSmooth=void 0;class wI extends qs{}wI.prototype.ValueTypeName="color";class Vc extends qs{}Vc.prototype.ValueTypeName="number";class _8 extends uf{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let u=e*a;for(let d=u+a;u!==d;u+=4)za.slerpFlat(s,0,o,u-a,o,u,l);return s}}class jl extends qs{InterpolantFactoryMethodLinear(e){return new _8(this.times,this.values,this.getValueSize(),e)}}jl.prototype.ValueTypeName="quaternion";jl.prototype.DefaultInterpolation=zc;jl.prototype.InterpolantFactoryMethodSmooth=void 0;class nh extends qs{}nh.prototype.ValueTypeName="string";nh.prototype.ValueBufferType=Array;nh.prototype.DefaultInterpolation=jd;nh.prototype.InterpolantFactoryMethodLinear=void 0;nh.prototype.InterpolantFactoryMethodSmooth=void 0;class Wc extends qs{}Wc.prototype.ValueTypeName="vector";class v8{constructor(e,t=-1,i,r=EF){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=as(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(x8(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(qs.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],u=[];l.push((a+s-1)%s,a,(a+1)%s),u.push(0,1,0);const d=f8(l);l=dM(l,1,d),u=dM(u,1,d),!r&&l[0]===0&&(l.push(s),u.push(u[0])),o.push(new Vc(".morphTargetInfluences["+t[a].name+"]",l,u).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const u=e[a],d=u.name.match(s);if(d&&d.length>1){const f=d[1];let p=r[f];p||(r[f]=p=[]),p.push(u)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(f,p,m,v,x){if(m.length!==0){const y=[],g=[];bI(m,y,g,v),y.length!==0&&x.push(new f(p,y,g))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const u=e.hierarchy||[];for(let f=0;f<u.length;f++){const p=u[f].keys;if(!(!p||p.length===0))if(p[0].morphTargets){const m={};let v;for(v=0;v<p.length;v++)if(p[v].morphTargets)for(let x=0;x<p[v].morphTargets.length;x++)m[p[v].morphTargets[x]]=-1;for(const x in m){const y=[],g=[];for(let T=0;T!==p[v].morphTargets.length;++T){const S=p[v];y.push(S.time),g.push(S.morphTarget===x?1:0)}r.push(new Vc(".morphTargetInfluence["+x+"]",y,g))}l=m.length*o}else{const m=".bones["+t[f].name+"]";i(Wc,m+".position",p,"pos",r),i(jl,m+".quaternion",p,"rot",r),i(Wc,m+".scale",p,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function y8(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Vc;case"vector":case"vector2":case"vector3":case"vector4":return Wc;case"color":return wI;case"quaternion":return jl;case"bool":case"boolean":return th;case"string":return nh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function x8(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=y8(n.type);if(n.times===void 0){const t=[],i=[];bI(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Xc={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class S8{constructor(e,t,i){const r=this;let s=!1,o=0,a=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(d){a++,s===!1&&r.onStart!==void 0&&r.onStart(d,o,a),s=!0},this.itemEnd=function(d){o++,r.onProgress!==void 0&&r.onProgress(d,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(d){r.onError!==void 0&&r.onError(d)},this.resolveURL=function(d){return l?l(d):d},this.setURLModifier=function(d){return l=d,this},this.addHandler=function(d,f){return u.push(d,f),this},this.removeHandler=function(d){const f=u.indexOf(d);return f!==-1&&u.splice(f,2),this},this.getHandler=function(d){for(let f=0,p=u.length;f<p;f+=2){const m=u[f],v=u[f+1];if(m.global&&(m.lastIndex=0),m.test(d))return v}return null}}}const E8=new S8;let ih=class{constructor(e){this.manager=e!==void 0?e:E8,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};ih.DEFAULT_MATERIAL_NAME="__DEFAULT";const lo={};class T8 extends Error{constructor(e,t){super(e),this.response=t}}class AI extends ih{constructor(e){super(e)}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Xc.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(lo[e]!==void 0){lo[e].push({onLoad:t,onProgress:i,onError:r});return}lo[e]=[],lo[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const d=lo[e],f=u.body.getReader(),p=u.headers.get("Content-Length")||u.headers.get("X-File-Size"),m=p?parseInt(p):0,v=m!==0;let x=0;const y=new ReadableStream({start(g){T();function T(){f.read().then(({done:S,value:w})=>{if(S)g.close();else{x+=w.byteLength;const M=new ProgressEvent("progress",{lengthComputable:v,loaded:x,total:m});for(let P=0,R=d.length;P<R;P++){const D=d[P];D.onProgress&&D.onProgress(M)}g.enqueue(w),T()}})}}});return new Response(y)}else throw new T8(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(d=>new DOMParser().parseFromString(d,a));case"json":return u.json();default:if(a===void 0)return u.text();{const f=/charset="?([^;"\s]*)"?/i.exec(a),p=f&&f[1]?f[1].toLowerCase():void 0,m=new TextDecoder(p);return u.arrayBuffer().then(v=>m.decode(v))}}}).then(u=>{Xc.add(e,u);const d=lo[e];delete lo[e];for(let f=0,p=d.length;f<p;f++){const m=d[f];m.onLoad&&m.onLoad(u)}}).catch(u=>{const d=lo[e];if(d===void 0)throw this.manager.itemError(e),u;delete lo[e];for(let f=0,p=d.length;f<p;f++){const m=d[f];m.onError&&m.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class b8 extends ih{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Xc.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=$d("img");function l(){d(),Xc.add(e,this),t&&t(this),s.manager.itemEnd(e)}function u(f){d(),r&&r(f),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class w8 extends ih{constructor(e){super(e)}load(e,t,i,r){const s=new hr,o=new b8(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},i,r),s}}class pE extends vn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new St(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}const ey=new Ct,fM=new Y,pM=new Y;class mE{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ft(512,512),this.map=null,this.mapPass=null,this.matrix=new Ct,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new aE,this._frameExtents=new Ft(1,1),this._viewportCount=1,this._viewports=[new Qt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;fM.setFromMatrixPosition(e.matrixWorld),t.position.copy(fM),pM.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(pM),t.updateMatrixWorld(),ey.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ey),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(ey)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class A8 extends mE{constructor(){super(new Di(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=Gc*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class M8 extends pE{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(vn.DEFAULT_UP),this.updateMatrix(),this.target=new vn,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new A8}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const mM=new Ct,zh=new Y,ty=new Y;class C8 extends mE{constructor(){super(new Di(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ft(4,2),this._viewportCount=6,this._viewports=[new Qt(2,1,1,1),new Qt(0,1,1,1),new Qt(3,1,1,1),new Qt(1,1,1,1),new Qt(3,0,1,1),new Qt(1,0,1,1)],this._cubeDirections=[new Y(1,0,0),new Y(-1,0,0),new Y(0,0,1),new Y(0,0,-1),new Y(0,1,0),new Y(0,-1,0)],this._cubeUps=[new Y(0,1,0),new Y(0,1,0),new Y(0,1,0),new Y(0,1,0),new Y(0,0,1),new Y(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),zh.setFromMatrixPosition(e.matrixWorld),i.position.copy(zh),ty.copy(i.position),ty.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(ty),i.updateMatrixWorld(),r.makeTranslation(-zh.x,-zh.y,-zh.z),mM.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(mM)}}class MI extends pE{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new C8}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class R8 extends mE{constructor(){super(new lE(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class P8 extends pE{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(vn.DEFAULT_UP),this.updateMatrix(),this.target=new vn,this.shadow=new R8}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class xd{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class I8 extends ih{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Xc.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){Xc.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}const gE="\\[\\]\\.:\\/",L8=new RegExp("["+gE+"]","g"),_E="[^"+gE+"]",D8="[^"+gE.replace("\\.","")+"]",N8=/((?:WC+[\/:])*)/.source.replace("WC",_E),U8=/(WCOD+)?/.source.replace("WCOD",D8),F8=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_E),O8=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_E),k8=new RegExp("^"+N8+U8+F8+O8+"$"),B8=["material","materials","bones","map"];class z8{constructor(e,t,i){const r=i||$t.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class $t{constructor(e,t,i){this.path=t,this.parsedPath=i||$t.parseTrackName(t),this.node=$t.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new $t.Composite(e,t,i):new $t(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(L8,"")}static parseTrackName(e){const t=k8.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);B8.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const l=i(a.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=$t.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let u=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let d=0;d<e.length;d++)if(e[d].name===u){u=d;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const o=e[r];if(o===void 0){const u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}$t.Composite=z8;$t.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};$t.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};$t.prototype.GetterByBindingType=[$t.prototype._getValue_direct,$t.prototype._getValue_array,$t.prototype._getValue_arrayElement,$t.prototype._getValue_toArray];$t.prototype.SetterByBindingTypeAndVersioning=[[$t.prototype._setValue_direct,$t.prototype._setValue_direct_setNeedsUpdate,$t.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[$t.prototype._setValue_array,$t.prototype._setValue_array_setNeedsUpdate,$t.prototype._setValue_array_setMatrixWorldNeedsUpdate],[$t.prototype._setValue_arrayElement,$t.prototype._setValue_arrayElement_setNeedsUpdate,$t.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[$t.prototype._setValue_fromArray,$t.prototype._setValue_fromArray_setNeedsUpdate,$t.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:iE}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=iE);function gM(n,e){if(e===TF)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===Kx||e===ZP){let t=n.getIndex();if(t===null){const o=[],a=n.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const i=t.count-2,r=[];if(e===Kx)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class G8 extends ih{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new j8(t)}),this.register(function(t){return new t6(t)}),this.register(function(t){return new n6(t)}),this.register(function(t){return new i6(t)}),this.register(function(t){return new Y8(t)}),this.register(function(t){return new q8(t)}),this.register(function(t){return new K8(t)}),this.register(function(t){return new Z8(t)}),this.register(function(t){return new X8(t)}),this.register(function(t){return new Q8(t)}),this.register(function(t){return new $8(t)}),this.register(function(t){return new e6(t)}),this.register(function(t){return new J8(t)}),this.register(function(t){return new V8(t)}),this.register(function(t){return new r6(t)}),this.register(function(t){return new s6(t)})}load(e,t,i,r){const s=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const u=xd.extractUrlBase(e);o=xd.resolveURL(u,this.path)}else o=xd.extractUrlBase(e);this.manager.itemStart(e);const a=function(u){r?r(u):console.error(u),s.manager.itemError(e),s.manager.itemEnd(e)},l=new AI(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(u){try{s.parse(u,o,function(d){t(d),s.manager.itemEnd(e)},a)}catch(d){a(d)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={},l=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===CI){try{o[Lt.KHR_BINARY_GLTF]=new o6(e)}catch(f){r&&r(f);return}s=JSON.parse(o[Lt.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const u=new y6(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let d=0;d<this.pluginCallbacks.length;d++){const f=this.pluginCallbacks[d](u);f.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[f.name]=f,o[f.name]=!0}if(s.extensionsUsed)for(let d=0;d<s.extensionsUsed.length;++d){const f=s.extensionsUsed[d],p=s.extensionsRequired||[];switch(f){case Lt.KHR_MATERIALS_UNLIT:o[f]=new W8;break;case Lt.KHR_DRACO_MESH_COMPRESSION:o[f]=new a6(s,this.dracoLoader);break;case Lt.KHR_TEXTURE_TRANSFORM:o[f]=new l6;break;case Lt.KHR_MESH_QUANTIZATION:o[f]=new u6;break;default:p.indexOf(f)>=0&&a[f]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}u.setExtensions(o),u.setPlugins(a),u.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function H8(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const Lt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class V8{constructor(e){this.parser=e,this.name=Lt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let u;const d=new St(16777215);l.color!==void 0&&d.setRGB(l.color[0],l.color[1],l.color[2],mi);const f=l.range!==void 0?l.range:0;switch(l.type){case"directional":u=new P8(d),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new MI(d),u.distance=f;break;case"spot":u=new M8(d),u.distance=f,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,u.angle=l.spot.outerConeAngle,u.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return u.position.set(0,0,0),u.decay=2,aa(u,l),l.intensity!==void 0&&(u.intensity=l.intensity),u.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(u),t.cache.add(i,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return i._getNodeRef(t.cache,a,l)})}}class W8{constructor(){this.name=Lt.KHR_MATERIALS_UNLIT}getMaterialType(){return bl}extendParams(e,t,i){const r=[];e.color=new St(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],mi),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(i.assignTexture(e,"map",s.baseColorTexture,Tn))}return Promise.all(r)}}class X8{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class j8{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Ft(a,a)}return Promise.all(s)}}class $8{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class Y8{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new St(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];if(o.sheenColorFactor!==void 0){const a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],mi)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Tn)),o.sheenRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class q8{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class K8{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new St().setRGB(a[0],a[1],a[2],mi),Promise.all(s)}}class Z8{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bo}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class Q8{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new St().setRGB(a[0],a[1],a[2],mi),o.specularColorTexture!==void 0&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,Tn)),Promise.all(s)}}class J8{constructor(e){this.parser=e,this.name=Lt.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&s.push(i.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}}class e6{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Bo}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class t6{constructor(e){this.parser=e,this.name=Lt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class n6{constructor(e){this.parser=e,this.name=Lt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const u=i.options.manager.getHandler(a.uri);u!==null&&(l=u)}return this.detectSupport().then(function(u){if(u)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class i6{constructor(e){this.parser=e,this.name=Lt.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const u=i.options.manager.getHandler(a.uri);u!==null&&(l=u)}return this.detectSupport().then(function(u){if(u)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class r6{constructor(e){this.name=Lt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=r.byteOffset||0,u=r.byteLength||0,d=r.count,f=r.byteStride,p=new Uint8Array(a,l,u);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(d,f,p,r.mode,r.filter).then(function(m){return m.buffer}):o.ready.then(function(){const m=new ArrayBuffer(d*f);return o.decodeGltfBuffer(new Uint8Array(m),d,f,p,r.mode,r.filter),m})})}else return null}}class s6{constructor(e){this.name=Lt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const r=t.meshes[i.mesh];for(const u of r.primitives)if(u.mode!==Ar.TRIANGLES&&u.mode!==Ar.TRIANGLE_STRIP&&u.mode!==Ar.TRIANGLE_FAN&&u.mode!==void 0)return null;const o=i.extensions[this.name].attributes,a=[],l={};for(const u in o)a.push(this.parser.getDependency("accessor",o[u]).then(d=>(l[u]=d,l[u])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(u=>{const d=u.pop(),f=d.isGroup?d.children:[d],p=u[0].count,m=[];for(const v of f){const x=new Ct,y=new Y,g=new za,T=new Y(1,1,1),S=new l8(v.geometry,v.material,p);for(let w=0;w<p;w++)l.TRANSLATION&&y.fromBufferAttribute(l.TRANSLATION,w),l.ROTATION&&g.fromBufferAttribute(l.ROTATION,w),l.SCALE&&T.fromBufferAttribute(l.SCALE,w),S.setMatrixAt(w,x.compose(y,g,T));for(const w in l)if(w==="_COLOR_0"){const M=l[w];S.instanceColor=new t1(M.array,M.itemSize,M.normalized)}else w!=="TRANSLATION"&&w!=="ROTATION"&&w!=="SCALE"&&v.geometry.setAttribute(w,l[w]);vn.prototype.copy.call(S,v),this.parser.assignFinalMaterial(S),m.push(S)}return d.isGroup?(d.clear(),d.add(...m),d):m[0]}))}}const CI="glTF",Gh=12,_M={JSON:1313821514,BIN:5130562};class o6{constructor(e){this.name=Lt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Gh),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==CI)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-Gh,s=new DataView(e,Gh);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const l=s.getUint32(o,!0);if(o+=4,l===_M.JSON){const u=new Uint8Array(e,Gh+o,a);this.content=i.decode(u)}else if(l===_M.BIN){const u=Gh+o;this.body=e.slice(u,u+a)}o+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class a6{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Lt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},u={};for(const d in o){const f=i1[d]||d.toLowerCase();a[f]=o[d]}for(const d in e.attributes){const f=i1[d]||d.toLowerCase();if(o[d]!==void 0){const p=i.accessors[e.attributes[d]],m=Sc[p.componentType];u[f]=m.name,l[f]=p.normalized===!0}}return t.getDependency("bufferView",s).then(function(d){return new Promise(function(f){r.decodeDracoFile(d,function(p){for(const m in p.attributes){const v=p.attributes[m],x=l[m];x!==void 0&&(v.normalized=x)}f(p)},a,u)})})}}class l6{constructor(){this.name=Lt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class u6{constructor(){this.name=Lt.KHR_MESH_QUANTIZATION}}class RI extends uf{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,u=a*3,d=r-t,f=(i-t)/d,p=f*f,m=p*f,v=e*u,x=v-u,y=-2*m+3*p,g=m-p,T=1-y,S=g-p+f;for(let w=0;w!==a;w++){const M=o[x+w+a],P=o[x+w+l]*d,R=o[v+w+a],D=o[v+w]*d;s[w]=T*M+S*P+y*R+g*D}return s}}const c6=new za;class h6 extends RI{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return c6.fromArray(s).normalize().toArray(s),s}}const Ar={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Sc={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},vM={9728:ti,9729:Wi,9984:qx,9985:VP,9986:Hm,9987:Vl},yM={33071:Pr,33648:Mg,10497:kc},ny={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},i1={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ta={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},d6={CUBICSPLINE:void 0,LINEAR:zc,STEP:jd},iy={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function f6(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new fE({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:No})),n.DefaultMaterial}function nl(n,e,t){for(const i in t.extensions)n[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function aa(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function p6(n,e,t){let i=!1,r=!1,s=!1;for(let u=0,d=e.length;u<d;u++){const f=e[u];if(f.POSITION!==void 0&&(i=!0),f.NORMAL!==void 0&&(r=!0),f.COLOR_0!==void 0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let u=0,d=e.length;u<d;u++){const f=e[u];if(i){const p=f.POSITION!==void 0?t.getDependency("accessor",f.POSITION):n.attributes.position;o.push(p)}if(r){const p=f.NORMAL!==void 0?t.getDependency("accessor",f.NORMAL):n.attributes.normal;a.push(p)}if(s){const p=f.COLOR_0!==void 0?t.getDependency("accessor",f.COLOR_0):n.attributes.color;l.push(p)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(u){const d=u[0],f=u[1],p=u[2];return i&&(n.morphAttributes.position=d),r&&(n.morphAttributes.normal=f),s&&(n.morphAttributes.color=p),n.morphTargetsRelative=!0,n})}function m6(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function g6(n){let e;const t=n.extensions&&n.extensions[Lt.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+ry(t.attributes):e=n.indices+":"+ry(n.attributes)+":"+n.mode,n.targets!==void 0)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+ry(n.targets[i]);return e}function ry(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function r1(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function _6(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const v6=new Ct;class y6{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new H8,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||r&&s<98?this.textureLoader=new w8(this.options.manager):this.textureLoader=new I8(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new AI(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};return nl(s,a,r),aa(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(i[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[u,d]of o.children.entries())s(d,a.children[u])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Lt.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(xd.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const r=t.byteLength||0,s=t.byteOffset||0;return i.slice(s,s+r)})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const o=ny[r.type],a=Sc[r.componentType],l=r.normalized===!0,u=new a(r.count*o);return Promise.resolve(new Fi(u,o,l))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=ny[r.type],u=Sc[r.componentType],d=u.BYTES_PER_ELEMENT,f=d*l,p=r.byteOffset||0,m=r.bufferView!==void 0?i.bufferViews[r.bufferView].byteStride:void 0,v=r.normalized===!0;let x,y;if(m&&m!==f){const g=Math.floor(p/m),T="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+g+":"+r.count;let S=t.cache.get(T);S||(x=new u(a,g*m,r.count*m/d),S=new n8(x,m/d),t.cache.add(T,S)),y=new cE(S,l,p%m/d,v)}else a===null?x=new u(r.count*l):x=new u(a,p,r.count*l),y=new Fi(x,l,v);if(r.sparse!==void 0){const g=ny.SCALAR,T=Sc[r.sparse.indices.componentType],S=r.sparse.indices.byteOffset||0,w=r.sparse.values.byteOffset||0,M=new T(o[1],S,r.sparse.count*g),P=new u(o[2],w,r.sparse.count*l);a!==null&&(y=new Fi(y.array.slice(),y.itemSize,y.normalized));for(let R=0,D=M.length;R<D;R++){const C=M[R];if(y.setX(C,P[R*l]),l>=2&&y.setY(C,P[R*l+1]),l>=3&&y.setZ(C,P[R*l+2]),l>=4&&y.setW(C,P[R*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return y})}loadTexture(e){const t=this.json,i=this.options,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=i.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const u=this.loadImageSource(t,i).then(function(d){d.flipY=!1,d.name=o.name||a.name||"",d.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(d.name=a.uri);const p=(s.samplers||{})[o.sampler]||{};return d.magFilter=vM[p.magFilter]||Wi,d.minFilter=vM[p.minFilter]||Vl,d.wrapS=yM[p.wrapS]||kc,d.wrapT=yM[p.wrapT]||kc,r.associations.set(d,{textures:e}),d}).catch(function(){return null});return this.textureCache[l]=u,u}loadImageSource(e,t){const i=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(f=>f.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",u=!1;if(o.bufferView!==void 0)l=i.getDependency("bufferView",o.bufferView).then(function(f){u=!0;const p=new Blob([f],{type:o.mimeType});return l=a.createObjectURL(p),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const d=Promise.resolve(l).then(function(f){return new Promise(function(p,m){let v=p;t.isImageBitmapLoader===!0&&(v=function(x){const y=new hr(x);y.needsUpdate=!0,p(y)}),t.load(xd.resolveURL(f,s.path),v,void 0,m)})}).then(function(f){return u===!0&&a.revokeObjectURL(l),f.userData.mimeType=o.mimeType||_6(o.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),f});return this.sourceCache[e]=d,d}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(o=o.clone(),o.channel=i.texCoord),s.extensions[Lt.KHR_TEXTURE_TRANSFORM]){const a=i.extensions!==void 0?i.extensions[Lt.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[Lt.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return r!==void 0&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new TI,Gs.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new EI,Gs.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return fE}loadMaterial(e){const t=this,i=this.json,r=this.extensions,s=i.materials[e];let o;const a={},l=s.extensions||{},u=[];if(l[Lt.KHR_MATERIALS_UNLIT]){const f=r[Lt.KHR_MATERIALS_UNLIT];o=f.getMaterialType(),u.push(f.extendParams(a,s,t))}else{const f=s.pbrMetallicRoughness||{};if(a.color=new St(1,1,1),a.opacity=1,Array.isArray(f.baseColorFactor)){const p=f.baseColorFactor;a.color.setRGB(p[0],p[1],p[2],mi),a.opacity=p[3]}f.baseColorTexture!==void 0&&u.push(t.assignTexture(a,"map",f.baseColorTexture,Tn)),a.metalness=f.metallicFactor!==void 0?f.metallicFactor:1,a.roughness=f.roughnessFactor!==void 0?f.roughnessFactor:1,f.metallicRoughnessTexture!==void 0&&(u.push(t.assignTexture(a,"metalnessMap",f.metallicRoughnessTexture)),u.push(t.assignTexture(a,"roughnessMap",f.metallicRoughnessTexture))),o=this._invokeOne(function(p){return p.getMaterialType&&p.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(p){return p.extendMaterialParams&&p.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=Us);const d=s.alphaMode||iy.OPAQUE;if(d===iy.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,d===iy.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==bl&&(u.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Ft(1,1),s.normalTexture.scale!==void 0)){const f=s.normalTexture.scale;a.normalScale.set(f,f)}if(s.occlusionTexture!==void 0&&o!==bl&&(u.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==bl){const f=s.emissiveFactor;a.emissive=new St().setRGB(f[0],f[1],f[2],mi)}return s.emissiveTexture!==void 0&&o!==bl&&u.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,Tn)),Promise.all(u).then(function(){const f=new o(a);return s.name&&(f.name=s.name),aa(f,s),t.associations.set(f,{materials:e}),s.extensions&&nl(r,f,s),f})}createUniqueName(e){const t=$t.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[Lt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return xM(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const u=e[a],d=g6(u),f=r[d];if(f)o.push(f.promise);else{let p;u.extensions&&u.extensions[Lt.KHR_DRACO_MESH_COMPRESSION]?p=s(u):p=xM(new Ys,u,t),r[d]={primitive:u,promise:p},o.push(p)}}return Promise.all(o)}loadMesh(e){const t=this,i=this.json,r=this.extensions,s=i.meshes[e],o=s.primitives,a=[];for(let l=0,u=o.length;l<u;l++){const d=o[l].material===void 0?f6(this.cache):this.getDependency("material",o[l].material);a.push(d)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const u=l.slice(0,l.length-1),d=l[l.length-1],f=[];for(let m=0,v=d.length;m<v;m++){const x=d[m],y=o[m];let g;const T=u[m];if(y.mode===Ar.TRIANGLES||y.mode===Ar.TRIANGLE_STRIP||y.mode===Ar.TRIANGLE_FAN||y.mode===void 0)g=s.isSkinnedMesh===!0?new r8(x,T):new Nr(x,T),g.isSkinnedMesh===!0&&g.normalizeSkinWeights(),y.mode===Ar.TRIANGLE_STRIP?g.geometry=gM(g.geometry,ZP):y.mode===Ar.TRIANGLE_FAN&&(g.geometry=gM(g.geometry,Kx));else if(y.mode===Ar.LINES)g=new u8(x,T);else if(y.mode===Ar.LINE_STRIP)g=new dE(x,T);else if(y.mode===Ar.LINE_LOOP)g=new c8(x,T);else if(y.mode===Ar.POINTS)g=new h8(x,T);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+y.mode);Object.keys(g.geometry.morphAttributes).length>0&&m6(g,s),g.name=t.createUniqueName(s.name||"mesh_"+e),aa(g,s),y.extensions&&nl(r,g,y),t.assignFinalMaterial(g),f.push(g)}for(let m=0,v=f.length;m<v;m++)t.associations.set(f[m],{meshes:e,primitives:m});if(f.length===1)return s.extensions&&nl(r,f[0],s),f[0];const p=new wl;s.extensions&&nl(r,p,s),t.associations.set(p,{meshes:e});for(let m=0,v=f.length;m<v;m++)p.add(f[m]);return p})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new Di(YF.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):i.type==="orthographic"&&(t=new lE(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),aa(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let u=0,d=o.length;u<d;u++){const f=o[u];if(f){a.push(f);const p=new Ct;s!==null&&p.fromArray(s.array,u*16),l.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[u])}return new hE(a,l)})}loadAnimation(e){const t=this.json,i=this,r=t.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],l=[],u=[],d=[];for(let f=0,p=r.channels.length;f<p;f++){const m=r.channels[f],v=r.samplers[m.sampler],x=m.target,y=x.node,g=r.parameters!==void 0?r.parameters[v.input]:v.input,T=r.parameters!==void 0?r.parameters[v.output]:v.output;x.node!==void 0&&(o.push(this.getDependency("node",y)),a.push(this.getDependency("accessor",g)),l.push(this.getDependency("accessor",T)),u.push(v),d.push(x))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(u),Promise.all(d)]).then(function(f){const p=f[0],m=f[1],v=f[2],x=f[3],y=f[4],g=[];for(let T=0,S=p.length;T<S;T++){const w=p[T],M=m[T],P=v[T],R=x[T],D=y[T];if(w===void 0)continue;w.updateMatrix&&w.updateMatrix();const C=i._createAnimationTracks(w,M,P,R,D);if(C)for(let L=0;L<C.length;L++)g.push(C[L])}return new v8(s,void 0,g)})}createNodeMesh(e){const t=this.json,i=this,r=t.nodes[e];return r.mesh===void 0?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,u=r.weights.length;l<u;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const t=this.json,i=this,r=t.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let u=0,d=a.length;u<d;u++)o.push(i.getDependency("node",a[u]));const l=r.skin===void 0?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(u){const d=u[0],f=u[1],p=u[2];p!==null&&d.traverse(function(m){m.isSkinnedMesh&&m.bind(p,v6)});for(let m=0,v=f.length;m<v;m++)d.add(f[m]);return d})}_loadNodeShallow(e){const t=this.json,i=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(u){return u.createNodeMesh&&u.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(u){return r._getNodeRef(r.cameraCache,s.camera,u)})),r._invokeAll(function(u){return u.createNodeAttachment&&u.createNodeAttachment(e)}).forEach(function(u){a.push(u)}),this.nodeCache[e]=Promise.all(a).then(function(u){let d;if(s.isBone===!0?d=new SI:u.length>1?d=new wl:u.length===1?d=u[0]:d=new vn,d!==u[0])for(let f=0,p=u.length;f<p;f++)d.add(u[f]);if(s.name&&(d.userData.name=s.name,d.name=o),aa(d,s),s.extensions&&nl(i,d,s),s.matrix!==void 0){const f=new Ct;f.fromArray(s.matrix),d.applyMatrix4(f)}else s.translation!==void 0&&d.position.fromArray(s.translation),s.rotation!==void 0&&d.quaternion.fromArray(s.rotation),s.scale!==void 0&&d.scale.fromArray(s.scale);return r.associations.has(d)||r.associations.set(d,{}),r.associations.get(d).nodes=e,d}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new wl;i.name&&(s.name=r.createUniqueName(i.name)),aa(s,i),i.extensions&&nl(t,s,i);const o=i.nodes||[],a=[];for(let l=0,u=o.length;l<u;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let d=0,f=l.length;d<f;d++)s.add(l[d]);const u=d=>{const f=new Map;for(const[p,m]of r.associations)(p instanceof Gs||p instanceof hr)&&f.set(p,m);return d.traverse(p=>{const m=r.associations.get(p);m!=null&&f.set(p,m)}),f};return r.associations=u(s),s})}_createAnimationTracks(e,t,i,r,s){const o=[],a=e.name?e.name:e.uuid,l=[];ta[s.path]===ta.weights?e.traverse(function(p){p.morphTargetInfluences&&l.push(p.name?p.name:p.uuid)}):l.push(a);let u;switch(ta[s.path]){case ta.weights:u=Vc;break;case ta.rotation:u=jl;break;case ta.position:case ta.scale:u=Wc;break;default:switch(i.itemSize){case 1:u=Vc;break;case 2:case 3:default:u=Wc;break}break}const d=r.interpolation!==void 0?d6[r.interpolation]:zc,f=this._getArrayFromAccessor(i);for(let p=0,m=l.length;p<m;p++){const v=new u(l[p]+"."+ta[s.path],t.array,f,d);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(v),o.push(v)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=r1(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){const r=this instanceof jl?h6:RI;return new r(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function x6(n,e,t){const i=e.attributes,r=new ko;if(i.POSITION!==void 0){const a=t.json.accessors[i.POSITION],l=a.min,u=a.max;if(l!==void 0&&u!==void 0){if(r.set(new Y(l[0],l[1],l[2]),new Y(u[0],u[1],u[2])),a.normalized){const d=r1(Sc[a.componentType]);r.min.multiplyScalar(d),r.max.multiplyScalar(d)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new Y,l=new Y;for(let u=0,d=s.length;u<d;u++){const f=s[u];if(f.POSITION!==void 0){const p=t.json.accessors[f.POSITION],m=p.min,v=p.max;if(m!==void 0&&v!==void 0){if(l.setX(Math.max(Math.abs(m[0]),Math.abs(v[0]))),l.setY(Math.max(Math.abs(m[1]),Math.abs(v[1]))),l.setZ(Math.max(Math.abs(m[2]),Math.abs(v[2]))),p.normalized){const x=r1(Sc[p.componentType]);l.multiplyScalar(x)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new $s;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}function xM(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in i){const a=i1[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(e.indices!==void 0&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return jt.workingColorSpace!==mi&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${jt.workingColorSpace}" not supported.`),aa(n,e),x6(n,e,t),Promise.all(r).then(function(){return e.targets!==void 0?p6(n,e.targets,t):n})}const S6="/computer.glb",E6=({setInScene:n})=>{const e=me.useRef(null);var t=.8,i=.005;let r=50;var s=1;const[o,a]=me.useState(window.innerWidth),[l,u]=me.useState(window.innerHeight);var d=SM(o);const[f,p]=me.useState(d.scaleX),[m,v]=me.useState(d.scaleY);var x=!1,y=!1;let g;const T=()=>{e.current&&(clearTimeout(g),g=setTimeout(()=>{a(window.innerWidth),u(window.innerHeight),d=SM(window.innerWidth),p(d.scaleX),v(d.scaleY)},1e3))};let S=!1,w=0,M=18;const P=`Hack the Burgh
2024
Press any key to begin...`;var R=document.getElementById("scene-begin-text"),D=document.getElementById("scene-logo-text");let C,L;const Z=()=>{console.log("start typing"),R=document.getElementById("scene-begin-text"),D=document.getElementById("scene-logo-text"),D&&R?(clearTimeout(C),C=setTimeout(()=>{console.log("start typing timeout"),clearTimeout(L),D.innerHTML="",R.innerHTML="",z()},1500)):setTimeout(Z,500)},V=()=>{x||(S=!0)},z=()=>{x=!0,D&&R&&w<P.length?(w>M?R.innerHTML+=P.charAt(w):D.innerHTML+=P.charAt(w),w++,L=setTimeout(z,r)):w==P.length&&(x=!1,y=!0,R==null||R.classList.add("active"),window.addEventListener("keypress",V),window.addEventListener("click",V),e.current.addEventListener("click",V))},F=()=>{R&&x==!1&&(R.style.opacity="0",R.style.animation="none"),x=!0,D&&M>-1?(D.innerHTML=D.innerHTML.slice(0,-1),M--):(x=!1,y=!1)};me.useEffect(()=>{window.addEventListener("resize",T)},[]),me.useEffect(()=>{j()},[o,l]);const j=()=>{if(e.current){const Q=new t8,$=new Di(75,o/l,.1,1e3);$.position.setZ(t);const O=new xI({canvas:e.current});O.setPixelRatio(window.devicePixelRatio),O.setSize(o,l);const G=new MI(16777215,1);G.position.set(0,.3,1),Q.add(G),O.setClearColor(0,0),new G8().load(S6,te=>{te.scene.position.set(0,m*-.3,0),te.scene.scale.set(f,m,1),Q.add(te.scene)},()=>{});const H=async()=>{var te;t>.4&&$.position.setZ(t-=i),S?x||y?(F(),setTimeout(()=>{requestAnimationFrame(H),O.render(Q,$)},50)):((te=document.querySelector(".scene-background"))==null||te.classList.add("active"),e.current.style.opacity=(s-=.001).toString(),t>.15?$.position.setZ(t-=.005):(window.removeEventListener("keypress",V),n(!1)),requestAnimationFrame(H),O.render(Q,$)):(requestAnimationFrame(H),O.render(Q,$))};H(),Z()}};return Et(dc,{children:[ie("div",{className:"scene-background"}),Et("div",{className:"scene-logo",id:"scene-logo",children:[ie("pre",{className:"scene-logo-text",id:"scene-logo-text"}),ie("pre",{className:"scene-begin-text",id:"scene-begin-text"})]}),ie("canvas",{ref:e}),";"]})},SM=(n,e)=>{let t=1.3,i=1;return n>1500||n>1200?(i=1.5,t=1.2):n>1e3?(i=1.3,t=1):n>600?(i=1.15,t=.9):n>450?(i=1,t=.7):(i=.9,t=.7),{scaleX:i,scaleY:t}},T6=()=>Et("svg",{viewBox:"419.4903 176.0819 43.4844 54.5078",xmlns:"http://www.w3.org/2000/svg",children:[ie("defs",{children:ie("clipPath",{id:"2be4ed1237",children:ie("path",{d:"M 165.742188 154.476562 L 209.242188 154.476562 L 209.242188 209 L 165.742188 209 Z M 165.742188 154.476562 ","clip-rule":"nonzero"})})}),ie("g",{"clip-path":"url(#2be4ed1237)",transform:"matrix(1, 0, 0, 1, 253.7442474365234, 21.60138702392578)",children:ie("path",{fill:"#a6d0dd",d:"M 183.453125 187.34375 C 183.410156 187.308594 183.371094 187.277344 183.328125 187.246094 C 183.183594 187.425781 183.035156 187.609375 182.886719 187.789062 C 182.933594 187.824219 182.980469 187.863281 183.023438 187.898438 C 183.167969 187.710938 183.308594 187.527344 183.453125 187.34375 Z M 197.625 174.351562 C 197.578125 174.3125 197.535156 174.269531 197.488281 174.230469 C 197.351562 174.378906 197.210938 174.53125 197.070312 174.679688 C 197.117188 174.722656 197.160156 174.765625 197.207031 174.808594 C 197.347656 174.65625 197.484375 174.503906 197.625 174.351562 Z M 196.257812 176.023438 C 196.210938 175.984375 196.160156 175.941406 196.109375 175.898438 C 195.964844 176.070312 195.820312 176.242188 195.675781 176.414062 C 195.726562 176.457031 195.777344 176.5 195.832031 176.542969 C 195.972656 176.371094 196.117188 176.199219 196.257812 176.023438 Z M 195.132812 177.382812 C 195.070312 177.320312 195.007812 177.257812 194.941406 177.195312 C 194.757812 177.429688 194.570312 177.664062 194.382812 177.898438 C 194.4375 177.941406 194.488281 177.984375 194.539062 178.03125 C 194.738281 177.816406 194.9375 177.601562 195.132812 177.382812 Z M 177.597656 164.375 C 177.671875 164.359375 177.742188 164.339844 177.816406 164.324219 C 177.773438 164.132812 177.726562 163.945312 177.683594 163.757812 C 177.613281 163.773438 177.546875 163.789062 177.476562 163.804688 C 177.515625 163.996094 177.558594 164.183594 177.597656 164.375 Z M 180.632812 190.894531 C 181.238281 190.65625 181.613281 190.300781 181.546875 189.386719 C 181.140625 190.054688 180.886719 190.472656 180.632812 190.894531 Z M 197.890625 165.992188 C 197.953125 166.046875 198.019531 166.101562 198.082031 166.152344 C 198.4375 165.671875 198.789062 165.191406 199.144531 164.707031 C 199.046875 164.640625 198.945312 164.574219 198.84375 164.507812 C 198.527344 165.003906 198.207031 165.496094 197.890625 165.992188 Z M 181.023438 187.976562 C 180.9375 187.929688 180.851562 187.878906 180.765625 187.832031 C 180.160156 188.472656 179.652344 189.175781 179.496094 190.105469 C 180.003906 189.394531 180.511719 188.6875 181.023438 187.976562 Z M 183.917969 168.371094 C 184.441406 170.902344 185.152344 173.335938 186.777344 175.40625 C 185.824219 173.058594 184.871094 170.714844 183.917969 168.371094 Z M 190.574219 192.582031 C 190.675781 192.53125 190.777344 192.484375 190.882812 192.433594 C 190.097656 190.570312 189.316406 188.707031 188.53125 186.828125 C 187.742188 187.1875 187.925781 187.734375 188.125 188.121094 C 188.902344 189.625 189.75 191.097656 190.574219 192.582031 Z M 182.742188 181.351562 C 182.804688 180.0625 181.957031 179.195312 181.554688 178.175781 C 181.136719 177.109375 180.605469 176.089844 180.125 175.046875 C 179.625 173.964844 179.121094 172.886719 178.625 171.800781 C 178.179688 170.816406 177.746094 169.828125 177.304688 168.84375 C 177.714844 171.875 181.539062 180.4375 182.742188 181.351562 Z M 193.402344 192.652344 C 193.367188 192.425781 193.386719 192.167969 193.285156 191.96875 C 192.21875 189.839844 191.136719 187.722656 190.046875 185.601562 C 189.988281 185.480469 189.863281 185.394531 189.769531 185.292969 C 189.683594 185.339844 189.601562 185.390625 189.515625 185.4375 C 189.730469 185.894531 189.933594 186.355469 190.160156 186.808594 C 190.414062 187.3125 190.683594 187.816406 190.960938 188.308594 C 191.78125 189.75 192.613281 191.183594 193.4375 192.621094 C 194.148438 194.667969 195.304688 196.46875 196.496094 198.253906 C 195.914062 196.871094 195.222656 195.546875 194.488281 194.242188 C 194.175781 193.6875 193.765625 193.183594 193.402344 192.652344 Z M 203.441406 165.882812 C 203.75 165.648438 204.054688 165.414062 204.363281 165.179688 C 204.273438 165.101562 204.179688 165.019531 204.089844 164.941406 C 203.882812 165.265625 203.675781 165.589844 203.472656 165.914062 C 202.925781 166.457031 202.378906 167 201.832031 167.542969 C 202.570312 167.164062 203.300781 166.773438 203.441406 165.882812 Z M 191.402344 177.066406 C 191.886719 176.632812 192.414062 176.242188 192.839844 175.761719 C 196.464844 171.691406 200.046875 167.582031 203.695312 163.527344 C 204.878906 162.214844 206.199219 161.03125 207.484375 159.816406 C 207.808594 159.515625 208.234375 159.328125 208.601562 159.097656 C 209.214844 159.714844 208.875 160.097656 208.539062 160.4375 C 207.929688 161.046875 207.285156 161.621094 206.671875 162.222656 C 206.3125 162.574219 205.980469 162.949219 205.714844 163.398438 C 206.941406 163.117188 207.417969 161.511719 209.230469 161.605469 C 202.609375 168.820312 196.839844 176.332031 190.75 183.808594 C 192.394531 187.09375 194.011719 190.335938 195.636719 193.574219 C 196.28125 194.855469 197.078125 196.074219 197.589844 197.402344 C 198.285156 199.214844 198.773438 201.109375 199.351562 202.964844 C 198.65625 203.175781 198.65625 203.175781 197.101562 201.210938 C 196.871094 201.769531 196.726562 202.582031 195.875 201.828125 C 195.890625 203.144531 197.140625 204.042969 196.746094 205.6875 C 195.980469 205.003906 195.433594 204.511719 194.886719 204.019531 C 194.820312 204.066406 194.753906 204.113281 194.6875 204.160156 C 194.828125 204.671875 194.964844 205.183594 195.167969 205.933594 C 194.75 205.757812 194.429688 205.726562 194.335938 205.5625 C 194.097656 205.15625 193.945312 204.695312 193.785156 204.246094 C 192.148438 199.617188 189.613281 195.445312 187.164062 191.230469 C 186.855469 190.699219 186.542969 190.167969 186.121094 189.4375 C 185.683594 190.011719 185.320312 190.480469 184.964844 190.953125 C 182.023438 194.894531 179.09375 198.847656 176.128906 202.773438 C 174.71875 204.644531 173.246094 206.464844 171.777344 208.292969 C 171.558594 208.566406 171.214844 208.738281 170.886719 208.988281 C 170.113281 208.007812 171.289062 207.488281 171.25 206.558594 C 170.210938 207.222656 169.996094 208.910156 168.308594 208.625 C 168.621094 207.992188 168.882812 207.460938 169.160156 206.902344 C 168.621094 206.878906 168.140625 206.859375 167.585938 206.832031 C 167.117188 207.164062 167 208.167969 165.746094 207.996094 C 166.261719 207.234375 166.652344 206.664062 167.039062 206.089844 C 167.375 205.601562 167.609375 205.195312 167.566406 204.464844 C 167.523438 203.65625 168.046875 202.738281 168.519531 201.988281 C 169.765625 200.015625 171.117188 198.101562 172.433594 196.167969 C 174.878906 192.585938 177.324219 189.007812 179.78125 185.433594 C 180.347656 184.605469 180.921875 183.777344 181.546875 182.996094 C 182.003906 182.429688 181.988281 181.9375 181.683594 181.296875 C 180.4375 178.664062 179.164062 176.039062 178.054688 173.347656 C 177.144531 171.148438 176.441406 168.863281 175.675781 166.605469 C 175.429688 165.890625 175.453125 165.1875 176.160156 164.710938 C 175.96875 164.023438 175.871094 163.34375 175.59375 162.75 C 175.058594 161.585938 175.328125 160.722656 176.378906 160.039062 C 177.335938 160 176.917969 161.003906 177.410156 161.421875 C 177.675781 161.359375 177.980469 161.285156 178.417969 161.175781 C 179.144531 163.273438 179.859375 165.351562 180.574219 167.421875 C 180.675781 167.394531 180.78125 167.367188 180.882812 167.339844 C 180.859375 167.089844 180.882812 166.824219 180.804688 166.59375 C 180.433594 165.457031 179.992188 164.34375 179.664062 163.199219 C 179.511719 162.675781 179.625 162.082031 179.503906 161.542969 C 179.304688 160.671875 179.042969 159.8125 178.742188 158.96875 C 178.554688 158.429688 178.25 157.933594 178.847656 157.269531 C 179.578125 158.027344 179.527344 159.039062 179.855469 159.875 C 180.203125 160.761719 180.472656 161.683594 180.78125 162.585938 C 181.085938 163.480469 181.402344 164.367188 181.976562 165.183594 C 181.757812 164.375 181.523438 163.570312 181.324219 162.757812 C 181.140625 161.996094 180.550781 161.207031 181.519531 160.242188 C 182.578125 162.796875 183.359375 165.273438 184.308594 167.683594 C 185.253906 170.078125 186.203125 172.46875 187.246094 175.105469 C 187.796875 174.476562 188.222656 174.042969 188.585938 173.566406 C 192.910156 167.894531 197.4375 162.390625 202.28125 157.160156 C 203.121094 156.257812 204.160156 155.539062 205.128906 154.765625 C 205.320312 154.613281 205.617188 154.597656 205.992188 154.480469 C 205.996094 155.882812 204.609375 156.371094 204.386719 157.488281 C 204.980469 158.1875 205.730469 158.433594 206.75 158.148438 C 206.664062 158.492188 206.675781 158.703125 206.574219 158.8125 C 205.285156 160.214844 203.933594 161.566406 202.683594 163.007812 C 201.242188 164.664062 199.871094 166.382812 198.492188 168.09375 C 196.207031 170.917969 193.9375 173.757812 191.671875 176.59375 C 191.558594 176.738281 191.511719 176.929688 191.4375 177.101562 C 191.234375 177.316406 191.027344 177.53125 190.824219 177.75 C 190.898438 177.800781 190.972656 177.855469 191.046875 177.910156 C 191.164062 177.628906 191.285156 177.347656 191.402344 177.066406 ","fill-opacity":"1","fill-rule":"nonzero"})})]}),b6=({page:n,setPage:e,setInScene:t})=>Et("nav",{children:[[{title:"Home",href:"/home"},{title:"Information",href:"/information"},{title:"Past Projects",href:"/past-projects"}].map((r,s)=>ie("a",{onClick:()=>e(r.title),className:`link ${n==r.title?"active":""}`,children:r.title},s)),ie("div",{className:"spacer"}),ie("div",{onClick:()=>{window.location.reload()},className:"logo",children:ie(T6,{})})]}),w6=n=>ie("div",{className:"border",children:ie("div",{className:"background",children:n.children})});var T0={exports:{}},Zl=(n=>(n[n.WEBGL_LEGACY=0]="WEBGL_LEGACY",n[n.WEBGL=1]="WEBGL",n[n.WEBGL2=2]="WEBGL2",n))(Zl||{}),PI=(n=>(n[n.UNKNOWN=0]="UNKNOWN",n[n.WEBGL=1]="WEBGL",n[n.CANVAS=2]="CANVAS",n))(PI||{}),s1=(n=>(n[n.COLOR=16384]="COLOR",n[n.DEPTH=256]="DEPTH",n[n.STENCIL=1024]="STENCIL",n))(s1||{}),rt=(n=>(n[n.NORMAL=0]="NORMAL",n[n.ADD=1]="ADD",n[n.MULTIPLY=2]="MULTIPLY",n[n.SCREEN=3]="SCREEN",n[n.OVERLAY=4]="OVERLAY",n[n.DARKEN=5]="DARKEN",n[n.LIGHTEN=6]="LIGHTEN",n[n.COLOR_DODGE=7]="COLOR_DODGE",n[n.COLOR_BURN=8]="COLOR_BURN",n[n.HARD_LIGHT=9]="HARD_LIGHT",n[n.SOFT_LIGHT=10]="SOFT_LIGHT",n[n.DIFFERENCE=11]="DIFFERENCE",n[n.EXCLUSION=12]="EXCLUSION",n[n.HUE=13]="HUE",n[n.SATURATION=14]="SATURATION",n[n.COLOR=15]="COLOR",n[n.LUMINOSITY=16]="LUMINOSITY",n[n.NORMAL_NPM=17]="NORMAL_NPM",n[n.ADD_NPM=18]="ADD_NPM",n[n.SCREEN_NPM=19]="SCREEN_NPM",n[n.NONE=20]="NONE",n[n.SRC_OVER=0]="SRC_OVER",n[n.SRC_IN=21]="SRC_IN",n[n.SRC_OUT=22]="SRC_OUT",n[n.SRC_ATOP=23]="SRC_ATOP",n[n.DST_OVER=24]="DST_OVER",n[n.DST_IN=25]="DST_IN",n[n.DST_OUT=26]="DST_OUT",n[n.DST_ATOP=27]="DST_ATOP",n[n.ERASE=26]="ERASE",n[n.SUBTRACT=28]="SUBTRACT",n[n.XOR=29]="XOR",n))(rt||{}),is=(n=>(n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN",n))(is||{}),Ee=(n=>(n[n.RGBA=6408]="RGBA",n[n.RGB=6407]="RGB",n[n.RG=33319]="RG",n[n.RED=6403]="RED",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.ALPHA=6406]="ALPHA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL",n))(Ee||{}),Ec=(n=>(n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",n))(Ec||{}),et=(n=>(n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.BYTE=5120]="BYTE",n[n.SHORT=5122]="SHORT",n[n.INT=5124]="INT",n[n.FLOAT=5126]="FLOAT",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.HALF_FLOAT=36193]="HALF_FLOAT",n))(et||{}),Ue=(n=>(n[n.FLOAT=0]="FLOAT",n[n.INT=1]="INT",n[n.UINT=2]="UINT",n))(Ue||{}),To=(n=>(n[n.NEAREST=0]="NEAREST",n[n.LINEAR=1]="LINEAR",n))(To||{}),Co=(n=>(n[n.CLAMP=33071]="CLAMP",n[n.REPEAT=10497]="REPEAT",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",n))(Co||{}),Ws=(n=>(n[n.OFF=0]="OFF",n[n.POW2=1]="POW2",n[n.ON=2]="ON",n[n.ON_MANUAL=3]="ON_MANUAL",n))(Ws||{}),ji=(n=>(n[n.NPM=0]="NPM",n[n.UNPACK=1]="UNPACK",n[n.PMA=2]="PMA",n[n.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",n[n.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",n[n.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",n))(ji||{}),Ls=(n=>(n[n.NO=0]="NO",n[n.YES=1]="YES",n[n.AUTO=2]="AUTO",n[n.BLEND=0]="BLEND",n[n.CLEAR=1]="CLEAR",n[n.BLIT=2]="BLIT",n))(Ls||{}),vE=(n=>(n[n.AUTO=0]="AUTO",n[n.MANUAL=1]="MANUAL",n))(vE||{}),Ur=(n=>(n.LOW="lowp",n.MEDIUM="mediump",n.HIGH="highp",n))(Ur||{}),kn=(n=>(n[n.NONE=0]="NONE",n[n.SCISSOR=1]="SCISSOR",n[n.STENCIL=2]="STENCIL",n[n.SPRITE=3]="SPRITE",n[n.COLOR=4]="COLOR",n))(kn||{}),Dn=(n=>(n[n.NONE=0]="NONE",n[n.LOW=2]="LOW",n[n.MEDIUM=4]="MEDIUM",n[n.HIGH=8]="HIGH",n))(Dn||{}),Hs=(n=>(n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",n))(Hs||{});const A6={createCanvas:(n,e)=>{const t=document.createElement("canvas");return t.width=n,t.height=e,t},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(n,e)=>fetch(n,e),parseXML:n=>new DOMParser().parseFromString(n,"text/xml")},Fe={ADAPTER:A6,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var sy=/iPhone/i,EM=/iPod/i,TM=/iPad/i,bM=/\biOS-universal(?:.+)Mac\b/i,oy=/\bAndroid(?:.+)Mobile\b/i,wM=/Android/i,Fu=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Kp=/Silk/i,uo=/Windows Phone/i,AM=/\bWindows(?:.+)ARM\b/i,MM=/BlackBerry/i,CM=/BB10/i,RM=/Opera Mini/i,PM=/\b(CriOS|Chrome)(?:.+)Mobile/i,IM=/Mobile(?:.+)Firefox\b/i,LM=function(n){return typeof n<"u"&&n.platform==="MacIntel"&&typeof n.maxTouchPoints=="number"&&n.maxTouchPoints>1&&typeof MSStream>"u"};function M6(n){return function(e){return e.test(n)}}function DM(n){var e={userAgent:"",platform:"",maxTouchPoints:0};!n&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof n=="string"?e.userAgent=n:n&&n.userAgent&&(e={userAgent:n.userAgent,platform:n.platform,maxTouchPoints:n.maxTouchPoints||0});var t=e.userAgent,i=t.split("[FBAN");typeof i[1]<"u"&&(t=i[0]),i=t.split("Twitter"),typeof i[1]<"u"&&(t=i[0]);var r=M6(t),s={apple:{phone:r(sy)&&!r(uo),ipod:r(EM),tablet:!r(sy)&&(r(TM)||LM(e))&&!r(uo),universal:r(bM),device:(r(sy)||r(EM)||r(TM)||r(bM)||LM(e))&&!r(uo)},amazon:{phone:r(Fu),tablet:!r(Fu)&&r(Kp),device:r(Fu)||r(Kp)},android:{phone:!r(uo)&&r(Fu)||!r(uo)&&r(oy),tablet:!r(uo)&&!r(Fu)&&!r(oy)&&(r(Kp)||r(wM)),device:!r(uo)&&(r(Fu)||r(Kp)||r(oy)||r(wM))||r(/\bokhttp\b/i)},windows:{phone:r(uo),tablet:r(AM),device:r(uo)||r(AM)},other:{blackberry:r(MM),blackberry10:r(CM),opera:r(RM),firefox:r(IM),chrome:r(PM),device:r(MM)||r(CM)||r(RM)||r(IM)||r(PM)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const C6=DM.default??DM,bo=C6(globalThis.navigator);Fe.RETINA_PREFIX=/@([0-9\.]+)x/;Fe.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var II={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function r(l,u,d){this.fn=l,this.context=u,this.once=d||!1}function s(l,u,d,f,p){if(typeof d!="function")throw new TypeError("The listener must be a function");var m=new r(d,f||l,p),v=t?t+u:u;return l._events[v]?l._events[v].fn?l._events[v]=[l._events[v],m]:l._events[v].push(m):(l._events[v]=m,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new i:delete l._events[u]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)e.call(d,f)&&u.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},a.prototype.listeners=function(u){var d=t?t+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var p=0,m=f.length,v=new Array(m);p<m;p++)v[p]=f[p].fn;return v},a.prototype.listenerCount=function(u){var d=t?t+u:u,f=this._events[d];return f?f.fn?1:f.length:0},a.prototype.emit=function(u,d,f,p,m,v){var x=t?t+u:u;if(!this._events[x])return!1;var y=this._events[x],g=arguments.length,T,S;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),g){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,f),!0;case 4:return y.fn.call(y.context,d,f,p),!0;case 5:return y.fn.call(y.context,d,f,p,m),!0;case 6:return y.fn.call(y.context,d,f,p,m,v),!0}for(S=1,T=new Array(g-1);S<g;S++)T[S-1]=arguments[S];y.fn.apply(y.context,T)}else{var w=y.length,M;for(S=0;S<w;S++)switch(y[S].once&&this.removeListener(u,y[S].fn,void 0,!0),g){case 1:y[S].fn.call(y[S].context);break;case 2:y[S].fn.call(y[S].context,d);break;case 3:y[S].fn.call(y[S].context,d,f);break;case 4:y[S].fn.call(y[S].context,d,f,p);break;default:if(!T)for(M=1,T=new Array(g-1);M<g;M++)T[M-1]=arguments[M];y[S].fn.apply(y[S].context,T)}}return!0},a.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},a.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},a.prototype.removeListener=function(u,d,f,p){var m=t?t+u:u;if(!this._events[m])return this;if(!d)return o(this,m),this;var v=this._events[m];if(v.fn)v.fn===d&&(!p||v.once)&&(!f||v.context===f)&&o(this,m);else{for(var x=0,y=[],g=v.length;x<g;x++)(v[x].fn!==d||p&&!v[x].once||f&&v[x].context!==f)&&y.push(v[x]);y.length?this._events[m]=y.length===1?y[0]:y:o(this,m)}return this},a.prototype.removeAllListeners=function(u){var d;return u?(d=t?t+u:u,this._events[d]&&o(this,d)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,n.exports=a})(II);var R6=II.exports;const cf=t0(R6);var yE={exports:{}};yE.exports=b0;yE.exports.default=b0;function b0(n,e,t){t=t||2;var i=e&&e.length,r=i?e[0]*t:n.length,s=LI(n,0,r,t,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,u,d,f,p,m;if(i&&(s=N6(n,e,s,t)),n.length>80*t){a=u=n[0],l=d=n[1];for(var v=t;v<r;v+=t)f=n[v],p=n[v+1],f<a&&(a=f),p<l&&(l=p),f>u&&(u=f),p>d&&(d=p);m=Math.max(u-a,d-l),m=m!==0?32767/m:0}return Yd(s,o,t,a,l,m,0),o}function LI(n,e,t,i,r){var s,o;if(r===l1(n,e,t,i)>0)for(s=e;s<t;s+=i)o=NM(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=NM(s,n[s],n[s+1],o);return o&&w0(o,o.next)&&(Kd(o),o=o.next),o}function $l(n,e){if(!n)return n;e||(e=n);var t=n,i;do if(i=!1,!t.steiner&&(w0(t,t.next)||gn(t.prev,t,t.next)===0)){if(Kd(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Yd(n,e,t,i,r,s,o){if(n){!o&&s&&B6(n,i,r,s);for(var a=n,l,u;n.prev!==n.next;){if(l=n.prev,u=n.next,s?I6(n,i,r,s):P6(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(u.i/t|0),Kd(n),n=u.next,a=u.next;continue}if(n=u,n===a){o?o===1?(n=L6($l(n),e,t),Yd(n,e,t,i,r,s,2)):o===2&&D6(n,e,t,i,r,s):Yd($l(n),e,t,i,r,s,1);break}}}}function P6(n){var e=n.prev,t=n,i=n.next;if(gn(e,t,i)>=0)return!1;for(var r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,u=i.y,d=r<s?r<o?r:o:s<o?s:o,f=a<l?a<u?a:u:l<u?l:u,p=r>s?r>o?r:o:s>o?s:o,m=a>l?a>u?a:u:l>u?l:u,v=i.next;v!==e;){if(v.x>=d&&v.x<=p&&v.y>=f&&v.y<=m&&uc(r,a,s,l,o,u,v.x,v.y)&&gn(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function I6(n,e,t,i){var r=n.prev,s=n,o=n.next;if(gn(r,s,o)>=0)return!1;for(var a=r.x,l=s.x,u=o.x,d=r.y,f=s.y,p=o.y,m=a<l?a<u?a:u:l<u?l:u,v=d<f?d<p?d:p:f<p?f:p,x=a>l?a>u?a:u:l>u?l:u,y=d>f?d>p?d:p:f>p?f:p,g=o1(m,v,e,t,i),T=o1(x,y,e,t,i),S=n.prevZ,w=n.nextZ;S&&S.z>=g&&w&&w.z<=T;){if(S.x>=m&&S.x<=x&&S.y>=v&&S.y<=y&&S!==r&&S!==o&&uc(a,d,l,f,u,p,S.x,S.y)&&gn(S.prev,S,S.next)>=0||(S=S.prevZ,w.x>=m&&w.x<=x&&w.y>=v&&w.y<=y&&w!==r&&w!==o&&uc(a,d,l,f,u,p,w.x,w.y)&&gn(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;S&&S.z>=g;){if(S.x>=m&&S.x<=x&&S.y>=v&&S.y<=y&&S!==r&&S!==o&&uc(a,d,l,f,u,p,S.x,S.y)&&gn(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;w&&w.z<=T;){if(w.x>=m&&w.x<=x&&w.y>=v&&w.y<=y&&w!==r&&w!==o&&uc(a,d,l,f,u,p,w.x,w.y)&&gn(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function L6(n,e,t){var i=n;do{var r=i.prev,s=i.next.next;!w0(r,s)&&DI(r,i,i.next,s)&&qd(r,s)&&qd(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),Kd(i),Kd(i.next),i=n=s),i=i.next}while(i!==n);return $l(i)}function D6(n,e,t,i,r,s){var o=n;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&H6(o,a)){var l=NI(o,a);o=$l(o,o.next),l=$l(l,l.next),Yd(o,e,t,i,r,s,0),Yd(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function N6(n,e,t,i){var r=[],s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,u=LI(n,a,l,i,!1),u===u.next&&(u.steiner=!0),r.push(G6(u));for(r.sort(U6),s=0;s<r.length;s++)t=F6(r[s],t);return t}function U6(n,e){return n.x-e.x}function F6(n,e){var t=O6(n,e);if(!t)return e;var i=NI(t,n);return $l(i,i.next),$l(t,t.next)}function O6(n,e){var t=e,i=n.x,r=n.y,s=-1/0,o;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){var a=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(a<=i&&a>s&&(s=a,o=t.x<t.next.x?t:t.next,a===i))return o}t=t.next}while(t!==e);if(!o)return null;var l=o,u=o.x,d=o.y,f=1/0,p;t=o;do i>=t.x&&t.x>=u&&i!==t.x&&uc(r<d?i:s,r,u,d,r<d?s:i,r,t.x,t.y)&&(p=Math.abs(r-t.y)/(i-t.x),qd(t,n)&&(p<f||p===f&&(t.x>o.x||t.x===o.x&&k6(o,t)))&&(o=t,f=p)),t=t.next;while(t!==l);return o}function k6(n,e){return gn(n.prev,n,e.prev)<0&&gn(e.next,n,n.next)<0}function B6(n,e,t,i){var r=n;do r.z===0&&(r.z=o1(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,z6(r)}function z6(n){var e,t,i,r,s,o,a,l,u=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<u&&(a++,i=i.nextZ,!!i);e++);for(l=u;a>0||l>0&&i;)a!==0&&(l===0||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,u*=2}while(o>1);return n}function o1(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function G6(n){var e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function uc(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function H6(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!V6(n,e)&&(qd(n,e)&&qd(e,n)&&W6(n,e)&&(gn(n.prev,n,e.prev)||gn(n,e.prev,e))||w0(n,e)&&gn(n.prev,n,n.next)>0&&gn(e.prev,e,e.next)>0)}function gn(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function w0(n,e){return n.x===e.x&&n.y===e.y}function DI(n,e,t,i){var r=Qp(gn(n,e,t)),s=Qp(gn(n,e,i)),o=Qp(gn(t,i,n)),a=Qp(gn(t,i,e));return!!(r!==s&&o!==a||r===0&&Zp(n,t,e)||s===0&&Zp(n,i,e)||o===0&&Zp(t,n,i)||a===0&&Zp(t,e,i))}function Zp(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Qp(n){return n>0?1:n<0?-1:0}function V6(n,e){var t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&DI(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function qd(n,e){return gn(n.prev,n,n.next)<0?gn(n,e,n.next)>=0&&gn(n,n.prev,e)>=0:gn(n,e,n.prev)<0||gn(n,n.next,e)<0}function W6(n,e){var t=n,i=!1,r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function NI(n,e){var t=new a1(n.i,n.x,n.y),i=new a1(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function NM(n,e,t,i){var r=new a1(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Kd(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function a1(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}b0.deviation=function(n,e,t,i){var r=e&&e.length,s=r?e[0]*t:n.length,o=Math.abs(l1(n,0,s,t));if(r)for(var a=0,l=e.length;a<l;a++){var u=e[a]*t,d=a<l-1?e[a+1]*t:n.length;o-=Math.abs(l1(n,u,d,t))}var f=0;for(a=0;a<i.length;a+=3){var p=i[a]*t,m=i[a+1]*t,v=i[a+2]*t;f+=Math.abs((n[p]-n[v])*(n[m+1]-n[p+1])-(n[p]-n[m])*(n[v+1]-n[p+1]))}return o===0&&f===0?0:Math.abs((f-o)/o)};function l1(n,e,t,i){for(var r=0,s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}b0.flatten=function(n){for(var e=n[0][0].length,t={vertices:[],holes:[],dimensions:e},i=0,r=0;r<n.length;r++){for(var s=0;s<n[r].length;s++)for(var o=0;o<e;o++)t.vertices.push(n[r][s][o]);r>0&&(i+=n[r-1].length,t.holes.push(i))}return t};var X6=yE.exports;const j6=t0(X6);var Dg={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */Dg.exports;(function(n,e){(function(t){var i=e&&!e.nodeType&&e,r=n&&!n.nodeType&&n,s=typeof Rm=="object"&&Rm;(s.global===s||s.window===s||s.self===s)&&(t=s);var o,a=2147483647,l=36,u=1,d=26,f=38,p=700,m=72,v=128,x="-",y=/^xn--/,g=/[^\x20-\x7E]/,T=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=l-u,M=Math.floor,P=String.fromCharCode,R;function D(k){throw new RangeError(S[k])}function C(k,H){for(var te=k.length,ee=[];te--;)ee[te]=H(k[te]);return ee}function L(k,H){var te=k.split("@"),ee="";te.length>1&&(ee=te[0]+"@",k=te[1]),k=k.replace(T,".");var re=k.split("."),ge=C(re,H).join(".");return ee+ge}function Z(k){for(var H=[],te=0,ee=k.length,re,ge;te<ee;)re=k.charCodeAt(te++),re>=55296&&re<=56319&&te<ee?(ge=k.charCodeAt(te++),(ge&64512)==56320?H.push(((re&1023)<<10)+(ge&1023)+65536):(H.push(re),te--)):H.push(re);return H}function V(k){return C(k,function(H){var te="";return H>65535&&(H-=65536,te+=P(H>>>10&1023|55296),H=56320|H&1023),te+=P(H),te}).join("")}function z(k){return k-48<10?k-22:k-65<26?k-65:k-97<26?k-97:l}function F(k,H){return k+22+75*(k<26)-((H!=0)<<5)}function j(k,H,te){var ee=0;for(k=te?M(k/p):k>>1,k+=M(k/H);k>w*d>>1;ee+=l)k=M(k/w);return M(ee+(w+1)*k/(k+f))}function Q(k){var H=[],te=k.length,ee,re=0,ge=v,ve=m,Me,Ze,Ye,ze,Ie,q,ct,Xe,st;for(Me=k.lastIndexOf(x),Me<0&&(Me=0),Ze=0;Ze<Me;++Ze)k.charCodeAt(Ze)>=128&&D("not-basic"),H.push(k.charCodeAt(Ze));for(Ye=Me>0?Me+1:0;Ye<te;){for(ze=re,Ie=1,q=l;Ye>=te&&D("invalid-input"),ct=z(k.charCodeAt(Ye++)),(ct>=l||ct>M((a-re)/Ie))&&D("overflow"),re+=ct*Ie,Xe=q<=ve?u:q>=ve+d?d:q-ve,!(ct<Xe);q+=l)st=l-Xe,Ie>M(a/st)&&D("overflow"),Ie*=st;ee=H.length+1,ve=j(re-ze,ee,ze==0),M(re/ee)>a-ge&&D("overflow"),ge+=M(re/ee),re%=ee,H.splice(re++,0,ge)}return V(H)}function $(k){var H,te,ee,re,ge,ve,Me,Ze,Ye,ze,Ie,q=[],ct,Xe,st,nt;for(k=Z(k),ct=k.length,H=v,te=0,ge=m,ve=0;ve<ct;++ve)Ie=k[ve],Ie<128&&q.push(P(Ie));for(ee=re=q.length,re&&q.push(x);ee<ct;){for(Me=a,ve=0;ve<ct;++ve)Ie=k[ve],Ie>=H&&Ie<Me&&(Me=Ie);for(Xe=ee+1,Me-H>M((a-te)/Xe)&&D("overflow"),te+=(Me-H)*Xe,H=Me,ve=0;ve<ct;++ve)if(Ie=k[ve],Ie<H&&++te>a&&D("overflow"),Ie==H){for(Ze=te,Ye=l;ze=Ye<=ge?u:Ye>=ge+d?d:Ye-ge,!(Ze<ze);Ye+=l)nt=Ze-ze,st=l-ze,q.push(P(F(ze+nt%st,0))),Ze=M(nt/st);q.push(P(F(Ze,0))),ge=j(te,Xe,ee==re),te=0,++ee}++te,++H}return q.join("")}function O(k){return L(k,function(H){return y.test(H)?Q(H.slice(4).toLowerCase()):H})}function G(k){return L(k,function(H){return g.test(H)?"xn--"+$(H):H})}if(o={version:"1.4.1",ucs2:{decode:Z,encode:V},decode:Q,encode:$,toASCII:G,toUnicode:O},i&&r)if(n.exports==i)r.exports=o;else for(R in o)o.hasOwnProperty(R)&&(i[R]=o[R]);else t.punycode=o})(Rm)})(Dg,Dg.exports);var $6=Dg.exports,Y6=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),i=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var r=42;e[t]=r;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==r||o.enumerable!==!0)return!1}return!0},UM=typeof Symbol<"u"&&Symbol,q6=Y6,K6=function(){return typeof UM!="function"||typeof Symbol!="function"||typeof UM("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:q6()},FM={foo:{}},Z6=Object,Q6=function(){return{__proto__:FM}.foo===FM.foo&&!({__proto__:null}instanceof Z6)},J6="Function.prototype.bind called on incompatible ",ez=Object.prototype.toString,tz=Math.max,nz="[object Function]",OM=function(e,t){for(var i=[],r=0;r<e.length;r+=1)i[r]=e[r];for(var s=0;s<t.length;s+=1)i[s+e.length]=t[s];return i},iz=function(e,t){for(var i=[],r=t||0,s=0;r<e.length;r+=1,s+=1)i[s]=e[r];return i},rz=function(n,e){for(var t="",i=0;i<n.length;i+=1)t+=n[i],i+1<n.length&&(t+=e);return t},sz=function(e){var t=this;if(typeof t!="function"||ez.apply(t)!==nz)throw new TypeError(J6+t);for(var i=iz(arguments,1),r,s=function(){if(this instanceof r){var d=t.apply(this,OM(i,arguments));return Object(d)===d?d:this}return t.apply(e,OM(i,arguments))},o=tz(0,t.length-i.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(r=Function("binder","return function ("+rz(a,",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var u=function(){};u.prototype=t.prototype,r.prototype=new u,u.prototype=null}return r},oz=sz,xE=Function.prototype.bind||oz,az=Function.prototype.call,lz=Object.prototype.hasOwnProperty,uz=xE,cz=uz.call(az,lz),It,jc=SyntaxError,UI=Function,Tc=TypeError,ay=function(n){try{return UI('"use strict"; return ('+n+").constructor;")()}catch{}},Dl=Object.getOwnPropertyDescriptor;if(Dl)try{Dl({},"")}catch{Dl=null}var ly=function(){throw new Tc},hz=Dl?function(){try{return arguments.callee,ly}catch{try{return Dl(arguments,"callee").get}catch{return ly}}}():ly,Ou=K6(),dz=Q6(),Qn=Object.getPrototypeOf||(dz?function(n){return n.__proto__}:null),Hu={},fz=typeof Uint8Array>"u"||!Qn?It:Qn(Uint8Array),Nl={"%AggregateError%":typeof AggregateError>"u"?It:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?It:ArrayBuffer,"%ArrayIteratorPrototype%":Ou&&Qn?Qn([][Symbol.iterator]()):It,"%AsyncFromSyncIteratorPrototype%":It,"%AsyncFunction%":Hu,"%AsyncGenerator%":Hu,"%AsyncGeneratorFunction%":Hu,"%AsyncIteratorPrototype%":Hu,"%Atomics%":typeof Atomics>"u"?It:Atomics,"%BigInt%":typeof BigInt>"u"?It:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?It:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?It:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?It:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?It:Float32Array,"%Float64Array%":typeof Float64Array>"u"?It:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?It:FinalizationRegistry,"%Function%":UI,"%GeneratorFunction%":Hu,"%Int8Array%":typeof Int8Array>"u"?It:Int8Array,"%Int16Array%":typeof Int16Array>"u"?It:Int16Array,"%Int32Array%":typeof Int32Array>"u"?It:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Ou&&Qn?Qn(Qn([][Symbol.iterator]())):It,"%JSON%":typeof JSON=="object"?JSON:It,"%Map%":typeof Map>"u"?It:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Ou||!Qn?It:Qn(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?It:Promise,"%Proxy%":typeof Proxy>"u"?It:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?It:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?It:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Ou||!Qn?It:Qn(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?It:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Ou&&Qn?Qn(""[Symbol.iterator]()):It,"%Symbol%":Ou?Symbol:It,"%SyntaxError%":jc,"%ThrowTypeError%":hz,"%TypedArray%":fz,"%TypeError%":Tc,"%Uint8Array%":typeof Uint8Array>"u"?It:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?It:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?It:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?It:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?It:WeakMap,"%WeakRef%":typeof WeakRef>"u"?It:WeakRef,"%WeakSet%":typeof WeakSet>"u"?It:WeakSet};if(Qn)try{null.error}catch(n){var pz=Qn(Qn(n));Nl["%Error.prototype%"]=pz}var mz=function n(e){var t;if(e==="%AsyncFunction%")t=ay("async function () {}");else if(e==="%GeneratorFunction%")t=ay("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=ay("async function* () {}");else if(e==="%AsyncGenerator%"){var i=n("%AsyncGeneratorFunction%");i&&(t=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var r=n("%AsyncGenerator%");r&&Qn&&(t=Qn(r.prototype))}return Nl[e]=t,t},kM={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},hf=xE,Ng=cz,gz=hf.call(Function.call,Array.prototype.concat),_z=hf.call(Function.apply,Array.prototype.splice),BM=hf.call(Function.call,String.prototype.replace),Ug=hf.call(Function.call,String.prototype.slice),vz=hf.call(Function.call,RegExp.prototype.exec),yz=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,xz=/\\(\\)?/g,Sz=function(e){var t=Ug(e,0,1),i=Ug(e,-1);if(t==="%"&&i!=="%")throw new jc("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&t!=="%")throw new jc("invalid intrinsic syntax, expected opening `%`");var r=[];return BM(e,yz,function(s,o,a,l){r[r.length]=a?BM(l,xz,"$1"):o||s}),r},Ez=function(e,t){var i=e,r;if(Ng(kM,i)&&(r=kM[i],i="%"+r[0]+"%"),Ng(Nl,i)){var s=Nl[i];if(s===Hu&&(s=mz(i)),typeof s>"u"&&!t)throw new Tc("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:i,value:s}}throw new jc("intrinsic "+e+" does not exist!")},Ql=function(e,t){if(typeof e!="string"||e.length===0)throw new Tc("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new Tc('"allowMissing" argument must be a boolean');if(vz(/^%?[^%]*%?$/,e)===null)throw new jc("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=Sz(e),r=i.length>0?i[0]:"",s=Ez("%"+r+"%",t),o=s.name,a=s.value,l=!1,u=s.alias;u&&(r=u[0],_z(i,gz([0,1],u)));for(var d=1,f=!0;d<i.length;d+=1){var p=i[d],m=Ug(p,0,1),v=Ug(p,-1);if((m==='"'||m==="'"||m==="`"||v==='"'||v==="'"||v==="`")&&m!==v)throw new jc("property names with quotes must have matching quotes");if((p==="constructor"||!f)&&(l=!0),r+="."+p,o="%"+r+"%",Ng(Nl,o))a=Nl[o];else if(a!=null){if(!(p in a)){if(!t)throw new Tc("base intrinsic for "+e+" exists, but the property is not available.");return}if(Dl&&d+1>=i.length){var x=Dl(a,p);f=!!x,f&&"get"in x&&!("originalValue"in x.get)?a=x.get:a=a[p]}else f=Ng(a,p),a=a[p];f&&!l&&(Nl[o]=a)}}return a},FI={exports:{}},Tz=Ql,u1=Tz("%Object.defineProperty%",!0),c1=function(){if(u1)try{return u1({},"a",{value:1}),!0}catch{return!1}return!1};c1.hasArrayLengthDefineBug=function(){if(!c1())return null;try{return u1([],"length",{value:1}).length!==1}catch{return!0}};var OI=c1,bz=Ql,Xm=bz("%Object.getOwnPropertyDescriptor%",!0);if(Xm)try{Xm([],"length")}catch{Xm=null}var kI=Xm,wz=OI(),SE=Ql,Sd=wz&&SE("%Object.defineProperty%",!0);if(Sd)try{Sd({},"a",{value:1})}catch{Sd=!1}var Az=SE("%SyntaxError%"),ku=SE("%TypeError%"),zM=kI,Mz=function(e,t,i){if(!e||typeof e!="object"&&typeof e!="function")throw new ku("`obj` must be an object or a function`");if(typeof t!="string"&&typeof t!="symbol")throw new ku("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new ku("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new ku("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new ku("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new ku("`loose`, if provided, must be a boolean");var r=arguments.length>3?arguments[3]:null,s=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,l=!!zM&&zM(e,t);if(Sd)Sd(e,t,{configurable:o===null&&l?l.configurable:!o,enumerable:r===null&&l?l.enumerable:!r,value:i,writable:s===null&&l?l.writable:!s});else if(a||!r&&!s&&!o)e[t]=i;else throw new Az("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},BI=Ql,GM=Mz,Cz=OI(),HM=kI,VM=BI("%TypeError%"),Rz=BI("%Math.floor%"),Pz=function(e,t){if(typeof e!="function")throw new VM("`fn` is not a function");if(typeof t!="number"||t<0||t>4294967295||Rz(t)!==t)throw new VM("`length` must be a positive 32-bit integer");var i=arguments.length>2&&!!arguments[2],r=!0,s=!0;if("length"in e&&HM){var o=HM(e,"length");o&&!o.configurable&&(r=!1),o&&!o.writable&&(s=!1)}return(r||s||!i)&&(Cz?GM(e,"length",t,!0,!0):GM(e,"length",t)),e};(function(n){var e=xE,t=Ql,i=Pz,r=t("%TypeError%"),s=t("%Function.prototype.apply%"),o=t("%Function.prototype.call%"),a=t("%Reflect.apply%",!0)||e.call(o,s),l=t("%Object.defineProperty%",!0),u=t("%Math.max%");if(l)try{l({},"a",{value:1})}catch{l=null}n.exports=function(p){if(typeof p!="function")throw new r("a function is required");var m=a(e,o,arguments);return i(m,1+u(0,p.length-(arguments.length-1)),!0)};var d=function(){return a(e,s,arguments)};l?l(n.exports,"apply",{value:d}):n.exports.apply=d})(FI);var Iz=FI.exports,zI=Ql,GI=Iz,Lz=GI(zI("String.prototype.indexOf")),Dz=function(e,t){var i=zI(e,!!t);return typeof i=="function"&&Lz(e,".prototype.")>-1?GI(i):i};const Nz={},Uz=Object.freeze(Object.defineProperty({__proto__:null,default:Nz},Symbol.toStringTag,{value:"Module"})),Fz=AR(Uz);var EE=typeof Map=="function"&&Map.prototype,uy=Object.getOwnPropertyDescriptor&&EE?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Fg=EE&&uy&&typeof uy.get=="function"?uy.get:null,WM=EE&&Map.prototype.forEach,TE=typeof Set=="function"&&Set.prototype,cy=Object.getOwnPropertyDescriptor&&TE?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Og=TE&&cy&&typeof cy.get=="function"?cy.get:null,XM=TE&&Set.prototype.forEach,Oz=typeof WeakMap=="function"&&WeakMap.prototype,Ed=Oz?WeakMap.prototype.has:null,kz=typeof WeakSet=="function"&&WeakSet.prototype,Td=kz?WeakSet.prototype.has:null,Bz=typeof WeakRef=="function"&&WeakRef.prototype,jM=Bz?WeakRef.prototype.deref:null,zz=Boolean.prototype.valueOf,Gz=Object.prototype.toString,Hz=Function.prototype.toString,Vz=String.prototype.match,bE=String.prototype.slice,ga=String.prototype.replace,Wz=String.prototype.toUpperCase,$M=String.prototype.toLowerCase,HI=RegExp.prototype.test,YM=Array.prototype.concat,Ds=Array.prototype.join,Xz=Array.prototype.slice,qM=Math.floor,h1=typeof BigInt=="function"?BigInt.prototype.valueOf:null,hy=Object.getOwnPropertySymbols,d1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,$c=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Mi=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===$c||"symbol")?Symbol.toStringTag:null,VI=Object.prototype.propertyIsEnumerable,KM=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(n){return n.__proto__}:null);function ZM(n,e){if(n===1/0||n===-1/0||n!==n||n&&n>-1e3&&n<1e3||HI.call(/e/,e))return e;var t=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof n=="number"){var i=n<0?-qM(-n):qM(n);if(i!==n){var r=String(i),s=bE.call(e,r.length+1);return ga.call(r,t,"$&_")+"."+ga.call(ga.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return ga.call(e,t,"$&_")}var f1=Fz,QM=f1.custom,JM=XI(QM)?QM:null,jz=function n(e,t,i,r){var s=t||{};if(la(s,"quoteStyle")&&s.quoteStyle!=="single"&&s.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(la(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=la(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(la(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(la(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return $I(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return a?ZM(e,l):l}if(typeof e=="bigint"){var u=String(e)+"n";return a?ZM(e,u):u}var d=typeof s.depth>"u"?5:s.depth;if(typeof i>"u"&&(i=0),i>=d&&d>0&&typeof e=="object")return p1(e)?"[Array]":"[Object]";var f=cG(s,i);if(typeof r>"u")r=[];else if(jI(r,e)>=0)return"[Circular]";function p(z,F,j){if(F&&(r=Xz.call(r),r.push(F)),j){var Q={depth:s.depth};return la(s,"quoteStyle")&&(Q.quoteStyle=s.quoteStyle),n(z,Q,i+1,r)}return n(z,s,i+1,r)}if(typeof e=="function"&&!eC(e)){var m=tG(e),v=Jp(e,p);return"[Function"+(m?": "+m:" (anonymous)")+"]"+(v.length>0?" { "+Ds.call(v,", ")+" }":"")}if(XI(e)){var x=$c?ga.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):d1.call(e);return typeof e=="object"&&!$c?Hh(x):x}if(aG(e)){for(var y="<"+$M.call(String(e.nodeName)),g=e.attributes||[],T=0;T<g.length;T++)y+=" "+g[T].name+"="+WI($z(g[T].value),"double",s);return y+=">",e.childNodes&&e.childNodes.length&&(y+="..."),y+="</"+$M.call(String(e.nodeName))+">",y}if(p1(e)){if(e.length===0)return"[]";var S=Jp(e,p);return f&&!uG(S)?"["+m1(S,f)+"]":"[ "+Ds.call(S,", ")+" ]"}if(qz(e)){var w=Jp(e,p);return!("cause"in Error.prototype)&&"cause"in e&&!VI.call(e,"cause")?"{ ["+String(e)+"] "+Ds.call(YM.call("[cause]: "+p(e.cause),w),", ")+" }":w.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Ds.call(w,", ")+" }"}if(typeof e=="object"&&o){if(JM&&typeof e[JM]=="function"&&f1)return f1(e,{depth:d-i});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(nG(e)){var M=[];return WM&&WM.call(e,function(z,F){M.push(p(F,e,!0)+" => "+p(z,e))}),tC("Map",Fg.call(e),M,f)}if(sG(e)){var P=[];return XM&&XM.call(e,function(z){P.push(p(z,e))}),tC("Set",Og.call(e),P,f)}if(iG(e))return dy("WeakMap");if(oG(e))return dy("WeakSet");if(rG(e))return dy("WeakRef");if(Zz(e))return Hh(p(Number(e)));if(Jz(e))return Hh(p(h1.call(e)));if(Qz(e))return Hh(zz.call(e));if(Kz(e))return Hh(p(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(e===Rm)return"{ [object globalThis] }";if(!Yz(e)&&!eC(e)){var R=Jp(e,p),D=KM?KM(e)===Object.prototype:e instanceof Object||e.constructor===Object,C=e instanceof Object?"":"null prototype",L=!D&&Mi&&Object(e)===e&&Mi in e?bE.call(Ga(e),8,-1):C?"Object":"",Z=D||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",V=Z+(L||C?"["+Ds.call(YM.call([],L||[],C||[]),": ")+"] ":"");return R.length===0?V+"{}":f?V+"{"+m1(R,f)+"}":V+"{ "+Ds.call(R,", ")+" }"}return String(e)};function WI(n,e,t){var i=(t.quoteStyle||e)==="double"?'"':"'";return i+n+i}function $z(n){return ga.call(String(n),/"/g,"&quot;")}function p1(n){return Ga(n)==="[object Array]"&&(!Mi||!(typeof n=="object"&&Mi in n))}function Yz(n){return Ga(n)==="[object Date]"&&(!Mi||!(typeof n=="object"&&Mi in n))}function eC(n){return Ga(n)==="[object RegExp]"&&(!Mi||!(typeof n=="object"&&Mi in n))}function qz(n){return Ga(n)==="[object Error]"&&(!Mi||!(typeof n=="object"&&Mi in n))}function Kz(n){return Ga(n)==="[object String]"&&(!Mi||!(typeof n=="object"&&Mi in n))}function Zz(n){return Ga(n)==="[object Number]"&&(!Mi||!(typeof n=="object"&&Mi in n))}function Qz(n){return Ga(n)==="[object Boolean]"&&(!Mi||!(typeof n=="object"&&Mi in n))}function XI(n){if($c)return n&&typeof n=="object"&&n instanceof Symbol;if(typeof n=="symbol")return!0;if(!n||typeof n!="object"||!d1)return!1;try{return d1.call(n),!0}catch{}return!1}function Jz(n){if(!n||typeof n!="object"||!h1)return!1;try{return h1.call(n),!0}catch{}return!1}var eG=Object.prototype.hasOwnProperty||function(n){return n in this};function la(n,e){return eG.call(n,e)}function Ga(n){return Gz.call(n)}function tG(n){if(n.name)return n.name;var e=Vz.call(Hz.call(n),/^function\s*([\w$]+)/);return e?e[1]:null}function jI(n,e){if(n.indexOf)return n.indexOf(e);for(var t=0,i=n.length;t<i;t++)if(n[t]===e)return t;return-1}function nG(n){if(!Fg||!n||typeof n!="object")return!1;try{Fg.call(n);try{Og.call(n)}catch{return!0}return n instanceof Map}catch{}return!1}function iG(n){if(!Ed||!n||typeof n!="object")return!1;try{Ed.call(n,Ed);try{Td.call(n,Td)}catch{return!0}return n instanceof WeakMap}catch{}return!1}function rG(n){if(!jM||!n||typeof n!="object")return!1;try{return jM.call(n),!0}catch{}return!1}function sG(n){if(!Og||!n||typeof n!="object")return!1;try{Og.call(n);try{Fg.call(n)}catch{return!0}return n instanceof Set}catch{}return!1}function oG(n){if(!Td||!n||typeof n!="object")return!1;try{Td.call(n,Td);try{Ed.call(n,Ed)}catch{return!0}return n instanceof WeakSet}catch{}return!1}function aG(n){return!n||typeof n!="object"?!1:typeof HTMLElement<"u"&&n instanceof HTMLElement?!0:typeof n.nodeName=="string"&&typeof n.getAttribute=="function"}function $I(n,e){if(n.length>e.maxStringLength){var t=n.length-e.maxStringLength,i="... "+t+" more character"+(t>1?"s":"");return $I(bE.call(n,0,e.maxStringLength),e)+i}var r=ga.call(ga.call(n,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,lG);return WI(r,"single",e)}function lG(n){var e=n.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+Wz.call(e.toString(16))}function Hh(n){return"Object("+n+")"}function dy(n){return n+" { ? }"}function tC(n,e,t,i){var r=i?m1(t,i):Ds.call(t,", ");return n+" ("+e+") {"+r+"}"}function uG(n){for(var e=0;e<n.length;e++)if(jI(n[e],`
`)>=0)return!1;return!0}function cG(n,e){var t;if(n.indent==="	")t="	";else if(typeof n.indent=="number"&&n.indent>0)t=Ds.call(Array(n.indent+1)," ");else return null;return{base:t,prev:Ds.call(Array(e+1),t)}}function m1(n,e){if(n.length===0)return"";var t=`
`+e.prev+e.base;return t+Ds.call(n,","+t)+`
`+e.prev}function Jp(n,e){var t=p1(n),i=[];if(t){i.length=n.length;for(var r=0;r<n.length;r++)i[r]=la(n,r)?e(n[r],n):""}var s=typeof hy=="function"?hy(n):[],o;if($c){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var l in n)la(n,l)&&(t&&String(Number(l))===l&&l<n.length||$c&&o["$"+l]instanceof Symbol||(HI.call(/[^\w$]/,l)?i.push(e(l,n)+": "+e(n[l],n)):i.push(l+": "+e(n[l],n))));if(typeof hy=="function")for(var u=0;u<s.length;u++)VI.call(n,s[u])&&i.push("["+e(s[u])+"]: "+e(n[s[u]],n));return i}var wE=Ql,rh=Dz,hG=jz,dG=wE("%TypeError%"),em=wE("%WeakMap%",!0),tm=wE("%Map%",!0),fG=rh("WeakMap.prototype.get",!0),pG=rh("WeakMap.prototype.set",!0),mG=rh("WeakMap.prototype.has",!0),gG=rh("Map.prototype.get",!0),_G=rh("Map.prototype.set",!0),vG=rh("Map.prototype.has",!0),AE=function(n,e){for(var t=n,i;(i=t.next)!==null;t=i)if(i.key===e)return t.next=i.next,i.next=n.next,n.next=i,i},yG=function(n,e){var t=AE(n,e);return t&&t.value},xG=function(n,e,t){var i=AE(n,e);i?i.value=t:n.next={key:e,next:n.next,value:t}},SG=function(n,e){return!!AE(n,e)},EG=function(){var e,t,i,r={assert:function(s){if(!r.has(s))throw new dG("Side channel does not contain "+hG(s))},get:function(s){if(em&&s&&(typeof s=="object"||typeof s=="function")){if(e)return fG(e,s)}else if(tm){if(t)return gG(t,s)}else if(i)return yG(i,s)},has:function(s){if(em&&s&&(typeof s=="object"||typeof s=="function")){if(e)return mG(e,s)}else if(tm){if(t)return vG(t,s)}else if(i)return SG(i,s);return!1},set:function(s,o){em&&s&&(typeof s=="object"||typeof s=="function")?(e||(e=new em),pG(e,s,o)):tm?(t||(t=new tm),_G(t,s,o)):(i||(i={key:{},next:null}),xG(i,s,o))}};return r},TG=String.prototype.replace,bG=/%20/g,fy={RFC1738:"RFC1738",RFC3986:"RFC3986"},ME={default:fy.RFC3986,formatters:{RFC1738:function(n){return TG.call(n,bG,"+")},RFC3986:function(n){return String(n)}},RFC1738:fy.RFC1738,RFC3986:fy.RFC3986},wG=ME,py=Object.prototype.hasOwnProperty,vl=Array.isArray,ws=function(){for(var n=[],e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n}(),AG=function(e){for(;e.length>1;){var t=e.pop(),i=t.obj[t.prop];if(vl(i)){for(var r=[],s=0;s<i.length;++s)typeof i[s]<"u"&&r.push(i[s]);t.obj[t.prop]=r}}},YI=function(e,t){for(var i=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)typeof e[r]<"u"&&(i[r]=e[r]);return i},MG=function n(e,t,i){if(!t)return e;if(typeof t!="object"){if(vl(e))e.push(t);else if(e&&typeof e=="object")(i&&(i.plainObjects||i.allowPrototypes)||!py.call(Object.prototype,t))&&(e[t]=!0);else return[e,t];return e}if(!e||typeof e!="object")return[e].concat(t);var r=e;return vl(e)&&!vl(t)&&(r=YI(e,i)),vl(e)&&vl(t)?(t.forEach(function(s,o){if(py.call(e,o)){var a=e[o];a&&typeof a=="object"&&s&&typeof s=="object"?e[o]=n(a,s,i):e.push(s)}else e[o]=s}),e):Object.keys(t).reduce(function(s,o){var a=t[o];return py.call(s,o)?s[o]=n(s[o],a,i):s[o]=a,s},r)},CG=function(e,t){return Object.keys(t).reduce(function(i,r){return i[r]=t[r],i},e)},RG=function(n,e,t){var i=n.replace(/\+/g," ");if(t==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},PG=function(e,t,i,r,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),i==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(d){return"%26%23"+parseInt(d.slice(2),16)+"%3B"});for(var a="",l=0;l<o.length;++l){var u=o.charCodeAt(l);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||s===wG.RFC1738&&(u===40||u===41)){a+=o.charAt(l);continue}if(u<128){a=a+ws[u];continue}if(u<2048){a=a+(ws[192|u>>6]+ws[128|u&63]);continue}if(u<55296||u>=57344){a=a+(ws[224|u>>12]+ws[128|u>>6&63]+ws[128|u&63]);continue}l+=1,u=65536+((u&1023)<<10|o.charCodeAt(l)&1023),a+=ws[240|u>>18]+ws[128|u>>12&63]+ws[128|u>>6&63]+ws[128|u&63]}return a},IG=function(e){for(var t=[{obj:{o:e},prop:"o"}],i=[],r=0;r<t.length;++r)for(var s=t[r],o=s.obj[s.prop],a=Object.keys(o),l=0;l<a.length;++l){var u=a[l],d=o[u];typeof d=="object"&&d!==null&&i.indexOf(d)===-1&&(t.push({obj:o,prop:u}),i.push(d))}return AG(t),e},LG=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},DG=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},NG=function(e,t){return[].concat(e,t)},UG=function(e,t){if(vl(e)){for(var i=[],r=0;r<e.length;r+=1)i.push(t(e[r]));return i}return t(e)},qI={arrayToObject:YI,assign:CG,combine:NG,compact:IG,decode:RG,encode:PG,isBuffer:DG,isRegExp:LG,maybeMap:UG,merge:MG},KI=EG,jm=qI,bd=ME,FG=Object.prototype.hasOwnProperty,nC={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},_o=Array.isArray,OG=Array.prototype.push,ZI=function(n,e){OG.apply(n,_o(e)?e:[e])},kG=Date.prototype.toISOString,iC=bd.default,Ti={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:jm.encode,encodeValuesOnly:!1,format:iC,formatter:bd.formatters[iC],indices:!1,serializeDate:function(e){return kG.call(e)},skipNulls:!1,strictNullHandling:!1},BG=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},my={},zG=function n(e,t,i,r,s,o,a,l,u,d,f,p,m,v,x,y){for(var g=e,T=y,S=0,w=!1;(T=T.get(my))!==void 0&&!w;){var M=T.get(e);if(S+=1,typeof M<"u"){if(M===S)throw new RangeError("Cyclic object value");w=!0}typeof T.get(my)>"u"&&(S=0)}if(typeof l=="function"?g=l(t,g):g instanceof Date?g=f(g):i==="comma"&&_o(g)&&(g=jm.maybeMap(g,function(Q){return Q instanceof Date?f(Q):Q})),g===null){if(s)return a&&!v?a(t,Ti.encoder,x,"key",p):t;g=""}if(BG(g)||jm.isBuffer(g)){if(a){var P=v?t:a(t,Ti.encoder,x,"key",p);return[m(P)+"="+m(a(g,Ti.encoder,x,"value",p))]}return[m(t)+"="+m(String(g))]}var R=[];if(typeof g>"u")return R;var D;if(i==="comma"&&_o(g))v&&a&&(g=jm.maybeMap(g,a)),D=[{value:g.length>0?g.join(",")||null:void 0}];else if(_o(l))D=l;else{var C=Object.keys(g);D=u?C.sort(u):C}for(var L=r&&_o(g)&&g.length===1?t+"[]":t,Z=0;Z<D.length;++Z){var V=D[Z],z=typeof V=="object"&&typeof V.value<"u"?V.value:g[V];if(!(o&&z===null)){var F=_o(g)?typeof i=="function"?i(L,V):L:L+(d?"."+V:"["+V+"]");y.set(e,S);var j=KI();j.set(my,y),ZI(R,n(z,F,i,r,s,o,i==="comma"&&v&&_o(g)?null:a,l,u,d,f,p,m,v,x,j))}}return R},GG=function(e){if(!e)return Ti;if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var t=e.charset||Ti.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=bd.default;if(typeof e.format<"u"){if(!FG.call(bd.formatters,e.format))throw new TypeError("Unknown format option provided.");i=e.format}var r=bd.formatters[i],s=Ti.filter;return(typeof e.filter=="function"||_o(e.filter))&&(s=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:Ti.addQueryPrefix,allowDots:typeof e.allowDots>"u"?Ti.allowDots:!!e.allowDots,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Ti.charsetSentinel,delimiter:typeof e.delimiter>"u"?Ti.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:Ti.encode,encoder:typeof e.encoder=="function"?e.encoder:Ti.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:Ti.encodeValuesOnly,filter:s,format:i,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:Ti.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:Ti.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Ti.strictNullHandling}},HG=function(n,e){var t=n,i=GG(e),r,s;typeof i.filter=="function"?(s=i.filter,t=s("",t)):_o(i.filter)&&(s=i.filter,r=s);var o=[];if(typeof t!="object"||t===null)return"";var a;e&&e.arrayFormat in nC?a=e.arrayFormat:e&&"indices"in e?a=e.indices?"indices":"repeat":a="indices";var l=nC[a];if(e&&"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var u=l==="comma"&&e&&e.commaRoundTrip;r||(r=Object.keys(t)),i.sort&&r.sort(i.sort);for(var d=KI(),f=0;f<r.length;++f){var p=r[f];i.skipNulls&&t[p]===null||ZI(o,zG(t[p],p,l,u,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,d))}var m=o.join(i.delimiter),v=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?v+="utf8=%26%2310003%3B&":v+="utf8=%E2%9C%93&"),m.length>0?v+m:""},Yc=qI,g1=Object.prototype.hasOwnProperty,VG=Array.isArray,Zn={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:Yc.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},WG=function(n){return n.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},QI=function(n,e){return n&&typeof n=="string"&&e.comma&&n.indexOf(",")>-1?n.split(","):n},XG="utf8=%26%2310003%3B",jG="utf8=%E2%9C%93",$G=function(e,t){var i={__proto__:null},r=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,s=t.parameterLimit===1/0?void 0:t.parameterLimit,o=r.split(t.delimiter,s),a=-1,l,u=t.charset;if(t.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===jG?u="utf-8":o[l]===XG&&(u="iso-8859-1"),a=l,l=o.length);for(l=0;l<o.length;++l)if(l!==a){var d=o[l],f=d.indexOf("]="),p=f===-1?d.indexOf("="):f+1,m,v;p===-1?(m=t.decoder(d,Zn.decoder,u,"key"),v=t.strictNullHandling?null:""):(m=t.decoder(d.slice(0,p),Zn.decoder,u,"key"),v=Yc.maybeMap(QI(d.slice(p+1),t),function(x){return t.decoder(x,Zn.decoder,u,"value")})),v&&t.interpretNumericEntities&&u==="iso-8859-1"&&(v=WG(v)),d.indexOf("[]=")>-1&&(v=VG(v)?[v]:v),g1.call(i,m)?i[m]=Yc.combine(i[m],v):i[m]=v}return i},YG=function(n,e,t,i){for(var r=i?e:QI(e,t),s=n.length-1;s>=0;--s){var o,a=n[s];if(a==="[]"&&t.parseArrays)o=[].concat(r);else{o=t.plainObjects?Object.create(null):{};var l=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,u=parseInt(l,10);!t.parseArrays&&l===""?o={0:r}:!isNaN(u)&&a!==l&&String(u)===l&&u>=0&&t.parseArrays&&u<=t.arrayLimit?(o=[],o[u]=r):l!=="__proto__"&&(o[l]=r)}r=o}return r},qG=function(e,t,i,r){if(e){var s=i.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,l=i.depth>0&&o.exec(s),u=l?s.slice(0,l.index):s,d=[];if(u){if(!i.plainObjects&&g1.call(Object.prototype,u)&&!i.allowPrototypes)return;d.push(u)}for(var f=0;i.depth>0&&(l=a.exec(s))!==null&&f<i.depth;){if(f+=1,!i.plainObjects&&g1.call(Object.prototype,l[1].slice(1,-1))&&!i.allowPrototypes)return;d.push(l[1])}return l&&d.push("["+s.slice(l.index)+"]"),YG(d,t,i,r)}},KG=function(e){if(!e)return Zn;if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=typeof e.charset>"u"?Zn.charset:e.charset;return{allowDots:typeof e.allowDots>"u"?Zn.allowDots:!!e.allowDots,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:Zn.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:Zn.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:Zn.arrayLimit,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:Zn.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:Zn.comma,decoder:typeof e.decoder=="function"?e.decoder:Zn.decoder,delimiter:typeof e.delimiter=="string"||Yc.isRegExp(e.delimiter)?e.delimiter:Zn.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:Zn.depth,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:Zn.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:Zn.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:Zn.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:Zn.strictNullHandling}},ZG=function(n,e){var t=KG(e);if(n===""||n===null||typeof n>"u")return t.plainObjects?Object.create(null):{};for(var i=typeof n=="string"?$G(n,t):n,r=t.plainObjects?Object.create(null):{},s=Object.keys(i),o=0;o<s.length;++o){var a=s[o],l=qG(a,i[a],t,typeof n=="string");r=Yc.merge(r,l,t)}return t.allowSparse===!0?r:Yc.compact(r)},QG=HG,JG=ZG,eH=ME,tH={formats:eH,parse:JG,stringify:QG},nH=$6;function Ro(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var iH=/^([a-z0-9.+-]+:)/i,rH=/:[0-9]*$/,sH=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,oH=["<",">",'"',"`"," ","\r",`
`,"	"],aH=["{","}","|","\\","^","`"].concat(oH),_1=["'"].concat(aH),rC=["%","/","?",";","#"].concat(_1),sC=["/","?","#"],lH=255,oC=/^[+a-z0-9A-Z_-]{0,63}$/,uH=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,cH={javascript:!0,"javascript:":!0},v1={javascript:!0,"javascript:":!0},bc={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y1=tH;function hH(n,e,t){if(n&&typeof n=="object"&&n instanceof Ro)return n;var i=new Ro;return i.parse(n,e,t),i}Ro.prototype.parse=function(n,e,t){if(typeof n!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof n);var i=n.indexOf("?"),r=i!==-1&&i<n.indexOf("#")?"?":"#",s=n.split(r),o=/\\/g;s[0]=s[0].replace(o,"/"),n=s.join(r);var a=n;if(a=a.trim(),!t&&n.split("#").length===1){var l=sH.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=y1.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var u=iH.exec(a);if(u){u=u[0];var d=u.toLowerCase();this.protocol=d,a=a.substr(u.length)}if(t||u||a.match(/^\/\/[^@/]+@[^@/]+/)){var f=a.substr(0,2)==="//";f&&!(u&&v1[u])&&(a=a.substr(2),this.slashes=!0)}if(!v1[u]&&(f||u&&!bc[u])){for(var p=-1,m=0;m<sC.length;m++){var v=a.indexOf(sC[m]);v!==-1&&(p===-1||v<p)&&(p=v)}var x,y;p===-1?y=a.lastIndexOf("@"):y=a.lastIndexOf("@",p),y!==-1&&(x=a.slice(0,y),a=a.slice(y+1),this.auth=decodeURIComponent(x)),p=-1;for(var m=0;m<rC.length;m++){var v=a.indexOf(rC[m]);v!==-1&&(p===-1||v<p)&&(p=v)}p===-1&&(p=a.length),this.host=a.slice(0,p),a=a.slice(p),this.parseHost(),this.hostname=this.hostname||"";var g=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!g)for(var T=this.hostname.split(/\./),m=0,S=T.length;m<S;m++){var w=T[m];if(w&&!w.match(oC)){for(var M="",P=0,R=w.length;P<R;P++)w.charCodeAt(P)>127?M+="x":M+=w[P];if(!M.match(oC)){var D=T.slice(0,m),C=T.slice(m+1),L=w.match(uH);L&&(D.push(L[1]),C.unshift(L[2])),C.length&&(a="/"+C.join(".")+a),this.hostname=D.join(".");break}}}this.hostname.length>lH?this.hostname="":this.hostname=this.hostname.toLowerCase(),g||(this.hostname=nH.toASCII(this.hostname));var Z=this.port?":"+this.port:"",V=this.hostname||"";this.host=V+Z,this.href+=this.host,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!cH[d])for(var m=0,S=_1.length;m<S;m++){var z=_1[m];if(a.indexOf(z)!==-1){var F=encodeURIComponent(z);F===z&&(F=escape(z)),a=a.split(z).join(F)}}var j=a.indexOf("#");j!==-1&&(this.hash=a.substr(j),a=a.slice(0,j));var Q=a.indexOf("?");if(Q!==-1?(this.search=a.substr(Q),this.query=a.substr(Q+1),e&&(this.query=y1.parse(this.query)),a=a.slice(0,Q)):e&&(this.search="",this.query={}),a&&(this.pathname=a),bc[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var Z=this.pathname||"",$=this.search||"";this.path=Z+$}return this.href=this.format(),this};Ro.prototype.format=function(){var n=this.auth||"";n&&(n=encodeURIComponent(n),n=n.replace(/%3A/i,":"),n+="@");var e=this.protocol||"",t=this.pathname||"",i=this.hash||"",r=!1,s="";this.host?r=n+this.host:this.hostname&&(r=n+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=y1.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||bc[e])&&r!==!1?(r="//"+(r||""),t&&t.charAt(0)!=="/"&&(t="/"+t)):r||(r=""),i&&i.charAt(0)!=="#"&&(i="#"+i),o&&o.charAt(0)!=="?"&&(o="?"+o),t=t.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+r+t+o+i};Ro.prototype.resolve=function(n){return this.resolveObject(hH(n,!1,!0)).format()};Ro.prototype.resolveObject=function(n){if(typeof n=="string"){var e=new Ro;e.parse(n,!1,!0),n=e}for(var t=new Ro,i=Object.keys(this),r=0;r<i.length;r++){var s=i[r];t[s]=this[s]}if(t.hash=n.hash,n.href==="")return t.href=t.format(),t;if(n.slashes&&!n.protocol){for(var o=Object.keys(n),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(t[l]=n[l])}return bc[t.protocol]&&t.hostname&&!t.pathname&&(t.pathname="/",t.path=t.pathname),t.href=t.format(),t}if(n.protocol&&n.protocol!==t.protocol){if(!bc[n.protocol]){for(var u=Object.keys(n),d=0;d<u.length;d++){var f=u[d];t[f]=n[f]}return t.href=t.format(),t}if(t.protocol=n.protocol,!n.host&&!v1[n.protocol]){for(var S=(n.pathname||"").split("/");S.length&&!(n.host=S.shift()););n.host||(n.host=""),n.hostname||(n.hostname=""),S[0]!==""&&S.unshift(""),S.length<2&&S.unshift(""),t.pathname=S.join("/")}else t.pathname=n.pathname;if(t.search=n.search,t.query=n.query,t.host=n.host||"",t.auth=n.auth,t.hostname=n.hostname||n.host,t.port=n.port,t.pathname||t.search){var p=t.pathname||"",m=t.search||"";t.path=p+m}return t.slashes=t.slashes||n.slashes,t.href=t.format(),t}var v=t.pathname&&t.pathname.charAt(0)==="/",x=n.host||n.pathname&&n.pathname.charAt(0)==="/",y=x||v||t.host&&n.pathname,g=y,T=t.pathname&&t.pathname.split("/")||[],S=n.pathname&&n.pathname.split("/")||[],w=t.protocol&&!bc[t.protocol];if(w&&(t.hostname="",t.port=null,t.host&&(T[0]===""?T[0]=t.host:T.unshift(t.host)),t.host="",n.protocol&&(n.hostname=null,n.port=null,n.host&&(S[0]===""?S[0]=n.host:S.unshift(n.host)),n.host=null),y=y&&(S[0]===""||T[0]==="")),x)t.host=n.host||n.host===""?n.host:t.host,t.hostname=n.hostname||n.hostname===""?n.hostname:t.hostname,t.search=n.search,t.query=n.query,T=S;else if(S.length)T||(T=[]),T.pop(),T=T.concat(S),t.search=n.search,t.query=n.query;else if(n.search!=null){if(w){t.host=T.shift(),t.hostname=t.host;var M=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;M&&(t.auth=M.shift(),t.hostname=M.shift(),t.host=t.hostname)}return t.search=n.search,t.query=n.query,(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t}if(!T.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;for(var P=T.slice(-1)[0],R=(t.host||n.host||T.length>1)&&(P==="."||P==="..")||P==="",D=0,C=T.length;C>=0;C--)P=T[C],P==="."?T.splice(C,1):P===".."?(T.splice(C,1),D++):D&&(T.splice(C,1),D--);if(!y&&!g)for(;D--;D)T.unshift("..");y&&T[0]!==""&&(!T[0]||T[0].charAt(0)!=="/")&&T.unshift(""),R&&T.join("/").substr(-1)!=="/"&&T.push("");var L=T[0]===""||T[0]&&T[0].charAt(0)==="/";if(w){t.hostname=L?"":T.length?T.shift():"",t.host=t.hostname;var M=t.host&&t.host.indexOf("@")>0?t.host.split("@"):!1;M&&(t.auth=M.shift(),t.hostname=M.shift(),t.host=t.hostname)}return y=y||t.host&&T.length,y&&!L&&T.unshift(""),T.length>0?t.pathname=T.join("/"):(t.pathname=null,t.path=null),(t.pathname!==null||t.search!==null)&&(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=n.auth||t.auth,t.slashes=t.slashes||n.slashes,t.href=t.format(),t};Ro.prototype.parseHost=function(){var n=this.host,e=rH.exec(n);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),n=n.substr(0,n.length-e.length)),n&&(this.hostname=n)};const aC={};function Pt(n,e,t=3){if(aC[e])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${n}`):(i=i.split(`
`).splice(t).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}
Deprecated since v${n}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}
Deprecated since v${n}`),console.warn(i))),aC[e]=!0}function Yr(n){if(typeof n!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(n)}`)}function Vh(n){return n.split("?")[0].split("#")[0]}function dH(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function fH(n,e,t){return n.replace(new RegExp(dH(e),"g"),t)}function pH(n,e){let t="",i=0,r=-1,s=0,o=-1;for(let a=0;a<=n.length;++a){if(a<n.length)o=n.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||s===1))if(r!==a-1&&s===2){if(t.length<2||i!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){const l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",i=0):(t=t.slice(0,l),i=t.length-1-t.lastIndexOf("/")),r=a,s=0;continue}}else if(t.length===2||t.length===1){t="",i=0,r=a,s=0;continue}}e&&(t.length>0?t+="/..":t="..",i=2)}else t.length>0?t+=`/${n.slice(r+1,a)}`:t=n.slice(r+1,a),i=a-r-1;r=a,s=0}else o===46&&s!==-1?++s:s=-1}return t}const Gn={toPosix(n){return fH(n,"\\","/")},isUrl(n){return/^https?:/.test(this.toPosix(n))},isDataUrl(n){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(n)},isBlobUrl(n){return n.startsWith("blob:")},hasProtocol(n){return/^[^/:]+:/.test(this.toPosix(n))},getProtocol(n){Yr(n),n=this.toPosix(n);const e=/^file:\/\/\//.exec(n);if(e)return e[0];const t=/^[^/:]+:\/{0,2}/.exec(n);return t?t[0]:""},toAbsolute(n,e,t){if(Yr(n),this.isDataUrl(n)||this.isBlobUrl(n))return n;const i=Vh(this.toPosix(e??Fe.ADAPTER.getBaseUrl())),r=Vh(this.toPosix(t??this.rootname(i)));return n=this.toPosix(n),n.startsWith("/")?Gn.join(r,n.slice(1)):this.isAbsolute(n)?n:this.join(i,n)},normalize(n){if(Yr(n),n.length===0)return".";if(this.isDataUrl(n)||this.isBlobUrl(n))return n;n=this.toPosix(n);let e="";const t=n.startsWith("/");this.hasProtocol(n)&&(e=this.rootname(n),n=n.slice(e.length));const i=n.endsWith("/");return n=pH(n,!1),n.length>0&&i&&(n+="/"),t?`/${n}`:e+n},isAbsolute(n){return Yr(n),n=this.toPosix(n),this.hasProtocol(n)?!0:n.startsWith("/")},join(...n){if(n.length===0)return".";let e;for(let t=0;t<n.length;++t){const i=n[t];if(Yr(i),i.length>0)if(e===void 0)e=i;else{const r=n[t-1]??"";this.joinExtensions.includes(this.extname(r).toLowerCase())?e+=`/../${i}`:e+=`/${i}`}}return e===void 0?".":this.normalize(e)},dirname(n){if(Yr(n),n.length===0)return".";n=this.toPosix(n);let e=n.charCodeAt(0);const t=e===47;let i=-1,r=!0;const s=this.getProtocol(n),o=n;n=n.slice(s.length);for(let a=n.length-1;a>=1;--a)if(e=n.charCodeAt(a),e===47){if(!r){i=a;break}}else r=!1;return i===-1?t?"/":this.isUrl(o)?s+n:s:t&&i===1?"//":s+n.slice(0,i)},rootname(n){Yr(n),n=this.toPosix(n);let e="";if(n.startsWith("/")?e="/":e=this.getProtocol(n),this.isUrl(n)){const t=n.indexOf("/",e.length);t!==-1?e=n.slice(0,t):e=n,e.endsWith("/")||(e+="/")}return e},basename(n,e){Yr(n),e&&Yr(e),n=Vh(this.toPosix(n));let t=0,i=-1,r=!0,s;if(e!==void 0&&e.length>0&&e.length<=n.length){if(e.length===n.length&&e===n)return"";let o=e.length-1,a=-1;for(s=n.length-1;s>=0;--s){const l=n.charCodeAt(s);if(l===47){if(!r){t=s+1;break}}else a===-1&&(r=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=n.length),n.slice(t,i)}for(s=n.length-1;s>=0;--s)if(n.charCodeAt(s)===47){if(!r){t=s+1;break}}else i===-1&&(r=!1,i=s+1);return i===-1?"":n.slice(t,i)},extname(n){Yr(n),n=Vh(this.toPosix(n));let e=-1,t=0,i=-1,r=!0,s=0;for(let o=n.length-1;o>=0;--o){const a=n.charCodeAt(o);if(a===47){if(!r){t=o+1;break}continue}i===-1&&(r=!1,i=o+1),a===46?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||i===-1||s===0||s===1&&e===i-1&&e===t+1?"":n.slice(e,i)},parse(n){Yr(n);const e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;n=Vh(this.toPosix(n));let t=n.charCodeAt(0);const i=this.isAbsolute(n);let r;e.root=this.rootname(n),i||this.hasProtocol(n)?r=1:r=0;let s=-1,o=0,a=-1,l=!0,u=n.length-1,d=0;for(;u>=r;--u){if(t=n.charCodeAt(u),t===47){if(!l){o=u+1;break}continue}a===-1&&(l=!1,a=u+1),t===46?s===-1?s=u:d!==1&&(d=1):s!==-1&&(d=-1)}return s===-1||a===-1||d===0||d===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&i?e.base=e.name=n.slice(1,a):e.base=e.name=n.slice(o,a)):(o===0&&i?(e.name=n.slice(1,s),e.base=n.slice(1,a)):(e.name=n.slice(o,s),e.base=n.slice(o,a)),e.ext=n.slice(s,a)),e.dir=this.dirname(n),e},sep:"/",delimiter:":",joinExtensions:[".html"]};let gy;async function mH(){return gy??(gy=(async()=>{var s;const n=document.createElement("canvas").getContext("webgl");if(!n)return ji.UNPACK;const e=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!e)return ji.UNPACK;const t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t);const i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e);const r=new Uint8Array(4);return n.readPixels(0,0,1,1,n.RGBA,n.UNSIGNED_BYTE,r),n.deleteFramebuffer(i),n.deleteTexture(t),(s=n.getExtension("WEBGL_lose_context"))==null||s.loseContext(),r[0]<=r[3]?ji.PMA:ji.UNPACK})()),gy}let _y;function gH(){return typeof _y>"u"&&(_y=function(){var e;const n={stencil:!0,failIfMajorPerformanceCaveat:Fe.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!Fe.ADAPTER.getWebGLRenderingContext())return!1;const t=Fe.ADAPTER.createCanvas();let i=t.getContext("webgl",n)||t.getContext("experimental-webgl",n);const r=!!((e=i==null?void 0:i.getContextAttributes())!=null&&e.stencil);if(i){const s=i.getExtension("WEBGL_lose_context");s&&s.loseContext()}return i=null,r}catch{return!1}}()),_y}var _H={grad:.9,turn:360,rad:360/(2*Math.PI)},co=function(n){return typeof n=="string"?n.length>0:typeof n=="number"},ei=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*n)/t+0},Fr=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),n>t?t:n>e?n:e},JI=function(n){return(n=isFinite(n)?n%360:0)>0?n:n+360},lC=function(n){return{r:Fr(n.r,0,255),g:Fr(n.g,0,255),b:Fr(n.b,0,255),a:Fr(n.a)}},vy=function(n){return{r:ei(n.r),g:ei(n.g),b:ei(n.b),a:ei(n.a,3)}},vH=/^#([0-9a-f]{3,8})$/i,nm=function(n){var e=n.toString(16);return e.length<2?"0"+e:e},eL=function(n){var e=n.r,t=n.g,i=n.b,r=n.a,s=Math.max(e,t,i),o=s-Math.min(e,t,i),a=o?s===e?(t-i)/o:s===t?2+(i-e)/o:4+(e-t)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:r}},tL=function(n){var e=n.h,t=n.s,i=n.v,r=n.a;e=e/360*6,t/=100,i/=100;var s=Math.floor(e),o=i*(1-t),a=i*(1-(e-s)*t),l=i*(1-(1-e+s)*t),u=s%6;return{r:255*[i,a,o,o,l,i][u],g:255*[l,i,i,a,o,o][u],b:255*[o,o,l,i,i,a][u],a:r}},uC=function(n){return{h:JI(n.h),s:Fr(n.s,0,100),l:Fr(n.l,0,100),a:Fr(n.a)}},cC=function(n){return{h:ei(n.h),s:ei(n.s),l:ei(n.l),a:ei(n.a,3)}},hC=function(n){return tL((t=(e=n).s,{h:e.h,s:(t*=((i=e.l)<50?i:100-i)/100)>0?2*t/(i+t)*100:0,v:i+t,a:e.a}));var e,t,i},wd=function(n){return{h:(e=eL(n)).h,s:(r=(200-(t=e.s))*(i=e.v)/100)>0&&r<200?t*i/100/(r<=100?r:200-r)*100:0,l:r/2,a:e.a};var e,t,i,r},yH=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,xH=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,SH=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,EH=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,x1={string:[[function(n){var e=vH.exec(n);return e?(n=e[1]).length<=4?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:n.length===4?ei(parseInt(n[3]+n[3],16)/255,2):1}:n.length===6||n.length===8?{r:parseInt(n.substr(0,2),16),g:parseInt(n.substr(2,2),16),b:parseInt(n.substr(4,2),16),a:n.length===8?ei(parseInt(n.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(n){var e=SH.exec(n)||EH.exec(n);return e?e[2]!==e[4]||e[4]!==e[6]?null:lC({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(n){var e=yH.exec(n)||xH.exec(n);if(!e)return null;var t,i,r=uC({h:(t=e[1],i=e[2],i===void 0&&(i="deg"),Number(t)*(_H[i]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return hC(r)},"hsl"]],object:[[function(n){var e=n.r,t=n.g,i=n.b,r=n.a,s=r===void 0?1:r;return co(e)&&co(t)&&co(i)?lC({r:Number(e),g:Number(t),b:Number(i),a:Number(s)}):null},"rgb"],[function(n){var e=n.h,t=n.s,i=n.l,r=n.a,s=r===void 0?1:r;if(!co(e)||!co(t)||!co(i))return null;var o=uC({h:Number(e),s:Number(t),l:Number(i),a:Number(s)});return hC(o)},"hsl"],[function(n){var e=n.h,t=n.s,i=n.v,r=n.a,s=r===void 0?1:r;if(!co(e)||!co(t)||!co(i))return null;var o=function(a){return{h:JI(a.h),s:Fr(a.s,0,100),v:Fr(a.v,0,100),a:Fr(a.a)}}({h:Number(e),s:Number(t),v:Number(i),a:Number(s)});return tL(o)},"hsv"]]},dC=function(n,e){for(var t=0;t<e.length;t++){var i=e[t][0](n);if(i)return[i,e[t][1]]}return[null,void 0]},TH=function(n){return typeof n=="string"?dC(n.trim(),x1.string):typeof n=="object"&&n!==null?dC(n,x1.object):[null,void 0]},yy=function(n,e){var t=wd(n);return{h:t.h,s:Fr(t.s+100*e,0,100),l:t.l,a:t.a}},xy=function(n){return(299*n.r+587*n.g+114*n.b)/1e3/255},fC=function(n,e){var t=wd(n);return{h:t.h,s:t.s,l:Fr(t.l+100*e,0,100),a:t.a}},S1=function(){function n(e){this.parsed=TH(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return n.prototype.isValid=function(){return this.parsed!==null},n.prototype.brightness=function(){return ei(xy(this.rgba),2)},n.prototype.isDark=function(){return xy(this.rgba)<.5},n.prototype.isLight=function(){return xy(this.rgba)>=.5},n.prototype.toHex=function(){return e=vy(this.rgba),t=e.r,i=e.g,r=e.b,o=(s=e.a)<1?nm(ei(255*s)):"","#"+nm(t)+nm(i)+nm(r)+o;var e,t,i,r,s,o},n.prototype.toRgb=function(){return vy(this.rgba)},n.prototype.toRgbString=function(){return e=vy(this.rgba),t=e.r,i=e.g,r=e.b,(s=e.a)<1?"rgba("+t+", "+i+", "+r+", "+s+")":"rgb("+t+", "+i+", "+r+")";var e,t,i,r,s},n.prototype.toHsl=function(){return cC(wd(this.rgba))},n.prototype.toHslString=function(){return e=cC(wd(this.rgba)),t=e.h,i=e.s,r=e.l,(s=e.a)<1?"hsla("+t+", "+i+"%, "+r+"%, "+s+")":"hsl("+t+", "+i+"%, "+r+"%)";var e,t,i,r,s},n.prototype.toHsv=function(){return e=eL(this.rgba),{h:ei(e.h),s:ei(e.s),v:ei(e.v),a:ei(e.a,3)};var e},n.prototype.invert=function(){return As({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},n.prototype.saturate=function(e){return e===void 0&&(e=.1),As(yy(this.rgba,e))},n.prototype.desaturate=function(e){return e===void 0&&(e=.1),As(yy(this.rgba,-e))},n.prototype.grayscale=function(){return As(yy(this.rgba,-1))},n.prototype.lighten=function(e){return e===void 0&&(e=.1),As(fC(this.rgba,e))},n.prototype.darken=function(e){return e===void 0&&(e=.1),As(fC(this.rgba,-e))},n.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},n.prototype.alpha=function(e){return typeof e=="number"?As({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):ei(this.rgba.a,3);var t},n.prototype.hue=function(e){var t=wd(this.rgba);return typeof e=="number"?As({h:e,s:t.s,l:t.l,a:t.a}):ei(t.h)},n.prototype.isEqual=function(e){return this.toHex()===As(e).toHex()},n}(),As=function(n){return n instanceof S1?n:new S1(n)},pC=[],bH=function(n){n.forEach(function(e){pC.indexOf(e)<0&&(e(S1,x1),pC.push(e))})};function wH(n,e){var t={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var r in t)i[t[r]]=r;var s={};n.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,u=i[this.toHex()];if(u)return u;if(o!=null&&o.closest){var d=this.toRgb(),f=1/0,p="black";if(!s.length)for(var m in t)s[m]=new n(t[m]).toRgb();for(var v in t){var x=(a=d,l=s[v],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));x<f&&(f=x,p=v)}return p}},e.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":t[a];return l?new n(l).toRgb():null},"name"])}bH([wH]);const Vu=class $m{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof $m)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,t){const i=typeof e;if(i!==typeof t)return!1;if(i==="number"||i==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((r,s)=>r===t[s]);if(e!==null&&t!==null){const r=Object.keys(e),s=Object.keys(t);return r.length!==s.length?!1:r.every(o=>e[o]===t[o])}return e===t}toRgba(){const[e,t,i,r]=this._components;return{r:e,g:t,b:i,a:r}}toRgb(){const[e,t,i]=this._components;return{r:e,g:t,b:i}}toRgbaString(){const[e,t,i]=this.toUint8RgbArray();return`rgba(${e},${t},${i},${this.alpha})`}toUint8RgbArray(e){const[t,i,r]=this._components;return e=e??[],e[0]=Math.round(t*255),e[1]=Math.round(i*255),e[2]=Math.round(r*255),e}toRgbArray(e){e=e??[];const[t,i,r]=this._components;return e[0]=t,e[1]=i,e[2]=r,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[t,i,r,s]=$m.temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=i,this._components[2]*=r,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(e===1)return(255<<24)+this._int;if(e===0)return t?0:this._int;let i=this._int>>16&255,r=this._int>>8&255,s=this._int&255;return t&&(i=i*e+.5|0,r=r*e+.5|0,s=s*e+.5|0),(e*255<<24)+(i<<16)+(r<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[t,i,r]=this._components;return this._components[0]=Math.round(t*e)/e,this._components[1]=Math.round(i*e)/e,this._components[2]=Math.round(r*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[t,i,r,s]=this._components;return e[0]=t,e[1]=i,e[2]=r,e[3]=s,e}normalize(e){let t,i,r,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const o=e;t=(o>>16&255)/255,i=(o>>8&255)/255,r=(o&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[t,i,r,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[t,i,r,s=255]=e,t/=255,i/=255,r/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const a=$m.HEX_PATTERN.exec(e);a&&(e=`#${a[2]}`)}const o=As(e);o.isValid()&&({r:t,g:i,b:r,a:s}=o.rgba,t/=255,i/=255,r/=255)}if(t!==void 0)this._components[0]=t,this._components[1]=i,this._components[2]=r,this._components[3]=s,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,t,i]=this._components;this._int=(e*255<<16)+(t*255<<8)+(i*255|0)}_clamp(e,t=0,i=1){return typeof e=="number"?Math.min(Math.max(e,t),i):(e.forEach((r,s)=>{e[s]=Math.min(Math.max(r,t),i)}),e)}};Vu.shared=new Vu,Vu.temp=new Vu,Vu.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let en=Vu;function AH(n){return Pt("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),en.shared.setValue(n).toHex()}function MH(n){return Pt("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),en.shared.setValue(n).toNumber()}function CH(){const n=[],e=[];for(let i=0;i<32;i++)n[i]=i,e[i]=i;n[rt.NORMAL_NPM]=rt.NORMAL,n[rt.ADD_NPM]=rt.ADD,n[rt.SCREEN_NPM]=rt.SCREEN,e[rt.NORMAL]=rt.NORMAL_NPM,e[rt.ADD]=rt.ADD_NPM,e[rt.SCREEN]=rt.SCREEN_NPM;const t=[];return t.push(e),t.push(n),t}const nL=CH();function iL(n,e){return nL[e?1:0][n]}function RH(n,e=null){const t=n*6;if(e=e||new Uint16Array(t),e.length!==t)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${t}`);for(let i=0,r=0;i<t;i+=6,r+=4)e[i+0]=r+0,e[i+1]=r+1,e[i+2]=r+2,e[i+3]=r+0,e[i+4]=r+2,e[i+5]=r+3;return e}function rL(n){if(n.BYTES_PER_ELEMENT===4)return n instanceof Float32Array?"Float32Array":n instanceof Uint32Array?"Uint32Array":"Int32Array";if(n.BYTES_PER_ELEMENT===2){if(n instanceof Uint16Array)return"Uint16Array"}else if(n.BYTES_PER_ELEMENT===1&&n instanceof Uint8Array)return"Uint8Array";return null}function kg(n){return n+=n===0?1:0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n+1}function mC(n){return!(n&n-1)&&!!n}function gC(n){let e=(n>65535?1:0)<<4;n>>>=e;let t=(n>255?1:0)<<3;return n>>>=t,e|=t,t=(n>15?1:0)<<2,n>>>=t,e|=t,t=(n>3?1:0)<<1,n>>>=t,e|=t,e|n>>1}function wc(n,e,t){const i=n.length;let r;if(e>=i||t===0)return;t=e+t>i?i-e:t;const s=i-t;for(r=e;r<s;++r)n[r]=n[r+t];n.length=s}function _a(n){return n===0?0:n<0?-1:1}let PH=0;function Yl(){return++PH}const E1=class{constructor(n,e,t,i){this.left=n,this.top=e,this.right=t,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};E1.EMPTY=new E1(0,0,0,0);let _C=E1;const vC={},Ms=Object.create(null),na=Object.create(null);class IH{constructor(e,t,i){this._canvas=Fe.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||Fe.RESOLUTION,this.resize(e,t)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,t){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(t*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function yC(n,e,t){for(let i=0,r=4*t*e;i<e;++i,r+=4)if(n[r+3]!==0)return!1;return!0}function xC(n,e,t,i,r){const s=4*e;for(let o=i,a=i*s+4*t;o<=r;++o,a+=s)if(n[a+3]!==0)return!1;return!0}function LH(n){const{width:e,height:t}=n,i=n.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");const r=i.getImageData(0,0,e,t).data;let s=0,o=0,a=e-1,l=t-1;for(;o<t&&yC(r,e,o);)++o;if(o===t)return _C.EMPTY;for(;yC(r,e,l);)--l;for(;xC(r,e,s,o,l);)++s;for(;xC(r,e,a,o,l);)--a;return++a,++l,new _C(s,o,a,l)}function DH(n){const e=LH(n),{width:t,height:i}=e;let r=null;if(!e.isEmpty()){const s=n.getContext("2d");if(s===null)throw new TypeError("Failed to get canvas 2D context");r=s.getImageData(e.left,e.top,t,i)}return{width:t,height:i,data:r}}function NH(n,e=globalThis.location){if(n.startsWith("data:"))return"";e=e||globalThis.location;const t=new URL(n,document.baseURI);return t.hostname!==e.hostname||t.port!==e.port||t.protocol!==e.protocol?"anonymous":""}function Uo(n,e=1){var i;const t=(i=Fe.RETINA_PREFIX)==null?void 0:i.exec(n);return t?parseFloat(t[1]):e}var Ne=(n=>(n.Renderer="renderer",n.Application="application",n.RendererSystem="renderer-webgl-system",n.RendererPlugin="renderer-webgl-plugin",n.CanvasRendererSystem="renderer-canvas-system",n.CanvasRendererPlugin="renderer-canvas-plugin",n.Asset="asset",n.LoadParser="load-parser",n.ResolveParser="resolve-parser",n.CacheParser="cache-parser",n.DetectionParser="detection-parser",n))(Ne||{});const T1=n=>{if(typeof n=="function"||typeof n=="object"&&n.extension){if(!n.extension)throw new Error("Extension class must have an extension object");n={...typeof n.extension!="object"?{type:n.extension}:n.extension,ref:n}}if(typeof n=="object")n={...n};else throw new Error("Invalid extension type");return typeof n.type=="string"&&(n.type=[n.type]),n},SC=(n,e)=>T1(n).priority??e,$e={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...n){return n.map(T1).forEach(e=>{e.type.forEach(t=>{var i,r;return(r=(i=this._removeHandlers)[t])==null?void 0:r.call(i,e)})}),this},add(...n){return n.map(T1).forEach(e=>{e.type.forEach(t=>{const i=this._addHandlers,r=this._queue;i[t]?i[t](e):(r[t]=r[t]||[],r[t].push(e))})}),this},handle(n,e,t){const i=this._addHandlers,r=this._removeHandlers;if(i[n]||r[n])throw new Error(`Extension type ${n} already has a handler`);i[n]=e,r[n]=t;const s=this._queue;return s[n]&&(s[n].forEach(o=>e(o)),delete s[n]),this},handleByMap(n,e){return this.handle(n,t=>{e[t.name]=t.ref},t=>{delete e[t.name]})},handleByList(n,e,t=-1){return this.handle(n,i=>{e.includes(i.ref)||(e.push(i.ref),e.sort((r,s)=>SC(s,t)-SC(r,t)))},i=>{const r=e.indexOf(i.ref);r!==-1&&e.splice(r,1)})}};class b1{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const UH=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function FH(n){let e="";for(let t=0;t<n;++t)t>0&&(e+=`
else `),t<n-1&&(e+=`if(test == ${t}.0){}`);return e}function OH(n,e){if(n===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const t=e.createShader(e.FRAGMENT_SHADER);for(;;){const i=UH.replace(/%forloop%/gi,FH(n));if(e.shaderSource(t,i),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))n=n/2|0;else break}return n}const Sy=0,Ey=1,Ty=2,by=3,wy=4,Ay=5;class Ks{constructor(){this.data=0,this.blendMode=rt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Sy)}set blend(e){!!(this.data&1<<Sy)!==e&&(this.data^=1<<Sy)}get offsets(){return!!(this.data&1<<Ey)}set offsets(e){!!(this.data&1<<Ey)!==e&&(this.data^=1<<Ey)}get culling(){return!!(this.data&1<<Ty)}set culling(e){!!(this.data&1<<Ty)!==e&&(this.data^=1<<Ty)}get depthTest(){return!!(this.data&1<<by)}set depthTest(e){!!(this.data&1<<by)!==e&&(this.data^=1<<by)}get depthMask(){return!!(this.data&1<<Ay)}set depthMask(e){!!(this.data&1<<Ay)!==e&&(this.data^=1<<Ay)}get clockwiseFrontFace(){return!!(this.data&1<<wy)}set clockwiseFrontFace(e){!!(this.data&1<<wy)!==e&&(this.data^=1<<wy)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==rt.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){const e=new Ks;return e.depthTest=!1,e.blend=!0,e}}Ks.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const w1=[];function sL(n,e){if(!n)return null;let t="";if(typeof n=="string"){const i=/\.(\w{3,4})(?:$|\?|#)/i.exec(n);i&&(t=i[1].toLowerCase())}for(let i=w1.length-1;i>=0;--i){const r=w1[i];if(r.test&&r.test(n,t))return new r(n,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class ls{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,t,i,r,s,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:u,items:d}=this;this._aliasCount++;for(let f=0,p=d.length;f<p;f++)d[f][u](e,t,i,r,s,o,a,l);return d===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return t!==-1&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(ls.prototype,{dispatch:{value:ls.prototype.emit},run:{value:ls.prototype.emit}});class Zd{constructor(e=0,t=0){this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new ls("setRealSize"),this.onUpdate=new ls("update"),this.onError=new ls("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,t,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,t){return!1}}class A0 extends Zd{constructor(e,t){const{width:i,height:r}=t||{};if(!i||!r)throw new Error("BufferResource width or height invalid");super(i,r),this.data=e,this.unpackAlignment=t.unpackAlignment??4}upload(e,t,i){const r=e.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,this.unpackAlignment),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ji.UNPACK);const s=t.realWidth,o=t.realHeight;return i.width===s&&i.height===o?r.texSubImage2D(t.target,0,0,0,s,o,t.format,i.type,this.data):(i.width=s,i.height=o,r.texImage2D(t.target,0,i.internalFormat,s,o,0,t.format,i.type,this.data)),!0}dispose(){this.data=null}static test(e){return e===null||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const kH={scaleMode:To.NEAREST,alphaMode:ji.NPM},A1=class Wu extends cf{constructor(e=null,t=null){super(),t=Object.assign({},Wu.defaultOptions,t);const{alphaMode:i,mipmap:r,anisotropicLevel:s,scaleMode:o,width:a,height:l,wrapMode:u,format:d,type:f,target:p,resolution:m,resourceOptions:v}=t;e&&!(e instanceof Zd)&&(e=sL(e,v),e.internal=!0),this.resolution=m||Fe.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=r,this.anisotropicLevel=s,this._wrapMode=u,this._scaleMode=o,this.format=d,this.type=f,this.target=p,this.alphaMode=i,this.uid=Yl(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let i;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,i=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,i=!0),i&&this.dirtyStyleId++,this}setSize(e,t,i){return i=i||this.resolution,this.setRealSize(e*i,t*i,i)}setRealSize(e,t,i){return this.resolution=i||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=mC(this.realWidth)&&mC(this.realHeight)}setResolution(e){const t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete na[this.cacheId],delete Ms[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Wu.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,t,i=Fe.STRICT_TEXTURE_CACHE){const r=typeof e=="string";let s=null;if(r)s=e;else{if(!e._pixiId){const a=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${Yl()}`}s=e._pixiId}let o=na[s];if(r&&i&&!o)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return o||(o=new Wu(e,t),o.cacheId=s,Wu.addToCache(o,s)),o}static fromBuffer(e,t,i,r){e=e||new Float32Array(t*i*4);const s=new A0(e,{width:t,height:i,...r==null?void 0:r.resourceOptions});let o,a;return e instanceof Float32Array?(o=Ee.RGBA,a=et.FLOAT):e instanceof Int32Array?(o=Ee.RGBA_INTEGER,a=et.INT):e instanceof Uint32Array?(o=Ee.RGBA_INTEGER,a=et.UNSIGNED_INT):e instanceof Int16Array?(o=Ee.RGBA_INTEGER,a=et.SHORT):e instanceof Uint16Array?(o=Ee.RGBA_INTEGER,a=et.UNSIGNED_SHORT):e instanceof Int8Array?(o=Ee.RGBA,a=et.BYTE):(o=Ee.RGBA,a=et.UNSIGNED_BYTE),s.internal=!0,new Wu(s,Object.assign({},kH,{type:a,format:o},r))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),na[t]&&na[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),na[t]=e)}static removeFromCache(e){if(typeof e=="string"){const t=na[e];if(t){const i=t.textureCacheIds.indexOf(e);return i>-1&&t.textureCacheIds.splice(i,1),delete na[e],t}}else if(e!=null&&e.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete na[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}};A1.defaultOptions={mipmap:Ws.POW2,anisotropicLevel:0,scaleMode:To.LINEAR,wrapMode:Co.CLAMP,alphaMode:ji.UNPACK,target:Ec.TEXTURE_2D,format:Ee.RGBA,type:et.UNSIGNED_BYTE},A1._globalBatch=0;let lt=A1;class M1{constructor(){this.texArray=null,this.blend=0,this.type=is.TRIANGLES,this.start=0,this.size=0,this.data=null}}let BH=0;class Cn{constructor(e,t=!0,i=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=t,this.id=BH++,this.disposeRunner=new ls("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?Hs.ELEMENT_ARRAY_BUFFER:Hs.ARRAY_BUFFER}get index(){return this.type===Hs.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new Cn(e)}}class Bg{constructor(e,t=0,i=!1,r=et.FLOAT,s,o,a,l=1){this.buffer=e,this.size=t,this.normalized=i,this.type=r,this.stride=s,this.start=o,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(e,t,i,r,s){return new Bg(e,t,i,r,s)}}const zH={Float32Array,Uint32Array,Int32Array,Uint8Array};function GH(n,e){let t=0,i=0;const r={};for(let l=0;l<n.length;l++)i+=e[l],t+=n[l].length;const s=new ArrayBuffer(t*4);let o=null,a=0;for(let l=0;l<n.length;l++){const u=e[l],d=n[l],f=rL(d);r[f]||(r[f]=new zH[f](s)),o=r[f];for(let p=0;p<d.length;p++){const m=(p/u|0)*i+a,v=p%u;o[m+v]=d[p]}a+=u}return new Float32Array(s)}const EC={5126:4,5123:2,5121:1};let HH=0;const VH={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Da{constructor(e=[],t={}){this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=HH++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ls("disposeGeometry"),this.refCount=0}addAttribute(e,t,i=0,r=!1,s,o,a,l=!1){if(!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof Cn||(t instanceof Array&&(t=new Float32Array(t)),t=new Cn(t));const u=e.split("|");if(u.length>1){for(let f=0;f<u.length;f++)this.addAttribute(u[f],t,i,r,s);return this}let d=this.buffers.indexOf(t);return d===-1&&(this.buffers.push(t),d=this.buffers.length-1),this.attributes[e]=new Bg(d,i,r,s,o,a,l),this.instanced=this.instanced||l,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof Cn||(e instanceof Array&&(e=new Uint16Array(e)),e=new Cn(e)),e.type=Hs.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const e=[],t=[],i=new Cn;let r;for(r in this.attributes){const s=this.attributes[r],o=this.buffers[s.buffer];e.push(o.data),t.push(s.size*EC[s.type]/4),s.buffer=0}for(i.data=GH(e,t),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new Da;for(let t=0;t<this.buffers.length;t++)e.buffers[t]=new Cn(this.buffers[t].data.slice(0));for(const t in this.attributes){const i=this.attributes[t];e.attributes[t]=new Bg(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=Hs.ELEMENT_ARRAY_BUFFER),e}static merge(e){const t=new Da,i=[],r=[],s=[];let o;for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)r[l]=r[l]||0,r[l]+=o.buffers[l].data.length,s[l]=0}for(let a=0;a<o.buffers.length;a++)i[a]=new VH[rL(o.buffers[a].data)](r[a]),t.buffers[a]=new Cn(i[a]);for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)i[l].set(o.buffers[l].data,s[l]),s[l]+=o.buffers[l].data.length}if(t.attributes=o.attributes,o.indexBuffer){t.indexBuffer=t.buffers[o.buffers.indexOf(o.indexBuffer)],t.indexBuffer.type=Hs.ELEMENT_ARRAY_BUFFER;let a=0,l=0,u=0,d=0;for(let f=0;f<o.buffers.length;f++)if(o.buffers[f]!==o.indexBuffer){d=f;break}for(const f in o.attributes){const p=o.attributes[f];(p.buffer|0)===d&&(l+=p.size*EC[p.type]/4)}for(let f=0;f<e.length;f++){const p=e[f].indexBuffer.data;for(let m=0;m<p.length;m++)t.indexBuffer.data[m+u]+=a;a+=e[f].buffers[d].data.length/l,u+=p.length}}return t}}class oL extends Da{constructor(e=!1){super(),this._buffer=new Cn(null,e,!1),this._indexBuffer=new Cn(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,et.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,et.FLOAT).addAttribute("aColor",this._buffer,4,!0,et.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,et.FLOAT).addIndex(this._indexBuffer)}}const zg=Math.PI*2,WH=180/Math.PI,XH=Math.PI/180;var di=(n=>(n[n.POLY=0]="POLY",n[n.RECT=1]="RECT",n[n.CIRC=2]="CIRC",n[n.ELIP=3]="ELIP",n[n.RREC=4]="RREC",n))(di||{});class Dt{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new Dt(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}}Dt.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const im=[new Dt,new Dt,new Dt,new Dt];class ut{constructor(e=0,t=0,i=0,r=0){this.x=Number(e),this.y=Number(t),this.width=Number(i),this.height=Number(r),this.type=di.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new ut(0,0,0,0)}clone(){return new ut(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}intersects(e,t){if(!t){const D=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=D)return!1;const C=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>C}const i=this.left,r=this.right,s=this.top,o=this.bottom;if(r<=i||o<=s)return!1;const a=im[0].set(e.left,e.top),l=im[1].set(e.left,e.bottom),u=im[2].set(e.right,e.top),d=im[3].set(e.right,e.bottom);if(u.x<=a.x||l.y<=a.y)return!1;const f=Math.sign(t.a*t.d-t.b*t.c);if(f===0||(t.apply(a,a),t.apply(l,l),t.apply(u,u),t.apply(d,d),Math.max(a.x,l.x,u.x,d.x)<=i||Math.min(a.x,l.x,u.x,d.x)>=r||Math.max(a.y,l.y,u.y,d.y)<=s||Math.min(a.y,l.y,u.y,d.y)>=o))return!1;const p=f*(l.y-a.y),m=f*(a.x-l.x),v=p*i+m*s,x=p*r+m*s,y=p*i+m*o,g=p*r+m*o;if(Math.max(v,x,y,g)<=p*a.x+m*a.y||Math.min(v,x,y,g)>=p*d.x+m*d.y)return!1;const T=f*(a.y-u.y),S=f*(u.x-a.x),w=T*i+S*s,M=T*r+S*s,P=T*i+S*o,R=T*r+S*o;return!(Math.max(w,M,P,R)<=T*a.x+S*a.y||Math.min(w,M,P,R)>=T*d.x+S*d.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this}fit(e){const t=Math.max(this.x,e.x),i=Math.min(this.x+this.width,e.x+e.width),r=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(i-t,0),this.y=r,this.height=Math.max(s-r,0),this}ceil(e=1,t=.001){const i=Math.ceil((this.x+this.width-t)*e)/e,r=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=i-this.x,this.height=r-this.y,this}enlarge(e){const t=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),r=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=i-t,this.y=r,this.height=s-r,this}}ut.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class M0{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.radius=i,this.type=di.CIRC}clone(){return new M0(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;const i=this.radius*this.radius;let r=this.x-e,s=this.y-t;return r*=r,s*=s,r+s<=i}getBounds(){return new ut(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}M0.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class C0{constructor(e=0,t=0,i=0,r=0){this.x=e,this.y=t,this.width=i,this.height=r,this.type=di.ELIP}clone(){return new C0(this.x,this.y,this.width,this.height)}contains(e,t){if(this.width<=0||this.height<=0)return!1;let i=(e-this.x)/this.width,r=(t-this.y)/this.height;return i*=i,r*=r,i+r<=1}getBounds(){return new ut(this.x-this.width,this.y-this.height,this.width,this.height)}}C0.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Ul{constructor(...e){let t=Array.isArray(e[0])?e[0]:e;if(typeof t[0]!="number"){const i=[];for(let r=0,s=t.length;r<s;r++)i.push(t[r].x,t[r].y);t=i}this.points=t,this.type=di.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),t=new Ul(e);return t.closeStroke=this.closeStroke,t}contains(e,t){let i=!1;const r=this.points.length/2;for(let s=0,o=r-1;s<r;o=s++){const a=this.points[s*2],l=this.points[s*2+1],u=this.points[o*2],d=this.points[o*2+1];l>t!=d>t&&e<(u-a)*((t-l)/(d-l))+a&&(i=!i)}return i}}Ul.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((n,e)=>`${n}, ${e}`,"")}]`};class R0{constructor(e=0,t=0,i=0,r=0,s=20){this.x=e,this.y=t,this.width=i,this.height=r,this.radius=s,this.type=di.RREC}clone(){return new R0(this.x,this.y,this.width,this.height,this.radius)}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+i&&t<=this.y+this.height-i||e>=this.x+i&&e<=this.x+this.width-i)return!0;let r=e-(this.x+i),s=t-(this.y+i);const o=i*i;if(r*r+s*s<=o||(r=e-(this.x+this.width-i),r*r+s*s<=o)||(s=t-(this.y+this.height-i),r*r+s*s<=o)||(r=e-(this.x+i),r*r+s*s<=o))return!0}return!1}}R0.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class an{constructor(e=1,t=0,i=0,r=1,s=0,o=0){this.array=null,this.a=e,this.b=t,this.c=i,this.d=r,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,i,r,s,o){return this.a=e,this.b=t,this.c=i,this.d=r,this.tx=s,this.ty=o,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const i=t||this.array;return e?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(e,t){t=t||new Dt;const i=e.x,r=e.y;return t.x=this.a*i+this.c*r+this.tx,t.y=this.b*i+this.d*r+this.ty,t}applyInverse(e,t){t=t||new Dt;const i=1/(this.a*this.d+this.c*-this.b),r=e.x,s=e.y;return t.x=this.d*i*r+-this.c*i*s+(this.ty*this.c-this.tx*this.d)*i,t.y=this.a*i*s+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),r=this.a,s=this.c,o=this.tx;return this.a=r*t-this.b*i,this.b=r*i+this.b*t,this.c=s*t-this.d*i,this.d=s*i+this.d*t,this.tx=o*t-this.ty*i,this.ty=o*i+this.ty*t,this}append(e){const t=this.a,i=this.b,r=this.c,s=this.d;return this.a=e.a*t+e.b*r,this.b=e.a*i+e.b*s,this.c=e.c*t+e.d*r,this.d=e.c*i+e.d*s,this.tx=e.tx*t+e.ty*r+this.tx,this.ty=e.tx*i+e.ty*s+this.ty,this}setTransform(e,t,i,r,s,o,a,l,u){return this.a=Math.cos(a+u)*s,this.b=Math.sin(a+u)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(i*this.a+r*this.c),this.ty=t-(i*this.b+r*this.d),this}prepend(e){const t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const i=this.a,r=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=r*e.a+this.d*e.c,this.d=r*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,i=this.b,r=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-r,s),l=Math.atan2(i,t),u=Math.abs(a+l);return u<1e-5||Math.abs(zg-u)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(t*t+i*i),e.scale.y=Math.sqrt(r*r+s*s),e.position.x=this.tx+(o.x*t+o.y*r),e.position.y=this.ty+(o.x*i+o.y*s),e}invert(){const e=this.a,t=this.b,i=this.c,r=this.d,s=this.tx,o=e*r-t*i;return this.a=r/o,this.b=-t/o,this.c=-i/o,this.d=e/o,this.tx=(i*this.ty-r*s)/o,this.ty=-(e*this.ty-t*s)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new an;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new an}static get TEMP_MATRIX(){return new an}}an.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const cl=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],hl=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],dl=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],fl=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],C1=[],aL=[],rm=Math.sign;function jH(){for(let n=0;n<16;n++){const e=[];C1.push(e);for(let t=0;t<16;t++){const i=rm(cl[n]*cl[t]+dl[n]*hl[t]),r=rm(hl[n]*cl[t]+fl[n]*hl[t]),s=rm(cl[n]*dl[t]+dl[n]*fl[t]),o=rm(hl[n]*dl[t]+fl[n]*fl[t]);for(let a=0;a<16;a++)if(cl[a]===i&&hl[a]===r&&dl[a]===s&&fl[a]===o){e.push(a);break}}}for(let n=0;n<16;n++){const e=new an;e.set(cl[n],hl[n],dl[n],fl[n],0,0),aL.push(e)}}jH();const pn={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:n=>cl[n],uY:n=>hl[n],vX:n=>dl[n],vY:n=>fl[n],inv:n=>n&8?n&15:-n&7,add:(n,e)=>C1[n][e],sub:(n,e)=>C1[n][pn.inv(e)],rotate180:n=>n^4,isVertical:n=>(n&3)===2,byDirection:(n,e)=>Math.abs(n)*2<=Math.abs(e)?e>=0?pn.S:pn.N:Math.abs(e)*2<=Math.abs(n)?n>0?pn.E:pn.W:e>0?n>0?pn.SE:pn.SW:n>0?pn.NE:pn.NW,matrixAppendRotationInv:(n,e,t=0,i=0)=>{const r=aL[pn.inv(e)];r.tx=t,r.ty=i,n.append(r)}};class Os{constructor(e,t,i=0,r=0){this._x=i,this._y=r,this.cb=e,this.scope=t}clone(e=this.cb,t=this.scope){return new Os(e,t,this._x,this._y)}set(e=0,t=e){return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}Os.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const R1=class{constructor(){this.worldTransform=new an,this.localTransform=new an,this.position=new Os(this.onChange,this,0,0),this.scale=new Os(this.onChange,this,1,1),this.pivot=new Os(this.onChange,this,0,0),this.skew=new Os(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const n=this.localTransform;this._localID!==this._currentLocalID&&(n.a=this._cx*this.scale.x,n.b=this._sx*this.scale.x,n.c=this._cy*this.scale.y,n.d=this._sy*this.scale.y,n.tx=this.position.x-(this.pivot.x*n.a+this.pivot.y*n.c),n.ty=this.position.y-(this.pivot.x*n.b+this.pivot.y*n.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(n){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==n._worldID){const t=n.worldTransform,i=this.worldTransform;i.a=e.a*t.a+e.b*t.c,i.b=e.a*t.b+e.b*t.d,i.c=e.c*t.a+e.d*t.c,i.d=e.c*t.b+e.d*t.d,i.tx=e.tx*t.a+e.ty*t.c+t.tx,i.ty=e.tx*t.b+e.ty*t.d+t.ty,this._parentID=n._worldID,this._worldID++}}setFromMatrix(n){n.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(n){this._rotation!==n&&(this._rotation=n,this.updateSkew())}};R1.IDENTITY=new R1;let P0=R1;P0.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var $H=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,YH=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function TC(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}function My(n){const e=new Array(n);for(let t=0;t<e.length;t++)e[t]=!1;return e}function lL(n,e){switch(n){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return My(2*e);case"bvec3":return My(3*e);case"bvec4":return My(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Ac=[{test:n=>n.type==="float"&&n.size===1&&!n.isArray,code:n=>`
            if(uv["${n}"] !== ud["${n}"].value)
            {
                ud["${n}"].value = uv["${n}"]
                gl.uniform1f(ud["${n}"].location, uv["${n}"])
            }
            `},{test:(n,e)=>(n.type==="sampler2D"||n.type==="samplerCube"||n.type==="sampler2DArray")&&n.size===1&&!n.isArray&&(e==null||e.castToBaseTexture!==void 0),code:n=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${n}"], t);

            if(ud["${n}"].value !== t)
            {
                ud["${n}"].value = t;
                gl.uniform1i(ud["${n}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(n,e)=>n.type==="mat3"&&n.size===1&&!n.isArray&&e.a!==void 0,code:n=>`
            gl.uniformMatrix3fv(ud["${n}"].location, false, uv["${n}"].toArray(true));
            `,codeUbo:n=>`
                var ${n}_matrix = uv.${n}.toArray(true);

                data[offset] = ${n}_matrix[0];
                data[offset+1] = ${n}_matrix[1];
                data[offset+2] = ${n}_matrix[2];
        
                data[offset + 4] = ${n}_matrix[3];
                data[offset + 5] = ${n}_matrix[4];
                data[offset + 6] = ${n}_matrix[5];
        
                data[offset + 8] = ${n}_matrix[6];
                data[offset + 9] = ${n}_matrix[7];
                data[offset + 10] = ${n}_matrix[8];
            `},{test:(n,e)=>n.type==="vec2"&&n.size===1&&!n.isArray&&e.x!==void 0,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${n}"].location, v.x, v.y);
                }`,codeUbo:n=>`
                v = uv.${n};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:n=>n.type==="vec2"&&n.size===1&&!n.isArray,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${n}"].location, v[0], v[1]);
                }
            `},{test:(n,e)=>n.type==="vec4"&&n.size===1&&!n.isArray&&e.width!==void 0,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${n}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:n=>`
                    v = uv.${n};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(n,e)=>n.type==="vec4"&&n.size===1&&!n.isArray&&e.red!==void 0,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${n}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:n=>`
                    v = uv.${n};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(n,e)=>n.type==="vec3"&&n.size===1&&!n.isArray&&e.red!==void 0,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${n}"].location, v.red, v.green, v.blue)
                }`,codeUbo:n=>`
                    v = uv.${n};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:n=>n.type==="vec4"&&n.size===1&&!n.isArray,code:n=>`
                cv = ud["${n}"].value;
                v = uv["${n}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${n}"].location, v[0], v[1], v[2], v[3])
                }`}],qH={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},KH={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function ZH(n,e){var i;const t=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const r in n.uniforms){const s=e[r];if(!s){((i=n.uniforms[r])==null?void 0:i.group)===!0&&(n.uniforms[r].ubo?t.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):t.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `));continue}const o=n.uniforms[r];let a=!1;for(let l=0;l<Ac.length;l++)if(Ac[l].test(s,o)){t.push(Ac[l].code(r,o)),a=!0;break}if(!a){const l=(s.size===1&&!s.isArray?qH:KH)[s.type].replace("location",`ud["${r}"].location`);t.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",t.join(`
`))}const uL={};let Bu=uL;function QH(){if(Bu===uL||Bu!=null&&Bu.isContextLost()){const n=Fe.ADAPTER.createCanvas();let e;Fe.PREFER_ENV>=Zl.WEBGL2&&(e=n.getContext("webgl2",{})),e||(e=n.getContext("webgl",{})||n.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),Bu=e}return Bu}let sm;function JH(){if(!sm){sm=Ur.MEDIUM;const n=QH();if(n&&n.getShaderPrecisionFormat){const e=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT);e&&(sm=e.precision?Ur.HIGH:Ur.MEDIUM)}}return sm}function bC(n,e){const t=n.getShaderSource(e).split(`
`).map((u,d)=>`${d}: ${u}`),i=n.getShaderInfoLog(e),r=i.split(`
`),s={},o=r.map(u=>parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(u=>u&&!s[u]?(s[u]=!0,!0):!1),a=[""];o.forEach(u=>{t[u-1]=`%c${t[u-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=t.join(`
`);a[0]=l,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function e7(n,e,t,i){n.getProgramParameter(e,n.LINK_STATUS)||(n.getShaderParameter(t,n.COMPILE_STATUS)||bC(n,t),n.getShaderParameter(i,n.COMPILE_STATUS)||bC(n,i),console.error("PixiJS Error: Could not initialize shader."),n.getProgramInfoLog(e)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",n.getProgramInfoLog(e)))}const t7={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function cL(n){return t7[n]}let om=null;const wC={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function hL(n,e){if(!om){const t=Object.keys(wC);om={};for(let i=0;i<t.length;++i){const r=t[i];om[n[r]]=wC[r]}}return om[e]}function AC(n,e,t){if(n.substring(0,9)!=="precision"){let i=e;return e===Ur.HIGH&&t!==Ur.HIGH&&(i=Ur.MEDIUM),`precision ${i} float;
${n}`}else if(t!==Ur.HIGH&&n.substring(0,15)==="precision highp")return n.replace("precision highp","precision mediump");return n}let Wh;function n7(){if(typeof Wh=="boolean")return Wh;try{Wh=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Wh=!1}return Wh}let i7=0;const am={},P1=class Xu{constructor(e,t,i="pixi-shader",r={}){this.extra={},this.id=i7++,this.vertexSrc=e||Xu.defaultVertexSrc,this.fragmentSrc=t||Xu.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=r,this.vertexSrc.substring(0,8)!=="#version"&&(i=i.replace(/\s+/g,"-"),am[i]?(am[i]++,i+=`-${am[i]}`):am[i]=1,this.vertexSrc=`#define SHADER_NAME ${i}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${i}
${this.fragmentSrc}`,this.vertexSrc=AC(this.vertexSrc,Xu.defaultVertexPrecision,Ur.HIGH),this.fragmentSrc=AC(this.fragmentSrc,Xu.defaultFragmentPrecision,JH())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return YH}static get defaultFragmentSrc(){return $H}static from(e,t,i){const r=e+t;let s=vC[r];return s||(vC[r]=s=new Xu(e,t,i)),s}};P1.defaultVertexPrecision=Ur.HIGH,P1.defaultFragmentPrecision=bo.apple.device?Ur.HIGH:Ur.MEDIUM;let wo=P1,r7=0;class us{constructor(e,t,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=r7++,this.static=!!t,this.ubo=!!i,e instanceof Cn?(this.buffer=e,this.buffer.type=Hs.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new Cn(new Float32Array(1)),this.buffer.type=Hs.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,t,i){if(!this.ubo)this.uniforms[e]=new us(t,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(e,t,i){return new us(e,t,i)}static uboFrom(e,t){return new us(e,t??!0,!0)}}class Vs{constructor(e,t){this.uniformBindCount=0,this.program=e,t?t instanceof us?this.uniformGroup=t:this.uniformGroup=new us(t):this.uniformGroup=new us({}),this.disposeRunner=new ls("disposeShader")}checkUniformExists(e,t){if(t.uniforms[e])return!0;for(const i in t.uniforms){const r=t.uniforms[i];if(r.group===!0&&this.checkUniformExists(e,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,t,i){const r=wo.from(e,t);return new Vs(r,i)}}class s7{constructor(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},!t.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!t.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const i=new Int32Array(e);for(let s=0;s<e;s++)i[s]=s;this.defaultGroupCache[e]=us.from({uSamplers:i},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${e}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new wo(this.vertexSrc,r)}const t={tint:new Float32Array([1,1,1,1]),translationMatrix:new an,default:this.defaultGroupCache[e]};return new Vs(this.programCache[e],t)}generateSampleSrc(e){let t="";t+=`
`,t+=`
`;for(let i=0;i<e;i++)i>0&&(t+=`
else `),i<e-1&&(t+=`if(vTextureId < ${i}.5)`),t+=`
{`,t+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,t+=`
}`;return t+=`
`,t+=`
`,t}}class I1{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function o7(){return!bo.apple.device}function a7(n){let e=!0;const t=Fe.ADAPTER.getNavigator();if(bo.tablet||bo.phone){if(bo.apple.device){const i=t.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(e=!1)}if(bo.android.device){const i=t.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(e=!1)}}return e?n:4}class I0{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var l7=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,u7=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const Jh=class Kr extends I0{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=oL,this.vertexSize=6,this.state=Ks.for2d(),this.size=Kr.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??a7(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??o7(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return Pt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return u7}static get defaultFragmentTemplate(){return l7}setShaderGenerator({vertex:e=Kr.defaultVertexSrc,fragment:t=Kr.defaultFragmentTemplate}={}){this.shaderGenerator=new s7(e,t)}contextChange(){const e=this.renderer.gl;Fe.PREFER_ENV===Zl.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),Kr.defaultMaxTextures),this.maxTextures=OH(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:t}=Kr,i=this.size/4,r=Math.floor(i/this.maxTextures)+1;for(;e.length<i;)e.push(new M1);for(;t.length<r;)t.push(new I1);for(let s=0;s<this.maxTextures;s++)this._tempBoundTextures[s]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:t}=this,i=Kr._textureArrayPool,r=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++lt._globalBatch,l=0,u=i[0],d=0;r.copyBoundTextures(s,t);for(let f=0;f<this._bufferSize;++f){const p=e[f];e[f]=null,p._batchEnabled!==a&&(u.count>=t&&(r.boundArray(u,s,a,t),this.buildDrawCalls(u,d,f),d=f,u=i[++l],++a),p._batchEnabled=a,p.touched=o,u.elements[u.count++]=p)}u.count>0&&(r.boundArray(u,s,a,t),this.buildDrawCalls(u,d,this._bufferSize),++l,++a);for(let f=0;f<s.length;f++)s[f]=null;lt._globalBatch=a}buildDrawCalls(e,t,i){const{_bufferedElements:r,_attributeBuffer:s,_indexBuffer:o,vertexSize:a}=this,l=Kr._drawCallPool;let u=this._dcIndex,d=this._aIndex,f=this._iIndex,p=l[u];p.start=this._iIndex,p.texArray=e;for(let m=t;m<i;++m){const v=r[m],x=v._texture.baseTexture,y=nL[x.alphaMode?1:0][v.blendMode];r[m]=null,t<m&&p.blend!==y&&(p.size=f-p.start,t=m,p=l[++u],p.texArray=e,p.start=f),this.packInterleavedGeometry(v,s,o,d,f),d+=v.vertexData.length/2*a,f+=v.indices.length,p.blend=y}t<i&&(p.size=f-p.start,++u),this._dcIndex=u,this._aIndex=d,this._iIndex=f}bindAndClearTexArray(e){const t=this.renderer.texture;for(let i=0;i<e.count;i++)t.bind(e.elements[i],e.ids[i]),e.elements[i]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:t,_indexBuffer:i}=this;Kr.canUploadSameBuffer?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:t,state:i}=this.renderer,r=Kr._drawCallPool;let s=null;for(let o=0;o<e;o++){const{texArray:a,type:l,size:u,start:d,blend:f}=r[o];s!==a&&(s=a,this.bindAndClearTexArray(a)),this.state.blendMode=f,i.set(this.state),t.drawElements(l,u,t.UNSIGNED_SHORT,d*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Kr.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const t=kg(Math.ceil(e/8)),i=gC(t),r=t*8;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);let s=this._aBuffers[r];return s||(this._aBuffers[r]=s=new b1(r*this.vertexSize*4)),s}getIndexBuffer(e){const t=kg(Math.ceil(e/12)),i=gC(t),r=t*12;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);let s=this._iBuffers[i];return s||(this._iBuffers[i]=s=new Uint16Array(r)),s}packInterleavedGeometry(e,t,i,r,s){const{uint32View:o,float32View:a}=t,l=r/this.vertexSize,u=e.uvs,d=e.indices,f=e.vertexData,p=e._texture.baseTexture._batchLocation,m=Math.min(e.worldAlpha,1),v=en.shared.setValue(e._tintRGB).toPremultiplied(m,e._texture.baseTexture.alphaMode>0);for(let x=0;x<f.length;x+=2)a[r++]=f[x],a[r++]=f[x+1],a[r++]=u[x],a[r++]=u[x+1],o[r++]=v,a[r++]=p;for(let x=0;x<d.length;x++)i[s++]=l+d[x]}};Jh.defaultBatchSize=4096,Jh.extension={name:"batch",type:Ne.RendererPlugin},Jh._drawCallPool=[],Jh._textureArrayPool=[];let pl=Jh;$e.add(pl);var c7=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,h7=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const L1=class ed extends Vs{constructor(e,t,i){const r=wo.from(e||ed.defaultVertexSrc,t||ed.defaultFragmentSrc);super(r,i),this.padding=0,this.resolution=ed.defaultResolution,this.multisample=ed.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Ks}apply(e,t,i,r,s){e.applyFilter(this,t,i,r)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return h7}static get defaultFragmentSrc(){return c7}};L1.defaultResolution=1,L1.defaultMultisample=Dn.NONE;let Ni=L1;class Gg{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new en(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:t,background:i,backgroundAlpha:r}=e,s=i??t;s!==void 0&&(this.color=s),this.alpha=r}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}Gg.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Gg.extension={type:[Ne.RendererSystem,Ne.CanvasRendererSystem],name:"background"};$e.add(Gg);class dL{constructor(e){this.renderer=e,this.emptyRenderer=new I0(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,t){const{boundTextures:i}=this.renderer.texture;for(let r=t-1;r>=0;--r)e[r]=i[r]||null,e[r]&&(e[r]._batchLocation=r)}boundArray(e,t,i,r){const{elements:s,ids:o,count:a}=e;let l=0;for(let u=0;u<a;u++){const d=s[u],f=d._batchLocation;if(f>=0&&f<r&&t[f]===d){o[u]=f;continue}for(;l<r;){const p=t[l];if(p&&p._batchEnabled===i&&p._batchLocation===l){l++;continue}o[u]=l,d._batchLocation=l,t[l]=d;break}}}destroy(){this.renderer=null}}dL.extension={type:Ne.RendererSystem,name:"batch"};$e.add(dL);let MC=0;class Hg{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=MC++}init(e){if(e.context)this.initFromContext(e.context);else{const t=this.renderer.background.alpha<1,i=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:t,premultipliedAlpha:i,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=MC++,this.renderer.runners.contextChange.emit(e);const t=this.renderer.view;t.addEventListener!==void 0&&(t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const t=this.createContext(this.renderer.view,e);this.initFromContext(t)}createContext(e,t){let i;if(Fe.PREFER_ENV>=Zl.WEBGL2&&(i=e.getContext("webgl2",t)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,t={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,e.removeEventListener!==void 0&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const t=e.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),t&&!t.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=i||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Hg.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},Hg.extension={type:Ne.RendererSystem,name:"context"};$e.add(Hg);class D1{constructor(e,t){if(this.width=Math.round(e),this.height=Math.round(t),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ls("disposeFramebuffer"),this.multisample=Dn.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,t){return this.colorTextures[e]=t||new lt(null,{scaleMode:To.NEAREST,resolution:1,mipmap:Ws.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new lt(null,{scaleMode:To.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Ws.OFF,format:Ee.DEPTH_COMPONENT,type:et.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,t){if(e=Math.round(e),t=Math.round(t),!e||!t)throw new Error("Framebuffer width and height must not be zero");if(!(e===this.width&&t===this.height)){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){const r=this.colorTextures[i],s=r.resolution;r.setSize(e/s,t/s)}if(this.depthTexture){const i=this.depthTexture.resolution;this.depthTexture.setSize(e/i,t/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class fL extends lt{constructor(e={}){if(typeof e=="number"){const t=arguments[0],i=arguments[1],r=arguments[2],s=arguments[3];e={width:t,height:i,scaleMode:r,resolution:s}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=Dn.NONE),super(null,e),this.mipmap=Ws.OFF,this.valid=!0,this._clear=new en([0,0,0,0]),this.framebuffer=new D1(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t){this.framebuffer.resize(e*this.resolution,t*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Na extends Zd{constructor(e){const t=e,i=t.naturalWidth||t.videoWidth||t.width,r=t.naturalHeight||t.videoHeight||t.height;super(i,r),this.source=e,this.noSubImage=!1}static crossOrigin(e,t,i){i===void 0&&!t.startsWith("data:")?e.crossOrigin=NH(t):i!==!1&&(e.crossOrigin=typeof i=="string"?i:"anonymous")}upload(e,t,i,r){const s=e.gl,o=t.realWidth,a=t.realHeight;if(r=r||this.source,typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement){if(!r.complete||r.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ji.UNPACK),!this.noSubImage&&t.target===s.TEXTURE_2D&&i.width===o&&i.height===a?s.texSubImage2D(s.TEXTURE_2D,0,0,0,t.format,i.type,r):(i.width=o,i.height=a,s.texImage2D(t.target,0,i.internalFormat,t.format,i.type,r)),!0}update(){if(this.destroyed)return;const e=this.source,t=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;this.resize(t,i),super.update()}dispose(){this.source=null}}class pL extends Na{constructor(e,t){if(t=t||{},typeof e=="string"){const i=new Image;Na.crossOrigin(i,e,t.crossorigin),i.src=e,e=i}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(t.createBitmap??Fe.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof t.alphaMode=="number"?t.alphaMode:null,this.bitmap=null,this._load=null,t.autoLoad!==!1&&this.load()}load(e){return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise((t,i)=>{const r=this.source;this.url=r.src;const s=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.update(),this._load=null,this.createBitmap?t(this.process()):t(this))};r.complete&&r.src?s():(r.onload=s,r.onerror=o=>{i(o),this.onError.emit(o)})}),this._load)}process(){const e=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const t=globalThis.createImageBitmap,i=!e.crossOrigin||e.crossOrigin==="anonymous";return this._process=fetch(e.src,{mode:i?"cors":"no-cors"}).then(r=>r.blob()).then(r=>t(r,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ji.UNPACK?"premultiply":"none"})).then(r=>this.destroyed?Promise.reject():(this.bitmap=r,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,t,i){if(typeof this.alphaMode=="number"&&(t.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,t,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,t,i,this.bitmap),!this.preserveBitmap){let r=!0;const s=t._glTextures;for(const o in s){const a=s[o];if(a!==i&&a.dirtyId!==t.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&(typeof e=="string"||e instanceof HTMLImageElement)}}class CE{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,t,i){const r=t.width,s=t.height;if(i){const o=e.width/2/r,a=e.height/2/s,l=e.x/r+o,u=e.y/s+a;i=pn.add(i,pn.NW),this.x0=l+o*pn.uX(i),this.y0=u+a*pn.uY(i),i=pn.add(i,2),this.x1=l+o*pn.uX(i),this.y1=u+a*pn.uY(i),i=pn.add(i,2),this.x2=l+o*pn.uX(i),this.y2=u+a*pn.uY(i),i=pn.add(i,2),this.x3=l+o*pn.uX(i),this.y3=u+a*pn.uY(i)}else this.x0=e.x/r,this.y0=e.y/s,this.x1=(e.x+e.width)/r,this.y1=e.y/s,this.x2=(e.x+e.width)/r,this.y2=(e.y+e.height)/s,this.x3=e.x/r,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}CE.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const CC=new CE;function lm(n){n.destroy=function(){},n.on=function(){},n.once=function(){},n.emit=function(){}}class Pe extends cf{constructor(e,t,i,r,s,o,a){if(super(),this.noFrame=!1,t||(this.noFrame=!0,t=new ut(0,0,1,1)),e instanceof Pe&&(e=e.baseTexture),this.baseTexture=e,this._frame=t,this.trim=r,this.valid=!1,this.destroyed=!1,this._uvs=CC,this.uvMatrix=null,this.orig=i||t,this._rotate=Number(s||0),s===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new Dt(o.x,o.y):new Dt(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=t:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:t}=this.baseTexture;t!=null&&t.url&&Ms[t.url]&&Pe.removeFromCache(t.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Pe.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var r;const e=this._frame.clone(),t=this._frame===this.orig?e:this.orig.clone(),i=new Pe(this.baseTexture,!this.noFrame&&e,t,(r=this.trim)==null?void 0:r.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=e),i}updateUvs(){this._uvs===CC&&(this._uvs=new CE),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,t={},i=Fe.STRICT_TEXTURE_CACHE){const r=typeof e=="string";let s=null;if(r)s=e;else if(e instanceof lt){if(!e.cacheId){const a=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e.cacheId=`${a}-${Yl()}`,lt.addToCache(e,e.cacheId)}s=e.cacheId}else{if(!e._pixiId){const a=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e._pixiId=`${a}_${Yl()}`}s=e._pixiId}let o=Ms[s];if(r&&i&&!o)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return!o&&!(e instanceof lt)?(t.resolution||(t.resolution=Uo(e)),o=new Pe(new lt(e,t)),o.baseTexture.cacheId=s,lt.addToCache(o.baseTexture,s),Pe.addToCache(o,s)):!o&&e instanceof lt&&(o=new Pe(e),Pe.addToCache(o,s)),o}static fromURL(e,t){const i=Object.assign({autoLoad:!1},t==null?void 0:t.resourceOptions),r=Pe.from(e,Object.assign({resourceOptions:i},t),!1),s=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):s.load().then(()=>Promise.resolve(r))}static fromBuffer(e,t,i,r){return new Pe(lt.fromBuffer(e,t,i,r))}static fromLoader(e,t,i,r){const s=new lt(e,Object.assign({scaleMode:lt.defaultOptions.scaleMode,resolution:Uo(t)},r)),{resource:o}=s;o instanceof pL&&(o.url=t);const a=new Pe(s);return i||(i=t),lt.addToCache(a.baseTexture,i),Pe.addToCache(a,i),i!==t&&(lt.addToCache(a.baseTexture,t),Pe.addToCache(a,t)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),Ms[t]&&Ms[t]!==e&&console.warn(`Texture added to the cache with an id [${t}] that already had an entry`),Ms[t]=e)}static removeFromCache(e){if(typeof e=="string"){const t=Ms[e];if(t){const i=t.textureCacheIds.indexOf(e);return i>-1&&t.textureCacheIds.splice(i,1),delete Ms[e],t}}else if(e!=null&&e.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)Ms[e.textureCacheIds[t]]===e&&delete Ms[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:t,y:i,width:r,height:s}=e,o=t+r>this.baseTexture.width,a=i+s>this.baseTexture.height;if(o||a){const l=o&&a?"and":"or",u=`X: ${t} + ${r} = ${t+r} > ${this.baseTexture.width}`,d=`Y: ${i} + ${s} = ${i+s} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${u} ${l} ${d}`)}this.valid=r&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return Pe._EMPTY||(Pe._EMPTY=new Pe(new lt),lm(Pe._EMPTY),lm(Pe._EMPTY.baseTexture)),Pe._EMPTY}static get WHITE(){if(!Pe._WHITE){const e=Fe.ADAPTER.createCanvas(16,16),t=e.getContext("2d");e.width=16,e.height=16,t.fillStyle="white",t.fillRect(0,0,16,16),Pe._WHITE=new Pe(lt.from(e)),lm(Pe._WHITE),lm(Pe._WHITE.baseTexture)}return Pe._WHITE}}class Jl extends Pe{constructor(e,t){super(e,t),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t,i=!0){const r=this.baseTexture.resolution,s=Math.round(e*r)/r,o=Math.round(t*r)/r;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,i&&this.baseTexture.resize(s,o),this.updateUvs()}setResolution(e){const{baseTexture:t}=this;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))}static create(e){return new Jl(new fL(e))}}class mL{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,t,i=Dn.NONE){const r=new fL(Object.assign({width:e,height:t,resolution:1,multisample:i},this.textureOptions));return new Jl(r)}getOptimalTexture(e,t,i=1,r=Dn.NONE){let s;e=Math.max(Math.ceil(e*i-1e-6),1),t=Math.max(Math.ceil(t*i-1e-6),1),!this.enableFullScreen||e!==this._pixelsWidth||t!==this._pixelsHeight?(e=kg(e),t=kg(t),s=((e&65535)<<16|t&65535)>>>0,r>1&&(s+=r*4294967296)):s=r>1?-r:-1,this.texturePool[s]||(this.texturePool[s]=[]);let o=this.texturePool[s].pop();return o||(o=this.createTexture(e,t,r)),o.filterPoolKey=s,o.setResolution(i),o}getFilterTexture(e,t,i){const r=this.getOptimalTexture(e.width,e.height,t||e.resolution,i||Dn.NONE);return r.filterFrame=e.filterFrame,r}returnTexture(e){const t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=e!==!1,e)for(const t in this.texturePool){const i=this.texturePool[t];if(i)for(let r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){this.enableFullScreen=e.width>0&&e.height>0;for(const t in this.texturePool){if(!(Number(t)<0))continue;const i=this.texturePool[t];if(i)for(let r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}mL.SCREEN_KEY=-1;class d7 extends Da{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class gL extends Da{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Cn(this.vertices),this.uvBuffer=new Cn(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,t){let i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,this.uvs[2]=i+t.width/e.width,this.uvs[3]=r,this.uvs[4]=i+t.width/e.width,this.uvs[5]=r+t.height/e.height,this.uvs[6]=i,this.uvs[7]=r+t.height/e.height,i=t.x,r=t.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+t.width,this.vertices[3]=r,this.vertices[4]=i+t.width,this.vertices[5]=r+t.height,this.vertices[6]=i,this.vertices[7]=r+t.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class f7{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Dn.NONE,this.sourceFrame=new ut,this.destinationFrame=new ut,this.bindingSourceFrame=new ut,this.bindingDestinationFrame=new ut,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const um=[new Dt,new Dt,new Dt,new Dt],Cy=new an;class _L{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new mL,this.statePool=[],this.quad=new d7,this.quadUv=new gL,this.tempRect=new ut,this.activeState={},this.globalUniforms=new us({outputFrame:new ut,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,t){const i=this.renderer,r=this.defaultFilterStack,s=this.statePool.pop()||new f7,o=i.renderTexture;let a,l;if(o.current){const y=o.current;a=y.resolution,l=y.multisample}else a=i.resolution,l=i.multisample;let u=t[0].resolution||a,d=t[0].multisample??l,f=t[0].padding,p=t[0].autoFit,m=t[0].legacy??!0;for(let y=1;y<t.length;y++){const g=t[y];u=Math.min(u,g.resolution||a),d=Math.min(d,g.multisample??l),f=this.useMaxPadding?Math.max(f,g.padding):f+g.padding,p=p&&g.autoFit,m=m||(g.legacy??!0)}r.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),r.push(s),s.resolution=u,s.multisample=d,s.legacy=m,s.target=e,s.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),s.sourceFrame.pad(f);const v=this.tempRect.copyFrom(o.sourceFrame);i.projection.transform&&this.transformAABB(Cy.copyFrom(i.projection.transform).invert(),v),p?(s.sourceFrame.fit(v),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(v)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,o.current?o.current.resolution:i.resolution,o.sourceFrame,o.destinationFrame,i.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,u,d),s.filters=t,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;const x=this.tempRect;x.x=0,x.y=0,x.width=s.sourceFrame.width,x.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=i.projection.transform,i.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,x),i.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,t=e.pop(),i=t.filters;this.activeState=t;const r=this.globalUniforms.uniforms;r.outputFrame=t.sourceFrame,r.resolution=t.resolution;const s=r.inputSize,o=r.inputPixel,a=r.inputClamp;if(s[0]=t.destinationFrame.width,s[1]=t.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*t.resolution),o[1]=Math.round(s[1]*t.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=t.sourceFrame.width*s[2]-.5*o[2],a[3]=t.sourceFrame.height*s[3]-.5*o[3],t.legacy){const u=r.filterArea;u[0]=t.destinationFrame.width,u[1]=t.destinationFrame.height,u[2]=t.sourceFrame.x,u[3]=t.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const l=e[e.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,t.renderTexture,l.renderTexture,Ls.BLEND,t),this.returnFilterTexture(t.renderTexture);else{let u=t.renderTexture,d=this.getOptimalFilterTexture(u.width,u.height,t.resolution);d.filterFrame=u.filterFrame;let f=0;for(f=0;f<i.length-1;++f){f===1&&t.multisample>1&&(d=this.getOptimalFilterTexture(u.width,u.height,t.resolution),d.filterFrame=u.filterFrame),i[f].apply(this,u,d,Ls.CLEAR,t);const p=u;u=d,d=p}i[f].apply(this,u,l.renderTexture,Ls.BLEND,t),f>1&&t.multisample>1&&this.returnFilterTexture(t.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(d)}t.clear(),this.statePool.push(t)}bindAndClear(e,t=Ls.CLEAR){const{renderTexture:i,state:r}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e==null?void 0:e.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,i.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const s=r.stateId&1||this.forceClear;(t===Ls.CLEAR||t===Ls.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,t,i,r){const s=this.renderer;s.state.set(e.state),this.bindAndClear(i,r),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(t._frame,t.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(is.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(is.TRIANGLE_STRIP))}calculateSpriteMatrix(e,t){const{sourceFrame:i,destinationFrame:r}=this.activeState,{orig:s}=t._texture,o=e.set(r.width,0,0,r.height,i.x,i.y),a=t.worldTransform.copyTo(an.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(t.anchor.x,t.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,t,i=1,r=Dn.NONE){return this.texturePool.getOptimalTexture(e,t,i,r)}getFilterTexture(e,t,i){if(typeof e=="number"){const s=e;e=t,t=s}e=e||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution,i||Dn.NONE);return r.filterFrame=e.filterFrame,r}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,t){const i=um[0],r=um[1],s=um[2],o=um[3];i.set(t.left,t.top),r.set(t.left,t.bottom),s.set(t.right,t.top),o.set(t.right,t.bottom),e.apply(i,i),e.apply(r,r),e.apply(s,s),e.apply(o,o);const a=Math.min(i.x,r.x,s.x,o.x),l=Math.min(i.y,r.y,s.y,o.y),u=Math.max(i.x,r.x,s.x,o.x),d=Math.max(i.y,r.y,s.y,o.y);t.x=a,t.y=l,t.width=u-a,t.height=d-l}roundFrame(e,t,i,r,s){if(!(e.width<=0||e.height<=0||i.width<=0||i.height<=0)){if(s){const{a:o,b:a,c:l,d:u}=s;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(u)>1e-4))return}s=s?Cy.copyFrom(s):Cy.identity(),s.translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.transformAABB(s,e),e.ceil(t),this.transformAABB(s.invert(),e)}}}_L.extension={type:Ne.RendererSystem,name:"filter"};$e.add(_L);class p7{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Dn.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const m7=new ut;class vL{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new D1(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new ut,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let t=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;Fe.PREFER_ENV===Zl.WEBGL_LEGACY&&(t=null,i=null),t?e.drawBuffers=r=>t.drawBuffersWEBGL(r):(this.hasMRT=!1,e.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,t,i=0){const{gl:r}=this;if(e){const s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==i&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=i),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,i)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let o=0;o<e.colorTextures.length;o++){const a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t){const o=t.width>>i,a=t.height>>i,l=o/t.width;this.setViewport(t.x*l,t.y*l,o,a)}else{const o=e.width>>i,a=e.height>>i;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,t,i,r){const s=this.viewport;e=Math.round(e),t=Math.round(t),i=Math.round(i),r=Math.round(r),(s.width!==i||s.height!==r||s.x!==e||s.y!==t)&&(s.x=e,s.y=t,s.width=i,s.height=r,this.gl.viewport(e,t,i,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,t,i,r,s=s1.COLOR|s1.DEPTH){const{gl:o}=this;o.clearColor(e,t,i,r),o.clear(s)}initFramebuffer(e){const{gl:t}=this,i=new p7(t.createFramebuffer());return i.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(e),e.disposeRunner.add(this),i}resizeFramebuffer(e){const{gl:t}=this,i=e.glFramebuffers[this.CONTEXT_UID];if(i.stencil){t.bindRenderbuffer(t.RENDERBUFFER,i.stencil);let o;this.renderer.context.webGLVersion===1?o=t.DEPTH_STENCIL:e.depth&&e.stencil?o=t.DEPTH24_STENCIL8:e.depth?o=t.DEPTH_COMPONENT24:o=t.STENCIL_INDEX8,i.msaaBuffer?t.renderbufferStorageMultisample(t.RENDERBUFFER,i.multisample,o,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,o,e.width,e.height)}const r=e.colorTextures;let s=r.length;t.drawBuffers||(s=Math.min(s,1));for(let o=0;o<s;o++){const a=r[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),o===0&&i.msaaBuffer&&(t.bindRenderbuffer(t.RENDERBUFFER,i.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,i.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,t){const{gl:i}=this,r=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures;let o=s.length;i.drawBuffers||(o=Math.min(o,1)),r.multisample>1&&this.canMultisampleFramebuffer(e)?r.msaaBuffer=r.msaaBuffer||i.createRenderbuffer():r.msaaBuffer&&(i.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const a=[];for(let l=0;l<o;l++){const u=s[l],d=u.parentTextureArray||u;this.renderer.texture.bind(d,0),l===0&&r.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,r.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,d._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,r.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+l,u.target,d._glTextures[this.CONTEXT_UID].texture,t),a.push(i.COLOR_ATTACHMENT0+l))}if(a.length>1&&i.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){const l=e.depthTexture;this.renderer.texture.bind(l,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,t)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){r.stencil=r.stencil||i.createRenderbuffer();let l,u;this.renderer.context.webGLVersion===1?(l=i.DEPTH_STENCIL_ATTACHMENT,u=i.DEPTH_STENCIL):e.depth&&e.stencil?(l=i.DEPTH_STENCIL_ATTACHMENT,u=i.DEPTH24_STENCIL8):e.depth?(l=i.DEPTH_ATTACHMENT,u=i.DEPTH_COMPONENT24):(l=i.STENCIL_ATTACHMENT,u=i.STENCIL_INDEX8),i.bindRenderbuffer(i.RENDERBUFFER,r.stencil),r.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,u,e.width,e.height):i.renderbufferStorage(i.RENDERBUFFER,u,e.width,e.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,l,i.RENDERBUFFER,r.stencil)}else r.stencil&&(i.deleteRenderbuffer(r.stencil),r.stencil=null)}canMultisampleFramebuffer(e){return this.renderer.context.webGLVersion!==1&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:t}=this;let i=Dn.NONE;if(e<=1||t===null)return i;for(let r=0;r<t.length;r++)if(t[r]<=e){i=t[r];break}return i===1&&(i=Dn.NONE),i}blit(e,t,i){const{current:r,renderer:s,gl:o,CONTEXT_UID:a}=this;if(s.context.webGLVersion!==2||!r)return;const l=r.glFramebuffers[a];if(!l)return;if(!e){if(!l.msaaBuffer)return;const d=r.colorTextures[0];if(!d)return;l.blitFramebuffer||(l.blitFramebuffer=new D1(r.width,r.height),l.blitFramebuffer.addColorTexture(0,d)),e=l.blitFramebuffer,e.colorTextures[0]!==d&&(e.colorTextures[0]=d,e.dirtyId++,e.dirtyFormat++),(e.width!==r.width||e.height!==r.height)&&(e.width=r.width,e.height=r.height,e.dirtyId++,e.dirtySize++)}t||(t=m7,t.width=r.width,t.height=r.height),i||(i=t);const u=t.width===i.width&&t.height===i.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(t.left,t.top,t.right,t.bottom,i.left,i.top,i.right,i.bottom,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,t){const i=e.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!i)return;delete e.glFramebuffers[this.CONTEXT_UID];const s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),t||(r.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&r.deleteRenderbuffer(i.msaaBuffer),i.stencil&&r.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,t)}disposeAll(e){const t=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<t.length;i++)this.disposeFramebuffer(t[i],e)}forceStencil(){const e=this.current;if(!e)return;const t=e.glFramebuffers[this.CONTEXT_UID];if(!t||t.stencil&&e.stencil)return;e.stencil=!0;const i=e.width,r=e.height,s=this.gl,o=t.stencil=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o);let a,l;this.renderer.context.webGLVersion===1?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH_STENCIL):e.depth?(a=s.DEPTH_STENCIL_ATTACHMENT,l=s.DEPTH24_STENCIL8):(a=s.STENCIL_ATTACHMENT,l=s.STENCIL_INDEX8),t.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,t.multisample,l,i,r):s.renderbufferStorage(s.RENDERBUFFER,l,i,r),s.framebufferRenderbuffer(s.FRAMEBUFFER,a,s.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new ut}destroy(){this.renderer=null}}vL.extension={type:Ne.RendererSystem,name:"framebuffer"};$e.add(vL);const Ry={5126:4,5123:2,5121:1};class yL{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,t.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;Fe.PREFER_ENV===Zl.WEBGL_LEGACY&&(i=null),i?(e.createVertexArray=()=>i.createVertexArrayOES(),e.bindVertexArray=r=>i.bindVertexArrayOES(r),e.deleteVertexArray=r=>i.deleteVertexArrayOES(r)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(t.webGLVersion!==2){const i=e.getExtension("ANGLE_instanced_arrays");i?(e.vertexAttribDivisor=(r,s)=>i.vertexAttribDivisorANGLE(r,s),e.drawElementsInstanced=(r,s,o,a,l)=>i.drawElementsInstancedANGLE(r,s,o,a,l),e.drawArraysInstanced=(r,s,o,a)=>i.drawArraysInstancedANGLE(r,s,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=t.webGLVersion===2||!!t.extensions.uint32ElementIndex}bind(e,t){t=t||this.renderer.shader.shader;const{gl:i}=this;let r=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;r||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=r={},s=!0);const o=r[t.program.id]||this.initGeometryVao(e,t,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?i.bindVertexArray(o):this.activateVao(e,t.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,t=this.renderer.buffer;for(let i=0;i<e.buffers.length;i++){const r=e.buffers[i];t.update(r)}}checkCompatibility(e,t){const i=e.attributes,r=t.attributeData;for(const s in r)if(!i[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,t){const i=e.attributes,r=t.attributeData,s=["g",e.id];for(const o in i)r[o]&&s.push(o,r[o].location);return s.join("-")}initGeometryVao(e,t,i=!0){const r=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=t.program;a.glPrograms[s]||this.renderer.shader.generateProgram(t),this.checkCompatibility(e,a);const l=this.getSignature(e,a),u=e.glVertexArrayObjects[this.CONTEXT_UID];let d=u[l];if(d)return u[a.id]=d,d;const f=e.buffers,p=e.attributes,m={},v={};for(const x in f)m[x]=0,v[x]=0;for(const x in p)!p[x].size&&a.attributeData[x]?p[x].size=a.attributeData[x].size:p[x].size||console.warn(`PIXI Geometry attribute '${x}' size cannot be determined (likely the bound shader does not have the attribute)`),m[p[x].buffer]+=p[x].size*Ry[p[x].type];for(const x in p){const y=p[x],g=y.size;y.stride===void 0&&(m[y.buffer]===g*Ry[y.type]?y.stride=0:y.stride=m[y.buffer]),y.start===void 0&&(y.start=v[y.buffer],v[y.buffer]+=g*Ry[y.type])}d=r.createVertexArray(),r.bindVertexArray(d);for(let x=0;x<f.length;x++){const y=f[x];o.bind(y),i&&y._glBuffers[s].refCount++}return this.activateVao(e,a),u[a.id]=d,u[l]=d,r.bindVertexArray(null),o.unbind(Hs.ARRAY_BUFFER),d}disposeGeometry(e,t){var a;if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const i=e.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,s=e.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(e.disposeRunner.remove(this),!!i){if(o)for(let l=0;l<s.length;l++){const u=s[l]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!t&&o.dispose(s[l],t))}if(!t){for(const l in i)if(l[0]==="g"){const u=i[l];this._activeVao===u&&this.unbind(),r.deleteVertexArray(u)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const t=Object.keys(this.managedGeometries);for(let i=0;i<t.length;i++)this.disposeGeometry(this.managedGeometries[t[i]],e)}activateVao(e,t){const i=this.gl,r=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);let l=null;for(const u in a){const d=a[u],f=o[d.buffer],p=f._glBuffers[r];if(t.attributeData[u]){l!==p&&(s.bind(f),l=p);const m=t.attributeData[u].location;if(i.enableVertexAttribArray(m),i.vertexAttribPointer(m,d.size,d.type||i.FLOAT,d.normalized,d.stride,d.start),d.instance)if(this.hasInstance)i.vertexAttribDivisor(m,d.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(e,t,i,r){const{gl:s}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,t||o.indexBuffer.data.length,l,(i||0)*a,r||1):s.drawElements(e,t||o.indexBuffer.data.length,l,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,i,t||o.getSize(),r||1):s.drawArrays(e,i,t||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}yL.extension={type:Ne.RendererSystem,name:"geometry"};$e.add(yL);const RC=new an;class RE{constructor(e,t){this._texture=e,this.mapCoord=new an,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof t>"u"?.5:t,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,t){t===void 0&&(t=e);const i=this.mapCoord;for(let r=0;r<e.length;r+=2){const s=e[r],o=e[r+1];t[r]=s*i.a+o*i.c+i.tx,t[r+1]=s*i.b+o*i.d+i.ty}return t}update(e){const t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;const i=t._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const r=t.orig,s=t.trim;s&&(RC.set(r.width/s.width,0,0,r.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(RC));const o=t.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(t._frame.x+l+u)/o.width,a[1]=(t._frame.y+l+u)/o.height,a[2]=(t._frame.x+t._frame.width-l+u)/o.width,a[3]=(t._frame.y+t._frame.height-l+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=t._frame.width===o.width&&t._frame.height===o.height&&t.rotate===0,!0}}var g7=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,_7=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class v7 extends Ni{constructor(e,t,i){let r=null;typeof e!="string"&&t===void 0&&i===void 0&&(r=e,e=void 0,t=void 0,i=void 0),super(e||_7,t||g7,i),this.maskSprite=r,this.maskMatrix=new an}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,t,i,r){const s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new RE(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,t,i,r))}}class y7{constructor(e=null){this.type=kn.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Ni.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=kn.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class xL{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,t){let i=t;if(!i.isMaskData){const s=this.maskDataPool.pop()||new y7;s.pooled=!0,s.maskObject=t,i=s}const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(r),i._colorMask=r?r._colorMask:15,i.autoDetect&&this.detect(i),i._target=e,i.type!==kn.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case kn.SCISSOR:this.renderer.scissor.push(i);break;case kn.STENCIL:this.renderer.stencil.push(i);break;case kn.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case kn.COLOR:this.pushColorMask(i);break}i.type===kn.SPRITE&&this.maskStack.push(i)}pop(e){const t=this.maskStack.pop();if(!(!t||t._target!==e)){if(t.enabled)switch(t.type){case kn.SCISSOR:this.renderer.scissor.pop(t);break;case kn.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case kn.SPRITE:this.popSpriteMask(t);break;case kn.COLOR:this.popColorMask(t);break}if(t.reset(),t.pooled&&this.maskDataPool.push(t),this.maskStack.length!==0){const i=this.maskStack[this.maskStack.length-1];i.type===kn.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(e){const t=e.maskObject;t?t.isSprite?e.type=kn.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=kn.SCISSOR:e.type=kn.STENCIL:e.type=kn.COLOR}pushSpriteMask(e){const{maskObject:t}=e,i=e._target;let r=e._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new v7])),r[0].resolution=e.resolution,r[0].multisample=e.multisample,r[0].maskSprite=t;const s=i.filterArea;i.filterArea=t.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=s,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const t=e._colorMask,i=e._colorMask=t&e.colorMask;i!==t&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(e){const t=e._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==t&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}}xL.extension={type:Ne.RendererSystem,name:"mask"};$e.add(xL);class SL{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:t}=this.renderer,i=this.getStackLength();this.maskStack=e;const r=this.getStackLength();r!==i&&(r===0?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const PC=new an,IC=[],EL=class Ym extends SL{constructor(e){super(e),this.glConst=Fe.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const t=e._scissorRect,{maskObject:i}=e,{renderer:r}=this,s=r.renderTexture,o=i.getBounds(!0,IC.pop()??new ut);this.roundFrameToPixels(o,s.current?s.current.resolution:r.resolution,s.sourceFrame,s.destinationFrame,r.projection.transform),t&&o.fit(t),e._scissorRectLocal=o}static isMatrixRotated(e){if(!e)return!1;const{a:t,b:i,c:r,d:s}=e;return(Math.abs(i)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(s)>1e-4)}testScissor(e){const{maskObject:t}=e;if(!t.isFastRect||!t.isFastRect()||Ym.isMatrixRotated(t.worldTransform)||Ym.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const i=e._scissorRectLocal;return i.width>0&&i.height>0}roundFrameToPixels(e,t,i,r,s){Ym.isMatrixRotated(s)||(s=s?PC.copyFrom(s):PC.identity(),s.translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.renderer.filter.transformAABB(s,e),e.fit(r),e.x=Math.round(e.x*t),e.y=Math.round(e.y*t),e.width=Math.round(e.width*t),e.height=Math.round(e.height*t))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:t}=this.renderer;e&&IC.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=e.y:t=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}};EL.extension={type:Ne.RendererSystem,name:"scissor"};let x7=EL;$e.add(x7);class TL extends SL{constructor(e){super(e),this.glConst=Fe.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const t=e.maskObject,{gl:i}=this.renderer,r=e._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),e._stencilCounter++;const s=e._colorMask;s!==0&&(e._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,r,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,s!==0&&(e._colorMask=s,i.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}pop(e){const t=this.renderer.gl;if(this.getStackLength()===0)t.disable(t.STENCIL_TEST);else{const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,r=i?i._colorMask:15;r!==0&&(i._colorMask=0,t.colorMask(!1,!1,!1,!1)),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,r!==0&&(i._colorMask=r,t.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}TL.extension={type:Ne.RendererSystem,name:"stencil"};$e.add(TL);class bL{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return Pt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return Pt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return Pt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){const e=this.rendererPlugins;for(const t in e)this.plugins[t]=new e[t](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}bL.extension={type:[Ne.RendererSystem,Ne.CanvasRendererSystem],name:"_plugin"};$e.add(bL);class wL{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new an,this.transform=null}update(e,t,i,r){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);const s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(e,t,i,r){const s=this.projectionMatrix,o=r?-1:1;s.identity(),s.a=1/t.width*2,s.d=o*(1/t.height*2),s.tx=-1-t.x*s.a,s.ty=-o-t.y*s.d}setTransform(e){}destroy(){this.renderer=null}}wL.extension={type:Ne.RendererSystem,name:"projection"};$e.add(wL);const S7=new P0,LC=new ut;class AL{constructor(e){this.renderer=e,this._tempMatrix=new an}generateTexture(e,t){const{region:i,...r}=t||{},s=(i==null?void 0:i.copyTo(LC))||e.getLocalBounds(LC,!0),o=r.resolution||this.renderer.resolution;s.width=Math.max(s.width,1/o),s.height=Math.max(s.height,1/o),r.width=s.width,r.height=s.height,r.resolution=o,r.multisample??(r.multisample=this.renderer.multisample);const a=Jl.create(r);this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;const l=e.transform;return e.transform=S7,this.renderer.render(e,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=l,a}destroy(){}}AL.extension={type:[Ne.RendererSystem,Ne.CanvasRendererSystem],name:"textureGenerator"};$e.add(AL);const il=new ut,Xh=new ut;class ML{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new ut,this.destinationFrame=new ut,this.viewportFrame=new ut}contextChange(){var t;const e=(t=this.renderer)==null?void 0:t.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,t,i){const r=this.renderer;this.current=e;let s,o,a;e?(s=e.baseTexture,a=s.resolution,t||(il.width=e.frame.width,il.height=e.frame.height,t=il),i||(Xh.x=e.frame.x,Xh.y=e.frame.y,Xh.width=t.width,Xh.height=t.height,i=Xh),o=s.framebuffer):(a=r.resolution,t||(il.width=r._view.screen.width,il.height=r._view.screen.height,t=il),i||(i=il,i.width=t.width,i.height=t.height));const l=this.viewportFrame;l.x=i.x*a,l.y=i.y*a,l.width=i.width*a,l.height=i.height*a,e||(l.y=r.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(i,t,a,!o),e?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(i)}clear(e,t){const i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,r=en.shared.setValue(e||i);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&r.premultiply(r.alpha);const s=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=s.width!==o.width||s.height!==o.height;if(a){let{x:l,y:u,width:d,height:f}=this.viewportFrame;l=Math.round(l),u=Math.round(u),d=Math.round(d),f=Math.round(f),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,u,d,f)}this.renderer.framebuffer.clear(r.red,r.green,r.blue,r.alpha,t),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}ML.extension={type:Ne.RendererSystem,name:"renderTexture"};$e.add(ML);class E7{constructor(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function T7(n,e){const t={},i=e.getProgramParameter(n,e.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=e.getActiveAttrib(n,r);if(s.name.startsWith("gl_"))continue;const o=hL(e,s.type),a={type:o,name:s.name,size:cL(o),location:e.getAttribLocation(n,s.name)};t[s.name]=a}return t}function b7(n,e){const t={},i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let r=0;r<i;r++){const s=e.getActiveUniform(n,r),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),l=hL(e,s.type);t[o]={name:o,index:r,type:l,size:s.size,isArray:a,value:lL(l,s.size)}}return t}function w7(n,e){var a;const t=TC(n,n.VERTEX_SHADER,e.vertexSrc),i=TC(n,n.FRAGMENT_SHADER,e.fragmentSrc),r=n.createProgram();n.attachShader(r,t),n.attachShader(r,i);const s=(a=e.extra)==null?void 0:a.transformFeedbackVaryings;if(s&&(typeof n.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):n.transformFeedbackVaryings(r,s.names,s.bufferMode==="separate"?n.SEPARATE_ATTRIBS:n.INTERLEAVED_ATTRIBS)),n.linkProgram(r),n.getProgramParameter(r,n.LINK_STATUS)||e7(n,r,t,i),e.attributeData=T7(r,n),e.uniformData=b7(r,n),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const l=Object.keys(e.attributeData);l.sort((u,d)=>u>d?1:-1);for(let u=0;u<l.length;u++)e.attributeData[l[u]].location=u,n.bindAttribLocation(r,u,l[u]);n.linkProgram(r)}n.deleteShader(t),n.deleteShader(i);const o={};for(const l in e.uniformData){const u=e.uniformData[l];o[l]={location:n.getUniformLocation(r,l),value:lL(u.type,u.size)}}return new E7(r,o)}function A7(n,e,t,i,r){t.buffer.update(r)}const M7={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},CL={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function C7(n){const e=n.map(s=>({data:s,offset:0,dataLen:0,dirty:0}));let t=0,i=0,r=0;for(let s=0;s<e.length;s++){const o=e[s];if(t=CL[o.data.type],o.data.size>1&&(t=Math.max(t,16)*o.data.size),o.dataLen=t,i%t!==0&&i<16){const a=i%t%16;i+=a,r+=a}i+t>16?(r=Math.ceil(r/16)*16,o.offset=r,r+=t,i=t):(o.offset=r,i+=t,r+=t)}return r=Math.ceil(r/16)*16,{uboElements:e,size:r}}function R7(n,e){const t=[];for(const i in n)e[i]&&t.push(e[i]);return t.sort((i,r)=>i.index-r.index),t}function P7(n,e){if(!n.autoManage)return{size:0,syncFunc:A7};const t=R7(n.uniforms,e),{uboElements:i,size:r}=C7(t),s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<i.length;o++){const a=i[o],l=n.uniforms[a.data.name],u=a.data.name;let d=!1;for(let f=0;f<Ac.length;f++){const p=Ac[f];if(p.codeUbo&&p.test(a.data,l)){s.push(`offset = ${a.offset/4};`,Ac[f].codeUbo(a.data.name,l)),d=!0;break}}if(!d)if(a.data.size>1){const f=cL(a.data.type),p=Math.max(CL[a.data.type]/16,1),m=f/p,v=(4-m%4)%4;s.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*p}; i++)
                {
                    for(var j = 0; j < ${m}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${v};
                }

                `)}else{const f=M7[a.data.type];s.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${a.offset/4};
                ${f};
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:r,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}let I7=0;const cm={textureCount:0,uboCount:0};class RL{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=I7++}systemCheck(){if(!n7())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,t){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const i=e.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),t||(cm.textureCount=0,cm.uboCount=0,this.syncUniformGroup(e.uniformGroup,cm)),r}setUniforms(e){const t=this.shader.program,i=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(i.uniformData,e,this.renderer)}syncUniformGroup(e,t){const i=this.getGlProgram();(!e.static||e.dirtyId!==i.uniformDirtyGroups[e.id])&&(i.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,i,t))}syncUniforms(e,t,i){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,i)}createSyncGroups(e){const t=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[t]||(this.cache[t]=ZH(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,t){const i=this.getGlProgram();if(!e.static||e.dirtyId!==0||!i.uniformGroups[e.id]){e.dirtyId=0;const r=i.uniformGroups[e.id]||this.createSyncBufferGroup(e,i,t);e.buffer.update(),r(i.uniformData,e.uniforms,this.renderer,cm,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,i.uniformBufferBindings[t])}createSyncBufferGroup(e,t,i){const{gl:r}=this.renderer;this.renderer.buffer.bind(e.buffer);const s=this.gl.getUniformBlockIndex(t.program,i);t.uniformBufferBindings[i]=this.shader.uniformBindCount,r.uniformBlockBinding(t.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(e,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=P7(e,this.shader.program.uniformData)),e.autoManage){const l=new Float32Array(a.size/4);e.buffer.update(l)}return t.uniformGroups[e.id]=a.syncFunc,t.uniformGroups[e.id]}getSignature(e,t,i){const r=e.uniforms,s=[`${i}-`];for(const o in r)s.push(o),t[o]&&s.push(t[o].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const t=this.gl,i=e.program,r=w7(t,i);return i.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}RL.extension={type:Ne.RendererSystem,name:"shader"};$e.add(RL);class Vg{constructor(e){this.renderer=e}run(e){const{renderer:t}=this;t.runners.init.emit(t.options),e.hello&&console.log(`PixiJS 7.3.3 - ${t.rendererLogId} - https://pixijs.com`),t.resize(t.screen.width,t.screen.height)}destroy(){}}Vg.defaultOptions={hello:!1},Vg.extension={type:[Ne.RendererSystem,Ne.CanvasRendererSystem],name:"startup"};$e.add(Vg);function L7(n,e=[]){return e[rt.NORMAL]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.ADD]=[n.ONE,n.ONE],e[rt.MULTIPLY]=[n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.SCREEN]=[n.ONE,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.OVERLAY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.DARKEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.LIGHTEN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.COLOR_DODGE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.COLOR_BURN]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.HARD_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.SOFT_LIGHT]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.DIFFERENCE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.EXCLUSION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.HUE]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.SATURATION]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.COLOR]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.LUMINOSITY]=[n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.NONE]=[0,0],e[rt.NORMAL_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.ADD_NPM]=[n.SRC_ALPHA,n.ONE,n.ONE,n.ONE],e[rt.SCREEN_NPM]=[n.SRC_ALPHA,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE_MINUS_SRC_ALPHA],e[rt.SRC_IN]=[n.DST_ALPHA,n.ZERO],e[rt.SRC_OUT]=[n.ONE_MINUS_DST_ALPHA,n.ZERO],e[rt.SRC_ATOP]=[n.DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],e[rt.DST_OVER]=[n.ONE_MINUS_DST_ALPHA,n.ONE],e[rt.DST_IN]=[n.ZERO,n.SRC_ALPHA],e[rt.DST_OUT]=[n.ZERO,n.ONE_MINUS_SRC_ALPHA],e[rt.DST_ATOP]=[n.ONE_MINUS_DST_ALPHA,n.SRC_ALPHA],e[rt.XOR]=[n.ONE_MINUS_DST_ALPHA,n.ONE_MINUS_SRC_ALPHA],e[rt.SUBTRACT]=[n.ONE,n.ONE,n.ONE,n.ONE,n.FUNC_REVERSE_SUBTRACT,n.FUNC_ADD],e}const D7=0,N7=1,U7=2,F7=3,O7=4,k7=5,PL=class N1{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=rt.NONE,this._blendEq=!1,this.map=[],this.map[D7]=this.setBlend,this.map[N7]=this.setOffset,this.map[U7]=this.setCullFace,this.map[F7]=this.setDepthTest,this.map[O7]=this.setFrontFace,this.map[k7]=this.setDepthMask,this.checks=[],this.defaultState=new Ks,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=L7(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,i=0;for(;t;)t&1&&this.map[i].call(this,!!(e.data&1<<i)),t=t>>1,i++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(N1.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(N1.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const t=this.blendModes[e],i=this.gl;t.length===2?i.blendFunc(t[0],t[1]):i.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,i.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){const i=this.checks.indexOf(e);t&&i===-1?this.checks.push(e):!t&&i!==-1&&this.checks.splice(i,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};PL.extension={type:Ne.RendererSystem,name:"state"};let B7=PL;$e.add(B7);class z7 extends cf{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const t=(e.priority??[]).filter(r=>e.systems[r]),i=[...t,...Object.keys(e.systems).filter(r=>!t.includes(r))];for(const r of i)this.addSystem(e.systems[r],r)}addRunners(...e){e.forEach(t=>{this.runners[t]=new ls(t)})}addSystem(e,t){const i=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);this[t]=i,this._systemsHash[t]=i;for(const r in this.runners)this.runners[r].add(i);return this}emitWithCustomOptions(e,t){const i=Object.keys(this._systemsHash);e.items.forEach(r=>{const s=i.find(o=>this._systemsHash[o]===r);r[e.name](t[s])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const td=class qm{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=qm.defaultMaxIdle,this.checkCountMax=qm.defaultCheckCountMax,this.mode=qm.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==vE.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,t=e.managedTextures;let i=!1;for(let r=0;r<t.length;r++){const s=t[r];s.resource&&this.count-s.touched>this.maxIdle&&(e.destroyTexture(s,!0),t[r]=null,i=!0)}if(i){let r=0;for(let s=0;s<t.length;s++)t[s]!==null&&(t[r++]=t[s]);t.length=r}}unload(e){const t=this.renderer.texture,i=e._texture;i&&!i.framebuffer&&t.destroyTexture(i);for(let r=e.children.length-1;r>=0;r--)this.unload(e.children[r])}destroy(){this.renderer=null}};td.defaultMode=vE.AUTO,td.defaultMaxIdle=60*60,td.defaultCheckCountMax=60*10,td.extension={type:Ne.RendererSystem,name:"textureGC"};let ml=td;$e.add(ml);class Py{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=et.UNSIGNED_BYTE,this.internalFormat=Ee.RGBA,this.samplerType=0}}function G7(n){let e;return"WebGL2RenderingContext"in globalThis&&n instanceof globalThis.WebGL2RenderingContext?e={[n.RGB]:Ue.FLOAT,[n.RGBA]:Ue.FLOAT,[n.ALPHA]:Ue.FLOAT,[n.LUMINANCE]:Ue.FLOAT,[n.LUMINANCE_ALPHA]:Ue.FLOAT,[n.R8]:Ue.FLOAT,[n.R8_SNORM]:Ue.FLOAT,[n.RG8]:Ue.FLOAT,[n.RG8_SNORM]:Ue.FLOAT,[n.RGB8]:Ue.FLOAT,[n.RGB8_SNORM]:Ue.FLOAT,[n.RGB565]:Ue.FLOAT,[n.RGBA4]:Ue.FLOAT,[n.RGB5_A1]:Ue.FLOAT,[n.RGBA8]:Ue.FLOAT,[n.RGBA8_SNORM]:Ue.FLOAT,[n.RGB10_A2]:Ue.FLOAT,[n.RGB10_A2UI]:Ue.FLOAT,[n.SRGB8]:Ue.FLOAT,[n.SRGB8_ALPHA8]:Ue.FLOAT,[n.R16F]:Ue.FLOAT,[n.RG16F]:Ue.FLOAT,[n.RGB16F]:Ue.FLOAT,[n.RGBA16F]:Ue.FLOAT,[n.R32F]:Ue.FLOAT,[n.RG32F]:Ue.FLOAT,[n.RGB32F]:Ue.FLOAT,[n.RGBA32F]:Ue.FLOAT,[n.R11F_G11F_B10F]:Ue.FLOAT,[n.RGB9_E5]:Ue.FLOAT,[n.R8I]:Ue.INT,[n.R8UI]:Ue.UINT,[n.R16I]:Ue.INT,[n.R16UI]:Ue.UINT,[n.R32I]:Ue.INT,[n.R32UI]:Ue.UINT,[n.RG8I]:Ue.INT,[n.RG8UI]:Ue.UINT,[n.RG16I]:Ue.INT,[n.RG16UI]:Ue.UINT,[n.RG32I]:Ue.INT,[n.RG32UI]:Ue.UINT,[n.RGB8I]:Ue.INT,[n.RGB8UI]:Ue.UINT,[n.RGB16I]:Ue.INT,[n.RGB16UI]:Ue.UINT,[n.RGB32I]:Ue.INT,[n.RGB32UI]:Ue.UINT,[n.RGBA8I]:Ue.INT,[n.RGBA8UI]:Ue.UINT,[n.RGBA16I]:Ue.INT,[n.RGBA16UI]:Ue.UINT,[n.RGBA32I]:Ue.INT,[n.RGBA32UI]:Ue.UINT,[n.DEPTH_COMPONENT16]:Ue.FLOAT,[n.DEPTH_COMPONENT24]:Ue.FLOAT,[n.DEPTH_COMPONENT32F]:Ue.FLOAT,[n.DEPTH_STENCIL]:Ue.FLOAT,[n.DEPTH24_STENCIL8]:Ue.FLOAT,[n.DEPTH32F_STENCIL8]:Ue.FLOAT}:e={[n.RGB]:Ue.FLOAT,[n.RGBA]:Ue.FLOAT,[n.ALPHA]:Ue.FLOAT,[n.LUMINANCE]:Ue.FLOAT,[n.LUMINANCE_ALPHA]:Ue.FLOAT,[n.DEPTH_STENCIL]:Ue.FLOAT},e}function H7(n){let e;return"WebGL2RenderingContext"in globalThis&&n instanceof globalThis.WebGL2RenderingContext?e={[et.UNSIGNED_BYTE]:{[Ee.RGBA]:n.RGBA8,[Ee.RGB]:n.RGB8,[Ee.RG]:n.RG8,[Ee.RED]:n.R8,[Ee.RGBA_INTEGER]:n.RGBA8UI,[Ee.RGB_INTEGER]:n.RGB8UI,[Ee.RG_INTEGER]:n.RG8UI,[Ee.RED_INTEGER]:n.R8UI,[Ee.ALPHA]:n.ALPHA,[Ee.LUMINANCE]:n.LUMINANCE,[Ee.LUMINANCE_ALPHA]:n.LUMINANCE_ALPHA},[et.BYTE]:{[Ee.RGBA]:n.RGBA8_SNORM,[Ee.RGB]:n.RGB8_SNORM,[Ee.RG]:n.RG8_SNORM,[Ee.RED]:n.R8_SNORM,[Ee.RGBA_INTEGER]:n.RGBA8I,[Ee.RGB_INTEGER]:n.RGB8I,[Ee.RG_INTEGER]:n.RG8I,[Ee.RED_INTEGER]:n.R8I},[et.UNSIGNED_SHORT]:{[Ee.RGBA_INTEGER]:n.RGBA16UI,[Ee.RGB_INTEGER]:n.RGB16UI,[Ee.RG_INTEGER]:n.RG16UI,[Ee.RED_INTEGER]:n.R16UI,[Ee.DEPTH_COMPONENT]:n.DEPTH_COMPONENT16},[et.SHORT]:{[Ee.RGBA_INTEGER]:n.RGBA16I,[Ee.RGB_INTEGER]:n.RGB16I,[Ee.RG_INTEGER]:n.RG16I,[Ee.RED_INTEGER]:n.R16I},[et.UNSIGNED_INT]:{[Ee.RGBA_INTEGER]:n.RGBA32UI,[Ee.RGB_INTEGER]:n.RGB32UI,[Ee.RG_INTEGER]:n.RG32UI,[Ee.RED_INTEGER]:n.R32UI,[Ee.DEPTH_COMPONENT]:n.DEPTH_COMPONENT24},[et.INT]:{[Ee.RGBA_INTEGER]:n.RGBA32I,[Ee.RGB_INTEGER]:n.RGB32I,[Ee.RG_INTEGER]:n.RG32I,[Ee.RED_INTEGER]:n.R32I},[et.FLOAT]:{[Ee.RGBA]:n.RGBA32F,[Ee.RGB]:n.RGB32F,[Ee.RG]:n.RG32F,[Ee.RED]:n.R32F,[Ee.DEPTH_COMPONENT]:n.DEPTH_COMPONENT32F},[et.HALF_FLOAT]:{[Ee.RGBA]:n.RGBA16F,[Ee.RGB]:n.RGB16F,[Ee.RG]:n.RG16F,[Ee.RED]:n.R16F},[et.UNSIGNED_SHORT_5_6_5]:{[Ee.RGB]:n.RGB565},[et.UNSIGNED_SHORT_4_4_4_4]:{[Ee.RGBA]:n.RGBA4},[et.UNSIGNED_SHORT_5_5_5_1]:{[Ee.RGBA]:n.RGB5_A1},[et.UNSIGNED_INT_2_10_10_10_REV]:{[Ee.RGBA]:n.RGB10_A2,[Ee.RGBA_INTEGER]:n.RGB10_A2UI},[et.UNSIGNED_INT_10F_11F_11F_REV]:{[Ee.RGB]:n.R11F_G11F_B10F},[et.UNSIGNED_INT_5_9_9_9_REV]:{[Ee.RGB]:n.RGB9_E5},[et.UNSIGNED_INT_24_8]:{[Ee.DEPTH_STENCIL]:n.DEPTH24_STENCIL8},[et.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[Ee.DEPTH_STENCIL]:n.DEPTH32F_STENCIL8}}:e={[et.UNSIGNED_BYTE]:{[Ee.RGBA]:n.RGBA,[Ee.RGB]:n.RGB,[Ee.ALPHA]:n.ALPHA,[Ee.LUMINANCE]:n.LUMINANCE,[Ee.LUMINANCE_ALPHA]:n.LUMINANCE_ALPHA},[et.UNSIGNED_SHORT_5_6_5]:{[Ee.RGB]:n.RGB},[et.UNSIGNED_SHORT_4_4_4_4]:{[Ee.RGBA]:n.RGBA},[et.UNSIGNED_SHORT_5_5_5_1]:{[Ee.RGBA]:n.RGBA}},e}class IL{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new lt,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=H7(e),this.samplerTypes=G7(e);const t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(let r=0;r<t;r++)this.boundTextures[r]=null;this.emptyTextures={};const i=new Py(e.createTexture());e.bindTexture(e.TEXTURE_2D,i.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=i,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new Py(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let r=0;r<6;r++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let r=0;r<this.boundTextures.length;r++)this.bind(null,r)}bind(e,t=0){const{gl:i}=this;if(e=e==null?void 0:e.castToBaseTexture(),(e==null?void 0:e.valid)&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const r=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),i.bindTexture(e.target,r.texture)),r.dirtyId!==e.dirtyId?(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),this.updateTexture(e)):r.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[t]=e}else this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[t]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:t,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(let r=0;r<i.length;r++)i[r]===e&&(this.currentLocation!==r&&(t.activeTexture(t.TEXTURE0+r),this.currentLocation=r),t.bindTexture(e.target,this.emptyTextures[e.target].texture),i[r]=null)}ensureSamplerType(e){const{boundTextures:t,hasIntegerTextures:i,CONTEXT_UID:r}=this;if(i)for(let s=e-1;s>=0;--s){const o=t[s];o&&o._glTextures[r].samplerType!==Ue.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(e){const t=new Py(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t}initTextureType(e,t){var i;t.internalFormat=((i=this.internalFormats[e.type])==null?void 0:i[e.format])??e.format,t.samplerType=this.samplerTypes[t.internalFormat]??Ue.FLOAT,this.webGLVersion===2&&e.type===et.HALF_FLOAT?t.type=this.gl.HALF_FLOAT:t.type=e.type}updateTexture(e){var r;const t=e._glTextures[this.CONTEXT_UID];if(!t)return;const i=this.renderer;if(this.initTextureType(e,t),(r=e.resource)==null?void 0:r.upload(i,e,t))t.samplerType!==Ue.FLOAT&&(this.hasIntegerTextures=!0);else{const s=e.realWidth,o=e.realHeight,a=i.gl;(t.width!==s||t.height!==o||t.dirtyId<0)&&(t.width=s,t.height=o,a.texImage2D(e.target,0,t.internalFormat,s,o,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}destroyTexture(e,t){const{gl:i}=this;if(e=e.castToBaseTexture(),e._glTextures[this.CONTEXT_UID]&&(this.unbind(e),i.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){const r=this.managedTextures.indexOf(e);r!==-1&&wc(this.managedTextures,r,1)}}updateTextureStyle(e){var i;const t=e._glTextures[this.CONTEXT_UID];t&&((e.mipmap===Ws.POW2||this.webGLVersion!==2)&&!e.isPowerOfTwo?t.mipmap=!1:t.mipmap=e.mipmap>=1,this.webGLVersion!==2&&!e.isPowerOfTwo?t.wrapMode=Co.CLAMP:t.wrapMode=e.wrapMode,(i=e.resource)!=null&&i.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)}setStyle(e,t){const i=this.gl;if(t.mipmap&&e.mipmap!==Ws.ON_MANUAL&&i.generateMipmap(e.target),i.texParameteri(e.target,i.TEXTURE_WRAP_S,t.wrapMode),i.texParameteri(e.target,i.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===To.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);const r=this.renderer.context.extensions.anisotropicFiltering;if(r&&e.anisotropicLevel>0&&e.scaleMode===To.LINEAR){const s=Math.min(e.anisotropicLevel,i.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(e.target,r.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===To.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(e.target,i.TEXTURE_MAG_FILTER,e.scaleMode===To.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}IL.extension={type:Ne.RendererSystem,name:"texture"};$e.add(IL);class LL{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:t,CONTEXT_UID:i}=this,r=e._glTransformFeedbacks[i]||this.createGLTransformFeedback(e);t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,t){const{gl:i,renderer:r}=this;t&&r.shader.bind(t),i.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:t,renderer:i,CONTEXT_UID:r}=this,s=t.createTransformFeedback();e._glTransformFeedbacks[r]=s,t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,s);for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];a&&(i.buffer.update(a),a._glBuffers[r].refCount++,t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[r].buffer||null))}return t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),s}disposeTransformFeedback(e,t){const i=e._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this);const s=this.renderer.buffer;if(s)for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];if(!a)continue;const l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!t&&s.dispose(a,t))}i&&(t||r.deleteTransformFeedback(i),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}LL.extension={type:Ne.RendererSystem,name:"transformFeedback"};$e.add(LL);class Wg{constructor(e){this.renderer=e}init(e){this.screen=new ut(0,0,e.width,e.height),this.element=e.view||Fe.ADAPTER.createCanvas(),this.resolution=e.resolution||Fe.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,t){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(t*this.resolution);const i=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=i,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",i,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){var t;e&&((t=this.element.parentNode)==null||t.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}Wg.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},Wg.extension={type:[Ne.RendererSystem,Ne.CanvasRendererSystem],name:"_view"};$e.add(Wg);Fe.PREFER_ENV=Zl.WEBGL2;Fe.STRICT_TEXTURE_CACHE=!1;Fe.RENDER_OPTIONS={...Hg.defaultOptions,...Gg.defaultOptions,...Wg.defaultOptions,...Vg.defaultOptions};Object.defineProperties(Fe,{WRAP_MODE:{get(){return lt.defaultOptions.wrapMode},set(n){Pt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),lt.defaultOptions.wrapMode=n}},SCALE_MODE:{get(){return lt.defaultOptions.scaleMode},set(n){Pt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),lt.defaultOptions.scaleMode=n}},MIPMAP_TEXTURES:{get(){return lt.defaultOptions.mipmap},set(n){Pt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),lt.defaultOptions.mipmap=n}},ANISOTROPIC_LEVEL:{get(){return lt.defaultOptions.anisotropicLevel},set(n){Pt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),lt.defaultOptions.anisotropicLevel=n}},FILTER_RESOLUTION:{get(){return Pt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Ni.defaultResolution},set(n){Ni.defaultResolution=n}},FILTER_MULTISAMPLE:{get(){return Pt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Ni.defaultMultisample},set(n){Ni.defaultMultisample=n}},SPRITE_MAX_TEXTURES:{get(){return pl.defaultMaxTextures},set(n){Pt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),pl.defaultMaxTextures=n}},SPRITE_BATCH_SIZE:{get(){return pl.defaultBatchSize},set(n){Pt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),pl.defaultBatchSize=n}},CAN_UPLOAD_SAME_BUFFER:{get(){return pl.canUploadSameBuffer},set(n){Pt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),pl.canUploadSameBuffer=n}},GC_MODE:{get(){return ml.defaultMode},set(n){Pt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ml.defaultMode=n}},GC_MAX_IDLE:{get(){return ml.defaultMaxIdle},set(n){Pt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ml.defaultMaxIdle=n}},GC_MAX_CHECK_COUNT:{get(){return ml.defaultCheckCountMax},set(n){Pt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ml.defaultCheckCountMax=n}},PRECISION_VERTEX:{get(){return wo.defaultVertexPrecision},set(n){Pt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),wo.defaultVertexPrecision=n}},PRECISION_FRAGMENT:{get(){return wo.defaultFragmentPrecision},set(n){Pt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),wo.defaultFragmentPrecision=n}}});var Ua=(n=>(n[n.INTERACTION=50]="INTERACTION",n[n.HIGH=25]="HIGH",n[n.NORMAL=0]="NORMAL",n[n.LOW=-25]="LOW",n[n.UTILITY=-50]="UTILITY",n))(Ua||{});class Iy{constructor(e,t=null,i=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=i,this.once=r}match(e,t=null){return this.fn===e&&this.context===t}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=e?null:t,this.previous=null,t}}const DL=class rr{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Iy(null,null,1/0),this.deltaMS=1/rr.targetFPMS,this.elapsedMS=1/rr.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,i=Ua.NORMAL){return this._addListener(new Iy(e,t,i))}addOnce(e,t,i=Ua.NORMAL){return this._addListener(new Iy(e,t,i,!0))}_addListener(e){let t=this._head.next,i=this._head;if(!t)e.connect(i);else{for(;t;){if(e.priority>t.priority){e.connect(i);break}i=t,t=t.next}e.previous||e.connect(i)}return this._startIfPossible(),this}remove(e,t){let i=this._head.next;for(;i;)i.match(e,t)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*rr.targetFPMS;const i=this._head;let r=i.next;for(;r;)r=r.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),i=Math.min(Math.max(0,t)/1e3,rr.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!rr._shared){const e=rr._shared=new rr;e.autoStart=!0,e._protected=!0}return rr._shared}static get system(){if(!rr._system){const e=rr._system=new rr;e.autoStart=!0,e._protected=!0}return rr._system}};DL.targetFPMS=.06;let ni=DL;Object.defineProperties(Fe,{TARGET_FPMS:{get(){return ni.targetFPMS},set(n){Pt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),ni.targetFPMS=n}}});class NL{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,Ua.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?ni.shared:new ni,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}NL.extension=Ne.Application;$e.add(NL);const UL=[];$e.handleByList(Ne.Renderer,UL);function V7(n){for(const e of UL)if(e.test(n))return new e(n);throw new Error("Unable to auto-detect a suitable renderer.")}var W7=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,X7=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const j7=W7,FL=X7;class OL{constructor(e){this.renderer=e}contextChange(e){let t;if(this.renderer.context.webGLVersion===1){const i=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,i)}else{const i=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,i)}t>=Dn.HIGH?this.multisample=Dn.HIGH:t>=Dn.MEDIUM?this.multisample=Dn.MEDIUM:t>=Dn.LOW?this.multisample=Dn.LOW:this.multisample=Dn.NONE}destroy(){}}OL.extension={type:Ne.RendererSystem,name:"_multisample"};$e.add(OL);class $7{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class kL{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:t,CONTEXT_UID:i}=this,r=e._glBuffers[i]||this.createGLBuffer(e);t.bindBuffer(e.type,r.buffer)}unbind(e){const{gl:t}=this;t.bindBuffer(e,null)}bindBufferBase(e,t){const{gl:i,CONTEXT_UID:r}=this;if(this.boundBufferBases[t]!==e){const s=e._glBuffers[r]||this.createGLBuffer(e);this.boundBufferBases[t]=e,i.bindBufferBase(i.UNIFORM_BUFFER,t,s.buffer)}}bindBufferRange(e,t,i){const{gl:r,CONTEXT_UID:s}=this;i=i||0;const o=e._glBuffers[s]||this.createGLBuffer(e);r.bindBufferRange(r.UNIFORM_BUFFER,t||0,o.buffer,i*256,256)}update(e){const{gl:t,CONTEXT_UID:i}=this,r=e._glBuffers[i]||this.createGLBuffer(e);if(e._updateID!==r.updateID)if(r.updateID=e._updateID,t.bindBuffer(e.type,r.buffer),r.byteLength>=e.data.byteLength)t.bufferSubData(e.type,0,e.data);else{const s=e.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;r.byteLength=e.data.byteLength,t.bufferData(e.type,e.data,s)}}dispose(e,t){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const i=e._glBuffers[this.CONTEXT_UID],r=this.gl;e.disposeRunner.remove(this),i&&(t||r.deleteBuffer(i.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const t=Object.keys(this.managedBuffers);for(let i=0;i<t.length;i++)this.dispose(this.managedBuffers[t[i]],e)}createGLBuffer(e){const{CONTEXT_UID:t,gl:i}=this;return e._glBuffers[t]=new $7(i.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[t]}}kL.extension={type:Ne.RendererSystem,name:"buffer"};$e.add(kL);class BL{constructor(e){this.renderer=e}render(e,t){const i=this.renderer;let r,s,o,a;if(t&&(r=t.renderTexture,s=t.clear,o=t.transform,a=t.skipUpdateTransform),this.renderingToScreen=!r,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=o,!i.context.isLost){if(r||(this.lastObjectRendered=e),!a){const l=e.enableTempParent();e.updateTransform(),e.disableTempParent(l)}i.renderTexture.bind(r),i.batch.currentRenderer.start(),(s??i.background.clearBeforeRender)&&i.renderTexture.clear(),e.render(i),i.batch.currentRenderer.flush(),r&&(t.blit&&i.framebuffer.blit(),r.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}BL.extension={type:Ne.RendererSystem,name:"objectRenderer"};$e.add(BL);const Km=class U1 extends z7{constructor(e){super(),this.type=PI.WEBGL,e=Object.assign({},Fe.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new us({projectionMatrix:new an},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:U1.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in e&&(Pt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=U1.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:gH()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Pt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Pt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Pt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Pt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){Pt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return Pt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){Pt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return Pt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}};Km.extension={type:Ne.Renderer,priority:1},Km.__plugins={},Km.__systems={};let PE=Km;$e.handleByMap(Ne.RendererPlugin,PE.__plugins);$e.handleByMap(Ne.RendererSystem,PE.__systems);$e.add(PE);class zL extends Zd{constructor(e,t){const{width:i,height:r}=t||{};super(i,r),this.items=[],this.itemDirtyIds=[];for(let s=0;s<e;s++){const o=new lt;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,t){for(let i=0;i<this.length;i++)e[i]&&(e[i].castToBaseTexture?this.addBaseTextureAt(e[i].castToBaseTexture(),i):e[i]instanceof Zd?this.addResourceAt(e[i],i):this.addResourceAt(sL(e[i],t),i))}dispose(){for(let e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,t){if(!this.items[t])throw new Error(`Index ${t} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this}bind(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=e,this.items[t].on("update",e.update,e)}unbind(e){super.unbind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=null,this.items[t].off("update",e.update,e)}load(){if(this._load)return this._load;const e=this.items.map(t=>t.resource).filter(t=>t).map(t=>t.load());return this._load=Promise.all(e).then(()=>{const{realWidth:t,realHeight:i}=this.items[0];return this.resize(t,i),this.update(),Promise.resolve(this)}),this._load}}class Y7 extends zL{constructor(e,t){const{width:i,height:r}=t||{};let s,o;Array.isArray(e)?(s=e,o=e.length):o=e,super(o,{width:i,height:r}),s&&this.initFromArray(s,t)}addBaseTextureAt(e,t){if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=Ec.TEXTURE_2D_ARRAY}upload(e,t,i){const{length:r,itemDirtyIds:s,items:o}=this,{gl:a}=e;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,r,0,t.format,i.type,null);for(let l=0;l<r;l++){const u=o[l];s[l]<u.dirtyId&&(s[l]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,u.resource.width,u.resource.height,1,t.format,i.type,u.resource.source))}return!0}}class q7 extends Na{constructor(e){super(e)}static test(e){const{OffscreenCanvas:t}=globalThis;return t&&e instanceof t?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}const GL=class nd extends zL{constructor(e,t){const{width:i,height:r,autoLoad:s,linkBaseTexture:o}=t||{};if(e&&e.length!==nd.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:i,height:r});for(let a=0;a<nd.SIDES;a++)this.items[a].target=Ec.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,e&&this.initFromArray(e,t),s!==!1&&this.load()}bind(e){super.bind(e),e.target=Ec.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,i){if(i===void 0&&(i=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=Ec.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(e,t,i){const r=this.itemDirtyIds;for(let s=0;s<nd.SIDES;s++){const o=this.items[s];(r[s]<o.dirtyId||i.dirtyId<t.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,i),r[s]=o.dirtyId):r[s]<-1&&(e.gl.texImage2D(o.target,0,i.internalFormat,t.realWidth,t.realHeight,0,t.format,i.type,null),r[s]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===nd.SIDES}};GL.SIDES=6;let K7=GL;class cc extends Na{constructor(e,t){t=t||{};let i,r,s;typeof e=="string"?(i=cc.EMPTY,r=e,s=!0):(i=e,r=null,s=!1),super(i),this.url=r,this.crossOrigin=t.crossOrigin??!0,this.alphaMode=typeof t.alphaMode=="number"?t.alphaMode:null,this.ownsImageBitmap=t.ownsImageBitmap??s,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(e,t)=>{if(this.url===null){e(this);return}try{const i=await Fe.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await i.blob();if(this.destroyed)return;const s=await createImageBitmap(r,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ji.UNPACK?"premultiply":"none"});if(this.destroyed){s.close();return}this.source=s,this.update(),e(this)}catch(i){if(this.destroyed)return;t(i),this.onError.emit(i)}}),this._load)}upload(e,t,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(t.alphaMode=this.alphaMode),super.upload(e,t,i)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof e=="string"||e instanceof ImageBitmap)}static get EMPTY(){return cc._EMPTY=cc._EMPTY??Fe.ADAPTER.createCanvas(0,0),cc._EMPTY}}const F1=class Zm extends Na{constructor(e,t){t=t||{},super(Fe.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},Zm.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;Na.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;const t=e.width,i=e.height;if(!t||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let r=t*this.scale,s=i*this.scale;(this._overrideWidth||this._overrideHeight)&&(r=this._overrideWidth||this._overrideHeight/i*t,s=this._overrideHeight||this._overrideWidth/t*i),r=Math.round(r),s=Math.round(s);const o=this.source;o.width=r,o.height=s,o._pixiId=`canvas_${Yl()}`,o.getContext("2d").drawImage(e,0,0,t,i,0,0,r,s),this._resolve(),this._resolve=null}}static getSize(e){const t=Zm.SVG_SIZE.exec(e),i={};return t&&(i[t[1]]=Math.round(parseFloat(t[3])),i[t[5]]=Math.round(parseFloat(t[7]))),i}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,t){return t==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&Zm.SVG_XML.test(e)}};F1.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,F1.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let O1=F1;const k1=class B1 extends Na{constructor(e,t){if(t=t||{},!(e instanceof HTMLVideoElement)){const i=document.createElement("video");t.autoLoad!==!1&&i.setAttribute("preload","auto"),t.playsinline!==!1&&(i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline","")),t.muted===!0&&(i.setAttribute("muted",""),i.muted=!0),t.loop===!0&&i.setAttribute("loop",""),t.autoPlay!==!1&&i.setAttribute("autoplay",""),typeof e=="string"&&(e=[e]);const r=e[0].src||e[0];Na.crossOrigin(i,r,t.crossorigin);for(let s=0;s<e.length;++s){const o=document.createElement("source");let{src:a,mime:l}=e[s];if(a=a||e[s],a.startsWith("data:"))l=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){const u=a.split("?").shift().toLowerCase(),d=u.slice(u.lastIndexOf(".")+1);l=l||B1.MIME_TYPES[d]||`video/${d}`}o.src=a,l&&(o.type=l),i.appendChild(o)}e=i}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){const t=ni.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((t,i)=>{this.valid?t(this):(this._resolve=t,this._reject=i,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!t&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();const e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(ni.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(ni.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(ni.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,t){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||B1.TYPES.includes(t)}};k1.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],k1.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let HL=k1;w1.push(cc,pL,q7,HL,O1,A0,K7,Y7);class Xg{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?ut.EMPTY:(e=e||new ut(0,0,1,1),e.x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,t){const{a:i,b:r,c:s,d:o,tx:a,ty:l}=e,u=i*t.x+s*t.y+a,d=r*t.x+o*t.y+l;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,d),this.maxY=Math.max(this.maxY,d)}addQuad(e){let t=this.minX,i=this.minY,r=this.maxX,s=this.maxY,o=e[0],a=e[1];t=o<t?o:t,i=a<i?a:i,r=o>r?o:r,s=a>s?a:s,o=e[2],a=e[3],t=o<t?o:t,i=a<i?a:i,r=o>r?o:r,s=a>s?a:s,o=e[4],a=e[5],t=o<t?o:t,i=a<i?a:i,r=o>r?o:r,s=a>s?a:s,o=e[6],a=e[7],t=o<t?o:t,i=a<i?a:i,r=o>r?o:r,s=a>s?a:s,this.minX=t,this.minY=i,this.maxX=r,this.maxY=s}addFrame(e,t,i,r,s){this.addFrameMatrix(e.worldTransform,t,i,r,s)}addFrameMatrix(e,t,i,r,s){const o=e.a,a=e.b,l=e.c,u=e.d,d=e.tx,f=e.ty;let p=this.minX,m=this.minY,v=this.maxX,x=this.maxY,y=o*t+l*i+d,g=a*t+u*i+f;p=y<p?y:p,m=g<m?g:m,v=y>v?y:v,x=g>x?g:x,y=o*r+l*i+d,g=a*r+u*i+f,p=y<p?y:p,m=g<m?g:m,v=y>v?y:v,x=g>x?g:x,y=o*t+l*s+d,g=a*t+u*s+f,p=y<p?y:p,m=g<m?g:m,v=y>v?y:v,x=g>x?g:x,y=o*r+l*s+d,g=a*r+u*s+f,p=y<p?y:p,m=g<m?g:m,v=y>v?y:v,x=g>x?g:x,this.minX=p,this.minY=m,this.maxX=v,this.maxY=x}addVertexData(e,t,i){let r=this.minX,s=this.minY,o=this.maxX,a=this.maxY;for(let l=t;l<i;l+=2){const u=e[l],d=e[l+1];r=u<r?u:r,s=d<s?d:s,o=u>o?u:o,a=d>a?d:a}this.minX=r,this.minY=s,this.maxX=o,this.maxY=a}addVertices(e,t,i,r){this.addVerticesMatrix(e.worldTransform,t,i,r)}addVerticesMatrix(e,t,i,r,s=0,o=s){const a=e.a,l=e.b,u=e.c,d=e.d,f=e.tx,p=e.ty;let m=this.minX,v=this.minY,x=this.maxX,y=this.maxY;for(let g=i;g<r;g+=2){const T=t[g],S=t[g+1],w=a*T+u*S+f,M=d*S+l*T+p;m=Math.min(m,w-s),x=Math.max(x,w+s),v=Math.min(v,M-o),y=Math.max(y,M+o)}this.minX=m,this.minY=v,this.maxX=x,this.maxY=y}addBounds(e){const t=this.minX,i=this.minY,r=this.maxX,s=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<i?e.minY:i,this.maxX=e.maxX>r?e.maxX:r,this.maxY=e.maxY>s?e.maxY:s}addBoundsMask(e,t){const i=e.minX>t.minX?e.minX:t.minX,r=e.minY>t.minY?e.minY:t.minY,s=e.maxX<t.maxX?e.maxX:t.maxX,o=e.maxY<t.maxY?e.maxY:t.maxY;if(i<=s&&r<=o){const a=this.minX,l=this.minY,u=this.maxX,d=this.maxY;this.minX=i<a?i:a,this.minY=r<l?r:l,this.maxX=s>u?s:u,this.maxY=o>d?o:d}}addBoundsMatrix(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,t){const i=e.minX>t.x?e.minX:t.x,r=e.minY>t.y?e.minY:t.y,s=e.maxX<t.x+t.width?e.maxX:t.x+t.width,o=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(i<=s&&r<=o){const a=this.minX,l=this.minY,u=this.maxX,d=this.maxY;this.minX=i<a?i:a,this.minY=r<l?r:l,this.maxX=s>u?s:u,this.maxY=o>d?o:d}}pad(e=0,t=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)}addFramePad(e,t,i,r,s,o){e-=s,t-=o,i+=s,r+=o,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>r?this.maxY:r}}class hn extends cf{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new P0,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Xg,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const t=Object.keys(e);for(let i=0;i<t.length;++i){const r=t[i];Object.defineProperty(hn.prototype,r,Object.getOwnPropertyDescriptor(e,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),t||(this._boundsRect||(this._boundsRect=new ut),t=this._boundsRect),this._bounds.getRectangle(t)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new ut),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Xg);const t=this.transform,i=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(i==null?void 0:i.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const r=this._bounds,s=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,e);return this.parent=i,this.transform=t,this._bounds=r,this._bounds.updateID+=this._boundsID-s,o}toGlobal(e,t,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)}toLocal(e,t,i,r){return t&&(e=t.toGlobal(e,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,i)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){var e;(e=this.parent)==null||e.removeChild(this)}setTransform(e=0,t=0,i=1,r=1,s=0,o=0,a=0,l=0,u=0){return this.position.x=e,this.position.y=t,this.scale.x=i||1,this.scale.y=r||1,this.rotation=s,this.skew.x=o,this.skew.y=a,this.pivot.x=l,this.pivot.y=u,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Z7),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*WH}set angle(e){this.transform.rotation=e*XH}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount--,t._maskRefCount===0&&(t.renderable=!0,t.isMask=!1))}if(this._mask=e,this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount===0&&(t.renderable=!1,t.isMask=!0),t._maskRefCount++)}}}}class Z7 extends hn{constructor(){super(...arguments),this.sortDirty=null}}hn.prototype.displayObjectUpdateTransform=hn.prototype.updateTransform;const Q7=new an;function J7(n,e){return n.zIndex===e.zIndex?n._lastSortedIndex-e._lastSortedIndex:n.zIndex-e.zIndex}const VL=class z1 extends hn{constructor(){super(),this.children=[],this.sortableChildren=z1.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{const t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;const i=this.getChildIndex(e),r=this.getChildIndex(t);this.children[i]=t,this.children[r]=e,this.onChildrenChange(i<r?i:r)}getChildIndex(e){const t=this.children.indexOf(e);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const i=this.getChildIndex(e);wc(this.children,i,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{const t=e[0],i=this.children.indexOf(t);if(i===-1)return null;t.parent=null,t.transform._parentID=-1,wc(this.children,i,1),this._boundsID++,this.onChildrenChange(i),t.emit("removed",this),this.emit("childRemoved",t,this,i)}return e[0]}removeChildAt(e){const t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,wc(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){const i=e,r=t,s=r-i;let o;if(s>0&&s<=r){o=this.children.splice(i,s);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,i=this.children.length;t<i;++t){const r=this.children[t];r._lastSortedIndex=t,!e&&r.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(J7),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){const i=this.children[e];i.visible&&i.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const t=this.children[e];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const i=t._mask.isMaskData?t._mask.maskObject:t._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(t._bounds,i._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){const i=super.getLocalBounds(e);if(!t)for(let r=0,s=this.children.length;r<s;++r){const o=this.children[r];o.visible&&o.updateTransform()}return i}_calculateBounds(){}_renderWithCulling(e){const t=e.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let i,r;this.cullArea?(i=this.cullArea,r=this.worldTransform):this._render!==z1.prototype._render&&(i=this.getBounds(!0));const s=e.projection.transform;if(s&&(r?(r=Q7.copyFrom(r),r.prepend(s)):r=s),i&&t.intersects(i,r))this._render(e);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){const l=this.children[o],u=l.cullable;l.cullable=u||!this.cullArea,l.render(e),l.cullable=u}}render(e){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let i=0,r=this.children.length;i<r;++i)this.children[i].render(e)}}renderAdvanced(e){var s,o,a;const t=this.filters,i=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let l=0;l<t.length;l++)t[l].enabled&&this._enabledFilters.push(t[l])}const r=t&&((s=this._enabledFilters)==null?void 0:s.length)||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==kn.NONE));if(r&&e.batch.flush(),t&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.push(this,this._enabledFilters),i&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let l=0,u=this.children.length;l<u;++l)this.children[l].render(e)}r&&e.batch.flush(),i&&e.mask.pop(this),t&&((a=this._enabledFilters)!=null&&a.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const t=typeof e=="boolean"?e:e==null?void 0:e.children,i=this.removeChildren(0,this.children.length);if(t)for(let r=0;r<i.length;++r)i[r].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const t=this.getLocalBounds().width;t!==0?this.scale.x=e/t:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const t=this.getLocalBounds().height;t!==0?this.scale.y=e/t:this.scale.y=1,this._height=e}};VL.defaultSortableChildren=!1;let Oi=VL;Oi.prototype.containerUpdateTransform=Oi.prototype.updateTransform;Object.defineProperties(Fe,{SORTABLE_CHILDREN:{get(){return Oi.defaultSortableChildren},set(n){Pt("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Oi.defaultSortableChildren=n}}});var L0=(n=>(n[n.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",n[n.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",n))(L0||{});const jh=new Dt,e9=new Uint16Array([0,1,2,0,2,3]);class Zs extends Oi{constructor(e){super(),this._anchor=new Os(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new en(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=rt.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||Pe.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=e9,this.pluginName="batch",this.isSprite=!0,this._roundPixels=Fe.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=_a(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=_a(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const t=this.transform.worldTransform,i=t.a,r=t.b,s=t.c,o=t.d,a=t.tx,l=t.ty,u=this.vertexData,d=e.trim,f=e.orig,p=this._anchor;let m=0,v=0,x=0,y=0;if(d?(v=d.x-p._x*f.width,m=v+d.width,y=d.y-p._y*f.height,x=y+d.height):(v=-p._x*f.width,m=v+f.width,y=-p._y*f.height,x=y+f.height),u[0]=i*v+s*y+a,u[1]=o*y+r*v+l,u[2]=i*m+s*y+a,u[3]=o*y+r*m+l,u[4]=i*m+s*x+a,u[5]=o*x+r*m+l,u[6]=i*v+s*x+a,u[7]=o*x+r*v+l,this._roundPixels){const g=Fe.RESOLUTION;for(let T=0;T<u.length;++T)u[T]=Math.round(u[T]*g)/g}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const e=this._texture,t=this.vertexTrimmedData,i=e.orig,r=this._anchor,s=this.transform.worldTransform,o=s.a,a=s.b,l=s.c,u=s.d,d=s.tx,f=s.ty,p=-r._x*i.width,m=p+i.width,v=-r._y*i.height,x=v+i.height;if(t[0]=o*p+l*v+d,t[1]=u*v+a*p+f,t[2]=o*m+l*v+d,t[3]=u*v+a*m+f,t[4]=o*m+l*x+d,t[5]=u*x+a*m+f,t[6]=o*p+l*x+d,t[7]=u*x+a*p+f,this._roundPixels){const y=Fe.RESOLUTION;for(let g=0;g<t.length;++g)t[g]=Math.round(t[g]*y)/y}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,t=this._texture.orig;!e||e.width===t.width&&e.height===t.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return this.children.length===0?(this._localBounds||(this._localBounds=new Xg),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new ut),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,jh);const t=this._texture.orig.width,i=this._texture.orig.height,r=-t*this.anchor.x;let s=0;return jh.x>=r&&jh.x<r+t&&(s=-i*this.anchor.y,jh.y>=s&&jh.y<s+i)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof e=="boolean"?e:e==null?void 0:e.texture){const t=typeof e=="boolean"?e:e==null?void 0:e.baseTexture;this._texture.destroy(!!t)}this._texture=null}static from(e,t){const i=e instanceof Pe?e:Pe.from(e,t);return new Zs(i)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const t=_a(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const t=_a(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||Pe.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const hm={willReadFrequently:!0},Cs=class Ke{static get experimentalLetterSpacingSupported(){let e=Ke._experimentalLetterSpacingSupported;if(e!==void 0){const t=Fe.ADAPTER.getCanvasRenderingContext2D().prototype;e=Ke._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,i,r,s,o,a,l,u){this.text=e,this.style=t,this.width=i,this.height=r,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=u}static measureText(e,t,i,r=Ke._canvas){i=i??t.wordWrap;const s=t.toFontString(),o=Ke.measureFont(s);o.fontSize===0&&(o.fontSize=t.fontSize,o.ascent=t.fontSize);const a=r.getContext("2d",hm);a.font=s;const l=(i?Ke.wordWrap(e,t,r):e).split(/(?:\r\n|\r|\n)/),u=new Array(l.length);let d=0;for(let v=0;v<l.length;v++){const x=Ke._measureText(l[v],t.letterSpacing,a);u[v]=x,d=Math.max(d,x)}let f=d+t.strokeThickness;t.dropShadow&&(f+=t.dropShadowDistance);const p=t.lineHeight||o.fontSize+t.strokeThickness;let m=Math.max(p,o.fontSize+t.strokeThickness*2)+t.leading+(l.length-1)*(p+t.leading);return t.dropShadow&&(m+=t.dropShadowDistance),new Ke(e,t,f,m,l,u,p+t.leading,d,o)}static _measureText(e,t,i){let r=!1;Ke.experimentalLetterSpacingSupported&&(Ke.experimentalLetterSpacing?(i.letterSpacing=`${t}px`,i.textLetterSpacing=`${t}px`,r=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let s=i.measureText(e).width;return s>0&&(r?s-=t:s+=(Ke.graphemeSegmenter(e).length-1)*t),s}static wordWrap(e,t,i=Ke._canvas){const r=i.getContext("2d",hm);let s=0,o="",a="";const l=Object.create(null),{letterSpacing:u,whiteSpace:d}=t,f=Ke.collapseSpaces(d),p=Ke.collapseNewlines(d);let m=!f;const v=t.wordWrapWidth+u,x=Ke.tokenize(e);for(let y=0;y<x.length;y++){let g=x[y];if(Ke.isNewline(g)){if(!p){a+=Ke.addLine(o),m=!f,o="",s=0;continue}g=" "}if(f){const S=Ke.isBreakingSpace(g),w=Ke.isBreakingSpace(o[o.length-1]);if(S&&w)continue}const T=Ke.getFromCache(g,u,l,r);if(T>v)if(o!==""&&(a+=Ke.addLine(o),o="",s=0),Ke.canBreakWords(g,t.breakWords)){const S=Ke.wordWrapSplit(g);for(let w=0;w<S.length;w++){let M=S[w],P=M,R=1;for(;S[w+R];){const C=S[w+R];if(!Ke.canBreakChars(P,C,g,w,t.breakWords))M+=C;else break;P=C,R++}w+=R-1;const D=Ke.getFromCache(M,u,l,r);D+s>v&&(a+=Ke.addLine(o),m=!1,o="",s=0),o+=M,s+=D}}else{o.length>0&&(a+=Ke.addLine(o),o="",s=0);const S=y===x.length-1;a+=Ke.addLine(g,!S),m=!1,o="",s=0}else T+s>v&&(m=!1,a+=Ke.addLine(o),o="",s=0),(o.length>0||!Ke.isBreakingSpace(g)||m)&&(o+=g,s+=T)}return a+=Ke.addLine(o,!1),a}static addLine(e,t=!0){return e=Ke.trimRight(e),e=t?`${e}
`:e,e}static getFromCache(e,t,i,r){let s=i[e];return typeof s!="number"&&(s=Ke._measureText(e,t,r)+t,i[e]=s),s}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){const i=e[t];if(!Ke.isBreakingSpace(i))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:Ke._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:Ke._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const t=[];let i="";if(typeof e!="string")return t;for(let r=0;r<e.length;r++){const s=e[r],o=e[r+1];if(Ke.isBreakingSpace(s,o)||Ke.isNewline(s)){i!==""&&(t.push(i),i=""),t.push(s);continue}i+=s}return i!==""&&t.push(i),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,i,r,s){return!0}static wordWrapSplit(e){return Ke.graphemeSegmenter(e)}static measureFont(e){if(Ke._fonts[e])return Ke._fonts[e];const t={ascent:0,descent:0,fontSize:0},i=Ke._canvas,r=Ke._context;r.font=e;const s=Ke.METRICS_STRING+Ke.BASELINE_SYMBOL,o=Math.ceil(r.measureText(s).width);let a=Math.ceil(r.measureText(Ke.BASELINE_SYMBOL).width);const l=Math.ceil(Ke.HEIGHT_MULTIPLIER*a);if(a=a*Ke.BASELINE_MULTIPLIER|0,o===0||l===0)return Ke._fonts[e]=t,t;i.width=o,i.height=l,r.fillStyle="#f00",r.fillRect(0,0,o,l),r.font=e,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(s,0,a);const u=r.getImageData(0,0,o,l).data,d=u.length,f=o*4;let p=0,m=0,v=!1;for(p=0;p<a;++p){for(let x=0;x<f;x+=4)if(u[m+x]!==255){v=!0;break}if(!v)m+=f;else break}for(t.ascent=a-p,m=d-f,v=!1,p=l;p>a;--p){for(let x=0;x<f;x+=4)if(u[m+x]!==255){v=!0;break}if(!v)m-=f;else break}return t.descent=p-a,t.fontSize=t.ascent+t.descent,Ke._fonts[e]=t,t}static clearMetrics(e=""){e?delete Ke._fonts[e]:Ke._fonts={}}static get _canvas(){var e;if(!Ke.__canvas){let t;try{const i=new OffscreenCanvas(0,0);if((e=i.getContext("2d",hm))!=null&&e.measureText)return Ke.__canvas=i,i;t=Fe.ADAPTER.createCanvas()}catch{t=Fe.ADAPTER.createCanvas()}t.width=t.height=10,Ke.__canvas=t}return Ke.__canvas}static get _context(){return Ke.__context||(Ke.__context=Ke._canvas.getContext("2d",hm)),Ke.__context}};Cs.METRICS_STRING="|q",Cs.BASELINE_SYMBOL="M",Cs.BASELINE_MULTIPLIER=1.4,Cs.HEIGHT_MULTIPLIER=2,Cs.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const n=new Intl.Segmenter;return e=>[...n.segment(e)].map(t=>t.segment)}return n=>[...n]})(),Cs.experimentalLetterSpacing=!1,Cs._fonts={},Cs._newlines=[10,13],Cs._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let ua=Cs;const t9=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],WL=class id{constructor(e){this.styleID=0,this.reset(),Dy(this,e,e)}clone(){const e={};return Dy(e,this,id.defaultStyle),new id(e)}reset(){Dy(this,id.defaultStyle,id.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const t=Ly(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const t=Ly(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){n9(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const t=Ly(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let i=t.length-1;i>=0;i--){let r=t[i].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!t9.includes(r)&&(r=`"${r}"`),t[i]=r}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}};WL.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:L0.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Fa=WL;function Ly(n){const e=en.shared,t=i=>{const r=e.setValue(i);return r.alpha===1?r.toHex():r.toRgbaString()};return Array.isArray(n)?n.map(t):t(n)}function n9(n,e){if(!Array.isArray(n)||!Array.isArray(e)||n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}function Dy(n,e,t){for(const i in t)Array.isArray(e[i])?n[i]=e[i].slice():n[i]=e[i]}const i9={texture:!0,children:!1,baseTexture:!0},XL=class G1 extends Zs{constructor(e,t,i){let r=!1;i||(i=Fe.ADAPTER.createCanvas(),r=!0),i.width=3,i.height=3;const s=Pe.from(i);s.orig=new ut,s.trim=new ut,super(s),this._ownCanvas=r,this.canvas=i,this.context=i.getContext("2d",{willReadFrequently:!0}),this._resolution=G1.defaultResolution??Fe.RESOLUTION,this._autoResolution=G1.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return ua.experimentalLetterSpacing}static set experimentalLetterSpacing(e){Pt("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),ua.experimentalLetterSpacing=e}updateText(e){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const i=this.context,r=ua.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=r.width,o=r.height,a=r.lines,l=r.lineHeight,u=r.lineWidths,d=r.maxLineWidth,f=r.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+t.padding*2)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=t.strokeThickness,i.textBaseline=t.textBaseline,i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit;let p,m;const v=t.dropShadow?2:1;for(let x=0;x<v;++x){const y=t.dropShadow&&x===0,g=y?Math.ceil(Math.max(1,o)+t.padding*2):0,T=g*this._resolution;if(y){i.fillStyle="black",i.strokeStyle="black";const w=t.dropShadowColor,M=t.dropShadowBlur*this._resolution,P=t.dropShadowDistance*this._resolution;i.shadowColor=en.shared.setValue(w).setAlpha(t.dropShadowAlpha).toRgbaString(),i.shadowBlur=M,i.shadowOffsetX=Math.cos(t.dropShadowAngle)*P,i.shadowOffsetY=Math.sin(t.dropShadowAngle)*P+T}else i.fillStyle=this._generateFillStyle(t,a,r),i.strokeStyle=t.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;let S=(l-f.fontSize)/2;l-f.fontSize<0&&(S=0);for(let w=0;w<a.length;w++)p=t.strokeThickness/2,m=t.strokeThickness/2+w*l+f.ascent+S,t.align==="right"?p+=d-u[w]:t.align==="center"&&(p+=(d-u[w])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(a[w],p+t.padding,m+t.padding-g,!0),t.fill&&this.drawLetterSpacing(a[w],p+t.padding,m+t.padding-g)}this.updateTexture()}drawLetterSpacing(e,t,i,r=!1){const s=this._style.letterSpacing;let o=!1;if(ua.experimentalLetterSpacingSupported&&(ua.experimentalLetterSpacing?(this.context.letterSpacing=`${s}px`,this.context.textLetterSpacing=`${s}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),s===0||o){r?this.context.strokeText(e,t,i):this.context.fillText(e,t,i);return}let a=t;const l=ua.graphemeSegmenter(e);let u=this.context.measureText(e).width,d=0;for(let f=0;f<l.length;++f){const p=l[f];r?this.context.strokeText(p,a,i):this.context.fillText(p,a,i);let m="";for(let v=f+1;v<l.length;++v)m+=l[v];d=this.context.measureText(m).width,a+=u-d+s,u=d}}updateTexture(){const e=this.canvas;if(this._style.trim){const o=DH(e);o.data&&(e.width=o.width,e.height=o.height,this.context.putImageData(o.data,0,0))}const t=this._texture,i=this._style,r=i.trim?0:i.padding,s=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-r,t.trim.y=-r,t.orig.width=t._frame.width-r*2,t.orig.height=t._frame.height-r*2,this._onTextureUpdate(),s.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,i){const r=e.fill;if(Array.isArray(r)){if(r.length===1)return r[0]}else return r;let s;const o=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,l=this.canvas.width/this._resolution-o-a*2,u=this.canvas.height/this._resolution-o-a*2,d=r.slice(),f=e.fillGradientStops.slice();if(!f.length){const p=d.length+1;for(let m=1;m<p;++m)f.push(m/p)}if(d.unshift(r[0]),f.unshift(0),d.push(r[r.length-1]),f.push(1),e.fillGradientType===L0.LINEAR_VERTICAL){s=this.context.createLinearGradient(l/2,a,l/2,u+a);const p=i.fontProperties.fontSize+e.strokeThickness;for(let m=0;m<t.length;m++){const v=i.lineHeight*(m-1)+p,x=i.lineHeight*m;let y=x;m>0&&v>x&&(y=(x+v)/2);const g=x+p,T=i.lineHeight*(m+1);let S=g;m+1<t.length&&T<g&&(S=(g+T)/2);const w=(S-y)/u;for(let M=0;M<d.length;M++){let P=0;typeof f[M]=="number"?P=f[M]:P=M/d.length;let R=Math.min(1,Math.max(0,y/u+P*w));R=Number(R.toFixed(5)),s.addColorStop(R,d[M])}}}else{s=this.context.createLinearGradient(a,u/2,l+a,u/2);const p=d.length+1;let m=1;for(let v=0;v<d.length;v++){let x;typeof f[v]=="number"?x=f[v]:x=m/p,s.addColorStop(x,d[v]),m++}}return s}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},i9,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const t=_a(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const t=_a(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof Fa?this._style=e:this._style=new Fa(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};XL.defaultAutoResolution=!0;let IE=XL;class jg{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Qm{static test(e){return typeof e=="string"&&e.startsWith("info face=")}static parse(e){const t=e.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const s in t){const o=t[s].match(/^[a-z]+/gm)[0],a=t[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(const u in a){const d=a[u].split("="),f=d[0],p=d[1].replace(/"/gm,""),m=parseFloat(p),v=isNaN(m)?p:m;l[f]=v}i[o].push(l)}const r=new jg;return i.info.forEach(s=>r.info.push({face:s.face,size:parseInt(s.size,10)})),i.common.forEach(s=>r.common.push({lineHeight:parseInt(s.lineHeight,10)})),i.page.forEach(s=>r.page.push({id:parseInt(s.id,10),file:s.file})),i.char.forEach(s=>r.char.push({id:parseInt(s.id,10),page:parseInt(s.page,10),x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xoffset:parseInt(s.xoffset,10),yoffset:parseInt(s.yoffset,10),xadvance:parseInt(s.xadvance,10)})),i.kerning.forEach(s=>r.kerning.push({first:parseInt(s.first,10),second:parseInt(s.second,10),amount:parseInt(s.amount,10)})),i.distanceField.forEach(s=>r.distanceField.push({distanceRange:parseInt(s.distanceRange,10),fieldType:s.fieldType})),r}}class H1{static test(e){const t=e;return typeof e!="string"&&"getElementsByTagName"in e&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(e){const t=new jg,i=e.getElementsByTagName("info"),r=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),l=e.getElementsByTagName("distanceField");for(let u=0;u<i.length;u++)t.info.push({face:i[u].getAttribute("face"),size:parseInt(i[u].getAttribute("size"),10)});for(let u=0;u<r.length;u++)t.common.push({lineHeight:parseInt(r[u].getAttribute("lineHeight"),10)});for(let u=0;u<s.length;u++)t.page.push({id:parseInt(s[u].getAttribute("id"),10)||0,file:s[u].getAttribute("file")});for(let u=0;u<o.length;u++){const d=o[u];t.char.push({id:parseInt(d.getAttribute("id"),10),page:parseInt(d.getAttribute("page"),10)||0,x:parseInt(d.getAttribute("x"),10),y:parseInt(d.getAttribute("y"),10),width:parseInt(d.getAttribute("width"),10),height:parseInt(d.getAttribute("height"),10),xoffset:parseInt(d.getAttribute("xoffset"),10),yoffset:parseInt(d.getAttribute("yoffset"),10),xadvance:parseInt(d.getAttribute("xadvance"),10)})}for(let u=0;u<a.length;u++)t.kerning.push({first:parseInt(a[u].getAttribute("first"),10),second:parseInt(a[u].getAttribute("second"),10),amount:parseInt(a[u].getAttribute("amount"),10)});for(let u=0;u<l.length;u++)t.distanceField.push({fieldType:l[u].getAttribute("fieldType"),distanceRange:parseInt(l[u].getAttribute("distanceRange"),10)});return t}}class V1{static test(e){return typeof e=="string"&&e.includes("<font>")?H1.test(Fe.ADAPTER.parseXML(e)):!1}static parse(e){return H1.parse(Fe.ADAPTER.parseXML(e))}}const Ny=[Qm,H1,V1];function r9(n){for(let e=0;e<Ny.length;e++)if(Ny[e].test(n))return Ny[e];return null}function s9(n,e,t,i,r,s){const o=t.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const l=t.dropShadow?t.dropShadowDistance:0,u=t.padding||0,d=n.width/i-l-u*2,f=n.height/i-l-u*2,p=o.slice(),m=t.fillGradientStops.slice();if(!m.length){const v=p.length+1;for(let x=1;x<v;++x)m.push(x/v)}if(p.unshift(o[0]),m.unshift(0),p.push(o[o.length-1]),m.push(1),t.fillGradientType===L0.LINEAR_VERTICAL){a=e.createLinearGradient(d/2,u,d/2,f+u);let v=0;const x=(s.fontProperties.fontSize+t.strokeThickness)/f;for(let y=0;y<r.length;y++){const g=s.lineHeight*y;for(let T=0;T<p.length;T++){let S=0;typeof m[T]=="number"?S=m[T]:S=T/p.length;const w=g/f+S*x;let M=Math.max(v,w);M=Math.min(M,1),a.addColorStop(M,p[T]),v=M}}}else{a=e.createLinearGradient(u,f/2,d+u,f/2);const v=p.length+1;let x=1;for(let y=0;y<p.length;y++){let g;typeof m[y]=="number"?g=m[y]:g=x/v,a.addColorStop(g,p[y]),x++}}return a}function o9(n,e,t,i,r,s,o){const a=t.text,l=t.fontProperties;e.translate(i,r),e.scale(s,s);const u=o.strokeThickness/2,d=-(o.strokeThickness/2);if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=s9(n,e,o,s,[a],t),e.strokeStyle=o.stroke,o.dropShadow){const f=o.dropShadowColor,p=o.dropShadowBlur*s,m=o.dropShadowDistance*s;e.shadowColor=en.shared.setValue(f).setAlpha(o.dropShadowAlpha).toRgbaString(),e.shadowBlur=p,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*m,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*m}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,u,d+t.lineHeight-l.descent),o.fill&&e.fillText(a,u,d+t.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function Jm(n){return n.codePointAt?n.codePointAt(0):n.charCodeAt(0)}function jL(n){return Array.from?Array.from(n):n.split("")}function a9(n){typeof n=="string"&&(n=[n]);const e=[];for(let t=0,i=n.length;t<i;t++){const r=n[t];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const s=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...jL(r))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}const ia=class Rs{constructor(e,t,i){var d;const[r]=e.info,[s]=e.common,[o]=e.page,[a]=e.distanceField,l=Uo(o.file),u={};this._ownsTextures=i,this.font=r.face,this.size=r.size,this.lineHeight=s.lineHeight/l,this.chars={},this.pageTextures=u;for(let f=0;f<e.page.length;f++){const{id:p,file:m}=e.page[f];u[p]=t instanceof Array?t[f]:t[m],a!=null&&a.fieldType&&a.fieldType!=="none"&&(u[p].baseTexture.alphaMode=ji.NO_PREMULTIPLIED_ALPHA,u[p].baseTexture.mipmap=Ws.OFF)}for(let f=0;f<e.char.length;f++){const{id:p,page:m}=e.char[f];let{x:v,y:x,width:y,height:g,xoffset:T,yoffset:S,xadvance:w}=e.char[f];v/=l,x/=l,y/=l,g/=l,T/=l,S/=l,w/=l;const M=new ut(v+u[m].frame.x/l,x+u[m].frame.y/l,y,g);this.chars[p]={xOffset:T,yOffset:S,xAdvance:w,kerning:{},texture:new Pe(u[m].baseTexture,M),page:m}}for(let f=0;f<e.kerning.length;f++){let{first:p,second:m,amount:v}=e.kerning[f];p/=l,m/=l,v/=l,this.chars[m]&&(this.chars[m].kerning[p]=v)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((d=a==null?void 0:a.fieldType)==null?void 0:d.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,t,i){let r;if(e instanceof jg)r=e;else{const o=r9(e);if(!o)throw new Error("Unrecognized data format for font.");r=o.parse(e)}t instanceof Pe&&(t=[t]);const s=new Rs(r,t,i);return Rs.available[s.font]=s,s}static uninstall(e){const t=Rs.available[e];if(!t)throw new Error(`No font found named '${e}'`);t.destroy(),delete Rs.available[e]}static from(e,t,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:r,padding:s,resolution:o,textureWidth:a,textureHeight:l,...u}=Object.assign({},Rs.defaultOptions,i),d=a9(r),f=t instanceof Fa?t:new Fa(t),p=a,m=new jg;m.info[0]={face:f.fontFamily,size:f.fontSize},m.common[0]={lineHeight:f.fontSize};let v=0,x=0,y,g,T,S=0;const w=[];for(let P=0;P<d.length;P++){y||(y=Fe.ADAPTER.createCanvas(),y.width=a,y.height=l,g=y.getContext("2d"),T=new lt(y,{resolution:o,...u}),w.push(new Pe(T)),m.page.push({id:w.length-1,file:""}));const R=d[P],D=ua.measureText(R,f,!1,y),C=D.width,L=Math.ceil(D.height),Z=Math.ceil((f.fontStyle==="italic"?2:1)*C);if(x>=l-L*o){if(x===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${f.fontFamily}', fontSize: ${f.fontSize}px, char: '${R}')`);--P,y=null,g=null,T=null,x=0,v=0,S=0;continue}if(S=Math.max(L+D.fontProperties.descent,S),Z*o+v>=p){if(v===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${f.fontFamily}', fontSize: ${f.fontSize}px, char: '${R}')`);--P,x+=S*o,x=Math.ceil(x),v=0,S=0;continue}o9(y,g,D,v,x,o,f);const V=Jm(D.text);m.char.push({id:V,page:w.length-1,x:v/o,y:x/o,width:Z,height:L,xoffset:0,yoffset:0,xadvance:C-(f.dropShadow?f.dropShadowDistance:0)-(f.stroke?f.strokeThickness:0)}),v+=(Z+2*s)*o,v=Math.ceil(v)}if(!(i!=null&&i.skipKerning))for(let P=0,R=d.length;P<R;P++){const D=d[P];for(let C=0;C<R;C++){const L=d[C],Z=g.measureText(D).width,V=g.measureText(L).width,z=g.measureText(D+L).width-(Z+V);z&&m.kerning.push({first:Jm(D),second:Jm(L),amount:z})}}const M=new Rs(m,w,!0);return Rs.available[e]!==void 0&&Rs.uninstall(e),Rs.available[e]=M,M}};ia.ALPHA=[["a","z"],["A","Z"]," "],ia.NUMERIC=[["0","9"]],ia.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],ia.ASCII=[[" ","~"]],ia.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:ia.ALPHANUMERIC},ia.available={};let ra=ia;class l9{constructor(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const t=this.uvBuffer.data;(!this.data||this.data.length!==t.length)&&(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}}const Uy=new Dt,DC=new Ul,$L=class YL extends Oi{constructor(e,t,i,r=is.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=i||Ks.for2d(),this.drawMode=r,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=Fe.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===is.TRIANGLES&&t.length<YL.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const t=this.geometry,i=this.shader;i.uvMatrix&&(i.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=i._tintRGB,this._texture=i.texture;const r=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[r]),e.plugins[r].render(this)}calculateVertices(){const e=this.geometry.buffers[0],t=e.data,i=e._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==t.length&&(this.vertexData=new Float32Array(t.length));const r=this.transform.worldTransform,s=r.a,o=r.b,a=r.c,l=r.d,u=r.tx,d=r.ty,f=this.vertexData;for(let p=0;p<f.length/2;p++){const m=t[p*2],v=t[p*2+1];f[p*2]=s*m+a*v+u,f[p*2+1]=o*m+l*v+d}if(this._roundPixels){const p=Fe.RESOLUTION;for(let m=0;m<f.length;++m)f[m]=Math.round(f[m]*p)/p}this.vertexDirty=i}calculateUvs(){const e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new l9(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,Uy);const t=this.geometry.getBuffer("aVertexPosition").data,i=DC.points,r=this.geometry.getIndex().data,s=r.length,o=this.drawMode===4?3:1;for(let a=0;a+2<s;a+=o){const l=r[a]*2,u=r[a+1]*2,d=r[a+2]*2;if(i[0]=t[l],i[1]=t[l+1],i[2]=t[u],i[3]=t[u+1],i[4]=t[d],i[5]=t[d+1],DC.contains(Uy.x,Uy.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};$L.BATCHABLE_SIZE=100;let Qd=$L;class D0 extends Da{constructor(e,t,i){super();const r=new Cn(e),s=new Cn(t,!0),o=new Cn(i,!0,!0);this.addAttribute("aVertexPosition",r,2,!1,et.FLOAT).addAttribute("aTextureCoord",s,2,!1,et.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var u9=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,c9=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class Jd extends Vs{constructor(e,t){const i={uSampler:e,alpha:1,uTextureMatrix:an.IDENTITY,uColor:new Float32Array([1,1,1,1])};t=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},t),t.uniforms&&Object.assign(i,t.uniforms),super(t.program||wo.from(c9,u9),i),this._colorDirty=!1,this.uvMatrix=new RE(e),this.batchable=t.program===void 0,this.pluginName=t.pluginName,this._tintColor=new en(t.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=t.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;en.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}var h9=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,d9=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const NC=[],UC=[],FC=[],qL=class KL extends Oi{constructor(e,t={}){super();const{align:i,tint:r,maxWidth:s,letterSpacing:o,fontName:a,fontSize:l}=Object.assign({},KL.styleDefaults,t);if(!ra.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=i,this._tintColor=new en(r),this._font=void 0,this._fontName=a,this._fontSize=l,this.text=e,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new Os(()=>{this.dirty=!0},this,0,0),this._roundPixels=Fe.ROUND_PIXELS,this.dirty=!0,this._resolution=Fe.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var Z;const e=ra.available[this._fontName],t=this.fontSize,i=t/e.size,r=new Dt,s=[],o=[],a=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",u=jL(l),d=this._maxWidth*e.size/t,f=e.distanceFieldType==="none"?NC:UC;let p=null,m=0,v=0,x=0,y=-1,g=0,T=0,S=0,w=0;for(let V=0;V<u.length;V++){const z=u[V],F=Jm(z);if(/(?:\s)/.test(z)&&(y=V,g=m,w++),z==="\r"||z===`
`){o.push(m),a.push(-1),v=Math.max(v,m),++x,++T,r.x=0,r.y+=e.lineHeight,p=null,w=0;continue}const j=e.chars[F];if(!j)continue;p&&j.kerning[p]&&(r.x+=j.kerning[p]);const Q=FC.pop()||{texture:Pe.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Dt};Q.texture=j.texture,Q.line=x,Q.charCode=F,Q.position.x=Math.round(r.x+j.xOffset+this._letterSpacing/2),Q.position.y=Math.round(r.y+j.yOffset),Q.prevSpaces=w,s.push(Q),m=Q.position.x+Math.max(j.xAdvance-j.xOffset,j.texture.orig.width),r.x+=j.xAdvance+this._letterSpacing,S=Math.max(S,j.yOffset+j.texture.height),p=F,y!==-1&&d>0&&r.x>d&&(++T,wc(s,1+y-T,1+V-y),V=y,y=-1,o.push(g),a.push(s.length>0?s[s.length-1].prevSpaces:0),v=Math.max(v,g),x++,r.x=0,r.y+=e.lineHeight,p=null,w=0)}const M=u[u.length-1];M!=="\r"&&M!==`
`&&(/(?:\s)/.test(M)&&(m=g),o.push(m),v=Math.max(v,m),a.push(-1));const P=[];for(let V=0;V<=x;V++){let z=0;this._align==="right"?z=v-o[V]:this._align==="center"?z=(v-o[V])/2:this._align==="justify"&&(z=a[V]<0?0:(v-o[V])/a[V]),P.push(z)}const R=s.length,D={},C=[],L=this._activePagesMeshData;f.push(...L);for(let V=0;V<R;V++){const z=s[V].texture,F=z.baseTexture.uid;if(!D[F]){let j=f.pop();if(!j){const $=new D0;let O,G;e.distanceFieldType==="none"?(O=new Jd(Pe.EMPTY),G=rt.NORMAL):(O=new Jd(Pe.EMPTY,{program:wo.from(d9,h9),uniforms:{uFWidth:0}}),G=rt.NORMAL_NPM);const k=new Qd($,O);k.blendMode=G,j={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:k,vertices:null,uvs:null,indices:null}}j.index=0,j.indexCount=0,j.vertexCount=0,j.uvsCount=0,j.total=0;const{_textureCache:Q}=this;Q[F]=Q[F]||new Pe(z.baseTexture),j.mesh.texture=Q[F],j.mesh.tint=this._tintColor.value,C.push(j),D[F]=j}D[F].total++}for(let V=0;V<L.length;V++)C.includes(L[V])||this.removeChild(L[V].mesh);for(let V=0;V<C.length;V++)C[V].mesh.parent!==this&&this.addChild(C[V].mesh);this._activePagesMeshData=C;for(const V in D){const z=D[V],F=z.total;if(!(((Z=z.indices)==null?void 0:Z.length)>6*F)||z.vertices.length<Qd.BATCHABLE_SIZE*2)z.vertices=new Float32Array(4*2*F),z.uvs=new Float32Array(4*2*F),z.indices=new Uint16Array(6*F);else{const j=z.total,Q=z.vertices;for(let $=j*4*2;$<Q.length;$++)Q[$]=0}z.mesh.size=6*F}for(let V=0;V<R;V++){const z=s[V];let F=z.position.x+P[z.line]*(this._align==="justify"?z.prevSpaces:1);this._roundPixels&&(F=Math.round(F));const j=F*i,Q=z.position.y*i,$=z.texture,O=D[$.baseTexture.uid],G=$.frame,k=$._uvs,H=O.index++;O.indices[H*6+0]=0+H*4,O.indices[H*6+1]=1+H*4,O.indices[H*6+2]=2+H*4,O.indices[H*6+3]=0+H*4,O.indices[H*6+4]=2+H*4,O.indices[H*6+5]=3+H*4,O.vertices[H*8+0]=j,O.vertices[H*8+1]=Q,O.vertices[H*8+2]=j+G.width*i,O.vertices[H*8+3]=Q,O.vertices[H*8+4]=j+G.width*i,O.vertices[H*8+5]=Q+G.height*i,O.vertices[H*8+6]=j,O.vertices[H*8+7]=Q+G.height*i,O.uvs[H*8+0]=k.x0,O.uvs[H*8+1]=k.y0,O.uvs[H*8+2]=k.x1,O.uvs[H*8+3]=k.y1,O.uvs[H*8+4]=k.x2,O.uvs[H*8+5]=k.y2,O.uvs[H*8+6]=k.x3,O.uvs[H*8+7]=k.y3}this._textWidth=v*i,this._textHeight=(r.y+e.lineHeight)*i;for(const V in D){const z=D[V];if(this.anchor.x!==0||this.anchor.y!==0){let $=0;const O=this._textWidth*this.anchor.x,G=this._textHeight*this.anchor.y;for(let k=0;k<z.total;k++)z.vertices[$++]-=O,z.vertices[$++]-=G,z.vertices[$++]-=O,z.vertices[$++]-=G,z.vertices[$++]-=O,z.vertices[$++]-=G,z.vertices[$++]-=O,z.vertices[$++]-=G}this._maxLineHeight=S*i;const F=z.mesh.geometry.getBuffer("aVertexPosition"),j=z.mesh.geometry.getBuffer("aTextureCoord"),Q=z.mesh.geometry.getIndex();F.data=z.vertices,j.data=z.uvs,Q.data=z.indices,F.update(),j.update(),Q.update()}for(let V=0;V<s.length;V++)FC.push(s[V]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:i,size:r}=ra.available[this._fontName];if(i!=="none"){const{a:s,b:o,c:a,d:l}=this.worldTransform,u=Math.sqrt(s*s+o*o),d=Math.sqrt(a*a+l*l),f=(Math.abs(u)+Math.abs(d))/2,p=this.fontSize/r,m=e._view.resolution;for(const v of this._activePagesMeshData)v.mesh.shader.uniforms.uFWidth=f*t*p*m}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=ra.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!ra.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??ra.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:t}=this,i=ra.available[this._fontName].distanceFieldType==="none"?NC:UC;i.push(...this._activePagesMeshData);for(const r of this._activePagesMeshData)this.removeChild(r.mesh);this._activePagesMeshData=[],i.filter(r=>t[r.mesh.texture.baseTexture.uid]).forEach(r=>{r.mesh.texture=Pe.EMPTY});for(const r in t)t[r].destroy(),delete t[r];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};qL.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};let f9=qL;const OC={loader:Ne.LoadParser,resolver:Ne.ResolveParser,cache:Ne.CacheParser,detection:Ne.DetectionParser};$e.handle(Ne.Asset,n=>{const e=n.ref;Object.entries(OC).filter(([t])=>!!e[t]).forEach(([t,i])=>$e.add(Object.assign(e[t],{extension:e[t].extension??i})))},n=>{const e=n.ref;Object.keys(OC).filter(t=>!!e[t]).forEach(t=>$e.remove(e[t]))});class p9{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(t=>{this._assetList.push(t)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<t;i++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function sh(n,e){if(Array.isArray(e)){for(const t of e)if(n.startsWith(`data:${t}`))return!0;return!1}return n.startsWith(`data:${e}`)}function Ha(n,e){const t=n.split("?")[0],i=Gn.extname(t).toLowerCase();return Array.isArray(e)?e.includes(i):i===e}const ns=(n,e,t=!1)=>(Array.isArray(n)||(n=[n]),e?n.map(i=>typeof i=="string"||t?e(i):i):n),W1=(n,e)=>{const t=e.split("?")[1];return t&&(n+=`?${t}`),n};function ZL(n,e,t,i,r){const s=e[t];for(let o=0;o<s.length;o++){const a=s[o];t<e.length-1?ZL(n.replace(i[t],a),e,t+1,i,r):r.push(n.replace(i[t],a))}}function m9(n){const e=/\{(.*?)\}/g,t=n.match(e),i=[];if(t){const r=[];t.forEach(s=>{const o=s.substring(1,s.length-1).split(",");r.push(o)}),ZL(n,r,0,t,i)}else i.push(n);return i}const $g=n=>!Array.isArray(n);class g9{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);return t||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){const i=ns(e);let r;for(let a=0;a<this.parsers.length;a++){const l=this.parsers[a];if(l.test(t)){r=l.getCacheableAssets(i,t);break}}r||(r={},i.forEach(a=>{r[a]=t}));const s=Object.keys(r),o={cacheKeys:s,keys:i};if(i.forEach(a=>{this._cacheMap.set(a,o)}),s.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==t&&console.warn("[Cache] already has key:",a),this._cache.set(a,r[a])}),t instanceof Pe){const a=t;i.forEach(l=>{a.baseTexture!==Pe.EMPTY.baseTexture&&lt.addToCache(a.baseTexture,l),Pe.addToCache(a,l)})}}remove(e){if(!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}const t=this._cacheMap.get(e);t.cacheKeys.forEach(i=>{this._cache.delete(i)}),t.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const yl=new g9;class _9{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,i)=>(this._parsersValidated=!1,e[t]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){const i={promise:null,parser:null};return i.promise=(async()=>{var o,a;let r=null,s=null;if(t.loadParser&&(s=this._parserHash[t.loadParser],s||console.warn(`[Assets] specified load parser "${t.loadParser}" not found while loading ${e}`)),!s){for(let l=0;l<this.parsers.length;l++){const u=this.parsers[l];if(u.load&&((o=u.test)!=null&&o.call(u,e,t,this))){s=u;break}}if(!s)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await s.load(e,t,this),i.parser=s;for(let l=0;l<this.parsers.length;l++){const u=this.parsers[l];u.parse&&u.parse&&await((a=u.testParse)==null?void 0:a.call(u,r,t,this))&&(r=await u.parse(r,t,this)||r,i.parser=u)}return r})(),i}async load(e,t){this._parsersValidated||this._validateParsers();let i=0;const r={},s=$g(e),o=ns(e,u=>({alias:[u],src:u})),a=o.length,l=o.map(async u=>{const d=Gn.toAbsolute(u.src);if(!r[u.src])try{this.promiseCache[d]||(this.promiseCache[d]=this._getLoadPromiseAndParser(d,u)),r[u.src]=await this.promiseCache[d].promise,t&&t(++i/a)}catch(f){throw delete this.promiseCache[d],delete r[u.src],new Error(`[Loader.load] Failed to load ${d}.
${f}`)}});return await Promise.all(l),s?r[o[0].src]:r}async unload(e){const t=ns(e,i=>({alias:[i],src:i})).map(async i=>{var o,a;const r=Gn.toAbsolute(i.src),s=this.promiseCache[r];if(s){const l=await s.promise;delete this.promiseCache[r],(a=(o=s.parser)==null?void 0:o.unload)==null||a.call(o,l,i,this)}});await Promise.all(t)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,t)=>(e[t.name]&&console.warn(`[Assets] loadParser name conflict "${t.name}"`),{...e,[t.name]:t}),{})}}var hs=(n=>(n[n.Low=0]="Low",n[n.Normal=1]="Normal",n[n.High=2]="High",n))(hs||{});const v9=".json",y9="application/json",x9={extension:{type:Ne.LoadParser,priority:hs.Low},name:"loadJson",test(n){return sh(n,y9)||Ha(n,v9)},async load(n){return await(await Fe.ADAPTER.fetch(n)).json()}};$e.add(x9);const S9=".txt",E9="text/plain",T9={name:"loadTxt",extension:{type:Ne.LoadParser,priority:hs.Low},test(n){return sh(n,E9)||Ha(n,S9)},async load(n){return await(await Fe.ADAPTER.fetch(n)).text()}};$e.add(T9);const b9=["normal","bold","100","200","300","400","500","600","700","800","900"],w9=[".ttf",".otf",".woff",".woff2"],A9=["font/ttf","font/otf","font/woff","font/woff2"],M9=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function C9(n){const e=Gn.extname(n),t=Gn.basename(n,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1));let i=t.length>0;for(const s of t)if(!s.match(M9)){i=!1;break}let r=t.join(" ");return i||(r=`"${r.replace(/[\\"]/g,"\\$&")}"`),r}const R9=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function P9(n){return R9.test(n)?n:encodeURI(n)}const I9={extension:{type:Ne.LoadParser,priority:hs.Low},name:"loadWebFont",test(n){return sh(n,A9)||Ha(n,w9)},async load(n,e){var i,r,s;const t=Fe.ADAPTER.getFontFaceSet();if(t){const o=[],a=((i=e.data)==null?void 0:i.family)??C9(n),l=((s=(r=e.data)==null?void 0:r.weights)==null?void 0:s.filter(d=>b9.includes(d)))??["normal"],u=e.data??{};for(let d=0;d<l.length;d++){const f=l[d],p=new FontFace(a,`url(${P9(n)})`,{...u,weight:f});await p.load(),t.add(p),o.push(p)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(n){(Array.isArray(n)?n:[n]).forEach(e=>Fe.ADAPTER.getFontFaceSet().delete(e))}};$e.add(I9);let kC=0,Fy;const L9="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",D9={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${L9}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},N9={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let Oy;class U9{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const t=URL.createObjectURL(new Blob([D9.code],{type:"application/javascript"})),i=new Worker(t);i.addEventListener("message",r=>{i.terminate(),URL.revokeObjectURL(t),e(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Fy===void 0&&(Fy=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<Fy&&(Oy||(Oy=URL.createObjectURL(new Blob([N9.code],{type:"application/javascript"}))),this._createdWorkers++,e=new Worker(Oy),e.addEventListener("message",t=>{this.complete(t.data),this.returnWorker(t.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){e.error!==void 0?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,t){await this._initWorkers();const i=new Promise((r,s)=>{this.queue.push({id:e,arguments:t,resolve:r,reject:s})});return this.next(),i}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const t=this.queue.pop(),i=t.id;this.resolveHash[kC]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:kC++,id:i})}}const BC=new U9;function df(n,e,t){n.resource.internal=!0;const i=new Pe(n),r=()=>{delete e.promiseCache[t],yl.has(t)&&yl.remove(t)};return i.baseTexture.once("destroyed",()=>{t in e.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),r())}),i.once("destroyed",()=>{n.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),r())}),i}const F9=[".jpeg",".jpg",".png",".webp",".avif"],O9=["image/jpeg","image/png","image/webp","image/avif"];async function k9(n){const e=await Fe.ADAPTER.fetch(n);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${n}: ${e.status} ${e.statusText}`);const t=await e.blob();return await createImageBitmap(t)}const N0={name:"loadTextures",extension:{type:Ne.LoadParser,priority:hs.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(n){return sh(n,O9)||Ha(n,F9)},async load(n,e,t){var a;const i=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let r;i?this.config.preferWorkers&&await BC.isImageBitmapSupported()?r=await BC.loadImageBitmap(n):r=await k9(n):r=await new Promise((l,u)=>{const d=new Image;d.crossOrigin=this.config.crossOrigin,d.src=n,d.complete?l(d):(d.onload=()=>l(d),d.onerror=f=>u(f))});const s={...e.data};s.resolution??(s.resolution=Uo(n)),i&&((a=s.resourceOptions)==null?void 0:a.ownsImageBitmap)===void 0&&(s.resourceOptions={...s.resourceOptions},s.resourceOptions.ownsImageBitmap=!0);const o=new lt(r,s);return o.resource.src=n,df(o,t,n)},unload(n){n.destroy(!0)}};$e.add(N0);const B9=".svg",z9="image/svg+xml",G9={extension:{type:Ne.LoadParser,priority:hs.High},name:"loadSVG",test(n){return sh(n,z9)||Ha(n,B9)},async testParse(n){return O1.test(n)},async parse(n,e,t){var s;const i=new O1(n,(s=e==null?void 0:e.data)==null?void 0:s.resourceOptions);await i.load();const r=new lt(i,{resolution:Uo(n),...e==null?void 0:e.data});return r.resource.src=e.src,df(r,t,e.src)},async load(n,e){return(await Fe.ADAPTER.fetch(n)).text()},unload:N0.unload};$e.add(G9);const H9=[".mp4",".m4v",".webm",".ogv"],V9=["video/mp4","video/webm","video/ogg"],W9={name:"loadVideo",extension:{type:Ne.LoadParser,priority:hs.High},config:{defaultAutoPlay:!0},test(n){return sh(n,V9)||Ha(n,H9)},async load(n,e,t){var o;let i;const r=await(await Fe.ADAPTER.fetch(n)).blob(),s=URL.createObjectURL(r);try{const a={autoPlay:this.config.defaultAutoPlay,...(o=e==null?void 0:e.data)==null?void 0:o.resourceOptions},l=new HL(s,a);await l.load();const u=new lt(l,{alphaMode:await mH(),resolution:Uo(n),...e==null?void 0:e.data});u.resource.src=n,i=df(u,t,n),i.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(s)})}catch(a){throw URL.revokeObjectURL(s),a}return i},unload(n){n.destroy(!0)}};$e.add(W9);class X9{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>`${e}${this._bundleIdConnector}${t}`,extractAssetIdFromBundle:(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const t=e;this._defaultSearchParams=Object.keys(t).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(t[i])}`).join("&")}}getAlias(e){const{alias:t,name:i,src:r,srcs:s}=e;return ns(t||i||r||s,o=>typeof o=="string"?o:Array.isArray(o)?o.map(a=>(a==null?void 0:a.src)??(a==null?void 0:a.srcs)??a):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(t=>{this.addBundle(t.name,t.assets)})}addBundle(e,t){const i=[];Array.isArray(t)?t.forEach(r=>{const s=r.src??r.srcs,o=r.alias??r.name;let a;if(typeof o=="string"){const l=this._createBundleAssetId(e,o);i.push(l),a=[o,l]}else{const l=o.map(u=>this._createBundleAssetId(e,u));i.push(...l),a=[...o,...l]}this.add({...r,alias:a,src:s})}):Object.keys(t).forEach(r=>{const s=[r,this._createBundleAssetId(e,r)];if(typeof t[r]=="string")this.add({alias:s,src:t[r]});else if(Array.isArray(t[r]))this.add({alias:s,src:t[r]});else{const o=t[r],a=o.src??o.srcs;this.add({...o,alias:s,src:Array.isArray(a)?a:[a]})}i.push(...s)}),this._bundles[e]=i}add(e,t,i,r,s){const o=[];typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"?(Pt("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:e,src:t,data:i,format:r,loadParser:s})):Array.isArray(e)?o.push(...e):o.push(e);let a;a=l=>{this.hasKey(l)&&console.warn(`[Resolver] already has key: ${l} overwriting`)},ns(o).forEach(l=>{const{src:u,srcs:d}=l;let{data:f,format:p,loadParser:m}=l;const v=ns(u||d).map(g=>typeof g=="string"?m9(g):Array.isArray(g)?g:[g]),x=this.getAlias(l);Array.isArray(x)?x.forEach(a):a(x);const y=[];v.forEach(g=>{g.forEach(T=>{let S={};if(typeof T!="object"){S.src=T;for(let w=0;w<this._parsers.length;w++){const M=this._parsers[w];if(M.test(T)){S=M.parse(T);break}}}else f=T.data??f,p=T.format??p,m=T.loadParser??m,S={...S,...T};if(!x)throw new Error(`[Resolver] alias is undefined for this asset: ${S.src}`);S=this.buildResolvedAsset(S,{aliases:x,data:f,format:p,loadParser:m}),y.push(S)})}),x.forEach(g=>{this._assetMap[g]=y})})}resolveBundle(e){const t=$g(e);e=ns(e);const i={};return e.forEach(r=>{const s=this._bundles[r];if(s){const o=this.resolve(s),a={};for(const l in o){const u=o[l];a[this._extractAssetIdFromBundle(r,l)]=u}i[r]=a}}),t?i[e[0]]:i}resolveUrl(e){const t=this.resolve(e);if(typeof e!="string"){const i={};for(const r in t)i[r]=t[r].src;return i}return t.src}resolve(e){const t=$g(e);e=ns(e);const i={};return e.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let s=this._assetMap[r];const o=s[0],a=this._getPreferredOrder(s);a==null||a.priority.forEach(l=>{a.params[l].forEach(u=>{const d=s.filter(f=>f[l]?f[l]===u:!1);d.length&&(s=d)})}),this._resolverHash[r]=s[0]??o}else this._resolverHash[r]=this.buildResolvedAsset({alias:[r],src:r},{});i[r]=this._resolverHash[r]}),t?i[e[0]]:i}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let t=0;t<e.length;t++){const i=e[0],r=this._preferredOrder.find(s=>s.params.format.includes(i.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const t=/\?/.test(e)?"&":"?";return`${e}${t}${this._defaultSearchParams}`}buildResolvedAsset(e,t){const{aliases:i,data:r,loadParser:s,format:o}=t;return(this._basePath||this._rootPath)&&(e.src=Gn.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=i??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...r||{},...e.data},e.loadParser=s??e.loadParser,e.format=o??Gn.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class j9{constructor(){this._detections=[],this._initialized=!1,this.resolver=new X9,this.loader=new _9,this.cache=yl,this._backgroundLoader=new p9(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var s,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let a=e.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const t=((s=e.texturePreference)==null?void 0:s.resolution)??1,i=typeof t=="number"?[t]:t,r=await this._detectFormats({preferredFormats:(o=e.texturePreference)==null?void 0:o.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:i}}),e.preferences&&this.setPreferences(e.preferences)}add(e,t,i,r,s){this.resolver.add(e,t,i,r,s)}async load(e,t){this._initialized||await this.init();const i=$g(e),r=ns(e).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(u=>!this.resolver.hasKey(u))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),s=this.resolver.resolve(r),o=await this._mapLoadToResolve(s,t);return i?o[r[0]]:o}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let i=!1;typeof e=="string"&&(i=!0,e=[e]);const r=this.resolver.resolveBundle(e),s={},o=Object.keys(r);let a=0,l=0;const u=()=>{t==null||t(++a/l)},d=o.map(f=>{const p=r[f];return l+=Object.keys(p).length,this._mapLoadToResolve(p,u).then(m=>{s[f]=m})});return await Promise.all(d),i?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolveBundle(e);Object.values(t).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return yl.get(e);const t={};for(let i=0;i<e.length;i++)t[i]=yl.get(e[i]);return t}async _mapLoadToResolve(e,t){const i=Object.values(e),r=Object.keys(e);this._backgroundLoader.active=!1;const s=await this.loader.load(i,t);this._backgroundLoader.active=!0;const o={};return i.forEach((a,l)=>{const u=s[a.src],d=[a.src];a.alias&&d.push(...a.alias),o[r[l]]=u,yl.set(d,u)}),o}async unload(e){this._initialized||await this.init();const t=ns(e).map(r=>typeof r!="string"?r.src:r),i=this.resolver.resolve(t);await this._unloadFromResolved(i)}async unloadBundle(e){this._initialized||await this.init(),e=ns(e);const t=this.resolver.resolveBundle(e),i=Object.keys(t).map(r=>this._unloadFromResolved(t[r]));await Promise.all(i)}async _unloadFromResolved(e){const t=Object.values(e);t.forEach(i=>{yl.remove(i.src)}),await this.loader.unload(t)}async _detectFormats(e){let t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const i of e.detections)e.skipDetections||await i.test()?t=await i.add(t):e.skipDetections||(t=await i.remove(t));return t=t.filter((i,r)=>t.indexOf(i)===r),t}get detections(){return this._detections}get preferWorkers(){return N0.config.preferWorkers}set preferWorkers(e){Pt("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(i=>i in e).forEach(i=>{t.config[i]=e[i]})})}}const Al=new j9;$e.handleByList(Ne.LoadParser,Al.loader.parsers).handleByList(Ne.ResolveParser,Al.resolver.parsers).handleByList(Ne.CacheParser,Al.cache.parsers).handleByList(Ne.DetectionParser,Al.detections);const $9={extension:Ne.CacheParser,test:n=>Array.isArray(n)&&n.every(e=>e instanceof Pe),getCacheableAssets:(n,e)=>{const t={};return n.forEach(i=>{e.forEach((r,s)=>{t[i+(s===0?"":s+1)]=r})}),t}};$e.add($9);async function QL(n){if("Image"in globalThis)return new Promise(e=>{const t=new Image;t.onload=()=>{e(!0)},t.onerror=()=>{e(!1)},t.src=n});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(n)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const Y9={extension:{type:Ne.DetectionParser,priority:1},test:async()=>QL("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async n=>[...n,"avif"],remove:async n=>n.filter(e=>e!=="avif")};$e.add(Y9);const q9={extension:{type:Ne.DetectionParser,priority:0},test:async()=>QL("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async n=>[...n,"webp"],remove:async n=>n.filter(e=>e!=="webp")};$e.add(q9);const zC=["png","jpg","jpeg"],K9={extension:{type:Ne.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async n=>[...n,...zC],remove:async n=>n.filter(e=>!zC.includes(e))};$e.add(K9);const Z9="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function LE(n){return Z9?!1:document.createElement("video").canPlayType(n)!==""}const Q9={extension:{type:Ne.DetectionParser,priority:0},test:async()=>LE("video/webm"),add:async n=>[...n,"webm"],remove:async n=>n.filter(e=>e!=="webm")};$e.add(Q9);const J9={extension:{type:Ne.DetectionParser,priority:0},test:async()=>LE("video/mp4"),add:async n=>[...n,"mp4","m4v"],remove:async n=>n.filter(e=>e!=="mp4"&&e!=="m4v")};$e.add(J9);const eV={extension:{type:Ne.DetectionParser,priority:0},test:async()=>LE("video/ogg"),add:async n=>[...n,"ogv"],remove:async n=>n.filter(e=>e!=="ogv")};$e.add(eV);const tV={extension:Ne.ResolveParser,test:N0.test,parse:n=>{var e;return{resolution:parseFloat(((e=Fe.RETINA_PREFIX.exec(n))==null?void 0:e[1])??"1"),format:Gn.extname(n).slice(1),src:n}}};$e.add(tV);const nV=[".xml",".fnt"],iV={extension:{type:Ne.LoadParser,priority:hs.Normal},name:"loadBitmapFont",test(n){return nV.includes(Gn.extname(n).toLowerCase())},async testParse(n){return Qm.test(n)||V1.test(n)},async parse(n,e,t){const i=Qm.test(n)?Qm.parse(n):V1.parse(n),{src:r}=e,{page:s}=i,o=[];for(let u=0;u<s.length;++u){const d=s[u].file;let f=Gn.join(Gn.dirname(r),d);f=W1(f,r),o.push(f)}const a=await t.load(o),l=o.map(u=>a[u]);return ra.install(i,l,!0)},async load(n,e){return(await Fe.ADAPTER.fetch(n)).text()},unload(n){n.destroy()}};$e.add(iV);const Yg={build(n){const e=n.points;let t,i,r,s,o,a;if(n.type===di.CIRC){const v=n.shape;t=v.x,i=v.y,o=a=v.radius,r=s=0}else if(n.type===di.ELIP){const v=n.shape;t=v.x,i=v.y,o=v.width,a=v.height,r=s=0}else{const v=n.shape,x=v.width/2,y=v.height/2;t=v.x+x,i=v.y+y,o=a=Math.max(0,Math.min(v.radius,Math.min(x,y))),r=x-o,s=y-a}if(!(o>=0&&a>=0&&r>=0&&s>=0)){e.length=0;return}const l=Math.ceil(2.3*Math.sqrt(o+a)),u=l*8+(r?4:0)+(s?4:0);if(e.length=u,u===0)return;if(l===0){e.length=8,e[0]=e[6]=t+r,e[1]=e[3]=i+s,e[2]=e[4]=t-r,e[5]=e[7]=i-s;return}let d=0,f=l*4+(r?2:0)+2,p=f,m=u;{const v=r+o,x=s,y=t+v,g=t-v,T=i+x;if(e[d++]=y,e[d++]=T,e[--f]=T,e[--f]=g,s){const S=i-x;e[p++]=g,e[p++]=S,e[--m]=S,e[--m]=y}}for(let v=1;v<l;v++){const x=Math.PI/2*(v/l),y=r+Math.cos(x)*o,g=s+Math.sin(x)*a,T=t+y,S=t-y,w=i+g,M=i-g;e[d++]=T,e[d++]=w,e[--f]=w,e[--f]=S,e[p++]=S,e[p++]=M,e[--m]=M,e[--m]=T}{const v=r,x=s+a,y=t+v,g=t-v,T=i+x,S=i-x;e[d++]=y,e[d++]=T,e[--m]=S,e[--m]=y,r&&(e[d++]=g,e[d++]=T,e[--m]=S,e[--m]=g)}},triangulate(n,e){const t=n.points,i=e.points,r=e.indices;if(t.length===0)return;let s=i.length/2;const o=s;let a,l;if(n.type!==di.RREC){const d=n.shape;a=d.x,l=d.y}else{const d=n.shape;a=d.x+d.width/2,l=d.y+d.height/2}const u=n.matrix;i.push(n.matrix?u.a*a+u.c*l+u.tx:a,n.matrix?u.b*a+u.d*l+u.ty:l),s++,i.push(t[0],t[1]);for(let d=2;d<t.length;d+=2)i.push(t[d],t[d+1]),r.push(s++,o,s);r.push(o+1,o,s)}};function GC(n,e=!1){const t=n.length;if(t<6)return;let i=0;for(let r=0,s=n[t-2],o=n[t-1];r<t;r+=2){const a=n[r],l=n[r+1];i+=(a-s)*(l+o),s=a,o=l}if(!e&&i>0||e&&i<=0){const r=t/2;for(let s=r+r%2;s<t;s+=2){const o=t-s-2,a=t-s-1,l=s,u=s+1;[n[o],n[l]]=[n[l],n[o]],[n[a],n[u]]=[n[u],n[a]]}}}const JL={build(n){n.points=n.shape.points.slice()},triangulate(n,e){let t=n.points;const i=n.holes,r=e.points,s=e.indices;if(t.length>=6){GC(t,!1);const o=[];for(let u=0;u<i.length;u++){const d=i[u];GC(d.points,!0),o.push(t.length/2),t=t.concat(d.points)}const a=j6(t,o,2);if(!a)return;const l=r.length/2;for(let u=0;u<a.length;u+=3)s.push(a[u]+l),s.push(a[u+1]+l),s.push(a[u+2]+l);for(let u=0;u<t.length;u++)r.push(t[u])}}},rV={build(n){const e=n.shape,t=e.x,i=e.y,r=e.width,s=e.height,o=n.points;o.length=0,r>=0&&s>=0&&o.push(t,i,t+r,i,t+r,i+s,t,i+s)},triangulate(n,e){const t=n.points,i=e.points;if(t.length===0)return;const r=i.length/2;i.push(t[0],t[1],t[2],t[3],t[6],t[7],t[4],t[5]),e.indices.push(r,r+1,r+2,r+1,r+2,r+3)}},sV={build(n){Yg.build(n)},triangulate(n,e){Yg.triangulate(n,e)}};var Mr=(n=>(n.MITER="miter",n.BEVEL="bevel",n.ROUND="round",n))(Mr||{}),va=(n=>(n.BUTT="butt",n.ROUND="round",n.SQUARE="square",n))(va||{});const qc={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(n,e=20){if(!this.adaptive||!n||isNaN(n))return e;let t=Math.ceil(n/this.maxLength);return t<this.minSegments?t=this.minSegments:t>this.maxSegments&&(t=this.maxSegments),t}};class HC{static curveTo(e,t,i,r,s,o){const a=o[o.length-2],l=o[o.length-1]-t,u=a-e,d=r-t,f=i-e,p=Math.abs(l*f-u*d);if(p<1e-8||s===0)return(o[o.length-2]!==e||o[o.length-1]!==t)&&o.push(e,t),null;const m=l*l+u*u,v=d*d+f*f,x=l*d+u*f,y=s*Math.sqrt(m)/p,g=s*Math.sqrt(v)/p,T=y*x/m,S=g*x/v,w=y*f+g*u,M=y*d+g*l,P=u*(g+T),R=l*(g+T),D=f*(y+S),C=d*(y+S),L=Math.atan2(R-M,P-w),Z=Math.atan2(C-M,D-w);return{cx:w+e,cy:M+t,radius:s,startAngle:L,endAngle:Z,anticlockwise:u*d>f*l}}static arc(e,t,i,r,s,o,a,l,u){const d=a-o,f=qc._segmentsCount(Math.abs(d)*s,Math.ceil(Math.abs(d)/zg)*40),p=d/(f*2),m=p*2,v=Math.cos(p),x=Math.sin(p),y=f-1,g=y%1/y;for(let T=0;T<=y;++T){const S=T+g*T,w=p+o+m*S,M=Math.cos(w),P=-Math.sin(w);u.push((v*M+x*P)*s+i,(v*-P+x*M)*s+r)}}}class oV{constructor(){this.reset()}begin(e,t,i){this.reset(),this.style=e,this.start=t,this.attribStart=i}end(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class DE{static curveLength(e,t,i,r,s,o,a,l){let u=0,d=0,f=0,p=0,m=0,v=0,x=0,y=0,g=0,T=0,S=0,w=e,M=t;for(let P=1;P<=10;++P)d=P/10,f=d*d,p=f*d,m=1-d,v=m*m,x=v*m,y=x*e+3*v*d*i+3*m*f*s+p*a,g=x*t+3*v*d*r+3*m*f*o+p*l,T=w-y,S=M-g,w=y,M=g,u+=Math.sqrt(T*T+S*S);return u}static curveTo(e,t,i,r,s,o,a){const l=a[a.length-2],u=a[a.length-1];a.length-=2;const d=qc._segmentsCount(DE.curveLength(l,u,e,t,i,r,s,o));let f=0,p=0,m=0,v=0,x=0;a.push(l,u);for(let y=1,g=0;y<=d;++y)g=y/d,f=1-g,p=f*f,m=p*f,v=g*g,x=v*g,a.push(m*l+3*p*g*e+3*f*v*i+x*s,m*u+3*p*g*t+3*f*v*r+x*o)}}function VC(n,e,t,i,r,s,o,a){const l=n-t*r,u=e-i*r,d=n+t*s,f=e+i*s;let p,m;o?(p=i,m=-t):(p=-i,m=t);const v=l+p,x=u+m,y=d+p,g=f+m;return a.push(v,x,y,g),2}function rl(n,e,t,i,r,s,o,a){const l=t-n,u=i-e;let d=Math.atan2(l,u),f=Math.atan2(r-n,s-e);a&&d<f?d+=Math.PI*2:!a&&d>f&&(f+=Math.PI*2);let p=d;const m=f-d,v=Math.abs(m),x=Math.sqrt(l*l+u*u),y=(15*v*Math.sqrt(x)/Math.PI>>0)+1,g=m/y;if(p+=g,a){o.push(n,e,t,i);for(let T=1,S=p;T<y;T++,S+=g)o.push(n,e,n+Math.sin(S)*x,e+Math.cos(S)*x);o.push(n,e,r,s)}else{o.push(t,i,n,e);for(let T=1,S=p;T<y;T++,S+=g)o.push(n+Math.sin(S)*x,e+Math.cos(S)*x,n,e);o.push(r,s,n,e)}return y*2}function aV(n,e){const t=n.shape;let i=n.points||t.points.slice();const r=e.closePointEps;if(i.length===0)return;const s=n.lineStyle,o=new Dt(i[0],i[1]),a=new Dt(i[i.length-2],i[i.length-1]),l=t.type!==di.POLY||t.closeStroke,u=Math.abs(o.x-a.x)<r&&Math.abs(o.y-a.y)<r;if(l){i=i.slice(),u&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));const $=(o.x+a.x)*.5,O=(a.y+o.y)*.5;i.unshift($,O),i.push($,O)}const d=e.points,f=i.length/2;let p=i.length;const m=d.length/2,v=s.width/2,x=v*v,y=s.miterLimit*s.miterLimit;let g=i[0],T=i[1],S=i[2],w=i[3],M=0,P=0,R=-(T-w),D=g-S,C=0,L=0,Z=Math.sqrt(R*R+D*D);R/=Z,D/=Z,R*=v,D*=v;const V=s.alignment,z=(1-V)*2,F=V*2;l||(s.cap===va.ROUND?p+=rl(g-R*(z-F)*.5,T-D*(z-F)*.5,g-R*z,T-D*z,g+R*F,T+D*F,d,!0)+2:s.cap===va.SQUARE&&(p+=VC(g,T,R,D,z,F,!0,d))),d.push(g-R*z,T-D*z,g+R*F,T+D*F);for(let $=1;$<f-1;++$){g=i[($-1)*2],T=i[($-1)*2+1],S=i[$*2],w=i[$*2+1],M=i[($+1)*2],P=i[($+1)*2+1],R=-(T-w),D=g-S,Z=Math.sqrt(R*R+D*D),R/=Z,D/=Z,R*=v,D*=v,C=-(w-P),L=S-M,Z=Math.sqrt(C*C+L*L),C/=Z,L/=Z,C*=v,L*=v;const O=S-g,G=T-w,k=S-M,H=P-w,te=O*k+G*H,ee=G*k-H*O,re=ee<0;if(Math.abs(ee)<.001*Math.abs(te)){d.push(S-R*z,w-D*z,S+R*F,w+D*F),te>=0&&(s.join===Mr.ROUND?p+=rl(S,w,S-R*z,w-D*z,S-C*z,w-L*z,d,!1)+4:p+=2,d.push(S-C*F,w-L*F,S+C*z,w+L*z));continue}const ge=(-R+g)*(-D+w)-(-R+S)*(-D+T),ve=(-C+M)*(-L+w)-(-C+S)*(-L+P),Me=(O*ve-k*ge)/ee,Ze=(H*ge-G*ve)/ee,Ye=(Me-S)*(Me-S)+(Ze-w)*(Ze-w),ze=S+(Me-S)*z,Ie=w+(Ze-w)*z,q=S-(Me-S)*F,ct=w-(Ze-w)*F,Xe=Math.min(O*O+G*G,k*k+H*H),st=re?z:F,nt=Xe+st*st*x,Zt=Ye<=nt;let gt=s.join;if(gt===Mr.MITER&&Ye/x>y&&(gt=Mr.BEVEL),Zt)switch(gt){case Mr.MITER:{d.push(ze,Ie,q,ct);break}case Mr.BEVEL:{re?d.push(ze,Ie,S+R*F,w+D*F,ze,Ie,S+C*F,w+L*F):d.push(S-R*z,w-D*z,q,ct,S-C*z,w-L*z,q,ct),p+=2;break}case Mr.ROUND:{re?(d.push(ze,Ie,S+R*F,w+D*F),p+=rl(S,w,S+R*F,w+D*F,S+C*F,w+L*F,d,!0)+4,d.push(ze,Ie,S+C*F,w+L*F)):(d.push(S-R*z,w-D*z,q,ct),p+=rl(S,w,S-R*z,w-D*z,S-C*z,w-L*z,d,!1)+4,d.push(S-C*z,w-L*z,q,ct));break}}else{switch(d.push(S-R*z,w-D*z,S+R*F,w+D*F),gt){case Mr.MITER:{re?d.push(q,ct,q,ct):d.push(ze,Ie,ze,Ie),p+=2;break}case Mr.ROUND:{re?p+=rl(S,w,S+R*F,w+D*F,S+C*F,w+L*F,d,!0)+2:p+=rl(S,w,S-R*z,w-D*z,S-C*z,w-L*z,d,!1)+2;break}}d.push(S-C*z,w-L*z,S+C*F,w+L*F),p+=2}}g=i[(f-2)*2],T=i[(f-2)*2+1],S=i[(f-1)*2],w=i[(f-1)*2+1],R=-(T-w),D=g-S,Z=Math.sqrt(R*R+D*D),R/=Z,D/=Z,R*=v,D*=v,d.push(S-R*z,w-D*z,S+R*F,w+D*F),l||(s.cap===va.ROUND?p+=rl(S-R*(z-F)*.5,w-D*(z-F)*.5,S-R*z,w-D*z,S+R*F,w+D*F,d,!1)+2:s.cap===va.SQUARE&&(p+=VC(S,w,R,D,z,F,!1,d)));const j=e.indices,Q=qc.epsilon*qc.epsilon;for(let $=m;$<p+m-2;++$)g=d[$*2],T=d[$*2+1],S=d[($+1)*2],w=d[($+1)*2+1],M=d[($+2)*2],P=d[($+2)*2+1],!(Math.abs(g*(w-P)+S*(P-T)+M*(T-w))<Q)&&j.push($,$+1,$+2)}function lV(n,e){let t=0;const i=n.shape,r=n.points||i.points,s=i.type!==di.POLY||i.closeStroke;if(r.length===0)return;const o=e.points,a=e.indices,l=r.length/2,u=o.length/2;let d=u;for(o.push(r[0],r[1]),t=1;t<l;t++)o.push(r[t*2],r[t*2+1]),a.push(d,d+1),d++;s&&a.push(d,u)}function WC(n,e){n.lineStyle.native?lV(n,e):aV(n,e)}class NE{static curveLength(e,t,i,r,s,o){const a=e-2*i+s,l=t-2*r+o,u=2*i-2*e,d=2*r-2*t,f=4*(a*a+l*l),p=4*(a*u+l*d),m=u*u+d*d,v=2*Math.sqrt(f+p+m),x=Math.sqrt(f),y=2*f*x,g=2*Math.sqrt(m),T=p/x;return(y*v+x*p*(v-g)+(4*m*f-p*p)*Math.log((2*x+T+v)/(T+g)))/(4*y)}static curveTo(e,t,i,r,s){const o=s[s.length-2],a=s[s.length-1],l=qc._segmentsCount(NE.curveLength(o,a,e,t,i,r));let u=0,d=0;for(let f=1;f<=l;++f){const p=f/l;u=o+(e-o)*p,d=a+(t-a)*p,s.push(u+(e+(i-e)*p-u)*p,d+(t+(r-t)*p-d)*p)}}}const ky={[di.POLY]:JL,[di.CIRC]:Yg,[di.ELIP]:Yg,[di.RECT]:rV,[di.RREC]:sV},XC=[],dm=[];class qg{constructor(e,t=null,i=null,r=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=i,this.fillStyle=t,this.matrix=r,this.type=e.type}clone(){return new qg(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const zu=new Dt,e3=class t3 extends oL{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Xg,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),dm.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t.reset(),XC.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,i=null,r=null){const s=new qg(e,t,i,r);return this.graphicsData.push(s),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;const i=new qg(e,null,null,t),r=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=r.lineStyle,r.holes.push(i),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const t=this.graphicsData;for(let i=0;i<t.length;++i){const r=t[i];if(r.fillStyle.visible&&r.shape&&(r.matrix?r.matrix.applyInverse(e,zu):zu.copyFrom(e),r.shape.contains(zu.x,zu.y))){let s=!1;if(r.holes){for(let o=0;o<r.holes.length;o++)if(r.holes[o].shape.contains(zu.x,zu.y)){s=!0;break}}if(!s)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,t=this.graphicsData;let i=null,r=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],r=i.style);for(let l=this.shapeIndex;l<t.length;l++){this.shapeIndex++;const u=t[l],d=u.fillStyle,f=u.lineStyle;ky[u.type].build(u),u.matrix&&this.transformPoints(u.points,u.matrix),(d.visible||f.visible)&&this.processHoles(u.holes);for(let p=0;p<2;p++){const m=p===0?d:f;if(!m.visible)continue;const v=m.texture.baseTexture,x=this.indices.length,y=this.points.length/2;v.wrapMode=Co.REPEAT,p===0?this.processFill(u):this.processLine(u);const g=this.points.length/2-y;g!==0&&(i&&!this._compareStyles(r,m)&&(i.end(x,y),i=null),i||(i=XC.pop()||new oV,i.begin(m,x,y),this.batches.push(i),r=m),this.addUvs(this.points,e,m.texture,y,g,m.matrix))}}const s=this.indices.length,o=this.points.length/2;if(i&&i.end(s,o),this.batches.length===0){this.batchable=!0;return}const a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){const i=this.graphicsData[e],r=i.fillStyle,s=i.lineStyle;if(r&&!r.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let t=0,i=e.length;t<i;t++){const r=e[t];for(let s=0;s<r.size;s++){const o=r.start+s;this.indicesUint16[o]=this.indicesUint16[o]-r.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let t=0;t<e.length;t++)if(e[t].style.native)return!1;return this.points.length<t3.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++lt._globalBatch;for(let f=0;f<this.drawCalls.length;f++)this.drawCalls[f].texArray.clear(),dm.push(this.drawCalls[f]);this.drawCalls.length=0;const t=this.colors,i=this.textureIds;let r=dm.pop();r||(r=new M1,r.texArray=new I1),r.texArray.count=0,r.start=0,r.size=0,r.type=is.TRIANGLES;let s=0,o=null,a=0,l=!1,u=is.TRIANGLES,d=0;this.drawCalls.push(r);for(let f=0;f<this.batches.length;f++){const p=this.batches[f],m=8,v=p.style,x=v.texture.baseTexture;l!==!!v.native&&(l=!!v.native,u=l?is.LINES:is.TRIANGLES,o=null,s=m,e++),o!==x&&(o=x,x._batchEnabled!==e&&(s===m&&(e++,s=0,r.size>0&&(r=dm.pop(),r||(r=new M1,r.texArray=new I1),this.drawCalls.push(r)),r.start=d,r.size=0,r.texArray.count=0,r.type=u),x.touched=1,x._batchEnabled=e,x._batchLocation=s,x.wrapMode=Co.REPEAT,r.texArray.elements[r.texArray.count++]=x,s++)),r.size+=p.size,d+=p.size,a=x._batchLocation,this.addColors(t,v.color,v.alpha,p.attribSize,p.attribStart),this.addTextureIds(i,a,p.attribSize,p.attribStart)}lt._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,t=this.uvs,i=this.colors,r=this.textureIds,s=new ArrayBuffer(e.length*3*4),o=new Float32Array(s),a=new Uint32Array(s);let l=0;for(let u=0;u<e.length/2;u++)o[l++]=e[u*2],o[l++]=e[u*2+1],o[l++]=t[u*2],o[l++]=t[u*2+1],a[l++]=i[u],o[l++]=r[u];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?JL.triangulate(e,this):ky[e.type].triangulate(e,this)}processLine(e){WC(e,this);for(let t=0;t<e.holes.length;t++)WC(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){const i=e[t];ky[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let i=0;i<e.length/2;i++){const r=e[i*2],s=e[i*2+1];e[i*2]=t.a*r+t.c*s+t.tx,e[i*2+1]=t.b*r+t.d*s+t.ty}}addColors(e,t,i,r,s=0){const o=en.shared.setValue(t).toLittleEndianNumber(),a=en.shared.setValue(o).toPremultiplied(i);e.length=Math.max(e.length,s+r);for(let l=0;l<r;l++)e[s+l]=a}addTextureIds(e,t,i,r=0){e.length=Math.max(e.length,r+i);for(let s=0;s<i;s++)e[r+s]=t}addUvs(e,t,i,r,s,o=null){let a=0;const l=t.length,u=i.frame;for(;a<s;){let f=e[(r+a)*2],p=e[(r+a)*2+1];if(o){const m=o.a*f+o.c*p+o.tx;p=o.b*f+o.d*p+o.ty,f=m}a++,t.push(f/u.width,p/u.height)}const d=i.baseTexture;(u.width<d.width||u.height<d.height)&&this.adjustUvs(t,i,l,s)}adjustUvs(e,t,i,r){const s=t.baseTexture,o=1e-6,a=i+r*2,l=t.frame,u=l.width/s.width,d=l.height/s.height;let f=l.x/l.width,p=l.y/l.height,m=Math.floor(e[i]+o),v=Math.floor(e[i+1]+o);for(let x=i+2;x<a;x+=2)m=Math.min(m,Math.floor(e[x]+o)),v=Math.min(v,Math.floor(e[x+1]+o));f-=m,p-=v;for(let x=i;x<a;x+=2)e[x]=(e[x]+f)*u,e[x+1]=(e[x+1]+p)*d}};e3.BATCHABLE_SIZE=100;let uV=e3;class U0{constructor(){this.color=16777215,this.alpha=1,this.texture=Pe.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new U0;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=Pe.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class UE extends U0{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=va.BUTT,this.join=Mr.MITER,this.miterLimit=10}clone(){const e=new UE;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=va.BUTT,this.join=Mr.MITER,this.miterLimit=10}}const By={},X1=class eg extends Oi{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new U0,this._lineStyle=new UE,this._matrix=null,this._holeMode=!1,this.state=Ks.for2d(),this._geometry=e||new uV,this._geometry.refCount++,this._transformID=-1,this._tintColor=new en(16777215),this.blendMode=rt.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new eg(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,i,r=.5,s=!1){return typeof e=="number"&&(e={width:e,color:t,alpha:i,alignment:r,native:s}),this.lineTextureStyle(e)}lineTextureStyle(e){const t={width:0,texture:Pe.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:va.BUTT,join:Mr.MITER,miterLimit:10};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const i=e.width>0&&e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:i},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Ul,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new Ul,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);const i=this.currentPath.points,r=i[i.length-2],s=i[i.length-1];return(r!==e||s!==t)&&i.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,i,r){this._initCurve();const s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),NE.curveTo(e,t,i,r,s),this}bezierCurveTo(e,t,i,r,s,o){return this._initCurve(),DE.curveTo(e,t,i,r,s,o,this.currentPath.points),this}arcTo(e,t,i,r,s){this._initCurve(e,t);const o=this.currentPath.points,a=HC.curveTo(e,t,i,r,s,o);if(a){const{cx:l,cy:u,radius:d,startAngle:f,endAngle:p,anticlockwise:m}=a;this.arc(l,u,d,f,p,m)}return this}arc(e,t,i,r,s,o=!1){if(r===s)return this;if(!o&&s<=r?s+=zg:o&&r<=s&&(r+=zg),s-r===0)return this;const a=e+Math.cos(r)*i,l=t+Math.sin(r)*i,u=this._geometry.closePointEps;let d=this.currentPath?this.currentPath.points:null;if(d){const f=Math.abs(d[d.length-2]-a),p=Math.abs(d[d.length-1]-l);f<u&&p<u||d.push(a,l)}else this.moveTo(a,l),d=this.currentPath.points;return HC.arc(a,l,e,t,i,r,s,o,d),this}beginFill(e=0,t){return this.beginTextureFill({texture:Pe.WHITE,color:e,alpha:t})}normalizeColor(e){const t=en.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??(e.alpha=t.alpha)}beginTextureFill(e){const t={texture:Pe.WHITE,color:16777215,matrix:null};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const i=e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:i},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,i,r){return this.drawShape(new ut(e,t,i,r))}drawRoundedRect(e,t,i,r,s){return this.drawShape(new R0(e,t,i,r,s))}drawCircle(e,t,i){return this.drawShape(new M0(e,t,i))}drawEllipse(e,t,i,r){return this.drawShape(new C0(e,t,i,r))}drawPolygon(...e){let t,i=!0;const r=e[0];r.points?(i=r.closeStroke,t=r.points):Array.isArray(e[0])?t=e[0]:t=e;const s=new Ul(t);return s.closeStroke=i,this.drawShape(s),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===di.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,t=this.blendMode,i=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(e.points);for(let r=0;r<i;r++){const s=e.batches[r],o=s.style.color,a=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),l=new Float32Array(e.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),u=new Uint16Array(e.indicesUint16.buffer,s.start*2,s.size),d={vertexData:a,blendMode:t,indices:u,uvs:l,_batchRGB:en.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[r]=d}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,i=this.batches.length;t<i;t++){const r=this.batches[t];r.worldAlpha=this.worldAlpha*r.alpha,e.plugins[this.pluginName].render(r)}}}_renderDirect(e){const t=this._resolveDirectShader(e),i=this._geometry,r=this.worldAlpha,s=t.uniforms,o=i.drawCalls;s.translationMatrix=this.transform.worldTransform,en.shared.setValue(this._tintColor).premultiply(r).toArray(s.tint),e.shader.bind(t),e.geometry.bind(i,t),e.state.set(this.state);for(let a=0,l=o.length;a<l;a++)this._renderDrawCallDirect(e,i.drawCalls[a])}_renderDrawCallDirect(e,t){const{texArray:i,type:r,size:s,start:o}=t,a=i.count;for(let l=0;l<a;l++)e.texture.bind(i.elements[l],l);e.geometry.draw(r,s,o)}_resolveDirectShader(e){let t=this.shader;const i=this.pluginName;if(!t){if(!By[i]){const{maxTextures:r}=e.plugins[i],s=new Int32Array(r);for(let l=0;l<r;l++)s[l]=l;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new an,default:us.from({uSamplers:s},!0)},a=e.plugins[i]._shader.program;By[i]=new Vs(a,o)}t=By[i]}return t}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:t,minY:i,maxX:r,maxY:s}=e.bounds;this._bounds.addFrame(this.transform,t,i,r,s)}containsPoint(e){return this.worldTransform.applyInverse(e,eg._TEMP_POINT),this._geometry.containsPoint(eg._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t._tintRGB=en.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const t=this.transform.worldTransform,i=t.a,r=t.b,s=t.c,o=t.d,a=t.tx,l=t.ty,u=this._geometry.points,d=this.vertexData;let f=0;for(let p=0;p<u.length;p+=2){const m=u[p],v=u[p+1];d[f++]=i*m+s*v+a,d[f++]=o*v+r*m+l}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};X1.curves=qc,X1._TEMP_POINT=new Dt;let Ad=X1;class cV extends D0{constructor(e=100,t=100,i=10,r=10){super(),this.segWidth=i,this.segHeight=r,this.width=e,this.height=t,this.build()}build(){const e=this.segWidth*this.segHeight,t=[],i=[],r=[],s=this.segWidth-1,o=this.segHeight-1,a=this.width/s,l=this.height/o;for(let d=0;d<e;d++){const f=d%this.segWidth,p=d/this.segWidth|0;t.push(f*a,p*l),i.push(f/s,p/o)}const u=s*o;for(let d=0;d<u;d++){const f=d%s,p=d/s|0,m=p*this.segWidth+f,v=p*this.segWidth+f+1,x=(p+1)*this.segWidth+f,y=(p+1)*this.segWidth+f+1;r.push(m,v,x,v,y,x)}this.buffers[0].data=new Float32Array(t),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}class hV extends D0{constructor(e=200,t,i=0){super(new Float32Array(t.length*4),new Float32Array(t.length*4),new Uint16Array((t.length-1)*6)),this.points=t,this._width=e,this.textureScale=i,this.build()}get width(){return this._width}build(){const e=this.points;if(!e)return;const t=this.getBuffer("aVertexPosition"),i=this.getBuffer("aTextureCoord"),r=this.getIndex();if(e.length<1)return;t.data.length/4!==e.length&&(t.data=new Float32Array(e.length*4),i.data=new Float32Array(e.length*4),r.data=new Uint16Array((e.length-1)*6));const s=i.data,o=r.data;s[0]=0,s[1]=0,s[2]=0,s[3]=1;let a=0,l=e[0];const u=this._width*this.textureScale,d=e.length;for(let p=0;p<d;p++){const m=p*4;if(this.textureScale>0){const v=l.x-e[p].x,x=l.y-e[p].y,y=Math.sqrt(v*v+x*x);l=e[p],a+=y/u}else a=p/(d-1);s[m]=a,s[m+1]=0,s[m+2]=a,s[m+3]=1}let f=0;for(let p=0;p<d-1;p++){const m=p*2;o[f++]=m,o[f++]=m+1,o[f++]=m+2,o[f++]=m+2,o[f++]=m+1,o[f++]=m+3}i.update(),r.update(),this.updateVertices()}updateVertices(){const e=this.points;if(e.length<1)return;let t=e[0],i,r=0,s=0;const o=this.buffers[0].data,a=e.length,l=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let u=0;u<a;u++){const d=e[u],f=u*4;u<e.length-1?i=e[u+1]:i=d,s=-(i.x-t.x),r=i.y-t.y;const p=Math.sqrt(r*r+s*s);p<1e-6?(r=0,s=0):(r/=p,s/=p,r*=l,s*=l),o[f]=d.x+r,o[f+1]=d.y+s,o[f+2]=d.x-r,o[f+3]=d.y-s,t=d}this.buffers[0].update()}update(){this.textureScale>0?this.build():this.updateVertices()}}class dV extends Qd{constructor(e,t,i){const r=new cV(e.width,e.height,t,i),s=new Jd(Pe.WHITE);super(r,s),this.texture=e,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;const e=this.geometry,{width:t,height:i}=this.shader.texture;this.autoResize&&(e.width!==t||e.height!==i)&&(e.width=this.shader.texture.width,e.height=this.shader.texture.height,e.build())}set texture(e){this.shader.texture!==e&&(this.shader.texture=e,this._textureID=-1,e.baseTexture.valid?this.textureUpdated():e.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(e)}destroy(e){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(e)}}const fm=10;class fV extends dV{constructor(e,t,i,r,s){var o,a,l,u;super(Pe.WHITE,4,4),this._origWidth=e.orig.width,this._origHeight=e.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=t??((o=e.defaultBorders)==null?void 0:o.left)??fm,this._rightWidth=r??((a=e.defaultBorders)==null?void 0:a.right)??fm,this._topHeight=i??((l=e.defaultBorders)==null?void 0:l.top)??fm,this._bottomHeight=s??((u=e.defaultBorders)==null?void 0:u.bottom)??fm,this.texture=e}textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh()}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(e){this.geometry.getBuffer("aVertexPosition").data=e}updateHorizontalVertices(){const e=this.vertices,t=this._getMinScale();e[9]=e[11]=e[13]=e[15]=this._topHeight*t,e[17]=e[19]=e[21]=e[23]=this._height-this._bottomHeight*t,e[25]=e[27]=e[29]=e[31]=this._height}updateVerticalVertices(){const e=this.vertices,t=this._getMinScale();e[2]=e[10]=e[18]=e[26]=this._leftWidth*t,e[4]=e[12]=e[20]=e[28]=this._width-this._rightWidth*t,e[6]=e[14]=e[22]=e[30]=this._width}_getMinScale(){const e=this._leftWidth+this._rightWidth,t=this._width>e?1:this._width/e,i=this._topHeight+this._bottomHeight,r=this._height>i?1:this._height/i;return Math.min(t,r)}get width(){return this._width}set width(e){this._width=e,this._refresh()}get height(){return this._height}set height(e){this._height=e,this._refresh()}get leftWidth(){return this._leftWidth}set leftWidth(e){this._leftWidth=e,this._refresh()}get rightWidth(){return this._rightWidth}set rightWidth(e){this._rightWidth=e,this._refresh()}get topHeight(){return this._topHeight}set topHeight(e){this._topHeight=e,this._refresh()}get bottomHeight(){return this._bottomHeight}set bottomHeight(e){this._bottomHeight=e,this._refresh()}_refresh(){const e=this.texture,t=this.geometry.buffers[1].data;this._origWidth=e.orig.width,this._origHeight=e.orig.height;const i=1/this._origWidth,r=1/this._origHeight;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1,t[2]=t[10]=t[18]=t[26]=i*this._leftWidth,t[4]=t[12]=t[20]=t[28]=1-i*this._rightWidth,t[9]=t[11]=t[13]=t[15]=r*this._topHeight,t[17]=t[19]=t[21]=t[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}class pV extends Qd{constructor(e=Pe.EMPTY,t,i,r,s){const o=new D0(t,i,r);o.getBuffer("aVertexPosition").static=!1;const a=new Jd(e);super(o,a,null,s),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(e){this.geometry.getBuffer("aVertexPosition").data=e}_render(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(e)}}class mV extends Qd{constructor(e,t,i=0){const r=new hV(e.height,t,i),s=new Jd(e);i>0&&(e.baseTexture.wrapMode=Co.REPEAT),super(r,s),this.autoUpdate=!0}_render(e){const t=this.geometry;(this.autoUpdate||t._width!==this.shader.texture.height)&&(t._width=this.shader.texture.height,t.update()),super._render(e)}}class gV extends Oi{constructor(e=1500,t,i=16384,r=!1){super();const s=16384;i>s&&(i=s),this._properties=[!1,!0,!1,!1,!1],this._maxSize=e,this._batchSize=i,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=rt.NORMAL,this.autoResize=r,this.roundPixels=!0,this.baseTexture=null,this.setProperties(t),this._tintColor=new en(0),this.tintRgb=new Float32Array(3),this.tint=16777215}setProperties(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintColor.toRgbArray(this.tintRgb)}render(e){!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",()=>this.onChildrenChange(0))),e.batch.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))}onChildrenChange(e){const t=Math.floor(e/this._batchSize);for(;this._bufferUpdateIDs.length<t;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[t]=++this._updateID}dispose(){if(this._buffers){for(let e=0;e<this._buffers.length;++e)this._buffers[e].destroy();this._buffers=null}}destroy(e){super.destroy(e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}class jC{constructor(e,t,i){this.geometry=new Da,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let r=0;r<e.length;++r){let s=e[r];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||et.FLOAT,offset:s.offset},t[r]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let t=0;this.indexBuffer=new Cn(RH(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=t,t+=a.size,this.dynamicStride+=a.size}const i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new Cn(this.dynamicData,!1,!1);let r=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=r,r+=a.size,this.staticStride+=a.size}const s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new Cn(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];e.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===et.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];e.addAttribute(a.attributeName,this.staticBuffer,0,a.type===et.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(e,t,i){for(let r=0;r<this.dynamicProperties.length;r++){const s=this.dynamicProperties[r];s.uploadFunction(e,t,i,s.type===et.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,t,i){for(let r=0;r<this.staticProperties.length;r++){const s=this.staticProperties[r];s.uploadFunction(e,t,i,s.type===et.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var _V=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,vV=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class n3 extends I0{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new an,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:et.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Vs.from(vV,_V,{}),this.state=Ks.for2d()}render(e){const t=e.children,i=e._maxSize,r=e._batchSize,s=this.renderer;let o=t.length;if(o===0)return;o>i&&!e.autoResize&&(o=i);let a=e._buffers;a||(a=e._buffers=this.generateBuffers(e));const l=t[0]._texture.baseTexture,u=l.alphaMode>0;this.state.blendMode=iL(e.blendMode,u),s.state.set(this.state);const d=s.gl,f=e.worldTransform.copyTo(this.tempMatrix);f.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=f.toArray(!0),this.shader.uniforms.uColor=en.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,u).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let p=!1;for(let m=0,v=0;m<o;m+=r,v+=1){let x=o-m;x>r&&(x=r),v>=a.length&&a.push(this._generateOneMoreBuffer(e));const y=a[v];y.uploadDynamic(t,m,x);const g=e._bufferUpdateIDs[v]||0;p=p||y._updateID<g,p&&(y._updateID=e._updateID,y.uploadStatic(t,m,x)),s.geometry.bind(y.geometry),d.drawElements(d.TRIANGLES,x*6,d.UNSIGNED_SHORT,0)}}generateBuffers(e){const t=[],i=e._maxSize,r=e._batchSize,s=e._properties;for(let o=0;o<i;o+=r)t.push(new jC(this.properties,s,r));return t}_generateOneMoreBuffer(e){const t=e._batchSize,i=e._properties;return new jC(this.properties,i,t)}uploadVertices(e,t,i,r,s,o){let a=0,l=0,u=0,d=0;for(let f=0;f<i;++f){const p=e[t+f],m=p._texture,v=p.scale.x,x=p.scale.y,y=m.trim,g=m.orig;y?(l=y.x-p.anchor.x*g.width,a=l+y.width,d=y.y-p.anchor.y*g.height,u=d+y.height):(a=g.width*(1-p.anchor.x),l=g.width*-p.anchor.x,u=g.height*(1-p.anchor.y),d=g.height*-p.anchor.y),r[o]=l*v,r[o+1]=d*x,r[o+s]=a*v,r[o+s+1]=d*x,r[o+s*2]=a*v,r[o+s*2+1]=u*x,r[o+s*3]=l*v,r[o+s*3+1]=u*x,o+=s*4}}uploadPosition(e,t,i,r,s,o){for(let a=0;a<i;a++){const l=e[t+a].position;r[o]=l.x,r[o+1]=l.y,r[o+s]=l.x,r[o+s+1]=l.y,r[o+s*2]=l.x,r[o+s*2+1]=l.y,r[o+s*3]=l.x,r[o+s*3+1]=l.y,o+=s*4}}uploadRotation(e,t,i,r,s,o){for(let a=0;a<i;a++){const l=e[t+a].rotation;r[o]=l,r[o+s]=l,r[o+s*2]=l,r[o+s*3]=l,o+=s*4}}uploadUvs(e,t,i,r,s,o){for(let a=0;a<i;++a){const l=e[t+a]._texture._uvs;l?(r[o]=l.x0,r[o+1]=l.y0,r[o+s]=l.x1,r[o+s+1]=l.y1,r[o+s*2]=l.x2,r[o+s*2+1]=l.y2,r[o+s*3]=l.x3,r[o+s*3+1]=l.y3,o+=s*4):(r[o]=0,r[o+1]=0,r[o+s]=0,r[o+s+1]=0,r[o+s*2]=0,r[o+s*2+1]=0,r[o+s*3]=0,r[o+s*3+1]=0,o+=s*4)}}uploadTint(e,t,i,r,s,o){for(let a=0;a<i;++a){const l=e[t+a],u=en.shared.setValue(l._tintRGB).toPremultiplied(l.alpha,l.texture.baseTexture.alphaMode>0);r[o]=u,r[o+s]=u,r[o+s*2]=u,r[o+s*3]=u,o+=s*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}n3.extension={name:"particle",type:Ne.RendererPlugin};$e.add(n3);class ef extends Zs{constructor(e,t=!0){super(e[0]instanceof Pe?e[0]:e[0].texture),this._textures=null,this._durations=null,this._autoUpdate=t,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=e}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(ni.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(ni.shared.add(this.update,this,Ua.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(e){this.stop(),this.currentFrame=e}gotoAndPlay(e){this.currentFrame=e,this.play()}update(e){if(!this._playing)return;const t=this.animationSpeed*e,i=this.currentFrame;if(this._durations!==null){let r=this._currentTime%1*this._durations[this.currentFrame];for(r+=t/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];const s=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*s,this._currentTime+=s;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=t;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<i||this.animationSpeed<0&&this.currentFrame>i)&&this.onLoop(),this.updateTexture())}updateTexture(){const e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this._texture=this._textures[e],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(e){this.stop(),super.destroy(e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(e){const t=[];for(let i=0;i<e.length;++i)t.push(Pe.from(e[i]));return new ef(t)}static fromImages(e){const t=[];for(let i=0;i<e.length;++i)t.push(Pe.from(e[i]));return new ef(t)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(e){if(e[0]instanceof Pe)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(let t=0;t<e.length;t++)this._textures.push(e[t].texture),this._durations.push(e[t].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e}set currentFrame(e){if(e<0||e>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${e}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(ni.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(ni.shared.add(this.update,this),this._isConnectedToTicker=!0))}}const $h=new Dt;class FE extends Zs{constructor(e,t=100,i=100){super(e),this.tileTransform=new P0,this._width=t,this._height=i,this.uvMatrix=this.texture.uvMatrix||new RE(e),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale(e){this.tileTransform.scale.copyFrom(e)}get tilePosition(){return this.tileTransform.position}set tilePosition(e){this.tileTransform.position.copyFrom(e)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render(e){const t=this._texture;!t||!t.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))}_calculateBounds(){const e=this._width*-this._anchor._x,t=this._height*-this._anchor._y,i=this._width*(1-this._anchor._x),r=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,t,i,r)}getLocalBounds(e){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new ut),e=this._localBoundsRect),this._bounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,$h);const t=this._width,i=this._height,r=-t*this.anchor._x;if($h.x>=r&&$h.x<r+t){const s=-i*this.anchor._y;if($h.y>=s&&$h.y<s+i)return!0}return!1}destroy(e){super.destroy(e),this.tileTransform=null,this.uvMatrix=null}static from(e,t){const i=e instanceof Pe?e:Pe.from(e,t);return new FE(i,t.width,t.height)}get width(){return this._width}set width(e){this._width=e}get height(){return this._height}set height(e){this._height=e}}var yV=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,xV=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,SV=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,$C=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,EV=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const pm=new an;class i3 extends I0{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new gL,this.state=Ks.for2d()}contextChange(){const e=this.renderer,t={globals:e.globalUniforms};this.simpleShader=Vs.from($C,EV,t),this.shader=e.context.webGLVersion>1?Vs.from(xV,yV,t):Vs.from($C,SV,t)}render(e){const t=this.renderer,i=this.quad;let r=i.vertices;r[0]=r[6]=e._width*-e.anchor.x,r[1]=r[3]=e._height*-e.anchor.y,r[2]=r[4]=e._width*(1-e.anchor.x),r[5]=r[7]=e._height*(1-e.anchor.y);const s=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;r=i.uvs,r[0]=r[6]=-s,r[1]=r[3]=-o,r[2]=r[4]=1-s,r[5]=r[7]=1-o,i.invalidate();const a=e._texture,l=a.baseTexture,u=l.alphaMode>0,d=e.tileTransform.localTransform,f=e.uvMatrix;let p=l.isPowerOfTwo&&a.frame.width===l.width&&a.frame.height===l.height;p&&(l._glTextures[t.CONTEXT_UID]?p=l.wrapMode!==Co.CLAMP:l.wrapMode===Co.CLAMP&&(l.wrapMode=Co.REPEAT));const m=p?this.simpleShader:this.shader,v=a.width,x=a.height,y=e._width,g=e._height;pm.set(d.a*v/y,d.b*v/g,d.c*x/y,d.d*x/g,d.tx/y,d.ty/g),pm.invert(),p?pm.prepend(f.mapCoord):(m.uniforms.uMapCoord=f.mapCoord.toArray(!0),m.uniforms.uClampFrame=f.uClampFrame,m.uniforms.uClampOffset=f.uClampOffset),m.uniforms.uTransform=pm.toArray(!0),m.uniforms.uColor=en.shared.setValue(e.tint).premultiply(e.worldAlpha,u).toArray(m.uniforms.uColor),m.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),m.uniforms.uSampler=a,t.shader.bind(m),t.geometry.bind(i),this.state.blendMode=iL(e.blendMode,u),t.state.set(this.state),t.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}i3.extension={name:"tilingSprite",type:Ne.RendererPlugin};$e.add(i3);const r3=class j1{constructor(e){this.stage=new Oi,e=Object.assign({forceCanvas:!1},e),this.renderer=V7(e),j1._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){var e;return(e=this.renderer)==null?void 0:e.view}get screen(){var e;return(e=this.renderer)==null?void 0:e.screen}destroy(e,t){const i=j1._plugins.slice(0);i.reverse(),i.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}};r3._plugins=[];let F0=r3;$e.handleByList(Ne.Application,F0._plugins);class s3{static init(e){Object.defineProperty(this,"resizeTo",{set(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let t,i;if(this._resizeTo===globalThis.window)t=globalThis.innerWidth,i=globalThis.innerHeight;else{const{clientWidth:r,clientHeight:s}=this._resizeTo;t=r,i=s}this.renderer.resize(t,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}s3.extension=Ne.Application;$e.add(s3);var o3={exports:{}},TV="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",bV=TV,wV=bV;function a3(){}function l3(){}l3.resetWarningCache=a3;var AV=function(){function n(i,r,s,o,a,l){if(l!==wV){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}n.isRequired=n;function e(){return n}var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:l3,resetWarningCache:a3};return t.PropTypes=t,t};o3.exports=AV();var MV=o3.exports;const rn=t0(MV);function ur(n){return ur=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ur(n)}function u3(n){var e=function(t,i){if(ur(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,i||"default");if(ur(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(t)}(n,"string");return ur(e)==="symbol"?e:String(e)}function Mn(n,e,t){return(e=u3(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zy(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function Fo(n){return function(e){if(Array.isArray(e))return zy(e)}(n)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(n)||function(e,t){if(e){if(typeof e=="string")return zy(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set"?Array.from(e):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?zy(e,t):void 0}}(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function bn(n,e){for(var t=arguments.length,i=new Array(t>2?t-2:0),r=2;r<t;r++)i[r-2]=arguments[r]}var CV=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function RV(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var PV=function(n){return n==null};function rd(n){var e=[];if(n===void 0)return e;if(typeof n=="string")e=n.split(",");else if(typeof n=="number")e=[n];else if(Array.isArray(n))e=Fo(n);else{if(n===null||ur(n)!=="object")return e;e=[n&&(n==null?void 0:n.x)||0,n&&(n==null?void 0:n.y)||0]}return e.filter(function(t){return!PV(t)&&!isNaN(t)}).map(Number)}function YC(n,e){if(n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Gy(n){return n instanceof Dt||n instanceof Os}var Kg=["click","mousedown","mousemove","mouseout","mouseover","mouseup","mouseupoutside","tap","touchstart","touchmove","touchend","touchendoutside","pointercancel","pointerout","pointerover","pointertap","pointerdown","pointerup","pointerupoutside","pointermove","rightclick","rightdown","rightup","rightupoutside","touchcancel","touchendoutside","touchmove","touchstart"];function Hy(n,e,t){if(Gy(n[e])&&Gy(t))n[e].copyFrom(t);else if(Gy(n[e])){var i=rd(t);bn(i!==void 0&&i.length>0&&i.length<3,"The property `%s` is a `PIXI.Point` or `PIXI.ObservablePoint` and must be set to a comma-separated string of either 1 or 2 coordinates, a 1 or 2 element array containing coordinates, or a PIXI Point/ObservablePoint. If only one coordinate is given then X and Y will be set to the provided value. Received: `%s` of type `%s`.",e,JSON.stringify(t),ur(t)),n[e].set(i.shift(),i.shift())}else n[e]=t}var Gu,c3=function(n){var e,t=n;if(!Array.isArray(t)){if(e=n,Object.prototype.toString.call(e)!=="[object Object]")throw new Error("collection needs to be an Array or Object");t=Object.keys(n)}var i={};return t.forEach(function(r){i[r]=!0}),function(r){return i[r]!==void 0}},h3=function(n){return function(){return!n.apply(void 0,arguments)}},$1="children",IV=(Mn(Gu={},$1,!0),Mn(Gu,"parent",!0),Mn(Gu,"worldAlpha",!0),Mn(Gu,"worldTransform",!0),Mn(Gu,"worldVisible",!0),Gu),Y1={alpha:1,buttonMode:!1,cacheAsBitmap:!1,cursor:null,filterArea:null,filters:null,hitArea:null,interactive:!1,mask:null,pivot:0,position:0,renderable:!0,rotation:0,scale:1,skew:0,transform:null,visible:!0,x:0,y:0},Xs=function(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=function(a){return requestAnimationFrame(function(){var l,u;a==null||(l=a.__reactpixi)===null||l===void 0||(u=l.root)===null||u===void 0||u.emit("__REACT_PIXI_REQUEST_RENDER__")})},r=function(a,l){if(t.hasOwnProperty(a))return bn(l.typeofs.some(function(u){return ur(t[a])===u})||l.instanceofs.some(function(u){return t[a]instanceof u}),"".concat(n," ").concat(a," prop is invalid")),t[a]};if(t.texture)return bn(t.texture instanceof Pe,"".concat(n," texture needs to be typeof `Texture`")),t.texture;var s=r("image",{typeofs:["string"],instanceofs:[HTMLImageElement]})||r("video",{typeofs:["string"],instanceofs:[HTMLVideoElement]})||r("source",{typeofs:["string","number"],instanceofs:[HTMLImageElement,HTMLVideoElement,HTMLCanvasElement,Pe]});bn(!!s,"".concat(n," could not get texture from props"));var o=Pe.from(s);return o.__reactpixi={root:e},o.once("update",i),o.once("loaded",i),o.valid&&i(o),o},LV=h3(c3([].concat(Fo(Object.keys(IV)),Fo(Kg))));function js(n,e,t){var i=!1;if(bn(hn.prototype.isPrototypeOf(n),"instance needs to be typeof `DisplayObject`, got `%s`",ur(n)),!t.ignoreEvents)for(var r=typeof n.removeListener=="function",s=typeof n.on=="function",o=0;o<Kg.length;o++){var a=Kg[o];e[a]!==t[a]&&(i=!0,typeof e[a]=="function"&&r&&n.removeListener(a,e[a]),typeof t[a]=="function"&&s&&n.on(a,t[a]))}var l=Object.keys(t||{});if(t.overwriteProps){for(var u=0;u<l.length;u++){var d=l[u];e[d]!==t[d]&&(i=!0,Hy(n,d,t[d]))}return i}for(var f=l.filter(LV),p=0;p<f.length;p++){var m=f[p],v=t[m];t[m]!==e[m]&&(i=!0),v!==void 0?Hy(n,m,v):m in Y1?(console.warn("setting default value: ".concat(m,", from: ").concat(n[m]," to: ").concat(v," for"),n),i=!0,Hy(n,m,Y1[m])):console.warn("ignoring prop: ".concat(m,", from ").concat(n[m]," to ").concat(v," for"),n)}return i}var DV=function(n,e){var t=e.text,i=e.style;return new f9(t,i)},NV=function(){return new Oi};function Va(n,e){if(n==null)return{};var t,i,r=function(o,a){if(o==null)return{};var l,u,d={},f=Object.keys(o);for(u=0;u<f.length;u++)l=f[u],a.indexOf(l)>=0||(d[l]=o[l]);return d}(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}var UV=["draw","geometry"],FV=function(n,e){var t=e.geometry;bn(!t||t instanceof Ad,"Graphics geometry needs to be a `PIXI.Graphics`");var i=t?new Ad(t.geometry):new Ad;return i.applyProps=function(r,s,o){var a=o.draw;o.geometry;var l=js(r,s,Va(o,UV));return s.draw!==a&&typeof a=="function"&&(l=!0,a.call(i,i)),l},i},OV=["image","texture"],kV=function(n,e){var t=e.leftWidth,i=t===void 0?10:t,r=e.topHeight,s=r===void 0?10:r,o=e.rightWidth,a=o===void 0?10:o,l=e.bottomHeight,u=l===void 0?10:l,d=Xs("NineSlicePlane",n,e),f=new fV(d,i,s,a,u);return f.applyProps=function(p,m,v){var x=v.image,y=v.texture,g=js(p,m,Va(v,OV));return(x||y)&&(y!==m.texture&&(g=!0),p.texture=Xs("NineSlicePlane",n,v)),g},f};function qC(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function mm(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?qC(Object(t),!0).forEach(function(i){Mn(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):qC(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}var BV=function(n,e){var t=e.maxSize,i=t===void 0?1500:t,r=e.batchSize,s=r===void 0?16384:r,o=e.autoResize,a=o!==void 0&&o,l=mm(mm({},{vertices:!1,scale:!0,position:!0,rotation:!0,uvs:!0,tint:!0}),e.properties||{}),u=mm(mm({},{children:!1,texture:!1,baseTexture:!1}),e.destroyOptions||{}),d=new gV(i,l,s,a);return d.willUnmount=function(f,p,m){f.destroy(u)},d},zV=["image","texture"],GV=function(n,e){var t=new Zs(Xs("Sprite",n,e));return t.applyProps=function(i,r,s){var o=s.image,a=s.texture,l=js(i,r,Va(s,zV));return(a&&r.texture!==s.texture||o&&r.image!==s.image)&&(r.texture!==s.texture&&(l=!0),i.texture=Xs("Sprite",n,s)),l},t},HV=["textures","isPlaying","initialFrame","images"],VV=function(n,e){var t=e.textures,i=e.images,r=e.isPlaying,s=r===void 0||r,o=e.initialFrame,a=function(u){return u.map(function(d){return bn(d instanceof Pe||(d==null?void 0:d.texture),"AnimationSprite texture needs to be an array of `PIXI.Texture` or `{ texture: PIXI.Texture, time:\n                number }`"),d})},l=i?ef.fromImages(i):new ef(a(t));return l[s?"gotoAndPlay":"gotoAndStop"](o||0),l.applyProps=function(u,d,f){var p=f.textures,m=f.isPlaying,v=f.initialFrame,x=f.images,y=js(u,d,Va(f,HV));if(x&&d.images!==x){for(var g=[],T=0;T<x.length;++T)g.push(Pe.from(x[T]));u.textures=g,y=!0}if(p&&d.textures!==p&&(u.textures=a(p),y=!0),m!==d.isPlaying||v!==d.initialFrame){var S=typeof v=="number"?v:l.currentFrame||0;l[m?"gotoAndPlay":"gotoAndStop"](S),y=!0}return y},l},WV=function(n,e){var t=e.text,i=t===void 0?"":t,r=e.style,s=r===void 0?{}:r,o=e.isSprite,a=new IE(i,s);return o?(a.updateText(),new Zs(a.texture)):a},XV=["tileScale","tilePosition","image","texture"],jV=function(n,e){var t=e.width,i=t===void 0?100:t,r=e.height,s=r===void 0?100:r,o=Xs("TilingSprite",n,e),a=new FE(o,i,s);return a.applyProps=function(l,u,d){var f=d.tileScale,p=d.tilePosition,m=d.image,v=d.texture,x=js(l,u,Va(d,XV));if(p){var y,g=rd(p);(y=l.tilePosition).set.apply(y,Fo(g)),x=!YC(rd(u.tilePosition),g)||x}if(f){var T,S=rd(f);(T=l.tileScale).set.apply(T,Fo(S)),x=!YC(rd(u.tileScale),S)||x}return(m||v)&&(v!==u.texture&&(x=!0),l.texture=Xs("Sprite",n,d)),x},a},$V=["image","texture"],YV=function(n,e){var t=Xs("Mesh",n,e),i=e.vertices,r=e.uvs,s=e.indices,o=e.drawMode,a=o===void 0?is.TRIANGLES:o,l=new pV(t,i,r,s,a);return l.applyProps=function(u,d,f){var p=f.image,m=f.texture,v=js(u,d,Va(f,$V));return(p||m)&&(m!==d.texture&&(v=!0),u.texture=Xs("Mesh",n,f)),v},l},qV=["image","texture"],KV=function(n,e){var t=Xs("SimpleRope",n,e),i=e.points,r=new mV(t,i);return r.applyProps=function(s,o,a){var l=a.image,u=a.texture,d=Va(a,qV);bn(Array.isArray(a.points),"SimpleRope points needs to be %s","Array<PIXI.Point>");var f=js(s,o,d);return(l||u)&&(u!==o.texture&&(f=!0),s.texture=Xs("SimpleRope",n,a)),f},r},ZV=Object.freeze({__proto__:null,BitmapText:DV,Container:NV,Graphics:FV,NineSlicePlane:kV,ParticleContainer:BV,Sprite:GV,Text:WV,TilingSprite:jV,SimpleMesh:YV,SimpleRope:KV,AnimatedSprite:VV});function KC(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function ZC(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?KC(Object(t),!0).forEach(function(i){Mn(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):KC(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}var Zi={BitmapText:"BitmapText",Container:"Container",Graphics:"Graphics",NineSlicePlane:"NineSlicePlane",ParticleContainer:"ParticleContainer",Sprite:"Sprite",AnimatedSprite:"AnimatedSprite",Text:"Text",TilingSprite:"TilingSprite",SimpleMesh:"SimpleMesh",SimpleRope:"SimpleRope"},QV=Object.keys(Zi).reduce(function(n,e){return ZC(ZC({},n),{},Mn({},e,ZV[e]))},{}),d3={};function JV(n,e){return bn(!!n,"Expect type to be defined, got `%s`",n),bn(!Zi[n],"Component `%s` could not be created, already exists in default components.",n),d3[n]=e,n}var QC,JC,eR,tR,q1={},K1={},eW={get exports(){return K1},set exports(n){K1=n}},nR={};function tW(){return JC||(JC=1,eW.exports=(QC||(QC=1,function(n){function e(O,G){var k=O.length;O.push(G);e:for(;0<k;){var H=k-1>>>1,te=O[H];if(!(0<r(te,G)))break e;O[H]=G,O[k]=te,k=H}}function t(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var G=O[0],k=O.pop();if(k!==G){O[0]=k;e:for(var H=0,te=O.length,ee=te>>>1;H<ee;){var re=2*(H+1)-1,ge=O[re],ve=re+1,Me=O[ve];if(0>r(ge,k))ve<te&&0>r(Me,ge)?(O[H]=Me,O[ve]=k,H=ve):(O[H]=ge,O[re]=k,H=re);else{if(!(ve<te&&0>r(Me,k)))break e;O[H]=Me,O[ve]=k,H=ve}}}return G}function r(O,G){var k=O.sortIndex-G.sortIndex;return k!==0?k:O.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,f=null,p=3,m=!1,v=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function S(O){for(var G=t(u);G!==null;){if(G.callback===null)i(u);else{if(!(G.startTime<=O))break;i(u),G.sortIndex=G.expirationTime,e(l,G)}G=t(u)}}function w(O){if(x=!1,S(O),!v)if(t(l)!==null)v=!0,Q(M);else{var G=t(u);G!==null&&$(w,G.startTime-O)}}function M(O,G){v=!1,x&&(x=!1,g(C),C=-1),m=!0;var k=p;try{for(S(G),f=t(l);f!==null&&(!(f.expirationTime>G)||O&&!V());){var H=f.callback;if(typeof H=="function"){f.callback=null,p=f.priorityLevel;var te=H(f.expirationTime<=G);G=n.unstable_now(),typeof te=="function"?f.callback=te:f===t(l)&&i(l),S(G)}else i(l);f=t(l)}if(f!==null)var ee=!0;else{var re=t(u);re!==null&&$(w,re.startTime-G),ee=!1}return ee}finally{f=null,p=k,m=!1}}typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var P,R=!1,D=null,C=-1,L=5,Z=-1;function V(){return!(n.unstable_now()-Z<L)}function z(){if(D!==null){var O=n.unstable_now();Z=O;var G=!0;try{G=D(!0,O)}finally{G?P():(R=!1,D=null)}}else R=!1}if(typeof T=="function")P=function(){T(z)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,j=F.port2;F.port1.onmessage=z,P=function(){j.postMessage(null)}}else P=function(){y(z,0)};function Q(O){D=O,R||(R=!0,P())}function $(O,G){C=y(function(){O(n.unstable_now())},G)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(O){O.callback=null},n.unstable_continueExecution=function(){v||m||(v=!0,Q(M))},n.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<O?Math.floor(1e3/O):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(O){switch(p){case 1:case 2:case 3:var G=3;break;default:G=p}var k=p;p=G;try{return O()}finally{p=k}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(O,G){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var k=p;p=O;try{return G()}finally{p=k}},n.unstable_scheduleCallback=function(O,G,k){var H=n.unstable_now();switch(k=typeof k=="object"&&k!==null&&typeof(k=k.delay)=="number"&&0<k?H+k:H,O){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return O={id:d++,callback:G,priorityLevel:O,startTime:k,expirationTime:te=k+te,sortIndex:-1},k>H?(O.sortIndex=k,e(u,O),t(l)===null&&O===t(u)&&(x?(g(C),C=-1):x=!0,$(w,k-H))):(O.sortIndex=te,e(l,O),v||m||(v=!0,Q(M))),O},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(O){var G=p;return function(){var k=p;p=G;try{return O.apply(this,arguments)}finally{p=k}}}}(nR)),nR)),K1}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function nW(){return tR||(tR=1,eR=function(n){var e={},t=ks,i=tW(),r=Object.assign;function s(c){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+c,_=1;_<arguments.length;_++)h+="&args[]="+encodeURIComponent(arguments[_]);return"Minified React error #"+c+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,a=Symbol.for("react.element"),l=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),m=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),y=Symbol.for("react.suspense_list"),g=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),S=Symbol.for("react.offscreen"),w=Symbol.iterator;function M(c){return c===null||typeof c!="object"?null:typeof(c=w&&c[w]||c["@@iterator"])=="function"?c:null}function P(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case u:return"Fragment";case l:return"Portal";case f:return"Profiler";case d:return"StrictMode";case x:return"Suspense";case y:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case m:return(c.displayName||"Context")+".Consumer";case p:return(c._context.displayName||"Context")+".Provider";case v:var h=c.render;return(c=c.displayName)||(c=(c=h.displayName||h.name||"")!==""?"ForwardRef("+c+")":"ForwardRef"),c;case g:return(h=c.displayName||null)!==null?h:P(c.type)||"Memo";case T:h=c._payload,c=c._init;try{return P(c(h))}catch{}}return null}function R(c){var h=c.type;switch(c.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=(c=h.render).displayName||c.name||"",h.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return P(h);case 8:return h===d?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function D(c){var h=c,_=c;if(c.alternate)for(;h.return;)h=h.return;else{c=h;do 4098&(h=c).flags&&(_=h.return),c=h.return;while(c)}return h.tag===3?_:null}function C(c){if(D(c)!==c)throw Error(s(188))}function L(c){var h=c.alternate;if(!h){if((h=D(c))===null)throw Error(s(188));return h!==c?null:c}for(var _=c,E=h;;){var b=_.return;if(b===null)break;var A=b.alternate;if(A===null){if((E=b.return)!==null){_=E;continue}break}if(b.child===A.child){for(A=b.child;A;){if(A===_)return C(b),c;if(A===E)return C(b),h;A=A.sibling}throw Error(s(188))}if(_.return!==E.return)_=b,E=A;else{for(var U=!1,W=b.child;W;){if(W===_){U=!0,_=b,E=A;break}if(W===E){U=!0,E=b,_=A;break}W=W.sibling}if(!U){for(W=A.child;W;){if(W===_){U=!0,_=A,E=b;break}if(W===E){U=!0,E=A,_=b;break}W=W.sibling}if(!U)throw Error(s(189))}}if(_.alternate!==E)throw Error(s(190))}if(_.tag!==3)throw Error(s(188));return _.stateNode.current===_?c:h}function Z(c){return(c=L(c))!==null?V(c):null}function V(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var h=V(c);if(h!==null)return h;c=c.sibling}return null}function z(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){if(c.tag!==4){var h=z(c);if(h!==null)return h}c=c.sibling}return null}var F,j=Array.isArray,Q=n.getPublicInstance,$=n.getRootHostContext,O=n.getChildHostContext,G=n.prepareForCommit,k=n.resetAfterCommit,H=n.createInstance,te=n.appendInitialChild,ee=n.finalizeInitialChildren,re=n.prepareUpdate,ge=n.shouldSetTextContent,ve=n.createTextInstance,Me=n.scheduleTimeout,Ze=n.cancelTimeout,Ye=n.noTimeout,ze=n.isPrimaryRenderer,Ie=n.supportsMutation,q=n.supportsPersistence,ct=n.supportsHydration,Xe=n.getInstanceFromNode,st=n.preparePortalMount,nt=n.getCurrentEventPriority,Zt=n.detachDeletedInstance,gt=n.supportsMicrotasks,xt=n.scheduleMicrotask,Ot=n.supportsTestSelectors,Un=n.findFiberRoot,Fn=n.getBoundingRect,B=n.getTextContent,I=n.isHiddenSubtree,se=n.matchAccessibilityRole,we=n.setFocusIfFocusable,ye=n.setupIntersectionObserver,Ae=n.appendChild,Qe=n.appendChildToContainer,Re=n.commitTextUpdate,Oe=n.commitMount,ft=n.commitUpdate,Bt=n.insertBefore,be=n.insertInContainerBefore,Vt=n.removeChild,yt=n.removeChildFromContainer,ht=n.resetTextContent,it=n.hideInstance,Ve=n.hideTextInstance,At=n.unhideInstance,X=n.unhideTextInstance,ke=n.clearContainer,Te=n.cloneInstance,he=n.createContainerChildSet,Ce=n.appendChildToContainerChildSet,at=n.finalizeContainerChildren,Rt=n.replaceContainerChildren,wn=n.cloneHiddenInstance,Wn=n.cloneHiddenTextInstance,qt=n.canHydrateInstance,ri=n.canHydrateTextInstance,pr=n.canHydrateSuspenseInstance,oh=n.isSuspenseInstancePending,ah=n.isSuspenseInstanceFallback,nu=n.getSuspenseInstanceFallbackErrorDetails,pf=n.registerSuspenseInstanceRetry,Qs=n.getNextHydratableSibling,mf=n.getFirstHydratableChild,gf=n.getFirstHydratableChildWithinContainer,B0=n.getFirstHydratableChildWithinSuspenseInstance,z0=n.hydrateInstance,G0=n.hydrateTextInstance,N=n.hydrateSuspenseInstance,J=n.getNextHydratableInstanceAfterSuspenseInstance,ae=n.commitHydratedContainer,le=n.commitHydratedSuspenseInstance,oe=n.clearSuspenseBoundary,Be=n.clearSuspenseBoundaryFromContainer,Je=n.shouldDeleteUnhydratedTailInstances,ot=n.didNotMatchHydratedContainerTextInstance,pt=n.didNotMatchHydratedTextInstance;function _t(c){if(F===void 0)try{throw Error()}catch(_){var h=_.stack.trim().match(/\n( *(at )?)/);F=h&&h[1]||""}return`
`+F+c}var mt=!1;function vt(c,h){if(!c||mt)return"";mt=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(ce){var E=ce}Reflect.construct(c,[],h)}else{try{h.call()}catch(ce){E=ce}c.call(h.prototype)}else{try{throw Error()}catch(ce){E=ce}c()}}catch(ce){if(ce&&E&&typeof ce.stack=="string"){for(var b=ce.stack.split(`
`),A=E.stack.split(`
`),U=b.length-1,W=A.length-1;1<=U&&0<=W&&b[U]!==A[W];)W--;for(;1<=U&&0<=W;U--,W--)if(b[U]!==A[W]){if(U!==1||W!==1)do if(U--,0>--W||b[U]!==A[W]){var ne=`
`+b[U].replace(" at new "," at ");return c.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",c.displayName)),ne}while(1<=U&&0<=W);break}}}finally{mt=!1,Error.prepareStackTrace=_}return(c=c?c.displayName||c.name:"")?_t(c):""}var dn=Object.prototype.hasOwnProperty,si=[],tn=-1;function Xn(c){return{current:c}}function dt(c){0>tn||(c.current=si[tn],si[tn]=null,tn--)}function We(c,h){tn++,si[tn]=c.current,c.current=h}var mr={},wt=Xn(mr),xn=Xn(!1),ds=mr;function gr(c,h){var _=c.type.contextTypes;if(!_)return mr;var E=c.stateNode;if(E&&E.__reactInternalMemoizedUnmaskedChildContext===h)return E.__reactInternalMemoizedMaskedChildContext;var b,A={};for(b in _)A[b]=h[b];return E&&((c=c.stateNode).__reactInternalMemoizedUnmaskedChildContext=h,c.__reactInternalMemoizedMaskedChildContext=A),A}function oi(c){return(c=c.childContextTypes)!=null}function Pn(){dt(xn),dt(wt)}function fs(c,h,_){if(wt.current!==mr)throw Error(s(168));We(wt,h),We(xn,_)}function iu(c,h,_){var E=c.stateNode;if(h=h.childContextTypes,typeof E.getChildContext!="function")return _;for(var b in E=E.getChildContext())if(!(b in h))throw Error(s(108,R(c)||"Unknown",b));return r({},_,E)}function ai(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||mr,ds=wt.current,We(wt,c),We(xn,xn.current),!0}function ru(c,h,_){var E=c.stateNode;if(!E)throw Error(s(169));_?(c=iu(c,h,ds),E.__reactInternalMemoizedMergedChildContext=c,dt(xn),dt(wt),We(wt,c)):dt(xn),We(xn,_)}var Qi=Math.clz32?Math.clz32:function(c){return(c>>>=0)===0?32:31-(_f(c)/P3|0)|0},_f=Math.log,P3=Math.LN2,H0=64,V0=4194304;function lh(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&c;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&c;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function vf(c,h){var _=c.pendingLanes;if(_===0)return 0;var E=0,b=c.suspendedLanes,A=c.pingedLanes,U=268435455&_;if(U!==0){var W=U&~b;W!==0?E=lh(W):(A&=U)!==0&&(E=lh(A))}else(U=_&~b)!==0?E=lh(U):A!==0&&(E=lh(A));if(E===0)return 0;if(h!==0&&h!==E&&!(h&b)&&((b=E&-E)>=(A=h&-h)||b===16&&4194240&A))return h;if(4&E&&(E|=16&_),(h=c.entangledLanes)!==0)for(c=c.entanglements,h&=E;0<h;)b=1<<(_=31-Qi(h)),E|=c[_],h&=~b;return E}function I3(c,h){switch(c){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;default:return-1}}function W0(c){return(c=-1073741825&c.pendingLanes)!==0?c:1073741824&c?1073741824:0}function BE(){var c=H0;return!(4194240&(H0<<=1))&&(H0=64),c}function X0(c){for(var h=[],_=0;31>_;_++)h.push(c);return h}function uh(c,h,_){c.pendingLanes|=h,h!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),(c=c.eventTimes)[h=31-Qi(h)]=_}function j0(c,h){var _=c.entangledLanes|=h;for(c=c.entanglements;_;){var E=31-Qi(_),b=1<<E;b&h|c[E]&h&&(c[E]|=h),_&=~b}}var Gt=0;function zE(c){return 1<(c&=-c)?4<c?268435455&c?16:536870912:4:1}var $0=i.unstable_scheduleCallback,GE=i.unstable_cancelCallback,L3=i.unstable_shouldYield,D3=i.unstable_requestPaint,jn=i.unstable_now,Y0=i.unstable_ImmediatePriority,N3=i.unstable_UserBlockingPriority,HE=i.unstable_NormalPriority,U3=i.unstable_IdlePriority,yf=null,ps=null,zr=typeof Object.is=="function"?Object.is:function(c,h){return c===h&&(c!==0||1/c==1/h)||c!=c&&h!=h},Js=null,xf=!1,q0=!1;function VE(c){Js===null?Js=[c]:Js.push(c)}function ms(){if(!q0&&Js!==null){q0=!0;var c=0,h=Gt;try{var _=Js;for(Gt=1;c<_.length;c++){var E=_[c];do E=E(!0);while(E!==null)}Js=null,xf=!1}catch(b){throw Js!==null&&(Js=Js.slice(c+1)),$0(Y0,ms),b}finally{Gt=h,q0=!1}}return null}var su=[],ou=0,Sf=null,Ef=0,_r=[],vr=0,Wa=null,gs=1,eo="";function Xa(c,h){su[ou++]=Ef,su[ou++]=Sf,Sf=c,Ef=h}function WE(c,h,_){_r[vr++]=gs,_r[vr++]=eo,_r[vr++]=Wa,Wa=c;var E=gs;c=eo;var b=32-Qi(E)-1;E&=~(1<<b),_+=1;var A=32-Qi(h)+b;if(30<A){var U=b-b%5;A=(E&(1<<U)-1).toString(32),E>>=U,b-=U,gs=1<<32-Qi(h)+b|_<<b|E,eo=A+c}else gs=1<<A|_<<b|E,eo=c}function K0(c){c.return!==null&&(Xa(c,1),WE(c,1,0))}function Z0(c){for(;c===Sf;)Sf=su[--ou],su[ou]=null,Ef=su[--ou],su[ou]=null;for(;c===Wa;)Wa=_r[--vr],_r[vr]=null,eo=_r[--vr],_r[vr]=null,gs=_r[--vr],_r[vr]=null}var Ji=null,yr=null,ln=!1,ch=!1,Gr=null;function XE(c,h){var _=br(5,null,null,0);_.elementType="DELETED",_.stateNode=h,_.return=c,(h=c.deletions)===null?(c.deletions=[_],c.flags|=16):h.push(_)}function jE(c,h){switch(c.tag){case 5:return(h=qt(h,c.type,c.pendingProps))!==null&&(c.stateNode=h,Ji=c,yr=mf(h),!0);case 6:return(h=ri(h,c.pendingProps))!==null&&(c.stateNode=h,Ji=c,yr=null,!0);case 13:if((h=pr(h))!==null){var _=Wa!==null?{id:gs,overflow:eo}:null;return c.memoizedState={dehydrated:h,treeContext:_,retryLane:1073741824},(_=br(18,null,null,0)).stateNode=h,_.return=c,c.child=_,Ji=c,yr=null,!0}return!1;default:return!1}}function Q0(c){return(1&c.mode)!=0&&(128&c.flags)==0}function J0(c){if(ln){var h=yr;if(h){var _=h;if(!jE(c,h)){if(Q0(c))throw Error(s(418));h=Qs(_);var E=Ji;h&&jE(c,h)?XE(E,_):(c.flags=-4097&c.flags|2,ln=!1,Ji=c)}}else{if(Q0(c))throw Error(s(418));c.flags=-4097&c.flags|2,ln=!1,Ji=c}}}function $E(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;Ji=c}function Tf(c){if(!ct||c!==Ji)return!1;if(!ln)return $E(c),ln=!0,!1;if(c.tag!==3&&(c.tag!==5||Je(c.type)&&!ge(c.type,c.memoizedProps))){var h=yr;if(h){if(Q0(c))throw YE(),Error(s(418));for(;h;)XE(c,h),h=Qs(h)}}if($E(c),c.tag===13){if(!ct)throw Error(s(316));if(!(c=(c=c.memoizedState)!==null?c.dehydrated:null))throw Error(s(317));yr=J(c)}else yr=Ji?Qs(c.stateNode):null;return!0}function YE(){for(var c=yr;c;)c=Qs(c)}function au(){ct&&(yr=Ji=null,ch=ln=!1)}function e_(c){Gr===null?Gr=[c]:Gr.push(c)}var F3=o.ReactCurrentBatchConfig;function bf(c,h){if(zr(c,h))return!0;if(typeof c!="object"||c===null||typeof h!="object"||h===null)return!1;var _=Object.keys(c),E=Object.keys(h);if(_.length!==E.length)return!1;for(E=0;E<_.length;E++){var b=_[E];if(!dn.call(h,b)||!zr(c[b],h[b]))return!1}return!0}function O3(c){switch(c.tag){case 5:return _t(c.type);case 16:return _t("Lazy");case 13:return _t("Suspense");case 19:return _t("SuspenseList");case 0:case 2:case 15:return c=vt(c.type,!1);case 11:return c=vt(c.type.render,!1);case 1:return c=vt(c.type,!0);default:return""}}function Hr(c,h){if(c&&c.defaultProps){for(var _ in h=r({},h),c=c.defaultProps)h[_]===void 0&&(h[_]=c[_]);return h}return h}var wf=Xn(null),Af=null,lu=null,t_=null;function n_(){t_=lu=Af=null}function qE(c,h,_){ze?(We(wf,h._currentValue),h._currentValue=_):(We(wf,h._currentValue2),h._currentValue2=_)}function i_(c){var h=wf.current;dt(wf),ze?c._currentValue=h:c._currentValue2=h}function r_(c,h,_){for(;c!==null;){var E=c.alternate;if((c.childLanes&h)!==h?(c.childLanes|=h,E!==null&&(E.childLanes|=h)):E!==null&&(E.childLanes&h)!==h&&(E.childLanes|=h),c===_)break;c=c.return}}function uu(c,h){Af=c,t_=lu=null,(c=c.dependencies)!==null&&c.firstContext!==null&&(c.lanes&h&&(zi=!0),c.firstContext=null)}function xr(c){var h=ze?c._currentValue:c._currentValue2;if(t_!==c)if(c={context:c,memoizedValue:h,next:null},lu===null){if(Af===null)throw Error(s(308));lu=c,Af.dependencies={lanes:0,firstContext:c}}else lu=lu.next=c;return h}var ja=null;function s_(c){ja===null?ja=[c]:ja.push(c)}function KE(c,h,_,E){var b=h.interleaved;return b===null?(_.next=_,s_(h)):(_.next=b.next,b.next=_),h.interleaved=_,_s(c,E)}function _s(c,h){c.lanes|=h;var _=c.alternate;for(_!==null&&(_.lanes|=h),_=c,c=c.return;c!==null;)c.childLanes|=h,(_=c.alternate)!==null&&(_.childLanes|=h),_=c,c=c.return;return _.tag===3?_.stateNode:null}var zo=!1;function o_(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ZE(c,h){c=c.updateQueue,h.updateQueue===c&&(h.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function to(c,h){return{eventTime:c,lane:h,tag:0,payload:null,callback:null,next:null}}function Go(c,h,_){var E=c.updateQueue;if(E===null)return null;if(E=E.shared,(2&Ut)!=0){var b=E.pending;return b===null?h.next=h:(h.next=b.next,b.next=h),E.pending=h,_s(c,_)}return(b=E.interleaved)===null?(h.next=h,s_(E)):(h.next=b.next,b.next=h),E.interleaved=h,_s(c,_)}function Mf(c,h,_){if((h=h.updateQueue)!==null&&(h=h.shared,(4194240&_)!=0)){var E=h.lanes;_|=E&=c.pendingLanes,h.lanes=_,j0(c,_)}}function QE(c,h){var _=c.updateQueue,E=c.alternate;if(E!==null&&_===(E=E.updateQueue)){var b=null,A=null;if((_=_.firstBaseUpdate)!==null){do{var U={eventTime:_.eventTime,lane:_.lane,tag:_.tag,payload:_.payload,callback:_.callback,next:null};A===null?b=A=U:A=A.next=U,_=_.next}while(_!==null);A===null?b=A=h:A=A.next=h}else b=A=h;return _={baseState:E.baseState,firstBaseUpdate:b,lastBaseUpdate:A,shared:E.shared,effects:E.effects},void(c.updateQueue=_)}(c=_.lastBaseUpdate)===null?_.firstBaseUpdate=h:c.next=h,_.lastBaseUpdate=h}function Cf(c,h,_,E){var b=c.updateQueue;zo=!1;var A=b.firstBaseUpdate,U=b.lastBaseUpdate,W=b.shared.pending;if(W!==null){b.shared.pending=null;var ne=W,ce=ne.next;ne.next=null,U===null?A=ce:U.next=ce,U=ne;var fe=c.alternate;fe!==null&&(W=(fe=fe.updateQueue).lastBaseUpdate)!==U&&(W===null?fe.firstBaseUpdate=ce:W.next=ce,fe.lastBaseUpdate=ne)}if(A!==null){var De=b.baseState;for(U=0,fe=ce=ne=null,W=A;;){var de=W.lane,Se=W.eventTime;if((E&de)===de){fe!==null&&(fe=fe.next={eventTime:Se,lane:0,tag:W.tag,payload:W.payload,callback:W.callback,next:null});e:{var je=c,Tt=W;switch(de=h,Se=_,Tt.tag){case 1:if(typeof(je=Tt.payload)=="function"){De=je.call(Se,De,de);break e}De=je;break e;case 3:je.flags=-65537&je.flags|128;case 0:if((de=typeof(je=Tt.payload)=="function"?je.call(Se,De,de):je)==null)break e;De=r({},De,de);break e;case 2:zo=!0}}W.callback!==null&&W.lane!==0&&(c.flags|=64,(de=b.effects)===null?b.effects=[W]:de.push(W))}else Se={eventTime:Se,lane:de,tag:W.tag,payload:W.payload,callback:W.callback,next:null},fe===null?(ce=fe=Se,ne=De):fe=fe.next=Se,U|=de;if((W=W.next)===null){if((W=b.shared.pending)===null)break;W=(de=W).next,de.next=null,b.lastBaseUpdate=de,b.shared.pending=null}}if(fe===null&&(ne=De),b.baseState=ne,b.firstBaseUpdate=ce,b.lastBaseUpdate=fe,(h=b.shared.interleaved)!==null){b=h;do U|=b.lane,b=b.next;while(b!==h)}else A===null&&(b.shared.lanes=0);Ya|=U,c.lanes=U,c.memoizedState=De}}function JE(c,h,_){if(c=h.effects,h.effects=null,c!==null)for(h=0;h<c.length;h++){var E=c[h],b=E.callback;if(b!==null){if(E.callback=null,E=_,typeof b!="function")throw Error(s(191,b));b.call(E)}}}var eT=new t.Component().refs;function a_(c,h,_,E){_=(_=_(E,h=c.memoizedState))==null?h:r({},h,_),c.memoizedState=_,c.lanes===0&&(c.updateQueue.baseState=_)}var Rf={isMounted:function(c){return!!(c=c._reactInternals)&&D(c)===c},enqueueSetState:function(c,h,_){c=c._reactInternals;var E=vi(),b=Xo(c),A=to(E,b);A.payload=h,_!=null&&(A.callback=_),(h=Go(c,A,b))!==null&&(Tr(h,c,b,E),Mf(h,c,b))},enqueueReplaceState:function(c,h,_){c=c._reactInternals;var E=vi(),b=Xo(c),A=to(E,b);A.tag=1,A.payload=h,_!=null&&(A.callback=_),(h=Go(c,A,b))!==null&&(Tr(h,c,b,E),Mf(h,c,b))},enqueueForceUpdate:function(c,h){c=c._reactInternals;var _=vi(),E=Xo(c),b=to(_,E);b.tag=2,h!=null&&(b.callback=h),(h=Go(c,b,E))!==null&&(Tr(h,c,E,_),Mf(h,c,E))}};function tT(c,h,_,E,b,A,U){return typeof(c=c.stateNode).shouldComponentUpdate=="function"?c.shouldComponentUpdate(E,A,U):!h.prototype||!h.prototype.isPureReactComponent||!bf(_,E)||!bf(b,A)}function nT(c,h,_){var E=!1,b=mr,A=h.contextType;return typeof A=="object"&&A!==null?A=xr(A):(b=oi(h)?ds:wt.current,A=(E=(E=h.contextTypes)!=null)?gr(c,b):mr),h=new h(_,A),c.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=Rf,c.stateNode=h,h._reactInternals=c,E&&((c=c.stateNode).__reactInternalMemoizedUnmaskedChildContext=b,c.__reactInternalMemoizedMaskedChildContext=A),h}function iT(c,h,_,E){c=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(_,E),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(_,E),h.state!==c&&Rf.enqueueReplaceState(h,h.state,null)}function l_(c,h,_,E){var b=c.stateNode;b.props=_,b.state=c.memoizedState,b.refs=eT,o_(c);var A=h.contextType;typeof A=="object"&&A!==null?b.context=xr(A):(A=oi(h)?ds:wt.current,b.context=gr(c,A)),b.state=c.memoizedState,typeof(A=h.getDerivedStateFromProps)=="function"&&(a_(c,h,A,_),b.state=c.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(h=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),h!==b.state&&Rf.enqueueReplaceState(b,b.state,null),Cf(c,_,b,E),b.state=c.memoizedState),typeof b.componentDidMount=="function"&&(c.flags|=4194308)}function hh(c,h,_){if((c=_.ref)!==null&&typeof c!="function"&&typeof c!="object"){if(_._owner){if(_=_._owner){if(_.tag!==1)throw Error(s(309));var E=_.stateNode}if(!E)throw Error(s(147,c));var b=E,A=""+c;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===A?h.ref:(h=function(U){var W=b.refs;W===eT&&(W=b.refs={}),U===null?delete W[A]:W[A]=U},h._stringRef=A,h)}if(typeof c!="string")throw Error(s(284));if(!_._owner)throw Error(s(290,c))}return c}function Pf(c,h){throw c=Object.prototype.toString.call(h),Error(s(31,c==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":c))}function rT(c){return(0,c._init)(c._payload)}function sT(c){function h(pe,K){if(c){var ue=pe.deletions;ue===null?(pe.deletions=[K],pe.flags|=16):ue.push(K)}}function _(pe,K){if(!c)return null;for(;K!==null;)h(pe,K),K=K.sibling;return null}function E(pe,K){for(pe=new Map;K!==null;)K.key!==null?pe.set(K.key,K):pe.set(K.index,K),K=K.sibling;return pe}function b(pe,K){return(pe=$o(pe,K)).index=0,pe.sibling=null,pe}function A(pe,K,ue){return pe.index=ue,c?(ue=pe.alternate)!==null?(ue=ue.index)<K?(pe.flags|=2,K):ue:(pe.flags|=2,K):(pe.flags|=1048576,K)}function U(pe){return c&&pe.alternate===null&&(pe.flags|=2),pe}function W(pe,K,ue,_e){return K===null||K.tag!==6?((K=Y_(ue,pe.mode,_e)).return=pe,K):((K=b(K,ue)).return=pe,K)}function ne(pe,K,ue,_e){var tt=ue.type;return tt===u?fe(pe,K,ue.props.children,_e,ue.key):K!==null&&(K.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===T&&rT(tt)===K.type)?((_e=b(K,ue.props)).ref=hh(pe,K,ue),_e.return=pe,_e):((_e=np(ue.type,ue.key,ue.props,null,pe.mode,_e)).ref=hh(pe,K,ue),_e.return=pe,_e)}function ce(pe,K,ue,_e){return K===null||K.tag!==4||K.stateNode.containerInfo!==ue.containerInfo||K.stateNode.implementation!==ue.implementation?((K=q_(ue,pe.mode,_e)).return=pe,K):((K=b(K,ue.children||[])).return=pe,K)}function fe(pe,K,ue,_e,tt){return K===null||K.tag!==7?((K=Za(ue,pe.mode,_e,tt)).return=pe,K):((K=b(K,ue)).return=pe,K)}function De(pe,K,ue){if(typeof K=="string"&&K!==""||typeof K=="number")return(K=Y_(""+K,pe.mode,ue)).return=pe,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case a:return(ue=np(K.type,K.key,K.props,null,pe.mode,ue)).ref=hh(pe,null,K),ue.return=pe,ue;case l:return(K=q_(K,pe.mode,ue)).return=pe,K;case T:return De(pe,(0,K._init)(K._payload),ue)}if(j(K)||M(K))return(K=Za(K,pe.mode,ue,null)).return=pe,K;Pf(pe,K)}return null}function de(pe,K,ue,_e){var tt=K!==null?K.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number")return tt!==null?null:W(pe,K,""+ue,_e);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case a:return ue.key===tt?ne(pe,K,ue,_e):null;case l:return ue.key===tt?ce(pe,K,ue,_e):null;case T:return de(pe,K,(tt=ue._init)(ue._payload),_e)}if(j(ue)||M(ue))return tt!==null?null:fe(pe,K,ue,_e,null);Pf(pe,ue)}return null}function Se(pe,K,ue,_e,tt){if(typeof _e=="string"&&_e!==""||typeof _e=="number")return W(K,pe=pe.get(ue)||null,""+_e,tt);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case a:return ne(K,pe=pe.get(_e.key===null?ue:_e.key)||null,_e,tt);case l:return ce(K,pe=pe.get(_e.key===null?ue:_e.key)||null,_e,tt);case T:return Se(pe,K,ue,(0,_e._init)(_e._payload),tt)}if(j(_e)||M(_e))return fe(K,pe=pe.get(ue)||null,_e,tt,null);Pf(K,_e)}return null}function je(pe,K,ue,_e){for(var tt=null,Wt=null,qe=K,Ht=K=0,ui=null;qe!==null&&Ht<ue.length;Ht++){qe.index>Ht?(ui=qe,qe=null):ui=qe.sibling;var Xt=de(pe,qe,ue[Ht],_e);if(Xt===null){qe===null&&(qe=ui);break}c&&qe&&Xt.alternate===null&&h(pe,qe),K=A(Xt,K,Ht),Wt===null?tt=Xt:Wt.sibling=Xt,Wt=Xt,qe=ui}if(Ht===ue.length)return _(pe,qe),ln&&Xa(pe,Ht),tt;if(qe===null){for(;Ht<ue.length;Ht++)(qe=De(pe,ue[Ht],_e))!==null&&(K=A(qe,K,Ht),Wt===null?tt=qe:Wt.sibling=qe,Wt=qe);return ln&&Xa(pe,Ht),tt}for(qe=E(pe,qe);Ht<ue.length;Ht++)(ui=Se(qe,pe,Ht,ue[Ht],_e))!==null&&(c&&ui.alternate!==null&&qe.delete(ui.key===null?Ht:ui.key),K=A(ui,K,Ht),Wt===null?tt=ui:Wt.sibling=ui,Wt=ui);return c&&qe.forEach(function(Yo){return h(pe,Yo)}),ln&&Xa(pe,Ht),tt}function Tt(pe,K,ue,_e){var tt=M(ue);if(typeof tt!="function")throw Error(s(150));if((ue=tt.call(ue))==null)throw Error(s(151));for(var Wt=tt=null,qe=K,Ht=K=0,ui=null,Xt=ue.next();qe!==null&&!Xt.done;Ht++,Xt=ue.next()){qe.index>Ht?(ui=qe,qe=null):ui=qe.sibling;var Yo=de(pe,qe,Xt.value,_e);if(Yo===null){qe===null&&(qe=ui);break}c&&qe&&Yo.alternate===null&&h(pe,qe),K=A(Yo,K,Ht),Wt===null?tt=Yo:Wt.sibling=Yo,Wt=Yo,qe=ui}if(Xt.done)return _(pe,qe),ln&&Xa(pe,Ht),tt;if(qe===null){for(;!Xt.done;Ht++,Xt=ue.next())(Xt=De(pe,Xt.value,_e))!==null&&(K=A(Xt,K,Ht),Wt===null?tt=Xt:Wt.sibling=Xt,Wt=Xt);return ln&&Xa(pe,Ht),tt}for(qe=E(pe,qe);!Xt.done;Ht++,Xt=ue.next())(Xt=Se(qe,pe,Ht,Xt.value,_e))!==null&&(c&&Xt.alternate!==null&&qe.delete(Xt.key===null?Ht:Xt.key),K=A(Xt,K,Ht),Wt===null?tt=Xt:Wt.sibling=Xt,Wt=Xt);return c&&qe.forEach(function(aD){return h(pe,aD)}),ln&&Xa(pe,Ht),tt}return function pe(K,ue,_e,tt){if(typeof _e=="object"&&_e!==null&&_e.type===u&&_e.key===null&&(_e=_e.props.children),typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case a:e:{for(var Wt=_e.key,qe=ue;qe!==null;){if(qe.key===Wt){if((Wt=_e.type)===u){if(qe.tag===7){_(K,qe.sibling),(ue=b(qe,_e.props.children)).return=K,K=ue;break e}}else if(qe.elementType===Wt||typeof Wt=="object"&&Wt!==null&&Wt.$$typeof===T&&rT(Wt)===qe.type){_(K,qe.sibling),(ue=b(qe,_e.props)).ref=hh(K,qe,_e),ue.return=K,K=ue;break e}_(K,qe);break}h(K,qe),qe=qe.sibling}_e.type===u?((ue=Za(_e.props.children,K.mode,tt,_e.key)).return=K,K=ue):((tt=np(_e.type,_e.key,_e.props,null,K.mode,tt)).ref=hh(K,ue,_e),tt.return=K,K=tt)}return U(K);case l:e:{for(qe=_e.key;ue!==null;){if(ue.key===qe){if(ue.tag===4&&ue.stateNode.containerInfo===_e.containerInfo&&ue.stateNode.implementation===_e.implementation){_(K,ue.sibling),(ue=b(ue,_e.children||[])).return=K,K=ue;break e}_(K,ue);break}h(K,ue),ue=ue.sibling}(ue=q_(_e,K.mode,tt)).return=K,K=ue}return U(K);case T:return pe(K,ue,(qe=_e._init)(_e._payload),tt)}if(j(_e))return je(K,ue,_e,tt);if(M(_e))return Tt(K,ue,_e,tt);Pf(K,_e)}return typeof _e=="string"&&_e!==""||typeof _e=="number"?(_e=""+_e,ue!==null&&ue.tag===6?(_(K,ue.sibling),(ue=b(ue,_e)).return=K,K=ue):(_(K,ue),(ue=Y_(_e,K.mode,tt)).return=K,K=ue),U(K)):_(K,ue)}}var cu=sT(!0),oT=sT(!1),dh={},Sr=Xn(dh),fh=Xn(dh),hu=Xn(dh);function vs(c){if(c===dh)throw Error(s(174));return c}function u_(c,h){We(hu,h),We(fh,c),We(Sr,dh),c=$(h),dt(Sr),We(Sr,c)}function du(){dt(Sr),dt(fh),dt(hu)}function aT(c){var h=vs(hu.current),_=vs(Sr.current);_!==(h=O(_,c.type,h))&&(We(fh,c),We(Sr,h))}function c_(c){fh.current===c&&(dt(Sr),dt(fh))}var Sn=Xn(0);function If(c){for(var h=c;h!==null;){if(h.tag===13){var _=h.memoizedState;if(_!==null&&((_=_.dehydrated)===null||oh(_)||ah(_)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if(128&h.flags)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var h_=[];function d_(){for(var c=0;c<h_.length;c++){var h=h_[c];ze?h._workInProgressVersionPrimary=null:h._workInProgressVersionSecondary=null}h_.length=0}var Lf=o.ReactCurrentDispatcher,f_=o.ReactCurrentBatchConfig,$a=0,fn=null,$n=null,Yn=null,Df=!1,ph=!1,mh=0,k3=0;function gi(){throw Error(s(321))}function p_(c,h){if(h===null)return!1;for(var _=0;_<h.length&&_<c.length;_++)if(!zr(c[_],h[_]))return!1;return!0}function m_(c,h,_,E,b,A){if($a=A,fn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,Lf.current=c===null||c.memoizedState===null?H3:V3,c=_(E,b),ph){A=0;do{if(ph=!1,mh=0,25<=A)throw Error(s(301));A+=1,Yn=$n=null,h.updateQueue=null,Lf.current=W3,c=_(E,b)}while(ph)}if(Lf.current=Ff,h=$n!==null&&$n.next!==null,$a=0,Yn=$n=fn=null,Df=!1,h)throw Error(s(300));return c}function g_(){var c=mh!==0;return mh=0,c}function ys(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yn===null?fn.memoizedState=Yn=c:Yn=Yn.next=c,Yn}function Er(){if($n===null){var c=fn.alternate;c=c!==null?c.memoizedState:null}else c=$n.next;var h=Yn===null?fn.memoizedState:Yn.next;if(h!==null)Yn=h,$n=c;else{if(c===null)throw Error(s(310));c={memoizedState:($n=c).memoizedState,baseState:$n.baseState,baseQueue:$n.baseQueue,queue:$n.queue,next:null},Yn===null?fn.memoizedState=Yn=c:Yn=Yn.next=c}return Yn}function gh(c,h){return typeof h=="function"?h(c):h}function __(c){var h=Er(),_=h.queue;if(_===null)throw Error(s(311));_.lastRenderedReducer=c;var E=$n,b=E.baseQueue,A=_.pending;if(A!==null){if(b!==null){var U=b.next;b.next=A.next,A.next=U}E.baseQueue=b=A,_.pending=null}if(b!==null){A=b.next,E=E.baseState;var W=U=null,ne=null,ce=A;do{var fe=ce.lane;if(($a&fe)===fe)ne!==null&&(ne=ne.next={lane:0,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null}),E=ce.hasEagerState?ce.eagerState:c(E,ce.action);else{var De={lane:fe,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null};ne===null?(W=ne=De,U=E):ne=ne.next=De,fn.lanes|=fe,Ya|=fe}ce=ce.next}while(ce!==null&&ce!==A);ne===null?U=E:ne.next=W,zr(E,h.memoizedState)||(zi=!0),h.memoizedState=E,h.baseState=U,h.baseQueue=ne,_.lastRenderedState=E}if((c=_.interleaved)!==null){b=c;do A=b.lane,fn.lanes|=A,Ya|=A,b=b.next;while(b!==c)}else b===null&&(_.lanes=0);return[h.memoizedState,_.dispatch]}function v_(c){var h=Er(),_=h.queue;if(_===null)throw Error(s(311));_.lastRenderedReducer=c;var E=_.dispatch,b=_.pending,A=h.memoizedState;if(b!==null){_.pending=null;var U=b=b.next;do A=c(A,U.action),U=U.next;while(U!==b);zr(A,h.memoizedState)||(zi=!0),h.memoizedState=A,h.baseQueue===null&&(h.baseState=A),_.lastRenderedState=A}return[A,E]}function lT(){}function uT(c,h){var _=fn,E=Er(),b=h(),A=!zr(E.memoizedState,b);if(A&&(E.memoizedState=b,zi=!0),E=E.queue,y_(dT.bind(null,_,E,c),[c]),E.getSnapshot!==h||A||Yn!==null&&1&Yn.memoizedState.tag){if(_.flags|=2048,_h(9,hT.bind(null,_,E,b,h),void 0,null),qn===null)throw Error(s(349));30&$a||cT(_,h,b)}return b}function cT(c,h,_){c.flags|=16384,c={getSnapshot:h,value:_},(h=fn.updateQueue)===null?(h={lastEffect:null,stores:null},fn.updateQueue=h,h.stores=[c]):(_=h.stores)===null?h.stores=[c]:_.push(c)}function hT(c,h,_,E){h.value=_,h.getSnapshot=E,fT(h)&&pT(c)}function dT(c,h,_){return _(function(){fT(h)&&pT(c)})}function fT(c){var h=c.getSnapshot;c=c.value;try{var _=h();return!zr(c,_)}catch{return!0}}function pT(c){var h=_s(c,1);h!==null&&Tr(h,c,1,-1)}function mT(c){var h=ys();return typeof c=="function"&&(c=c()),h.memoizedState=h.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:gh,lastRenderedState:c},h.queue=c,c=c.dispatch=G3.bind(null,fn,c),[h.memoizedState,c]}function _h(c,h,_,E){return c={tag:c,create:h,destroy:_,deps:E,next:null},(h=fn.updateQueue)===null?(h={lastEffect:null,stores:null},fn.updateQueue=h,h.lastEffect=c.next=c):(_=h.lastEffect)===null?h.lastEffect=c.next=c:(E=_.next,_.next=c,c.next=E,h.lastEffect=c),c}function gT(){return Er().memoizedState}function Nf(c,h,_,E){var b=ys();fn.flags|=c,b.memoizedState=_h(1|h,_,void 0,E===void 0?null:E)}function Uf(c,h,_,E){var b=Er();E=E===void 0?null:E;var A=void 0;if($n!==null){var U=$n.memoizedState;if(A=U.destroy,E!==null&&p_(E,U.deps))return void(b.memoizedState=_h(h,_,A,E))}fn.flags|=c,b.memoizedState=_h(1|h,_,A,E)}function _T(c,h){return Nf(8390656,8,c,h)}function y_(c,h){return Uf(2048,8,c,h)}function vT(c,h){return Uf(4,2,c,h)}function yT(c,h){return Uf(4,4,c,h)}function xT(c,h){return typeof h=="function"?(c=c(),h(c),function(){h(null)}):h!=null?(c=c(),h.current=c,function(){h.current=null}):void 0}function ST(c,h,_){return _=_!=null?_.concat([c]):null,Uf(4,4,xT.bind(null,h,c),_)}function x_(){}function ET(c,h){var _=Er();h=h===void 0?null:h;var E=_.memoizedState;return E!==null&&h!==null&&p_(h,E[1])?E[0]:(_.memoizedState=[c,h],c)}function TT(c,h){var _=Er();h=h===void 0?null:h;var E=_.memoizedState;return E!==null&&h!==null&&p_(h,E[1])?E[0]:(c=c(),_.memoizedState=[c,h],c)}function bT(c,h,_){return 21&$a?(zr(_,h)||(_=BE(),fn.lanes|=_,Ya|=_,c.baseState=!0),h):(c.baseState&&(c.baseState=!1,zi=!0),c.memoizedState=_)}function B3(c,h){var _=Gt;Gt=_!==0&&4>_?_:4,c(!0);var E=f_.transition;f_.transition={};try{c(!1),h()}finally{Gt=_,f_.transition=E}}function wT(){return Er().memoizedState}function z3(c,h,_){var E=Xo(c);_={lane:E,action:_,hasEagerState:!1,eagerState:null,next:null},AT(c)?MT(h,_):(_=KE(c,h,_,E))!==null&&(Tr(_,c,E,vi()),CT(_,h,E))}function G3(c,h,_){var E=Xo(c),b={lane:E,action:_,hasEagerState:!1,eagerState:null,next:null};if(AT(c))MT(h,b);else{var A=c.alternate;if(c.lanes===0&&(A===null||A.lanes===0)&&(A=h.lastRenderedReducer)!==null)try{var U=h.lastRenderedState,W=A(U,_);if(b.hasEagerState=!0,b.eagerState=W,zr(W,U)){var ne=h.interleaved;return ne===null?(b.next=b,s_(h)):(b.next=ne.next,ne.next=b),void(h.interleaved=b)}}catch{}(_=KE(c,h,b,E))!==null&&(Tr(_,c,E,b=vi()),CT(_,h,E))}}function AT(c){var h=c.alternate;return c===fn||h!==null&&h===fn}function MT(c,h){ph=Df=!0;var _=c.pending;_===null?h.next=h:(h.next=_.next,_.next=h),c.pending=h}function CT(c,h,_){if(4194240&_){var E=h.lanes;_|=E&=c.pendingLanes,h.lanes=_,j0(c,_)}}var Ff={readContext:xr,useCallback:gi,useContext:gi,useEffect:gi,useImperativeHandle:gi,useInsertionEffect:gi,useLayoutEffect:gi,useMemo:gi,useReducer:gi,useRef:gi,useState:gi,useDebugValue:gi,useDeferredValue:gi,useTransition:gi,useMutableSource:gi,useSyncExternalStore:gi,useId:gi,unstable_isNewReconciler:!1},H3={readContext:xr,useCallback:function(c,h){return ys().memoizedState=[c,h===void 0?null:h],c},useContext:xr,useEffect:_T,useImperativeHandle:function(c,h,_){return _=_!=null?_.concat([c]):null,Nf(4194308,4,xT.bind(null,h,c),_)},useLayoutEffect:function(c,h){return Nf(4194308,4,c,h)},useInsertionEffect:function(c,h){return Nf(4,2,c,h)},useMemo:function(c,h){var _=ys();return h=h===void 0?null:h,c=c(),_.memoizedState=[c,h],c},useReducer:function(c,h,_){var E=ys();return h=_!==void 0?_(h):h,E.memoizedState=E.baseState=h,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:h},E.queue=c,c=c.dispatch=z3.bind(null,fn,c),[E.memoizedState,c]},useRef:function(c){return c={current:c},ys().memoizedState=c},useState:mT,useDebugValue:x_,useDeferredValue:function(c){return ys().memoizedState=c},useTransition:function(){var c=mT(!1),h=c[0];return c=B3.bind(null,c[1]),ys().memoizedState=c,[h,c]},useMutableSource:function(){},useSyncExternalStore:function(c,h,_){var E=fn,b=ys();if(ln){if(_===void 0)throw Error(s(407));_=_()}else{if(_=h(),qn===null)throw Error(s(349));30&$a||cT(E,h,_)}b.memoizedState=_;var A={value:_,getSnapshot:h};return b.queue=A,_T(dT.bind(null,E,A,c),[c]),E.flags|=2048,_h(9,hT.bind(null,E,A,_,h),void 0,null),_},useId:function(){var c=ys(),h=qn.identifierPrefix;if(ln){var _=eo;h=":"+h+"R"+(_=(gs&~(1<<32-Qi(gs)-1)).toString(32)+_),0<(_=mh++)&&(h+="H"+_.toString(32)),h+=":"}else h=":"+h+"r"+(_=k3++).toString(32)+":";return c.memoizedState=h},unstable_isNewReconciler:!1},V3={readContext:xr,useCallback:ET,useContext:xr,useEffect:y_,useImperativeHandle:ST,useInsertionEffect:vT,useLayoutEffect:yT,useMemo:TT,useReducer:__,useRef:gT,useState:function(){return __(gh)},useDebugValue:x_,useDeferredValue:function(c){return bT(Er(),$n.memoizedState,c)},useTransition:function(){return[__(gh)[0],Er().memoizedState]},useMutableSource:lT,useSyncExternalStore:uT,useId:wT,unstable_isNewReconciler:!1},W3={readContext:xr,useCallback:ET,useContext:xr,useEffect:y_,useImperativeHandle:ST,useInsertionEffect:vT,useLayoutEffect:yT,useMemo:TT,useReducer:v_,useRef:gT,useState:function(){return v_(gh)},useDebugValue:x_,useDeferredValue:function(c){var h=Er();return $n===null?h.memoizedState=c:bT(h,$n.memoizedState,c)},useTransition:function(){return[v_(gh)[0],Er().memoizedState]},useMutableSource:lT,useSyncExternalStore:uT,useId:wT,unstable_isNewReconciler:!1};function fu(c,h){try{var _="",E=h;do _+=O3(E),E=E.return;while(E);var b=_}catch(A){b=`
Error generating stack: `+A.message+`
`+A.stack}return{value:c,source:h,stack:b,digest:null}}function S_(c,h,_){return{value:c,source:null,stack:_??null,digest:h??null}}function E_(c,h){try{console.error(h.value)}catch(_){setTimeout(function(){throw _})}}var X3=typeof WeakMap=="function"?WeakMap:Map;function RT(c,h,_){(_=to(-1,_)).tag=3,_.payload={element:null};var E=h.value;return _.callback=function(){Kf||(Kf=!0,G_=E),E_(0,h)},_}function PT(c,h,_){(_=to(-1,_)).tag=3;var E=c.type.getDerivedStateFromError;if(typeof E=="function"){var b=h.value;_.payload=function(){return E(b)},_.callback=function(){E_(0,h)}}var A=c.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(_.callback=function(){E_(0,h),typeof E!="function"&&(Vo===null?Vo=new Set([this]):Vo.add(this));var U=h.stack;this.componentDidCatch(h.value,{componentStack:U!==null?U:""})}),_}function IT(c,h,_){var E=c.pingCache;if(E===null){E=c.pingCache=new X3;var b=new Set;E.set(h,b)}else(b=E.get(h))===void 0&&(b=new Set,E.set(h,b));b.has(_)||(b.add(_),c=eD.bind(null,c,h,_),h.then(c,c))}function LT(c){do{var h;if((h=c.tag===13)&&(h=(h=c.memoizedState)===null||h.dehydrated!==null),h)return c;c=c.return}while(c!==null);return null}function DT(c,h,_,E,b){return 1&c.mode?(c.flags|=65536,c.lanes=b,c):(c===h?c.flags|=65536:(c.flags|=128,_.flags|=131072,_.flags&=-52805,_.tag===1&&(_.alternate===null?_.tag=17:((h=to(-1,1)).tag=2,Go(_,h,1))),_.lanes|=1),c)}var j3=o.ReactCurrentOwner,zi=!1;function Gi(c,h,_,E){h.child=c===null?oT(h,null,_,E):cu(h,c.child,_,E)}function NT(c,h,_,E,b){_=_.render;var A=h.ref;return uu(h,b),E=m_(c,h,_,E,A,b),_=g_(),c===null||zi?(ln&&_&&K0(h),h.flags|=1,Gi(c,h,E,b),h.child):(h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~b,no(c,h,b))}function UT(c,h,_,E,b){if(c===null){var A=_.type;return typeof A!="function"||$_(A)||A.defaultProps!==void 0||_.compare!==null||_.defaultProps!==void 0?((c=np(_.type,null,E,h,h.mode,b)).ref=h.ref,c.return=h,h.child=c):(h.tag=15,h.type=A,FT(c,h,A,E,b))}if(A=c.child,(c.lanes&b)==0){var U=A.memoizedProps;if((_=(_=_.compare)!==null?_:bf)(U,E)&&c.ref===h.ref)return no(c,h,b)}return h.flags|=1,(c=$o(A,E)).ref=h.ref,c.return=h,h.child=c}function FT(c,h,_,E,b){if(c!==null){var A=c.memoizedProps;if(bf(A,E)&&c.ref===h.ref){if(zi=!1,h.pendingProps=E=A,(c.lanes&b)==0)return h.lanes=c.lanes,no(c,h,b);131072&c.flags&&(zi=!0)}}return T_(c,h,_,E,b)}function OT(c,h,_){var E=h.pendingProps,b=E.children,A=c!==null?c.memoizedState:null;if(E.mode==="hidden")if(!(1&h.mode))h.memoizedState={baseLanes:0,cachePool:null,transitions:null},We(mu,er),er|=_;else{if(!(1073741824&_))return c=A!==null?A.baseLanes|_:_,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:c,cachePool:null,transitions:null},h.updateQueue=null,We(mu,er),er|=c,null;h.memoizedState={baseLanes:0,cachePool:null,transitions:null},E=A!==null?A.baseLanes:_,We(mu,er),er|=E}else A!==null?(E=A.baseLanes|_,h.memoizedState=null):E=_,We(mu,er),er|=E;return Gi(c,h,b,_),h.child}function kT(c,h){var _=h.ref;(c===null&&_!==null||c!==null&&c.ref!==_)&&(h.flags|=512,h.flags|=2097152)}function T_(c,h,_,E,b){var A=oi(_)?ds:wt.current;return A=gr(h,A),uu(h,b),_=m_(c,h,_,E,A,b),E=g_(),c===null||zi?(ln&&E&&K0(h),h.flags|=1,Gi(c,h,_,b),h.child):(h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~b,no(c,h,b))}function BT(c,h,_,E,b){if(oi(_)){var A=!0;ai(h)}else A=!1;if(uu(h,b),h.stateNode===null)zf(c,h),nT(h,_,E),l_(h,_,E,b),E=!0;else if(c===null){var U=h.stateNode,W=h.memoizedProps;U.props=W;var ne=U.context,ce=_.contextType;typeof ce=="object"&&ce!==null?ce=xr(ce):ce=gr(h,ce=oi(_)?ds:wt.current);var fe=_.getDerivedStateFromProps,De=typeof fe=="function"||typeof U.getSnapshotBeforeUpdate=="function";De||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(W!==E||ne!==ce)&&iT(h,U,E,ce),zo=!1;var de=h.memoizedState;U.state=de,Cf(h,E,U,b),ne=h.memoizedState,W!==E||de!==ne||xn.current||zo?(typeof fe=="function"&&(a_(h,_,fe,E),ne=h.memoizedState),(W=zo||tT(h,_,W,E,de,ne,ce))?(De||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(h.flags|=4194308)):(typeof U.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=E,h.memoizedState=ne),U.props=E,U.state=ne,U.context=ce,E=W):(typeof U.componentDidMount=="function"&&(h.flags|=4194308),E=!1)}else{U=h.stateNode,ZE(c,h),W=h.memoizedProps,ce=h.type===h.elementType?W:Hr(h.type,W),U.props=ce,De=h.pendingProps,de=U.context,typeof(ne=_.contextType)=="object"&&ne!==null?ne=xr(ne):ne=gr(h,ne=oi(_)?ds:wt.current);var Se=_.getDerivedStateFromProps;(fe=typeof Se=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(W!==De||de!==ne)&&iT(h,U,E,ne),zo=!1,de=h.memoizedState,U.state=de,Cf(h,E,U,b);var je=h.memoizedState;W!==De||de!==je||xn.current||zo?(typeof Se=="function"&&(a_(h,_,Se,E),je=h.memoizedState),(ce=zo||tT(h,_,ce,E,de,je,ne)||!1)?(fe||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(E,je,ne),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(E,je,ne)),typeof U.componentDidUpdate=="function"&&(h.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof U.componentDidUpdate!="function"||W===c.memoizedProps&&de===c.memoizedState||(h.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||W===c.memoizedProps&&de===c.memoizedState||(h.flags|=1024),h.memoizedProps=E,h.memoizedState=je),U.props=E,U.state=je,U.context=ne,E=ce):(typeof U.componentDidUpdate!="function"||W===c.memoizedProps&&de===c.memoizedState||(h.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||W===c.memoizedProps&&de===c.memoizedState||(h.flags|=1024),E=!1)}return b_(c,h,_,E,A,b)}function b_(c,h,_,E,b,A){kT(c,h);var U=(128&h.flags)!=0;if(!E&&!U)return b&&ru(h,_,!1),no(c,h,A);E=h.stateNode,j3.current=h;var W=U&&typeof _.getDerivedStateFromError!="function"?null:E.render();return h.flags|=1,c!==null&&U?(h.child=cu(h,c.child,null,A),h.child=cu(h,null,W,A)):Gi(c,h,W,A),h.memoizedState=E.state,b&&ru(h,_,!0),h.child}function zT(c){var h=c.stateNode;h.pendingContext?fs(0,h.pendingContext,h.pendingContext!==h.context):h.context&&fs(0,h.context,!1),u_(c,h.containerInfo)}function GT(c,h,_,E,b){return au(),e_(b),h.flags|=256,Gi(c,h,_,E),h.child}var vh,yh,Of,kf,w_={dehydrated:null,treeContext:null,retryLane:0};function A_(c){return{baseLanes:c,cachePool:null,transitions:null}}function HT(c,h,_){var E,b=h.pendingProps,A=Sn.current,U=!1,W=(128&h.flags)!=0;if((E=W)||(E=(c===null||c.memoizedState!==null)&&(2&A)!=0),E?(U=!0,h.flags&=-129):c!==null&&c.memoizedState===null||(A|=1),We(Sn,1&A),c===null)return J0(h),(c=h.memoizedState)!==null&&(c=c.dehydrated)!==null?(1&h.mode?ah(c)?h.lanes=8:h.lanes=1073741824:h.lanes=1,null):(W=b.children,c=b.fallback,U?(b=h.mode,U=h.child,W={mode:"hidden",children:W},!(1&b)&&U!==null?(U.childLanes=0,U.pendingProps=W):U=ip(W,b,0,null),c=Za(c,b,_,null),U.return=h,c.return=h,U.sibling=c,h.child=U,h.child.memoizedState=A_(_),h.memoizedState=w_,c):M_(h,W));if((A=c.memoizedState)!==null&&(E=A.dehydrated)!==null)return function(ce,fe,De,de,Se,je,Tt){if(De)return 256&fe.flags?(fe.flags&=-257,Bf(ce,fe,Tt,de=S_(Error(s(422))))):fe.memoizedState!==null?(fe.child=ce.child,fe.flags|=128,null):(je=de.fallback,Se=fe.mode,de=ip({mode:"visible",children:de.children},Se,0,null),(je=Za(je,Se,Tt,null)).flags|=2,de.return=fe,je.return=fe,de.sibling=je,fe.child=de,1&fe.mode&&cu(fe,ce.child,null,Tt),fe.child.memoizedState=A_(Tt),fe.memoizedState=w_,je);if(!(1&fe.mode))return Bf(ce,fe,Tt,null);if(ah(Se))return de=nu(Se).digest,je=Error(s(419)),de=S_(je,de,void 0),Bf(ce,fe,Tt,de);if(De=(Tt&ce.childLanes)!=0,zi||De){if((de=qn)!==null){switch(Tt&-Tt){case 4:Se=2;break;case 16:Se=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Se=32;break;case 536870912:Se=268435456;break;default:Se=0}(Se=Se&(de.suspendedLanes|Tt)?0:Se)!==0&&Se!==je.retryLane&&(je.retryLane=Se,_s(ce,Se),Tr(de,ce,Se,-1))}return j_(),Bf(ce,fe,Tt,de=S_(Error(s(421))))}return oh(Se)?(fe.flags|=128,fe.child=ce.child,fe=tD.bind(null,ce),pf(Se,fe),null):(ce=je.treeContext,ct&&(yr=B0(Se),Ji=fe,ln=!0,Gr=null,ch=!1,ce!==null&&(_r[vr++]=gs,_r[vr++]=eo,_r[vr++]=Wa,gs=ce.id,eo=ce.overflow,Wa=fe)),fe=M_(fe,de.children),fe.flags|=4096,fe)}(c,h,W,b,E,A,_);if(U){U=b.fallback,W=h.mode,E=(A=c.child).sibling;var ne={mode:"hidden",children:b.children};return!(1&W)&&h.child!==A?((b=h.child).childLanes=0,b.pendingProps=ne,h.deletions=null):(b=$o(A,ne)).subtreeFlags=14680064&A.subtreeFlags,E!==null?U=$o(E,U):(U=Za(U,W,_,null)).flags|=2,U.return=h,b.return=h,b.sibling=U,h.child=b,b=U,U=h.child,W=(W=c.child.memoizedState)===null?A_(_):{baseLanes:W.baseLanes|_,cachePool:null,transitions:W.transitions},U.memoizedState=W,U.childLanes=c.childLanes&~_,h.memoizedState=w_,b}return c=(U=c.child).sibling,b=$o(U,{mode:"visible",children:b.children}),!(1&h.mode)&&(b.lanes=_),b.return=h,b.sibling=null,c!==null&&((_=h.deletions)===null?(h.deletions=[c],h.flags|=16):_.push(c)),h.child=b,h.memoizedState=null,b}function M_(c,h){return(h=ip({mode:"visible",children:h},c.mode,0,null)).return=c,c.child=h}function Bf(c,h,_,E){return E!==null&&e_(E),cu(h,c.child,null,_),(c=M_(h,h.pendingProps.children)).flags|=2,h.memoizedState=null,c}function VT(c,h,_){c.lanes|=h;var E=c.alternate;E!==null&&(E.lanes|=h),r_(c.return,h,_)}function C_(c,h,_,E,b){var A=c.memoizedState;A===null?c.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:E,tail:_,tailMode:b}:(A.isBackwards=h,A.rendering=null,A.renderingStartTime=0,A.last=E,A.tail=_,A.tailMode=b)}function WT(c,h,_){var E=h.pendingProps,b=E.revealOrder,A=E.tail;if(Gi(c,h,E.children,_),(2&(E=Sn.current))!=0)E=1&E|2,h.flags|=128;else{if(c!==null&&128&c.flags)e:for(c=h.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&VT(c,_,h);else if(c.tag===19)VT(c,_,h);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===h)break e;for(;c.sibling===null;){if(c.return===null||c.return===h)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}E&=1}if(We(Sn,E),(1&h.mode)==0)h.memoizedState=null;else switch(b){case"forwards":for(_=h.child,b=null;_!==null;)(c=_.alternate)!==null&&If(c)===null&&(b=_),_=_.sibling;(_=b)===null?(b=h.child,h.child=null):(b=_.sibling,_.sibling=null),C_(h,!1,b,_,A);break;case"backwards":for(_=null,b=h.child,h.child=null;b!==null;){if((c=b.alternate)!==null&&If(c)===null){h.child=b;break}c=b.sibling,b.sibling=_,_=b,b=c}C_(h,!0,_,null,A);break;case"together":C_(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function zf(c,h){!(1&h.mode)&&c!==null&&(c.alternate=null,h.alternate=null,h.flags|=2)}function no(c,h,_){if(c!==null&&(h.dependencies=c.dependencies),Ya|=h.lanes,(_&h.childLanes)==0)return null;if(c!==null&&h.child!==c.child)throw Error(s(153));if(h.child!==null){for(_=$o(c=h.child,c.pendingProps),h.child=_,_.return=h;c.sibling!==null;)c=c.sibling,(_=_.sibling=$o(c,c.pendingProps)).return=h;_.sibling=null}return h.child}function xs(c){c.flags|=4}function XT(c,h){if(c!==null&&c.child===h.child)return!0;if(16&h.flags)return!1;for(c=h.child;c!==null;){if(12854&c.flags||12854&c.subtreeFlags)return!1;c=c.sibling}return!0}if(Ie)vh=function(c,h){for(var _=h.child;_!==null;){if(_.tag===5||_.tag===6)te(c,_.stateNode);else if(_.tag!==4&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===h)break;for(;_.sibling===null;){if(_.return===null||_.return===h)return;_=_.return}_.sibling.return=_.return,_=_.sibling}},yh=function(){},Of=function(c,h,_,E,b){if((c=c.memoizedProps)!==E){var A=h.stateNode,U=vs(Sr.current);_=re(A,_,c,E,b,U),(h.updateQueue=_)&&xs(h)}},kf=function(c,h,_,E){_!==E&&xs(h)};else if(q){vh=function(c,h,_,E){for(var b=h.child;b!==null;){if(b.tag===5){var A=b.stateNode;_&&E&&(A=wn(A,b.type,b.memoizedProps,b)),te(c,A)}else if(b.tag===6)A=b.stateNode,_&&E&&(A=Wn(A,b.memoizedProps,b)),te(c,A);else if(b.tag!==4){if(b.tag===22&&b.memoizedState!==null)(A=b.child)!==null&&(A.return=b),vh(c,b,!0,!0);else if(b.child!==null){b.child.return=b,b=b.child;continue}}if(b===h)break;for(;b.sibling===null;){if(b.return===null||b.return===h)return;b=b.return}b.sibling.return=b.return,b=b.sibling}};var jT=function(c,h,_,E){for(var b=h.child;b!==null;){if(b.tag===5){var A=b.stateNode;_&&E&&(A=wn(A,b.type,b.memoizedProps,b)),Ce(c,A)}else if(b.tag===6)A=b.stateNode,_&&E&&(A=Wn(A,b.memoizedProps,b)),Ce(c,A);else if(b.tag!==4){if(b.tag===22&&b.memoizedState!==null)(A=b.child)!==null&&(A.return=b),jT(c,b,!0,!0);else if(b.child!==null){b.child.return=b,b=b.child;continue}}if(b===h)break;for(;b.sibling===null;){if(b.return===null||b.return===h)return;b=b.return}b.sibling.return=b.return,b=b.sibling}};yh=function(c,h){var _=h.stateNode;if(!XT(c,h)){c=_.containerInfo;var E=he(c);jT(E,h,!1,!1),_.pendingChildren=E,xs(h),at(c,E)}},Of=function(c,h,_,E,b){var A=c.stateNode,U=c.memoizedProps;if((c=XT(c,h))&&U===E)h.stateNode=A;else{var W=h.stateNode,ne=vs(Sr.current),ce=null;U!==E&&(ce=re(W,_,U,E,b,ne)),c&&ce===null?h.stateNode=A:(A=Te(A,ce,_,U,E,h,c,W),ee(A,_,E,b,ne)&&xs(h),h.stateNode=A,c?xs(h):vh(A,h,!1,!1))}},kf=function(c,h,_,E){_!==E?(c=vs(hu.current),_=vs(Sr.current),h.stateNode=ve(E,c,_,h),xs(h)):h.stateNode=c.stateNode}}else yh=function(){},Of=function(){},kf=function(){};function xh(c,h){if(!ln)switch(c.tailMode){case"hidden":h=c.tail;for(var _=null;h!==null;)h.alternate!==null&&(_=h),h=h.sibling;_===null?c.tail=null:_.sibling=null;break;case"collapsed":_=c.tail;for(var E=null;_!==null;)_.alternate!==null&&(E=_),_=_.sibling;E===null?h||c.tail===null?c.tail=null:c.tail.sibling=null:E.sibling=null}}function Ci(c){var h=c.alternate!==null&&c.alternate.child===c.child,_=0,E=0;if(h)for(var b=c.child;b!==null;)_|=b.lanes|b.childLanes,E|=14680064&b.subtreeFlags,E|=14680064&b.flags,b.return=c,b=b.sibling;else for(b=c.child;b!==null;)_|=b.lanes|b.childLanes,E|=b.subtreeFlags,E|=b.flags,b.return=c,b=b.sibling;return c.subtreeFlags|=E,c.childLanes=_,h}function $3(c,h,_){var E=h.pendingProps;switch(Z0(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ci(h),null;case 1:case 17:return oi(h.type)&&Pn(),Ci(h),null;case 3:return _=h.stateNode,du(),dt(xn),dt(wt),d_(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),c!==null&&c.child!==null||(Tf(h)?xs(h):c===null||c.memoizedState.isDehydrated&&!(256&h.flags)||(h.flags|=1024,Gr!==null&&(W_(Gr),Gr=null))),yh(c,h),Ci(h),null;case 5:c_(h),_=vs(hu.current);var b=h.type;if(c!==null&&h.stateNode!=null)Of(c,h,b,E,_),c.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!E){if(h.stateNode===null)throw Error(s(166));return Ci(h),null}if(c=vs(Sr.current),Tf(h)){if(!ct)throw Error(s(175));c=z0(h.stateNode,h.type,h.memoizedProps,_,c,h,!ch),h.updateQueue=c,c!==null&&xs(h)}else{var A=H(b,E,_,c,h);vh(A,h,!1,!1),h.stateNode=A,ee(A,b,E,_,c)&&xs(h)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return Ci(h),null;case 6:if(c&&h.stateNode!=null)kf(c,h,c.memoizedProps,E);else{if(typeof E!="string"&&h.stateNode===null)throw Error(s(166));if(c=vs(hu.current),_=vs(Sr.current),Tf(h)){if(!ct)throw Error(s(176));if(c=h.stateNode,_=h.memoizedProps,(E=G0(c,_,h,!ch))&&(b=Ji)!==null)switch(b.tag){case 3:ot(b.stateNode.containerInfo,c,_,(1&b.mode)!=0);break;case 5:pt(b.type,b.memoizedProps,b.stateNode,c,_,(1&b.mode)!=0)}E&&xs(h)}else h.stateNode=ve(E,c,_,h)}return Ci(h),null;case 13:if(dt(Sn),E=h.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(ln&&yr!==null&&1&h.mode&&!(128&h.flags))YE(),au(),h.flags|=98560,b=!1;else if(b=Tf(h),E!==null&&E.dehydrated!==null){if(c===null){if(!b)throw Error(s(318));if(!ct)throw Error(s(344));if(!(b=(b=h.memoizedState)!==null?b.dehydrated:null))throw Error(s(317));N(b,h)}else au(),!(128&h.flags)&&(h.memoizedState=null),h.flags|=4;Ci(h),b=!1}else Gr!==null&&(W_(Gr),Gr=null),b=!0;if(!b)return 65536&h.flags?h:null}return 128&h.flags?(h.lanes=_,h):((_=E!==null)!=(c!==null&&c.memoizedState!==null)&&_&&(h.child.flags|=8192,1&h.mode&&(c===null||1&Sn.current?On===0&&(On=3):j_())),h.updateQueue!==null&&(h.flags|=4),Ci(h),null);case 4:return du(),yh(c,h),c===null&&st(h.stateNode.containerInfo),Ci(h),null;case 10:return i_(h.type._context),Ci(h),null;case 19:if(dt(Sn),(b=h.memoizedState)===null)return Ci(h),null;if(E=(128&h.flags)!=0,(A=b.rendering)===null)if(E)xh(b,!1);else{if(On!==0||c!==null&&128&c.flags)for(c=h.child;c!==null;){if((A=If(c))!==null){for(h.flags|=128,xh(b,!1),(c=A.updateQueue)!==null&&(h.updateQueue=c,h.flags|=4),h.subtreeFlags=0,c=_,_=h.child;_!==null;)b=c,(E=_).flags&=14680066,(A=E.alternate)===null?(E.childLanes=0,E.lanes=b,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=A.childLanes,E.lanes=A.lanes,E.child=A.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=A.memoizedProps,E.memoizedState=A.memoizedState,E.updateQueue=A.updateQueue,E.type=A.type,b=A.dependencies,E.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext}),_=_.sibling;return We(Sn,1&Sn.current|2),h.child}c=c.sibling}b.tail!==null&&jn()>z_&&(h.flags|=128,E=!0,xh(b,!1),h.lanes=4194304)}else{if(!E)if((c=If(A))!==null){if(h.flags|=128,E=!0,(c=c.updateQueue)!==null&&(h.updateQueue=c,h.flags|=4),xh(b,!0),b.tail===null&&b.tailMode==="hidden"&&!A.alternate&&!ln)return Ci(h),null}else 2*jn()-b.renderingStartTime>z_&&_!==1073741824&&(h.flags|=128,E=!0,xh(b,!1),h.lanes=4194304);b.isBackwards?(A.sibling=h.child,h.child=A):((c=b.last)!==null?c.sibling=A:h.child=A,b.last=A)}return b.tail!==null?(h=b.tail,b.rendering=h,b.tail=h.sibling,b.renderingStartTime=jn(),h.sibling=null,c=Sn.current,We(Sn,E?1&c|2:1&c),h):(Ci(h),null);case 22:case 23:return X_(),_=h.memoizedState!==null,c!==null&&c.memoizedState!==null!==_&&(h.flags|=8192),_&&1&h.mode?1073741824&er&&(Ci(h),Ie&&6&h.subtreeFlags&&(h.flags|=8192)):Ci(h),null;case 24:case 25:return null}throw Error(s(156,h.tag))}function Y3(c,h){switch(Z0(h),h.tag){case 1:return oi(h.type)&&Pn(),65536&(c=h.flags)?(h.flags=-65537&c|128,h):null;case 3:return du(),dt(xn),dt(wt),d_(),65536&(c=h.flags)&&!(128&c)?(h.flags=-65537&c|128,h):null;case 5:return c_(h),null;case 13:if(dt(Sn),(c=h.memoizedState)!==null&&c.dehydrated!==null){if(h.alternate===null)throw Error(s(340));au()}return 65536&(c=h.flags)?(h.flags=-65537&c|128,h):null;case 19:return dt(Sn),null;case 4:return du(),null;case 10:return i_(h.type._context),null;case 22:case 23:return X_(),null;default:return null}}var Gf=!1,_i=!1,q3=typeof WeakSet=="function"?WeakSet:Set,Ge=null;function pu(c,h){var _=c.ref;if(_!==null)if(typeof _=="function")try{_(null)}catch(E){un(c,h,E)}else _.current=null}function $T(c,h,_){try{_()}catch(E){un(c,h,E)}}var YT=!1;function Sh(c,h,_){var E=h.updateQueue;if((E=E!==null?E.lastEffect:null)!==null){var b=E=E.next;do{if((b.tag&c)===c){var A=b.destroy;b.destroy=void 0,A!==void 0&&$T(h,_,A)}b=b.next}while(b!==E)}}function Hf(c,h){if((h=(h=h.updateQueue)!==null?h.lastEffect:null)!==null){var _=h=h.next;do{if((_.tag&c)===c){var E=_.create;_.destroy=E()}_=_.next}while(_!==h)}}function R_(c){var h=c.ref;if(h!==null){var _=c.stateNode;c.tag===5?c=Q(_):c=_,typeof h=="function"?h(c):h.current=c}}function qT(c){var h=c.alternate;h!==null&&(c.alternate=null,qT(h)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(h=c.stateNode)!==null&&Zt(h),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function KT(c){return c.tag===5||c.tag===3||c.tag===4}function ZT(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||KT(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(2&c.flags||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(2&c.flags))return c.stateNode}}function P_(c,h,_){var E=c.tag;if(E===5||E===6)c=c.stateNode,h?be(_,c,h):Qe(_,c);else if(E!==4&&(c=c.child)!==null)for(P_(c,h,_),c=c.sibling;c!==null;)P_(c,h,_),c=c.sibling}function I_(c,h,_){var E=c.tag;if(E===5||E===6)c=c.stateNode,h?Bt(_,c,h):Ae(_,c);else if(E!==4&&(c=c.child)!==null)for(I_(c,h,_),c=c.sibling;c!==null;)I_(c,h,_),c=c.sibling}var Ri=null,Ss=!1;function Es(c,h,_){for(_=_.child;_!==null;)L_(c,h,_),_=_.sibling}function L_(c,h,_){if(ps&&typeof ps.onCommitFiberUnmount=="function")try{ps.onCommitFiberUnmount(yf,_)}catch{}switch(_.tag){case 5:_i||pu(_,h);case 6:if(Ie){var E=Ri,b=Ss;Ri=null,Es(c,h,_),Ss=b,(Ri=E)!==null&&(Ss?yt(Ri,_.stateNode):Vt(Ri,_.stateNode))}else Es(c,h,_);break;case 18:Ie&&Ri!==null&&(Ss?Be(Ri,_.stateNode):oe(Ri,_.stateNode));break;case 4:Ie?(E=Ri,b=Ss,Ri=_.stateNode.containerInfo,Ss=!0,Es(c,h,_),Ri=E,Ss=b):(q&&(E=_.stateNode.containerInfo,b=he(E),Rt(E,b)),Es(c,h,_));break;case 0:case 11:case 14:case 15:if(!_i&&(E=_.updateQueue)!==null&&(E=E.lastEffect)!==null){b=E=E.next;do{var A=b,U=A.destroy;A=A.tag,U!==void 0&&(2&A||4&A)&&$T(_,h,U),b=b.next}while(b!==E)}Es(c,h,_);break;case 1:if(!_i&&(pu(_,h),typeof(E=_.stateNode).componentWillUnmount=="function"))try{E.props=_.memoizedProps,E.state=_.memoizedState,E.componentWillUnmount()}catch(W){un(_,h,W)}Es(c,h,_);break;case 21:Es(c,h,_);break;case 22:1&_.mode?(_i=(E=_i)||_.memoizedState!==null,Es(c,h,_),_i=E):Es(c,h,_);break;default:Es(c,h,_)}}function QT(c){var h=c.updateQueue;if(h!==null){c.updateQueue=null;var _=c.stateNode;_===null&&(_=c.stateNode=new q3),h.forEach(function(E){var b=nD.bind(null,c,E);_.has(E)||(_.add(E),E.then(b,b))})}}function Vr(c,h){var _=h.deletions;if(_!==null)for(var E=0;E<_.length;E++){var b=_[E];try{var A=c,U=h;if(Ie){var W=U;e:for(;W!==null;){switch(W.tag){case 5:Ri=W.stateNode,Ss=!1;break e;case 3:case 4:Ri=W.stateNode.containerInfo,Ss=!0;break e}W=W.return}if(Ri===null)throw Error(s(160));L_(A,U,b),Ri=null,Ss=!1}else L_(A,U,b);var ne=b.alternate;ne!==null&&(ne.return=null),b.return=null}catch(ce){un(b,h,ce)}}if(12854&h.subtreeFlags)for(h=h.child;h!==null;)JT(h,c),h=h.sibling}function JT(c,h){var _=c.alternate,E=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(Vr(h,c),Ts(c),4&E){try{Sh(3,c,c.return),Hf(3,c)}catch(de){un(c,c.return,de)}try{Sh(5,c,c.return)}catch(de){un(c,c.return,de)}}break;case 1:Vr(h,c),Ts(c),512&E&&_!==null&&pu(_,_.return);break;case 5:if(Vr(h,c),Ts(c),512&E&&_!==null&&pu(_,_.return),Ie){if(32&c.flags){var b=c.stateNode;try{ht(b)}catch(de){un(c,c.return,de)}}if(4&E&&(b=c.stateNode)!=null){var A=c.memoizedProps;if(_=_!==null?_.memoizedProps:A,E=c.type,h=c.updateQueue,c.updateQueue=null,h!==null)try{ft(b,h,E,_,A,c)}catch(de){un(c,c.return,de)}}}break;case 6:if(Vr(h,c),Ts(c),4&E&&Ie){if(c.stateNode===null)throw Error(s(162));b=c.stateNode,A=c.memoizedProps,_=_!==null?_.memoizedProps:A;try{Re(b,_,A)}catch(de){un(c,c.return,de)}}break;case 3:if(Vr(h,c),Ts(c),4&E){if(Ie&&ct&&_!==null&&_.memoizedState.isDehydrated)try{ae(h.containerInfo)}catch(de){un(c,c.return,de)}if(q){b=h.containerInfo,A=h.pendingChildren;try{Rt(b,A)}catch(de){un(c,c.return,de)}}}break;case 4:if(Vr(h,c),Ts(c),4&E&&q){b=(A=c.stateNode).containerInfo,A=A.pendingChildren;try{Rt(b,A)}catch(de){un(c,c.return,de)}}break;case 13:Vr(h,c),Ts(c),8192&(b=c.child).flags&&(A=b.memoizedState!==null,b.stateNode.isHidden=A,!A||b.alternate!==null&&b.alternate.memoizedState!==null||(B_=jn())),4&E&&QT(c);break;case 22:var U=_!==null&&_.memoizedState!==null;if(1&c.mode?(_i=(_=_i)||U,Vr(h,c),_i=_):Vr(h,c),Ts(c),8192&E){if(_=c.memoizedState!==null,(c.stateNode.isHidden=_)&&!U&&(1&c.mode)!=0)for(Ge=c,E=c.child;E!==null;){for(h=Ge=E;Ge!==null;){var W=(U=Ge).child;switch(U.tag){case 0:case 11:case 14:case 15:Sh(4,U,U.return);break;case 1:pu(U,U.return);var ne=U.stateNode;if(typeof ne.componentWillUnmount=="function"){var ce=U,fe=U.return;try{var De=ce;ne.props=De.memoizedProps,ne.state=De.memoizedState,ne.componentWillUnmount()}catch(de){un(ce,fe,de)}}break;case 5:pu(U,U.return);break;case 22:if(U.memoizedState!==null){nb(h);continue}}W!==null?(W.return=U,Ge=W):nb(h)}E=E.sibling}if(Ie){e:if(E=null,Ie)for(h=c;;){if(h.tag===5){if(E===null){E=h;try{b=h.stateNode,_?it(b):At(h.stateNode,h.memoizedProps)}catch(de){un(c,c.return,de)}}}else if(h.tag===6){if(E===null)try{A=h.stateNode,_?Ve(A):X(A,h.memoizedProps)}catch(de){un(c,c.return,de)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===c)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break e;for(;h.sibling===null;){if(h.return===null||h.return===c)break e;E===h&&(E=null),h=h.return}E===h&&(E=null),h.sibling.return=h.return,h=h.sibling}}}break;case 19:Vr(h,c),Ts(c),4&E&&QT(c);break;case 21:break;default:Vr(h,c),Ts(c)}}function Ts(c){var h=c.flags;if(2&h){try{if(Ie){e:{for(var _=c.return;_!==null;){if(KT(_)){var E=_;break e}_=_.return}throw Error(s(160))}switch(E.tag){case 5:var b=E.stateNode;32&E.flags&&(ht(b),E.flags&=-33),I_(c,ZT(c),b);break;case 3:case 4:var A=E.stateNode.containerInfo;P_(c,ZT(c),A);break;default:throw Error(s(161))}}}catch(U){un(c,c.return,U)}c.flags&=-3}4096&h&&(c.flags&=-4097)}function K3(c,h,_){Ge=c,eb(c)}function eb(c,h,_){for(var E=(1&c.mode)!=0;Ge!==null;){var b=Ge,A=b.child;if(b.tag===22&&E){var U=b.memoizedState!==null||Gf;if(!U){var W=b.alternate,ne=W!==null&&W.memoizedState!==null||_i;W=Gf;var ce=_i;if(Gf=U,(_i=ne)&&!ce)for(Ge=b;Ge!==null;)ne=(U=Ge).child,U.tag===22&&U.memoizedState!==null?ib(b):ne!==null?(ne.return=U,Ge=ne):ib(b);for(;A!==null;)Ge=A,eb(A),A=A.sibling;Ge=b,Gf=W,_i=ce}tb(c)}else 8772&b.subtreeFlags&&A!==null?(A.return=b,Ge=A):tb(c)}}function tb(c){for(;Ge!==null;){var h=Ge;if(8772&h.flags){var _=h.alternate;try{if(8772&h.flags)switch(h.tag){case 0:case 11:case 15:_i||Hf(5,h);break;case 1:var E=h.stateNode;if(4&h.flags&&!_i)if(_===null)E.componentDidMount();else{var b=h.elementType===h.type?_.memoizedProps:Hr(h.type,_.memoizedProps);E.componentDidUpdate(b,_.memoizedState,E.__reactInternalSnapshotBeforeUpdate)}var A=h.updateQueue;A!==null&&JE(h,A,E);break;case 3:var U=h.updateQueue;if(U!==null){if(_=null,h.child!==null)switch(h.child.tag){case 5:_=Q(h.child.stateNode);break;case 1:_=h.child.stateNode}JE(h,U,_)}break;case 5:var W=h.stateNode;_===null&&4&h.flags&&Oe(W,h.type,h.memoizedProps,h);break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(ct&&h.memoizedState===null){var ne=h.alternate;if(ne!==null){var ce=ne.memoizedState;if(ce!==null){var fe=ce.dehydrated;fe!==null&&le(fe)}}}break;default:throw Error(s(163))}_i||512&h.flags&&R_(h)}catch(De){un(h,h.return,De)}}if(h===c){Ge=null;break}if((_=h.sibling)!==null){_.return=h.return,Ge=_;break}Ge=h.return}}function nb(c){for(;Ge!==null;){var h=Ge;if(h===c){Ge=null;break}var _=h.sibling;if(_!==null){_.return=h.return,Ge=_;break}Ge=h.return}}function ib(c){for(;Ge!==null;){var h=Ge;try{switch(h.tag){case 0:case 11:case 15:var _=h.return;try{Hf(4,h)}catch(ne){un(h,_,ne)}break;case 1:var E=h.stateNode;if(typeof E.componentDidMount=="function"){var b=h.return;try{E.componentDidMount()}catch(ne){un(h,b,ne)}}var A=h.return;try{R_(h)}catch(ne){un(h,A,ne)}break;case 5:var U=h.return;try{R_(h)}catch(ne){un(h,U,ne)}}}catch(ne){un(h,h.return,ne)}if(h===c){Ge=null;break}var W=h.sibling;if(W!==null){W.return=h.return,Ge=W;break}Ge=h.return}}var Vf=0,Wf=1,Xf=2,jf=3,$f=4;if(typeof Symbol=="function"&&Symbol.for){var Eh=Symbol.for;Vf=Eh("selector.component"),Wf=Eh("selector.has_pseudo_class"),Xf=Eh("selector.role"),jf=Eh("selector.test_id"),$f=Eh("selector.text")}function D_(c){var h=Xe(c);if(h!=null){if(typeof h.memoizedProps["data-testname"]!="string")throw Error(s(364));return h}if((c=Un(c))===null)throw Error(s(362));return c.stateNode.current}function N_(c,h){switch(h.$$typeof){case Vf:if(c.type===h.value)return!0;break;case Wf:e:{h=h.value,c=[c,0];for(var _=0;_<c.length;){var E=c[_++],b=c[_++],A=h[b];if(E.tag!==5||!I(E)){for(;A!=null&&N_(E,A);)A=h[++b];if(b===h.length){h=!0;break e}for(E=E.child;E!==null;)c.push(E,b),E=E.sibling}}h=!1}return h;case Xf:if(c.tag===5&&se(c.stateNode,h.value))return!0;break;case $f:if((c.tag===5||c.tag===6)&&(c=B(c))!==null&&0<=c.indexOf(h.value))return!0;break;case jf:if(c.tag===5&&typeof(c=c.memoizedProps["data-testname"])=="string"&&c.toLowerCase()===h.value.toLowerCase())return!0;break;default:throw Error(s(365))}return!1}function U_(c){switch(c.$$typeof){case Vf:return"<"+(P(c.value)||"Unknown")+">";case Wf:return":has("+(U_(c)||"")+")";case Xf:return'[role="'+c.value+'"]';case $f:return'"'+c.value+'"';case jf:return'[data-testname="'+c.value+'"]';default:throw Error(s(365))}}function rb(c,h){var _=[];c=[c,0];for(var E=0;E<c.length;){var b=c[E++],A=c[E++],U=h[A];if(b.tag!==5||!I(b)){for(;U!=null&&N_(b,U);)U=h[++A];if(A===h.length)_.push(b);else for(b=b.child;b!==null;)c.push(b,A),b=b.sibling}}return _}function F_(c,h){if(!Ot)throw Error(s(363));c=rb(c=D_(c),h),h=[],c=Array.from(c);for(var _=0;_<c.length;){var E=c[_++];if(E.tag===5)I(E)||h.push(E.stateNode);else for(E=E.child;E!==null;)c.push(E),E=E.sibling}return h}var Z3=Math.ceil,Yf=o.ReactCurrentDispatcher,O_=o.ReactCurrentOwner,An=o.ReactCurrentBatchConfig,Ut=0,qn=null,In=null,li=0,er=0,mu=Xn(0),On=0,Th=null,Ya=0,qf=0,k_=0,bh=null,tr=null,B_=0,z_=1/0,Ho=null;function gu(){z_=jn()+500}var sb,Kf=!1,G_=null,Vo=null,Zf=!1,Wo=null,Qf=0,wh=0,H_=null,Jf=-1,ep=0;function vi(){return 6&Ut?jn():Jf!==-1?Jf:Jf=jn()}function Xo(c){return 1&c.mode?2&Ut&&li!==0?li&-li:F3.transition!==null?(ep===0&&(ep=BE()),ep):(c=Gt)!==0?c:nt():1}function Tr(c,h,_,E){if(50<wh)throw wh=0,H_=null,Error(s(185));uh(c,_,E),2&Ut&&c===qn||(c===qn&&(!(2&Ut)&&(qf|=_),On===4&&jo(c,li)),Hi(c,E),_===1&&Ut===0&&!(1&h.mode)&&(gu(),xf&&ms()))}function Hi(c,h){var _=c.callbackNode;(function(b,A){for(var U=b.suspendedLanes,W=b.pingedLanes,ne=b.expirationTimes,ce=b.pendingLanes;0<ce;){var fe=31-Qi(ce),De=1<<fe,de=ne[fe];de===-1?De&U&&!(De&W)||(ne[fe]=I3(De,A)):de<=A&&(b.expiredLanes|=De),ce&=~De}})(c,h);var E=vf(c,c===qn?li:0);if(E===0)_!==null&&GE(_),c.callbackNode=null,c.callbackPriority=0;else if(h=E&-E,c.callbackPriority!==h){if(_!=null&&GE(_),h===1)c.tag===0?function(b){xf=!0,VE(b)}(ab.bind(null,c)):VE(ab.bind(null,c)),gt?xt(function(){!(6&Ut)&&ms()}):$0(Y0,ms),_=null;else{switch(zE(E)){case 1:_=Y0;break;case 4:_=N3;break;case 16:default:_=HE;break;case 536870912:_=U3}_=mb(_,ob.bind(null,c))}c.callbackPriority=h,c.callbackNode=_}}function ob(c,h){if(Jf=-1,ep=0,(6&Ut)!=0)throw Error(s(327));var _=c.callbackNode;if(Ka()&&c.callbackNode!==_)return null;var E=vf(c,c===qn?li:0);if(E===0)return null;if(30&E||E&c.expiredLanes||h)h=tp(c,E);else{h=E;var b=Ut;Ut|=2;var A=cb();for(qn===c&&li===h||(Ho=null,gu(),qa(c,h));;)try{J3();break}catch(W){ub(c,W)}n_(),Yf.current=A,Ut=b,In!==null?h=0:(qn=null,li=0,h=On)}if(h!==0){if(h===2&&(b=W0(c))!==0&&(E=b,h=V_(c,b)),h===1)throw _=Th,qa(c,0),jo(c,E),Hi(c,jn()),_;if(h===6)jo(c,E);else{if(b=c.current.alternate,(30&E)==0&&!function(W){for(var ne=W;;){if(16384&ne.flags){var ce=ne.updateQueue;if(ce!==null&&(ce=ce.stores)!==null)for(var fe=0;fe<ce.length;fe++){var De=ce[fe],de=De.getSnapshot;De=De.value;try{if(!zr(de(),De))return!1}catch{return!1}}}if(ce=ne.child,16384&ne.subtreeFlags&&ce!==null)ce.return=ne,ne=ce;else{if(ne===W)break;for(;ne.sibling===null;){if(ne.return===null||ne.return===W)return!0;ne=ne.return}ne.sibling.return=ne.return,ne=ne.sibling}}return!0}(b)&&((h=tp(c,E))===2&&(A=W0(c))!==0&&(E=A,h=V_(c,A)),h===1))throw _=Th,qa(c,0),jo(c,E),Hi(c,jn()),_;switch(c.finishedWork=b,c.finishedLanes=E,h){case 0:case 1:throw Error(s(345));case 2:case 5:_u(c,tr,Ho);break;case 3:if(jo(c,E),(130023424&E)===E&&10<(h=B_+500-jn())){if(vf(c,0)!==0)break;if(((b=c.suspendedLanes)&E)!==E){vi(),c.pingedLanes|=c.suspendedLanes&b;break}c.timeoutHandle=Me(_u.bind(null,c,tr,Ho),h);break}_u(c,tr,Ho);break;case 4:if(jo(c,E),(4194240&E)===E)break;for(h=c.eventTimes,b=-1;0<E;){var U=31-Qi(E);A=1<<U,(U=h[U])>b&&(b=U),E&=~A}if(E=b,10<(E=(120>(E=jn()-E)?120:480>E?480:1080>E?1080:1920>E?1920:3e3>E?3e3:4320>E?4320:1960*Z3(E/1960))-E)){c.timeoutHandle=Me(_u.bind(null,c,tr,Ho),E);break}_u(c,tr,Ho);break;default:throw Error(s(329))}}}return Hi(c,jn()),c.callbackNode===_?ob.bind(null,c):null}function V_(c,h){var _=bh;return c.current.memoizedState.isDehydrated&&(qa(c,h).flags|=256),(c=tp(c,h))!==2&&(h=tr,tr=_,h!==null&&W_(h)),c}function W_(c){tr===null?tr=c:tr.push.apply(tr,c)}function jo(c,h){for(h&=~k_,h&=~qf,c.suspendedLanes|=h,c.pingedLanes&=~h,c=c.expirationTimes;0<h;){var _=31-Qi(h),E=1<<_;c[_]=-1,h&=~E}}function ab(c){if(6&Ut)throw Error(s(327));Ka();var h=vf(c,0);if(!(1&h))return Hi(c,jn()),null;var _=tp(c,h);if(c.tag!==0&&_===2){var E=W0(c);E!==0&&(h=E,_=V_(c,E))}if(_===1)throw _=Th,qa(c,0),jo(c,h),Hi(c,jn()),_;if(_===6)throw Error(s(345));return c.finishedWork=c.current.alternate,c.finishedLanes=h,_u(c,tr,Ho),Hi(c,jn()),null}function lb(c){Wo!==null&&Wo.tag===0&&!(6&Ut)&&Ka();var h=Ut;Ut|=1;var _=An.transition,E=Gt;try{if(An.transition=null,Gt=1,c)return c()}finally{Gt=E,An.transition=_,!(6&(Ut=h))&&ms()}}function X_(){er=mu.current,dt(mu)}function qa(c,h){c.finishedWork=null,c.finishedLanes=0;var _=c.timeoutHandle;if(_!==Ye&&(c.timeoutHandle=Ye,Ze(_)),In!==null)for(_=In.return;_!==null;){var E=_;switch(Z0(E),E.tag){case 1:(E=E.type.childContextTypes)!=null&&Pn();break;case 3:du(),dt(xn),dt(wt),d_();break;case 5:c_(E);break;case 4:du();break;case 13:case 19:dt(Sn);break;case 10:i_(E.type._context);break;case 22:case 23:X_()}_=_.return}if(qn=c,In=c=$o(c.current,null),li=er=h,On=0,Th=null,k_=qf=Ya=0,tr=bh=null,ja!==null){for(h=0;h<ja.length;h++)if((E=(_=ja[h]).interleaved)!==null){_.interleaved=null;var b=E.next,A=_.pending;if(A!==null){var U=A.next;A.next=b,E.next=U}_.pending=E}ja=null}return c}function ub(c,h){for(;;){var _=In;try{if(n_(),Lf.current=Ff,Df){for(var E=fn.memoizedState;E!==null;){var b=E.queue;b!==null&&(b.pending=null),E=E.next}Df=!1}if($a=0,Yn=$n=fn=null,ph=!1,mh=0,O_.current=null,_===null||_.return===null){On=1,Th=h,In=null;break}e:{var A=c,U=_.return,W=_,ne=h;if(h=li,W.flags|=32768,ne!==null&&typeof ne=="object"&&typeof ne.then=="function"){var ce=ne,fe=W,De=fe.tag;if(!(1&fe.mode)&&(De===0||De===11||De===15)){var de=fe.alternate;de?(fe.updateQueue=de.updateQueue,fe.memoizedState=de.memoizedState,fe.lanes=de.lanes):(fe.updateQueue=null,fe.memoizedState=null)}var Se=LT(U);if(Se!==null){Se.flags&=-257,DT(Se,U,W,0,h),1&Se.mode&&IT(A,ce,h),ne=ce;var je=(h=Se).updateQueue;if(je===null){var Tt=new Set;Tt.add(ne),h.updateQueue=Tt}else je.add(ne);break e}if(!(1&h)){IT(A,ce,h),j_();break e}ne=Error(s(426))}else if(ln&&1&W.mode){var pe=LT(U);if(pe!==null){!(65536&pe.flags)&&(pe.flags|=256),DT(pe,U,W,0,h),e_(fu(ne,W));break e}}A=ne=fu(ne,W),On!==4&&(On=2),bh===null?bh=[A]:bh.push(A),A=U;do{switch(A.tag){case 3:A.flags|=65536,h&=-h,A.lanes|=h,QE(A,RT(0,ne,h));break e;case 1:W=ne;var K=A.type,ue=A.stateNode;if(!(128&A.flags)&&(typeof K.getDerivedStateFromError=="function"||ue!==null&&typeof ue.componentDidCatch=="function"&&(Vo===null||!Vo.has(ue)))){A.flags|=65536,h&=-h,A.lanes|=h,QE(A,PT(A,W,h));break e}}A=A.return}while(A!==null)}db(_)}catch(_e){h=_e,In===_&&_!==null&&(In=_=_.return);continue}break}}function cb(){var c=Yf.current;return Yf.current=Ff,c===null?Ff:c}function j_(){On!==0&&On!==3&&On!==2||(On=4),qn===null||!(268435455&Ya)&&!(268435455&qf)||jo(qn,li)}function tp(c,h){var _=Ut;Ut|=2;var E=cb();for(qn===c&&li===h||(Ho=null,qa(c,h));;)try{Q3();break}catch(b){ub(c,b)}if(n_(),Ut=_,Yf.current=E,In!==null)throw Error(s(261));return qn=null,li=0,On}function Q3(){for(;In!==null;)hb(In)}function J3(){for(;In!==null&&!L3();)hb(In)}function hb(c){var h=sb(c.alternate,c,er);c.memoizedProps=c.pendingProps,h===null?db(c):In=h,O_.current=null}function db(c){var h=c;do{var _=h.alternate;if(c=h.return,(32768&h.flags)==0){if((_=$3(_,h,er))!==null)return void(In=_)}else{if((_=Y3(_,h))!==null)return _.flags&=32767,void(In=_);if(c===null)return On=6,void(In=null);c.flags|=32768,c.subtreeFlags=0,c.deletions=null}if((h=h.sibling)!==null)return void(In=h);In=h=c}while(h!==null);On===0&&(On=5)}function _u(c,h,_){var E=Gt,b=An.transition;try{An.transition=null,Gt=1,function(A,U,W,ne){do Ka();while(Wo!==null);if(6&Ut)throw Error(s(327));W=A.finishedWork;var ce=A.finishedLanes;if(W===null)return null;if(A.finishedWork=null,A.finishedLanes=0,W===A.current)throw Error(s(177));A.callbackNode=null,A.callbackPriority=0;var fe=W.lanes|W.childLanes;if(function(Se,je){var Tt=Se.pendingLanes&~je;Se.pendingLanes=je,Se.suspendedLanes=0,Se.pingedLanes=0,Se.expiredLanes&=je,Se.mutableReadLanes&=je,Se.entangledLanes&=je,je=Se.entanglements;var pe=Se.eventTimes;for(Se=Se.expirationTimes;0<Tt;){var K=31-Qi(Tt),ue=1<<K;je[K]=0,pe[K]=-1,Se[K]=-1,Tt&=~ue}}(A,fe),A===qn&&(In=qn=null,li=0),!(2064&W.subtreeFlags)&&!(2064&W.flags)||Zf||(Zf=!0,mb(HE,function(){return Ka(),null})),fe=(15990&W.flags)!=0,(15990&W.subtreeFlags)!=0||fe){fe=An.transition,An.transition=null;var De=Gt;Gt=1;var de=Ut;Ut|=4,O_.current=null,function(Se,je){for(G(Se.containerInfo),Ge=je;Ge!==null;)if(je=(Se=Ge).child,(1028&Se.subtreeFlags)!=0&&je!==null)je.return=Se,Ge=je;else for(;Ge!==null;){Se=Ge;try{var Tt=Se.alternate;if(1024&Se.flags)switch(Se.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(Tt!==null){var pe=Tt.memoizedProps,K=Tt.memoizedState,ue=Se.stateNode,_e=ue.getSnapshotBeforeUpdate(Se.elementType===Se.type?pe:Hr(Se.type,pe),K);ue.__reactInternalSnapshotBeforeUpdate=_e}break;case 3:Ie&&ke(Se.stateNode.containerInfo);break;default:throw Error(s(163))}}catch(tt){un(Se,Se.return,tt)}if((je=Se.sibling)!==null){je.return=Se.return,Ge=je;break}Ge=Se.return}Tt=YT,YT=!1}(A,W),JT(W,A),k(A.containerInfo),A.current=W,K3(W),D3(),Ut=de,Gt=De,An.transition=fe}else A.current=W;if(Zf&&(Zf=!1,Wo=A,Qf=ce),fe=A.pendingLanes,fe===0&&(Vo=null),function(Se){if(ps&&typeof ps.onCommitFiberRoot=="function")try{ps.onCommitFiberRoot(yf,Se,void 0,(128&Se.current.flags)==128)}catch{}}(W.stateNode),Hi(A,jn()),U!==null)for(ne=A.onRecoverableError,W=0;W<U.length;W++)ce=U[W],ne(ce.value,{componentStack:ce.stack,digest:ce.digest});if(Kf)throw Kf=!1,A=G_,G_=null,A;1&Qf&&A.tag!==0&&Ka(),fe=A.pendingLanes,1&fe?A===H_?wh++:(wh=0,H_=A):wh=0,ms()}(c,h,_,E)}finally{An.transition=b,Gt=E}return null}function Ka(){if(Wo!==null){var c=zE(Qf),h=An.transition,_=Gt;try{if(An.transition=null,Gt=16>c?16:c,Wo===null)var E=!1;else{if(c=Wo,Wo=null,Qf=0,(6&Ut)!=0)throw Error(s(331));var b=Ut;for(Ut|=4,Ge=c.current;Ge!==null;){var A=Ge,U=A.child;if(16&Ge.flags){var W=A.deletions;if(W!==null){for(var ne=0;ne<W.length;ne++){var ce=W[ne];for(Ge=ce;Ge!==null;){var fe=Ge;switch(fe.tag){case 0:case 11:case 15:Sh(8,fe,A)}var De=fe.child;if(De!==null)De.return=fe,Ge=De;else for(;Ge!==null;){var de=(fe=Ge).sibling,Se=fe.return;if(qT(fe),fe===ce){Ge=null;break}if(de!==null){de.return=Se,Ge=de;break}Ge=Se}}}var je=A.alternate;if(je!==null){var Tt=je.child;if(Tt!==null){je.child=null;do{var pe=Tt.sibling;Tt.sibling=null,Tt=pe}while(Tt!==null)}}Ge=A}}if(2064&A.subtreeFlags&&U!==null)U.return=A,Ge=U;else e:for(;Ge!==null;){if(2048&(A=Ge).flags)switch(A.tag){case 0:case 11:case 15:Sh(9,A,A.return)}var K=A.sibling;if(K!==null){K.return=A.return,Ge=K;break e}Ge=A.return}}var ue=c.current;for(Ge=ue;Ge!==null;){var _e=(U=Ge).child;if(2064&U.subtreeFlags&&_e!==null)_e.return=U,Ge=_e;else e:for(U=ue;Ge!==null;){if(2048&(W=Ge).flags)try{switch(W.tag){case 0:case 11:case 15:Hf(9,W)}}catch(Wt){un(W,W.return,Wt)}if(W===U){Ge=null;break e}var tt=W.sibling;if(tt!==null){tt.return=W.return,Ge=tt;break e}Ge=W.return}}if(Ut=b,ms(),ps&&typeof ps.onPostCommitFiberRoot=="function")try{ps.onPostCommitFiberRoot(yf,c)}catch{}E=!0}return E}finally{Gt=_,An.transition=h}}return!1}function fb(c,h,_){c=Go(c,h=RT(0,h=fu(_,h),1),1),h=vi(),c!==null&&(uh(c,1,h),Hi(c,h))}function un(c,h,_){if(c.tag===3)fb(c,c,_);else for(;h!==null;){if(h.tag===3){fb(h,c,_);break}if(h.tag===1){var E=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(Vo===null||!Vo.has(E))){h=Go(h,c=PT(h,c=fu(_,c),1),1),c=vi(),h!==null&&(uh(h,1,c),Hi(h,c));break}}h=h.return}}function eD(c,h,_){var E=c.pingCache;E!==null&&E.delete(h),h=vi(),c.pingedLanes|=c.suspendedLanes&_,qn===c&&(li&_)===_&&(On===4||On===3&&(130023424&li)===li&&500>jn()-B_?qa(c,0):k_|=_),Hi(c,h)}function pb(c,h){h===0&&(1&c.mode?(h=V0,!(130023424&(V0<<=1))&&(V0=4194304)):h=1);var _=vi();(c=_s(c,h))!==null&&(uh(c,h,_),Hi(c,_))}function tD(c){var h=c.memoizedState,_=0;h!==null&&(_=h.retryLane),pb(c,_)}function nD(c,h){var _=0;switch(c.tag){case 13:var E=c.stateNode,b=c.memoizedState;b!==null&&(_=b.retryLane);break;case 19:E=c.stateNode;break;default:throw Error(s(314))}E!==null&&E.delete(h),pb(c,_)}function mb(c,h){return $0(c,h)}function iD(c,h,_,E){this.tag=c,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function br(c,h,_,E){return new iD(c,h,_,E)}function $_(c){return!(!(c=c.prototype)||!c.isReactComponent)}function $o(c,h){var _=c.alternate;return _===null?((_=br(c.tag,h,c.key,c.mode)).elementType=c.elementType,_.type=c.type,_.stateNode=c.stateNode,_.alternate=c,c.alternate=_):(_.pendingProps=h,_.type=c.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=14680064&c.flags,_.childLanes=c.childLanes,_.lanes=c.lanes,_.child=c.child,_.memoizedProps=c.memoizedProps,_.memoizedState=c.memoizedState,_.updateQueue=c.updateQueue,h=c.dependencies,_.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},_.sibling=c.sibling,_.index=c.index,_.ref=c.ref,_}function np(c,h,_,E,b,A){var U=2;if(E=c,typeof c=="function")$_(c)&&(U=1);else if(typeof c=="string")U=5;else e:switch(c){case u:return Za(_.children,b,A,h);case d:U=8,b|=8;break;case f:return(c=br(12,_,h,2|b)).elementType=f,c.lanes=A,c;case x:return(c=br(13,_,h,b)).elementType=x,c.lanes=A,c;case y:return(c=br(19,_,h,b)).elementType=y,c.lanes=A,c;case S:return ip(_,b,A,h);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case p:U=10;break e;case m:U=9;break e;case v:U=11;break e;case g:U=14;break e;case T:U=16,E=null;break e}throw Error(s(130,c==null?c:typeof c,""))}return(h=br(U,_,h,b)).elementType=c,h.type=E,h.lanes=A,h}function Za(c,h,_,E){return(c=br(7,c,E,h)).lanes=_,c}function ip(c,h,_,E){return(c=br(22,c,E,h)).elementType=S,c.lanes=_,c.stateNode={isHidden:!1},c}function Y_(c,h,_){return(c=br(6,c,null,h)).lanes=_,c}function q_(c,h,_){return(h=br(4,c.children!==null?c.children:[],c.key,h)).lanes=_,h.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},h}function rD(c,h,_,E,b){this.tag=h,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ye,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=X0(0),this.expirationTimes=X0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=X0(0),this.identifierPrefix=E,this.onRecoverableError=b,ct&&(this.mutableSourceEagerHydrationData=null)}function gb(c,h,_,E,b,A,U,W,ne){return c=new rD(c,h,_,W,ne),h===1?(h=1,A===!0&&(h|=8)):h=0,A=br(3,null,null,h),c.current=A,A.stateNode=c,A.memoizedState={element:E,isDehydrated:_,cache:null,transitions:null,pendingSuspenseBoundaries:null},o_(A),c}function _b(c){if(!c)return mr;e:{if(D(c=c._reactInternals)!==c||c.tag!==1)throw Error(s(170));var h=c;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(oi(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(s(171))}if(c.tag===1){var _=c.type;if(oi(_))return iu(c,_,h)}return h}function vb(c){var h=c._reactInternals;if(h===void 0)throw typeof c.render=="function"?Error(s(188)):(c=Object.keys(c).join(","),Error(s(268,c)));return(c=Z(h))===null?null:c.stateNode}function yb(c,h){if((c=c.memoizedState)!==null&&c.dehydrated!==null){var _=c.retryLane;c.retryLane=_!==0&&_<h?_:h}}function rp(c,h){yb(c,h),(c=c.alternate)&&yb(c,h)}function sD(c){return(c=Z(c))===null?null:c.stateNode}function oD(){return null}return sb=function(c,h,_){if(c!==null)if(c.memoizedProps!==h.pendingProps||xn.current)zi=!0;else{if(!(c.lanes&_)&&!(128&h.flags))return zi=!1,function(De,de,Se){switch(de.tag){case 3:zT(de),au();break;case 5:aT(de);break;case 1:oi(de.type)&&ai(de);break;case 4:u_(de,de.stateNode.containerInfo);break;case 10:qE(0,de.type._context,de.memoizedProps.value);break;case 13:var je=de.memoizedState;if(je!==null)return je.dehydrated!==null?(We(Sn,1&Sn.current),de.flags|=128,null):Se&de.child.childLanes?HT(De,de,Se):(We(Sn,1&Sn.current),(De=no(De,de,Se))!==null?De.sibling:null);We(Sn,1&Sn.current);break;case 19:if(je=(Se&de.childLanes)!=0,(128&De.flags)!=0){if(je)return WT(De,de,Se);de.flags|=128}var Tt=de.memoizedState;if(Tt!==null&&(Tt.rendering=null,Tt.tail=null,Tt.lastEffect=null),We(Sn,Sn.current),je)break;return null;case 22:case 23:return de.lanes=0,OT(De,de,Se)}return no(De,de,Se)}(c,h,_);zi=(131072&c.flags)!=0}else zi=!1,ln&&1048576&h.flags&&WE(h,Ef,h.index);switch(h.lanes=0,h.tag){case 2:var E=h.type;zf(c,h),c=h.pendingProps;var b=gr(h,wt.current);uu(h,_),b=m_(null,h,E,c,b,_);var A=g_();return h.flags|=1,typeof b=="object"&&b!==null&&typeof b.render=="function"&&b.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,oi(E)?(A=!0,ai(h)):A=!1,h.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,o_(h),b.updater=Rf,h.stateNode=b,b._reactInternals=h,l_(h,E,c,_),h=b_(null,h,E,!0,A,_)):(h.tag=0,ln&&A&&K0(h),Gi(null,h,b,_),h=h.child),h;case 16:E=h.elementType;e:{switch(zf(c,h),c=h.pendingProps,E=(b=E._init)(E._payload),h.type=E,b=h.tag=function(De){if(typeof De=="function")return $_(De)?1:0;if(De!=null){if((De=De.$$typeof)===v)return 11;if(De===g)return 14}return 2}(E),c=Hr(E,c),b){case 0:h=T_(null,h,E,c,_);break e;case 1:h=BT(null,h,E,c,_);break e;case 11:h=NT(null,h,E,c,_);break e;case 14:h=UT(null,h,E,Hr(E.type,c),_);break e}throw Error(s(306,E,""))}return h;case 0:return E=h.type,b=h.pendingProps,T_(c,h,E,b=h.elementType===E?b:Hr(E,b),_);case 1:return E=h.type,b=h.pendingProps,BT(c,h,E,b=h.elementType===E?b:Hr(E,b),_);case 3:e:{if(zT(h),c===null)throw Error(s(387));E=h.pendingProps,b=(A=h.memoizedState).element,ZE(c,h),Cf(h,E,null,_);var U=h.memoizedState;if(E=U.element,ct&&A.isDehydrated){if(A={element:E,isDehydrated:!1,cache:U.cache,pendingSuspenseBoundaries:U.pendingSuspenseBoundaries,transitions:U.transitions},h.updateQueue.baseState=A,h.memoizedState=A,256&h.flags){h=GT(c,h,E,_,b=fu(Error(s(423)),h));break e}if(E!==b){h=GT(c,h,E,_,b=fu(Error(s(424)),h));break e}for(ct&&(yr=gf(h.stateNode.containerInfo),Ji=h,ln=!0,Gr=null,ch=!1),_=oT(h,null,E,_),h.child=_;_;)_.flags=-3&_.flags|4096,_=_.sibling}else{if(au(),E===b){h=no(c,h,_);break e}Gi(c,h,E,_)}h=h.child}return h;case 5:return aT(h),c===null&&J0(h),E=h.type,b=h.pendingProps,A=c!==null?c.memoizedProps:null,U=b.children,ge(E,b)?U=null:A!==null&&ge(E,A)&&(h.flags|=32),kT(c,h),Gi(c,h,U,_),h.child;case 6:return c===null&&J0(h),null;case 13:return HT(c,h,_);case 4:return u_(h,h.stateNode.containerInfo),E=h.pendingProps,c===null?h.child=cu(h,null,E,_):Gi(c,h,E,_),h.child;case 11:return E=h.type,b=h.pendingProps,NT(c,h,E,b=h.elementType===E?b:Hr(E,b),_);case 7:return Gi(c,h,h.pendingProps,_),h.child;case 8:case 12:return Gi(c,h,h.pendingProps.children,_),h.child;case 10:e:{if(E=h.type._context,b=h.pendingProps,A=h.memoizedProps,qE(0,E,U=b.value),A!==null)if(zr(A.value,U)){if(A.children===b.children&&!xn.current){h=no(c,h,_);break e}}else for((A=h.child)!==null&&(A.return=h);A!==null;){var W=A.dependencies;if(W!==null){U=A.child;for(var ne=W.firstContext;ne!==null;){if(ne.context===E){if(A.tag===1){(ne=to(-1,_&-_)).tag=2;var ce=A.updateQueue;if(ce!==null){var fe=(ce=ce.shared).pending;fe===null?ne.next=ne:(ne.next=fe.next,fe.next=ne),ce.pending=ne}}A.lanes|=_,(ne=A.alternate)!==null&&(ne.lanes|=_),r_(A.return,_,h),W.lanes|=_;break}ne=ne.next}}else if(A.tag===10)U=A.type===h.type?null:A.child;else if(A.tag===18){if((U=A.return)===null)throw Error(s(341));U.lanes|=_,(W=U.alternate)!==null&&(W.lanes|=_),r_(U,_,h),U=A.sibling}else U=A.child;if(U!==null)U.return=A;else for(U=A;U!==null;){if(U===h){U=null;break}if((A=U.sibling)!==null){A.return=U.return,U=A;break}U=U.return}A=U}Gi(c,h,b.children,_),h=h.child}return h;case 9:return b=h.type,E=h.pendingProps.children,uu(h,_),E=E(b=xr(b)),h.flags|=1,Gi(c,h,E,_),h.child;case 14:return b=Hr(E=h.type,h.pendingProps),UT(c,h,E,b=Hr(E.type,b),_);case 15:return FT(c,h,h.type,h.pendingProps,_);case 17:return E=h.type,b=h.pendingProps,b=h.elementType===E?b:Hr(E,b),zf(c,h),h.tag=1,oi(E)?(c=!0,ai(h)):c=!1,uu(h,_),nT(h,E,b),l_(h,E,b,_),b_(null,h,E,!0,c,_);case 19:return WT(c,h,_);case 22:return OT(c,h,_)}throw Error(s(156,h.tag))},e.attemptContinuousHydration=function(c){if(c.tag===13){var h=_s(c,134217728);h!==null&&Tr(h,c,134217728,vi()),rp(c,134217728)}},e.attemptDiscreteHydration=function(c){if(c.tag===13){var h=_s(c,1);h!==null&&Tr(h,c,1,vi()),rp(c,1)}},e.attemptHydrationAtCurrentPriority=function(c){if(c.tag===13){var h=Xo(c),_=_s(c,h);_!==null&&Tr(_,c,h,vi()),rp(c,h)}},e.attemptSynchronousHydration=function(c){switch(c.tag){case 3:var h=c.stateNode;if(h.current.memoizedState.isDehydrated){var _=lh(h.pendingLanes);_!==0&&(j0(h,1|_),Hi(h,jn()),!(6&Ut)&&(gu(),ms()))}break;case 13:lb(function(){var E=_s(c,1);if(E!==null){var b=vi();Tr(E,c,1,b)}}),rp(c,1)}},e.batchedUpdates=function(c,h){var _=Ut;Ut|=1;try{return c(h)}finally{(Ut=_)===0&&(gu(),xf&&ms())}},e.createComponentSelector=function(c){return{$$typeof:Vf,value:c}},e.createContainer=function(c,h,_,E,b,A,U){return gb(c,h,!1,null,0,E,0,A,U)},e.createHasPseudoClassSelector=function(c){return{$$typeof:Wf,value:c}},e.createHydrationContainer=function(c,h,_,E,b,A,U,W,ne){return(c=gb(_,E,!0,c,0,A,0,W,ne)).context=_b(null),_=c.current,(A=to(E=vi(),b=Xo(_))).callback=h??null,Go(_,A,b),c.current.lanes=b,uh(c,b,E),Hi(c,E),c},e.createPortal=function(c,h,_){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:E==null?null:""+E,children:c,containerInfo:h,implementation:_}},e.createRoleSelector=function(c){return{$$typeof:Xf,value:c}},e.createTestNameSelector=function(c){return{$$typeof:jf,value:c}},e.createTextSelector=function(c){return{$$typeof:$f,value:c}},e.deferredUpdates=function(c){var h=Gt,_=An.transition;try{return An.transition=null,Gt=16,c()}finally{Gt=h,An.transition=_}},e.discreteUpdates=function(c,h,_,E,b){var A=Gt,U=An.transition;try{return An.transition=null,Gt=1,c(h,_,E,b)}finally{Gt=A,An.transition=U,Ut===0&&gu()}},e.findAllNodes=F_,e.findBoundingRects=function(c,h){if(!Ot)throw Error(s(363));h=F_(c,h),c=[];for(var _=0;_<h.length;_++)c.push(Fn(h[_]));for(h=c.length-1;0<h;h--)for(var E=(_=c[h]).x,b=E+_.width,A=_.y,U=A+_.height,W=h-1;0<=W;W--)if(h!==W){var ne=c[W],ce=ne.x,fe=ce+ne.width,De=ne.y,de=De+ne.height;if(E>=ce&&A>=De&&b<=fe&&U<=de){c.splice(h,1);break}if(!(E!==ce||_.width!==ne.width||de<A||De>U)){De>A&&(ne.height+=De-A,ne.y=A),de<U&&(ne.height=U-De),c.splice(h,1);break}if(!(A!==De||_.height!==ne.height||fe<E||ce>b)){ce>E&&(ne.width+=ce-E,ne.x=E),fe<b&&(ne.width=b-ce),c.splice(h,1);break}}return c},e.findHostInstance=vb,e.findHostInstanceWithNoPortals=function(c){return(c=(c=L(c))!==null?z(c):null)===null?null:c.stateNode},e.findHostInstanceWithWarning=function(c){return vb(c)},e.flushControlled=function(c){var h=Ut;Ut|=1;var _=An.transition,E=Gt;try{An.transition=null,Gt=1,c()}finally{Gt=E,An.transition=_,(Ut=h)===0&&(gu(),ms())}},e.flushPassiveEffects=Ka,e.flushSync=lb,e.focusWithin=function(c,h){if(!Ot)throw Error(s(363));for(h=rb(c=D_(c),h),h=Array.from(h),c=0;c<h.length;){var _=h[c++];if(!I(_)){if(_.tag===5&&we(_.stateNode))return!0;for(_=_.child;_!==null;)h.push(_),_=_.sibling}}return!1},e.getCurrentUpdatePriority=function(){return Gt},e.getFindAllNodesFailureDescription=function(c,h){if(!Ot)throw Error(s(363));var _=0,E=[];c=[D_(c),0];for(var b=0;b<c.length;){var A=c[b++],U=c[b++],W=h[U];if((A.tag!==5||!I(A))&&(N_(A,W)&&(E.push(U_(W)),++U>_&&(_=U)),U<h.length))for(A=A.child;A!==null;)c.push(A,U),A=A.sibling}if(_<h.length){for(c=[];_<h.length;_++)c.push(U_(h[_]));return`findAllNodes was able to match part of the selector:
  `+E.join(" > ")+`

No matching component was found for:
  `+c.join(" > ")}return null},e.getPublicRootInstance=function(c){return(c=c.current).child?c.child.tag===5?Q(c.child.stateNode):c.child.stateNode:null},e.injectIntoDevTools=function(c){if(c={bundleType:c.bundleType,version:c.version,rendererPackageName:c.rendererPackageName,rendererConfig:c.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:sD,findFiberByHostInstance:c.findFiberByHostInstance||oD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")c=!1;else{var h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(h.isDisabled||!h.supportsFiber)c=!0;else{try{yf=h.inject(c),ps=h}catch{}c=!!h.checkDCE}}return c},e.isAlreadyRendering=function(){return!1},e.observeVisibleRects=function(c,h,_,E){if(!Ot)throw Error(s(363));c=F_(c,h);var b=ye(c,_,E).disconnect;return{disconnect:function(){b()}}},e.registerMutableSourceForHydration=function(c,h){var _=h._getVersion;_=_(h._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[h,_]:c.mutableSourceEagerHydrationData.push(h,_)},e.runWithPriority=function(c,h){var _=Gt;try{return Gt=c,h()}finally{Gt=_}},e.shouldError=function(){return null},e.shouldSuspend=function(){return!1},e.updateContainer=function(c,h,_,E){var b=h.current,A=vi(),U=Xo(b);return _=_b(_),h.context===null?h.context=_:h.pendingContext=_,(h=to(A,U)).payload={element:c},(E=E===void 0?null:E)!==null&&(h.callback=E),(c=Go(b,h,U))!==null&&(Tr(c,b,U,A),Mf(c,b,U)),U},e}),eR}({get exports(){return q1},set exports(n){q1=n}}).exports=nW();var iW=RV(q1),f3={name:"root",private:!0,workspaces:["packages/*"],scripts:{build:"nx run-many --target=build --all --parallel","build:force":"nx run-many --target=build --all --parallel --skip-nx-cache","build:docs":"nx run @pixi/react-docs:deploy",clean:"rimraf packages/*/dist packages/*/build",lint:"eslint .",prepare:"husky install",prerelease:"./scripts/checkReleaseBranch.mjs && npm run lint && npm run test:force && npm run build:force",release:"lerna publish --no-private",test:"nx run-many --target=test --all --parallel","test:force":"nx run-many --target=test --all --parallel --skip-nx-cache","test:ci":"nx run-many --target=test:ci --all --parallel","test:ci:force":"nx run-many --target=test:ci --all --parallel --skip-nx-cache","test:types":"nx run-many --target=test:types --all --parallel","test:types:force":"nx run-many --target=test:types --all --parallel --skip-nx-cache"},husky:{hooks:{"pre-commit":"lint-staged"}},"lint-staged":{"*.{ts,js,mjs}":["eslint --cache --fix"]},resolutions:{"get-pkg-repo":"4.1.1","hosted-git-info":"^2.1.4"},dependencies:{"@babel/runtime":"^7.14.8","@pixi/app":"^7.1.1","@pixi/constants":"^7.1.1","@pixi/core":"^7.1.1","@pixi/display":"^7.1.1","@pixi/extensions":"^7.1.1","@pixi/graphics":"^7.1.1","@pixi/math":"^7.1.1","@pixi/mesh":"^7.1.1","@pixi/mesh-extras":"^7.1.1","@pixi/particle-container":"^7.1.1","@pixi/sprite":"^7.1.1","@pixi/sprite-animated":"^7.1.1","@pixi/sprite-tiling":"^7.1.1","@pixi/text":"^7.1.1","@pixi/text-bitmap":"^7.1.1","@pixi/ticker":"^7.1.1","@react-spring/animated":"^9.6.1","@react-spring/types":"^9.6.1",react:"^18.0.0","react-dom":"^18.0.0","react-reconciler":"0.29.0","react-spring":"^9.6.1"},devDependencies:{"@babel/cli":"^7.20.7","@babel/core":"^7.20.7","@babel/eslint-parser":"^7.19.1","@babel/plugin-transform-runtime":"^7.19.6","@babel/preset-env":"^7.20.2","@babel/preset-react":"^7.18.6","@nrwl/nx-cloud":"latest","@pixi/eslint-config":"^4.0.1","@rollup/plugin-alias":"^4.0.2","@rollup/plugin-babel":"^6.0.3","@rollup/plugin-commonjs":"^24.0.0","@rollup/plugin-json":"^6.0.0","@rollup/plugin-node-resolve":"^15.0.1","@rollup/plugin-replace":"^5.0.2","@rollup/plugin-terser":"^0.2.1","@rollup/plugin-typescript":"^10.0.1","@types/jest":"^29.2.4","@types/react":"17.0.15","@types/react-dom":"17.0.9","@types/react-reconciler":"0.28.2","babel-jest":"^29.3.1","babel-plugin-module-resolver":"4.1.0","cross-env":"^7.0.3",eslint:"^8.29.0","eslint-plugin-react":"^7.31.11",husky:"^8.0.2",jest:"^29.3.1","jest-environment-jsdom":"^29.3.1","jest-extended":"^3.2.0","jest-watch-typeahead":"^2.2.1",lerna:"^6.0.3","lint-staged":"^13.1.0",nx:"15.3.0",rimraf:"^3.0.2",rollup:"^3.7.0","rollup-plugin-filesize":"^9.1.2","rollup-plugin-visualizer":"^5.9.0","ts-jest":"^29.0.3","ts-node":"^10.9.1",typescript:"^4.9.4"}},Z1={},gm={get exports(){return Z1},set exports(n){Z1=n}};(function(){var n,e,t,i,r,s;typeof performance<"u"&&performance!==null&&performance.now?gm.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(gm.exports=function(){return(n()-r)/1e6},e=process.hrtime,i=(n=function(){var o;return 1e9*(o=e())[0]+o[1]})(),s=1e9*process.uptime(),r=i-s):Date.now?(gm.exports=function(){return Date.now()-t},t=Date.now()):(gm.exports=function(){return new Date().getTime()-t},t=new Date().getTime())}).call(CV);var iR,hc={},sl={};({get exports(){return hc},set exports(n){hc=n}}).exports=(iR||(iR=1,sl.ConcurrentRoot=1,sl.ContinuousEventPriority=4,sl.DefaultEventPriority=16,sl.DiscreteEventPriority=1,sl.IdleEventPriority=536870912,sl.LegacyRoot=0),sl);var rW={};function Vy(n,e){n.addChild&&(n.addChild(e),typeof e.didMount=="function"&&e.didMount(e,n))}function p3(n,e){var t,i,r;(t=n.willUnmount)===null||t===void 0||t.call(n,n,e),((i=n.config)===null||i===void 0?void 0:i.destroyChildren)!==!1&&(r=n.children)!==null&&r!==void 0&&r.length&&Fo(n.children).forEach(function(s){p3(s,n)})}function rR(n,e){var t;p3(e,n),n.removeChild(e);var i=(t=e.config)!==null&&t!==void 0?t:{},r=i.destroy,s=r===void 0||r,o=i.destroyChildren,a=o===void 0||o,l=i.destroyTexture,u=l!==void 0&&l,d=i.destroyBaseTexture,f=d!==void 0&&d;s&&e.destroy({children:a,texture:u,baseTexture:f})}function sR(n,e,t){bn(e!==t,"pixi-react: PixiFiber cannot insert node before itself"),n.children.indexOf(e)!==-1&&n.removeChild(e);var i=n.getChildIndex(t);n.addChildAt(e,i)}var oR=null,rs=iW({getRootHostContext:function(){return rW},getChildHostContext:function(n){return n},getChildHostContextForEventComponent:function(n){return n},getPublicInstance:function(n){return n},getCurrentEventPriority:function(){return function(){var n,e;if(typeof window>"u")return hc.DefaultEventPriority;switch((n=window)===null||n===void 0||(e=n.event)===null||e===void 0?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return hc.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return hc.ContinuousEventPriority;default:return hc.DefaultEventPriority}}()},prepareForCommit:function(){return null},resetAfterCommit:function(){},createInstance:function(n){var e,t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=QV[n];if(typeof s=="function"&&(e=s(r,i)),!e){var o=d3[n];o&&((e=o.create(i,{root:r})).didMount=o.didMount?o.didMount.bind(e):void 0,e.willUnmount=o.willUnmount?o.willUnmount.bind(e):void 0,e.applyProps=o.applyProps?o.applyProps.bind(e):void 0,e.config=o.config)}return e&&(e.__reactpixi={root:r},(typeof((t=e)===null||t===void 0?void 0:t.applyProps)=="function"?e.applyProps:js)(e,{},i)),e},hideInstance:function(n){n.visible=!1},unhideInstance:function(n,e){var t=e==null||!e.hasOwnProperty("visible")||e.visible;n.visible=t},finalizeInitialChildren:function(n,e,t){return!1},prepareUpdate:function(n,e,t,i,r,s){return oR=function(o,a,l,u){var d=null;for(var f in l)!u.hasOwnProperty(f)&&l.hasOwnProperty(f)&&l[f]!==null&&(f===$1||(d||(d=[]),d.push(f,null)));for(var p in u){var m=u[p],v=l!==null?l[p]:void 0;!u.hasOwnProperty(p)||m===v||m===null&&v===null||p===$1||(d||(d=[]),d.push(p,m))}return d}(0,0,t,i)},shouldSetTextContent:function(n,e){return!1},shouldDeprioritizeSubtree:function(n,e){var t=e.alpha===void 0||e.alpha>0,i=e.renderable===void 0||e.renderable===!0,r=e.visible===void 0||e.visible===!0;return!(t&&i&&r)},createTextInstance:function(n,e,t){bn(!1,'pixi-react: Error trying to add text node "'.concat(n,'"'),"PixiFiber does not support text nodes as children of a Pixi component. To pass a string value to your component, use a property other than children. If you wish to display some text, you can use &lt;Text text={string} /&gt; instead.")},unhideTextInstance:function(n,e){},mountEventComponent:function(){},updateEventComponent:function(){},handleEventTarget:function(){},scheduleTimeout:setTimeout,cancelTimeout:clearTimeout,noTimeout:-1,warnsIfNotActing:!1,now:Z1,isPrimaryRenderer:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,supportsMicrotasks:!0,scheduleMicrotask:queueMicrotask,appendInitialChild:function(){for(var n,e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var s=Vy.apply(null,i);return(n=i[0].__reactpixi)===null||n===void 0||(e=n.root)===null||e===void 0||e.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"appendInitialChild"}),s},appendChild:function(){for(var n,e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var s=Vy.apply(null,i);return(n=i[0].__reactpixi)===null||n===void 0||(e=n.root)===null||e===void 0||e.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"appendChild"}),s},appendChildToContainer:function(){for(var n,e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var s=Vy.apply(null,i);return(n=i[0].__reactpixi)===null||n===void 0||(e=n.root)===null||e===void 0||e.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"appendChildToContainer"}),s},removeChild:function(){for(var n,e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var s=rR.apply(null,i);return(n=i[0].__reactpixi)===null||n===void 0||(e=n.root)===null||e===void 0||e.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"removeChild"}),s},removeChildFromContainer:function(){for(var n,e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var s=rR.apply(null,i);return(n=i[0].__reactpixi)===null||n===void 0||(e=n.root)===null||e===void 0||e.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"removeChildFromContainer"}),s},insertBefore:sR,insertInContainerBefore:function(){for(var n,e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var s=sR.apply(null,i);return(n=i[0].__reactpixi)===null||n===void 0||(e=n.root)===null||e===void 0||e.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"insertInContainerBefore"}),s},commitUpdate:function(n,e,t,i,r){var s,o,a=n&&n.applyProps;typeof a!="function"&&(a=js),(a(n,i,r)||oR)&&((s=n.__reactpixi)===null||s===void 0||(o=s.root)===null||o===void 0||o.emit("__REACT_PIXI_REQUEST_RENDER__",{detail:"commitUpdate"}))},commitMount:function(n,e,t,i,r){},commitTextUpdate:function(n,e,t){},resetTextContent:function(n){},clearContainer:function(n){},getFundamentalComponentInstance:function(n){throw new Error("Not yet implemented.")},mountFundamentalComponent:function(n){throw new Error("Not yet implemented.")},shouldUpdateFundamentalComponent:function(n){throw new Error("Not yet implemented.")},unmountFundamentalComponent:function(n){throw new Error("Not yet implemented.")},getInstanceFromNode:function(n){throw new Error("Not yet implemented.")},isOpaqueHydratingObject:function(n){throw new Error("Not yet implemented")},makeOpaqueHydratingObject:function(n){throw new Error("Not yet implemented.")},makeClientIdInDEV:function(n){throw new Error("Not yet implemented")},beforeActiveInstanceBlur:function(n){},afterActiveInstanceBlur:function(){},detachDeletedInstance:function(){},preparePortalMount:function(n){}}),sW=f3.dependencies["react-dom"].replace(/[^0-9.]/g,""),oW=f3.name;rs.injectIntoDevTools({bundleType:0,version:sW,rendererPackageName:oW,findHostInstanceByFiber:rs.findHostInstance});var Pa=new Map;function m3(n){if(bn(Oi.prototype.isPrototypeOf(n),"Invalid argument `container`, expected instance of `PIXI.Container`."),Pa.has(n)){var e=Pa.get(n).pixiFiberContainer;rs.updateContainer(null,e,void 0,function(){Pa.delete(n)})}}function g3(n){bn(Oi.prototype.isPrototypeOf(n),"Invalid argument `container`, expected instance of `PIXI.Container`.");var e=Pa.get(n);if(bn(!e,"Pixi React: createRoot should only be called once"),!e){var t=rs.createContainer(n);e={pixiFiberContainer:t,reactRoot:{render:function(i){return rs.updateContainer(i,t,void 0),rs.getPublicRootInstance(t)},unmount:function(){m3(n),Pa.delete(n)}}},Pa.set(n,e)}return e.reactRoot}function aW(n,e,t){var i;return console.warn("Pixi React Deprecation Warning: render is deprecated, use createRoot instead"),t!==void 0&&console.warn("Pixi React Deprecation Warning: render callback no longer exists in React 18"),Pa.has(e)?i=Pa.get(e).reactRoot:i=g3(e),i.render(n)}function lW(n){m3(n)}function tf(){return tf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},tf.apply(this,arguments)}function uW(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function cW(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,u3(i.key),i)}}function fo(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Zg(n,e){return Zg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},Zg(n,e)}function hW(n,e){if(e&&(ur(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fo(n)}function Qg(n){return Qg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qg(n)}var O0=ks.createContext(null),_3=O0.Provider,v3=O0.Consumer,dW=function(n){var e=ks.forwardRef(function(t,i){return ks.createElement(v3,null,function(r){return ks.createElement(n,tf({},t,{ref:i,app:r}))})});return e.displayName="withPIXIApp(".concat(n.displayName||n.name,")"),e};function fW(n){var e=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var t,i=Qg(n);if(e){var r=Qg(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return hW(this,t)}}function aR(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function _m(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?aR(Object(t),!0).forEach(function(i){Mn(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):aR(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}var lR=function(){},y3={width:rn.number,height:rn.number,onMount:rn.func,onUnmount:rn.func,raf:rn.bool,renderOnComponentChange:rn.bool,children:rn.node,options:rn.shape({autoStart:rn.bool,width:rn.number,height:rn.number,useContextAlpha:rn.bool,backgroundAlpha:rn.number,autoDensity:rn.bool,antialias:rn.bool,preserveDrawingBuffer:rn.bool,resolution:rn.number,forceCanvas:rn.bool,backgroundColor:rn.number,clearBeforeRender:rn.bool,powerPreference:rn.string,sharedTicker:rn.bool,sharedLoader:rn.bool,resizeTo:function(n,e){var t=n[e];t&&bn(t===window||t instanceof HTMLElement,"Invalid prop `resizeTo` of type ".concat(ur(t),", expect `window` or an `HTMLElement`."))},view:function(n,e,t){var i=n[e];i&&bn(i instanceof HTMLCanvasElement,"Invalid prop `view` of type ".concat(ur(i),", supplied to ").concat(t,", expected `<canvas> Element`"))}})},pW={width:800,height:600,onMount:lR,onUnmount:lR,raf:!0,renderOnComponentChange:!0},Q1=function(n){(function(s,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(o&&o.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),o&&Zg(s,o)})(r,ks.Component);var e,t,i=fW(r);function r(){var s;uW(this,r);for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return Mn(fo(s=i.call.apply(i,[this].concat(a))),"_canvas",null),Mn(fo(s),"_mediaQuery",null),Mn(fo(s),"_ticker",null),Mn(fo(s),"_needsUpdate",!0),Mn(fo(s),"app",null),Mn(fo(s),"updateSize",function(){var u=s.props,d=u.width,f=u.height,p=u.options;p!=null&&p.resolution||(s.app.renderer.resolution=window.devicePixelRatio,s.resetInteractionManager()),s.app.renderer.resize(d,f)}),Mn(fo(s),"needsRenderUpdate",function(){s._needsUpdate=!0}),Mn(fo(s),"renderStage",function(){var u=s.props,d=u.renderOnComponentChange;!u.raf&&d&&s._needsUpdate&&(s._needsUpdate=!1,s.app.renderer.render(s.app.stage))}),s}return e=r,(t=[{key:"componentDidMount",value:function(){var s=this.props,o=s.onMount,a=s.width,l=s.height,u=s.options,d=s.raf,f=s.renderOnComponentChange;this.app=new F0(_m(_m({width:a,height:l,view:this._canvas},u),{},{autoDensity:(u==null?void 0:u.autoDensity)!==!1})),this.app.ticker.autoStart=!1,this.app.ticker[d?"start":"stop"](),this.app.stage.__reactpixi={root:this.app.stage},this.mountNode=rs.createContainer(this.app.stage),rs.updateContainer(this.getChildren(),this.mountNode,this),o(this.app),u!=null&&u.autoDensity&&window.matchMedia&&(u==null?void 0:u.resolution)===void 0&&(this._mediaQuery=window.matchMedia("(-webkit-min-device-pixel-ratio: 1.3), (min-resolution: 120dpi)"),this._mediaQuery.addListener(this.updateSize)),f&&!d&&(this._ticker=new ni,this._ticker.autoStart=!0,this._ticker.add(this.renderStage),this.app.stage.on("__REACT_PIXI_REQUEST_RENDER__",this.needsRenderUpdate)),this.updateSize(),this.renderStage()}},{key:"componentDidUpdate",value:function(s,o,a){var l,u=this.props,d=u.width,f=u.height,p=u.raf,m=u.renderOnComponentChange,v=u.options;(v==null?void 0:v.resolution)!==void 0&&(s==null?void 0:s.options.resolution)!==(v==null?void 0:v.resolution)&&(this.app.renderer.resolution=v.resolution,this.resetInteractionManager()),s.height===f&&s.width===d&&((l=s.options)===null||l===void 0?void 0:l.resolution)===(v==null?void 0:v.resolution)||this.updateSize(),s.raf!==p&&this.app.ticker[p?"start":"stop"](),rs.updateContainer(this.getChildren(),this.mountNode,this),s.width===d&&s.height===f&&s.raf===p&&s.renderOnComponentChange===m&&s.options===v||(this._needsUpdate=!0,this.renderStage())}},{key:"resetInteractionManager",value:function(){var s=this.app.renderer.plugins.interaction;s!=null&&s.resolution&&(s.resolution=this.app.renderer.resolution)}},{key:"getChildren",value:function(){var s=this.props.children;return ks.createElement(_3,{value:this.app},s)}},{key:"componentDidCatch",value:function(s,o){console.error("Error occurred in `Stage`."),console.error(s),console.error(o)}},{key:"componentWillUnmount",value:function(){this.props.onUnmount(this.app),this._ticker&&(this._ticker.remove(this.renderStage),this._ticker.destroy()),this.app.stage.off("__REACT_PIXI_REQUEST_RENDER__",this.needsRenderUpdate),rs.updateContainer(null,this.mountNode,this),this._mediaQuery&&(this._mediaQuery.removeListener(this.updateSize),this._mediaQuery=null),this.app.destroy()}},{key:"render",value:function(){var s,o,a=this,l=this.props.options;return l&&l.view?(bn(l.view instanceof HTMLCanvasElement,"options.view needs to be a `HTMLCanvasElement`"),null):ks.createElement("canvas",tf({},(s=this.props,o=[].concat(Fo(Object.keys(y3)),Fo(Object.keys(Y1))),Object.keys(s).filter(function(u){return!o.includes(u)}).reduce(function(u,d){return _m(_m({},u),{},Mn({},d,s[d]))},{})),{ref:function(u){return a._canvas=u}}))}}])&&cW(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),r}();Q1.propTypes=y3,Q1.defaultProps=pW;var mW=Q1;function x3(){var n=me.useContext(O0);return bn(n instanceof F0,"No Context found with `%s`. Make sure to wrap component with `%s`","PIXI.Application","AppProvider"),n}function gW(n){var e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],t=x3();bn(typeof n=="function","`useTick` needs a callback function."),bn(t instanceof F0,"No Context found with `%s`. Make sure to wrap component with `%s`","PIXI.Application","AppProvider");var i=me.useRef(null);me.useEffect(function(){i.current=n},[n]),me.useEffect(function(){if(e){var r=function(s){return i.current.apply(t.ticker,[s,t.ticker])};return t.ticker.add(r),function(){t.ticker&&t.ticker.remove(r)}}},[e])}function _W(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function J1(n,e,t){return J1=_W()?Reflect.construct.bind():function(i,r,s){var o=[null];o.push.apply(o,r);var a=new(Function.bind.apply(i,o));return s&&Zg(a,s.prototype),a},J1.apply(null,arguments)}var vW=["children","apply"];function uR(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function vm(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?uR(Object(t),!0).forEach(function(i){Mn(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):uR(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}var yW=function(n,e){bn(ur(e)==="object","Second argument needs to be an indexed object with { prop: Filter }");var t=Object.keys(e),i=function(r){var s=r.children,o=r.apply,a=Va(r,vW),l=me.useRef(me.useMemo(function(){return t.map(function(f){var p,m=(a==null||(p=a[f])===null||p===void 0?void 0:p.construct)||[];return J1(e[f],Fo(m))})},[t])),u=me.useMemo(function(){return t.reduce(function(f,p,m){return vm(vm({},f),{},Mn({},p,l.current[m]))},{})},[t]),d=me.useMemo(function(){return Object.keys(a).filter(h3(c3(t))).reduce(function(f,p){return vm(vm({},f),{},Mn({},p,a[p]))},{})},[a,t]);return t.forEach(function(f,p){return Object.assign(l.current[p],a[f])}),o&&function(){for(var f=arguments.length,p=new Array(f),m=0;m<f;m++)p[m]=arguments[m];return p.every(function(v){return typeof v=="function"})}(o)&&o.call(n,u),ks.createElement(n,tf({},d,{filters:l.current}),s)};return i.displayName="FilterWrapper",i.propTypes={children:rn.node,apply:rn.func},i},xW=Zi.BitmapText,SW=Zi.Container,EW=Zi.Graphics,TW=Zi.NineSlicePlane,bW=Zi.ParticleContainer,wW=Zi.Sprite,AW=Zi.AnimatedSprite,MW=Zi.Text,CW=Zi.TilingSprite,RW=Zi.SimpleMesh,PW=Zi.SimpleRope;const IW=Object.freeze(Object.defineProperty({__proto__:null,AnimatedSprite:AW,AppConsumer:v3,AppContext:O0,AppProvider:_3,BitmapText:xW,Container:SW,Graphics:EW,NineSlicePlane:TW,ParticleContainer:bW,PixiComponent:JV,PixiFiber:rs,SimpleMesh:RW,SimpleRope:PW,Sprite:wW,Stage:mW,TYPES:Zi,Text:MW,TilingSprite:CW,applyDefaultProps:js,createRoot:g3,eventHandlers:Kg,render:aW,unmountComponentAtNode:lW,useApp:x3,useTick:gW,withFilters:yW,withPixiApp:dW},Symbol.toStringTag,{value:"Module"})),LW=AR(IW);T0.exports=LW;var kt=T0.exports;const eu="/assets/sprite-30c52f66.png",DW=()=>window.innerWidth||document.documentElement.clientWidth,OE=DW()-200,NW=400,xl=1/2*OE,sd=95,ym=92,cR=1,hR=1,dR=1,UW=({gameSpeed:n})=>{const[e,t]=me.useState(-1);return kt.useTick(()=>{t(e-n*2)},n>0),ie(kt.Container,{position:[0,300],children:ie(kt.TilingSprite,{width:OE,height:25,image:eu,tilePosition:{x:e,y:158}})})},S3=new an;hn.prototype._cacheAsBitmap=!1;hn.prototype._cacheData=null;hn.prototype._cacheAsBitmapResolution=null;hn.prototype._cacheAsBitmapMultisample=null;class FW{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(hn.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(n){n!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=n,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(n){n!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=n,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(n){if(this._cacheAsBitmap===n)return;this._cacheAsBitmap=n;let e;n?(this._cacheData||(this._cacheData=new FW),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}});hn.prototype._renderCached=function(n){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(n),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(n))};hn.prototype._initCachedDisplayObject=function(n){var p,m;if((p=this._cacheData)!=null&&p.sprite)return;const e=this.alpha;this.alpha=1,n.batch.flush();const t=this.getLocalBounds(new ut,!0);if((m=this.filters)!=null&&m.length){const v=this.filters[0].padding;t.pad(v)}const i=this.cacheAsBitmapResolution||n.resolution;t.ceil(i),t.width=Math.max(t.width,1/i),t.height=Math.max(t.height,1/i);const r=n.renderTexture.current,s=n.renderTexture.sourceFrame.clone(),o=n.renderTexture.destinationFrame.clone(),a=n.projection.transform,l=Jl.create({width:t.width,height:t.height,resolution:i,multisample:this.cacheAsBitmapMultisample??n.multisample}),u=`cacheAsBitmap_${Yl()}`;this._cacheData.textureCacheId=u,lt.addToCache(l.baseTexture,u),Pe.addToCache(l,u);const d=this.transform.localTransform.copyTo(S3).invert().translate(-t.x,-t.y);this.render=this._cacheData.originalRender,n.render(this,{renderTexture:l,clear:!0,transform:d,skipUpdateTransform:!1}),n.framebuffer.blit(),n.projection.transform=a,n.renderTexture.bind(r,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const f=new Zs(l);f.transform.worldTransform=this.transform.worldTransform,f.anchor.x=-(t.x/t.width),f.anchor.y=-(t.y/t.height),f.alpha=e,f._bounds=this._bounds,this._cacheData.sprite=f,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=f.containsPoint.bind(f)};hn.prototype._renderCachedCanvas=function(n){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(n),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(n))};hn.prototype._initCachedDisplayObjectCanvas=function(n){var d;if((d=this._cacheData)!=null&&d.sprite)return;const e=this.getLocalBounds(new ut,!0),t=this.alpha;this.alpha=1;const i=n.canvasContext.activeContext,r=n._projTransform,s=this.cacheAsBitmapResolution||n.resolution;e.ceil(s),e.width=Math.max(e.width,1/s),e.height=Math.max(e.height,1/s);const o=Jl.create({width:e.width,height:e.height,resolution:s}),a=`cacheAsBitmap_${Yl()}`;this._cacheData.textureCacheId=a,lt.addToCache(o.baseTexture,a),Pe.addToCache(o,a);const l=S3;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=e.x,l.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,n.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),n.canvasContext.activeContext=i,n._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const u=new Zs(o);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(e.x/e.width),u.anchor.y=-(e.y/e.height),u.alpha=t,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=n._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)};hn.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};hn.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};hn.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,lt.removeFromCache(this._cacheData.textureCacheId),Pe.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};hn.prototype._cacheAsBitmapDestroy=function(n){this.cacheAsBitmap=!1,this.destroy(n)};hn.prototype.name=null;Oi.prototype.getChildByName=function(n,e){for(let t=0,i=this.children.length;t<i;t++)if(this.children[t].name===n)return this.children[t];if(e)for(let t=0,i=this.children.length;t<i;t++){const r=this.children[t];if(!r.getChildByName)continue;const s=r.getChildByName(n,!0);if(s)return s}return null};hn.prototype.getGlobalPosition=function(n=new Dt,e=!1){return this.parent?this.parent.toGlobal(this.position,n,e):(n.x=this.position.x,n.y=this.position.y),n};var OW=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class kW extends Ni{constructor(e=1){super(j7,OW,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}const BW={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},zW=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function GW(n){const e=BW[n],t=e.length;let i=zW,r="";const s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<n;a++){let l=s.replace("%index%",a.toString());o=a,a>=t&&(o=n-a-1),l=l.replace("%value%",e[o].toString()),r+=l,r+=`
`}return i=i.replace("%blur%",r),i=i.replace("%size%",n.toString()),i}const HW=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function VW(n,e){const t=Math.ceil(n/2);let i=HW,r="",s;e?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<n;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(t-1)}.0`),r+=a,r+=`
`}return i=i.replace("%blur%",r),i=i.replace("%size%",n.toString()),i}class eS extends Ni{constructor(e,t=8,i=4,r=Ni.defaultResolution,s=5){const o=VW(s,e),a=GW(s);super(o,a),this.horizontal=e,this.resolution=r,this._quality=0,this.quality=i,this.blur=t}apply(e,t,i,r){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/t.width):this.uniforms.strength=1/i.height*(i.height/t.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/t.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/t.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,t,i,r);else{const s=e.getFilterTexture(),o=e.renderer;let a=t,l=s;this.state.blend=!1,e.applyFilter(this,a,l,Ls.CLEAR);for(let u=1;u<this.passes-1;u++){e.bindAndClear(a,Ls.BLIT),this.uniforms.uSampler=l;const d=l;l=a,a=d,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,l,i,r),e.returnFilterTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class WW extends Ni{constructor(e=8,t=4,i=Ni.defaultResolution,r=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new eS(!0,e,t,i,r),this.blurYFilter=new eS(!1,e,t,i,r),this.resolution=i,this.quality=t,this.blur=e,this.repeatEdgePixels=!1}apply(e,t,i,r){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const a=e.getFilterTexture();this.blurXFilter.apply(e,t,a,Ls.CLEAR),this.blurYFilter.apply(e,a,i,r),e.returnFilterTexture(a)}else o?this.blurYFilter.apply(e,t,i,r):this.blurXFilter.apply(e,t,i,r)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var XW=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class tS extends Ni{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(FL,XW,e),this.alpha=1}_loadMatrix(e,t=!1){let i=e;t&&(this._multiply(i,this.uniforms.m,e),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(e,t,i){return e[0]=t[0]*i[0]+t[1]*i[5]+t[2]*i[10]+t[3]*i[15],e[1]=t[0]*i[1]+t[1]*i[6]+t[2]*i[11]+t[3]*i[16],e[2]=t[0]*i[2]+t[1]*i[7]+t[2]*i[12]+t[3]*i[17],e[3]=t[0]*i[3]+t[1]*i[8]+t[2]*i[13]+t[3]*i[18],e[4]=t[0]*i[4]+t[1]*i[9]+t[2]*i[14]+t[3]*i[19]+t[4],e[5]=t[5]*i[0]+t[6]*i[5]+t[7]*i[10]+t[8]*i[15],e[6]=t[5]*i[1]+t[6]*i[6]+t[7]*i[11]+t[8]*i[16],e[7]=t[5]*i[2]+t[6]*i[7]+t[7]*i[12]+t[8]*i[17],e[8]=t[5]*i[3]+t[6]*i[8]+t[7]*i[13]+t[8]*i[18],e[9]=t[5]*i[4]+t[6]*i[9]+t[7]*i[14]+t[8]*i[19]+t[9],e[10]=t[10]*i[0]+t[11]*i[5]+t[12]*i[10]+t[13]*i[15],e[11]=t[10]*i[1]+t[11]*i[6]+t[12]*i[11]+t[13]*i[16],e[12]=t[10]*i[2]+t[11]*i[7]+t[12]*i[12]+t[13]*i[17],e[13]=t[10]*i[3]+t[11]*i[8]+t[12]*i[13]+t[13]*i[18],e[14]=t[10]*i[4]+t[11]*i[9]+t[12]*i[14]+t[13]*i[19]+t[14],e[15]=t[15]*i[0]+t[16]*i[5]+t[17]*i[10]+t[18]*i[15],e[16]=t[15]*i[1]+t[16]*i[6]+t[17]*i[11]+t[18]*i[16],e[17]=t[15]*i[2]+t[16]*i[7]+t[17]*i[12]+t[18]*i[17],e[18]=t[15]*i[3]+t[16]*i[8]+t[17]*i[13]+t[18]*i[18],e[19]=t[15]*i[4]+t[16]*i[9]+t[17]*i[14]+t[18]*i[19]+t[19],e}_colorMatrix(e){const t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t}brightness(e,t){const i=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(i,t)}tint(e,t){const[i,r,s]=en.shared.setValue(e).toArray(),o=[i,0,0,0,0,0,r,0,0,0,0,0,s,0,0,0,0,0,1,0];this._loadMatrix(o,t)}greyscale(e,t){const i=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(i,t)}blackAndWhite(e){const t=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(t,e)}hue(e,t){e=(e||0)/180*Math.PI;const i=Math.cos(e),r=Math.sin(e),s=Math.sqrt,o=1/3,a=s(o),l=i+(1-i)*o,u=o*(1-i)-a*r,d=o*(1-i)+a*r,f=o*(1-i)+a*r,p=i+o*(1-i),m=o*(1-i)-a*r,v=o*(1-i)-a*r,x=o*(1-i)+a*r,y=i+o*(1-i),g=[l,u,d,0,0,f,p,m,0,0,v,x,y,0,0,0,0,0,1,0];this._loadMatrix(g,t)}contrast(e,t){const i=(e||0)+1,r=-.5*(i-1),s=[i,0,0,0,r,0,i,0,0,r,0,0,i,0,r,0,0,0,1,0];this._loadMatrix(s,t)}saturate(e=0,t){const i=e*2/3+1,r=(i-1)*-.5,s=[i,r,r,0,0,r,i,r,0,0,r,r,i,0,0,0,0,0,1,0];this._loadMatrix(s,t)}desaturate(){this.saturate(-1)}negative(e){const t=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(t,e)}sepia(e){const t=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(t,e)}technicolor(e){const t=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(t,e)}polaroid(e){const t=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(t,e)}toBGR(e){const t=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(t,e)}kodachrome(e){const t=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(t,e)}browni(e){const t=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(t,e)}vintage(e){const t=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(t,e)}colorTone(e,t,i,r,s){e=e||.2,t=t||.15,i=i||16770432,r=r||3375104;const o=en.shared,[a,l,u]=o.setValue(i).toArray(),[d,f,p]=o.setValue(r).toArray(),m=[.3,.59,.11,0,0,a,l,u,e,0,d,f,p,t,0,a-d,l-f,u-p,0,0];this._loadMatrix(m,s)}night(e,t){e=e||.1;const i=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(i,t)}predator(e,t){const i=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(i,t)}lsd(e){const t=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(t,e)}reset(){const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}tS.prototype.grayscale=tS.prototype.greyscale;var jW=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,$W=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class YW extends Ni{constructor(e,t){const i=new an;e.renderable=!1,super($W,jW,{mapSampler:e._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=i,t==null&&(t=20),this.scale=new Dt(t,t)}apply(e,t,i,r){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const s=this.maskSprite.worldTransform,o=Math.sqrt(s.a*s.a+s.b*s.b),a=Math.sqrt(s.c*s.c+s.d*s.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=s.a/o,this.uniforms.rotation[1]=s.b/o,this.uniforms.rotation[2]=s.c/a,this.uniforms.rotation[3]=s.d/a),e.applyFilter(this,t,i,r)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var qW=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,KW=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class ZW extends Ni{constructor(){super(KW,qW)}}var QW=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class JW extends Ni{constructor(e=.5,t=Math.random()){super(FL,QW,{uNoise:0,uSeed:0}),this.noise=e,this.seed=t}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}const fR={AlphaFilter:kW,BlurFilter:WW,BlurFilterPass:eS,ColorMatrixFilter:tS,DisplacementFilter:YW,FXAAFilter:ZW,NoiseFilter:JW};Object.entries(fR).forEach(([n,e])=>{Object.defineProperty(fR,n,{get(){return Pt("7.1.0",`filters.${n} has moved to ${n}`),e}})});class eX{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(ni.system.add(this.tickerUpdate,this,Ua.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(ni.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&e.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const da=new eX;class ff{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=ff.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Dt,this.page=new Dt,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,t,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,t,i,r,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Jg extends ff{constructor(){super(...arguments),this.client=new Dt,this.movement=new Dt,this.offset=new Dt,this.global=new Dt,this.screen=new Dt}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,t,i){return e.worldTransform.applyInverse(i||this.global,t)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,t,i,r,s,o,a,l,u,d,f,p,m,v,x){throw new Error("Method not implemented.")}}class Zr extends Jg{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Mc extends Jg{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}Mc.DOM_DELTA_PIXEL=0,Mc.DOM_DELTA_LINE=1,Mc.DOM_DELTA_PAGE=2;const tX=2048,nX=new Dt,Wy=new Dt;class iX{constructor(e){this.dispatch=new cf,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort((i,r)=>i.priority-r.priority)}dispatchEvent(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const t=this.mappingTable[e.type];if(t)for(let i=0,r=t.length;i<r;i++)t[i].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,t){da.pauseUpdate=!0;const i=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",r=this[i](this.rootTarget,this.rootTarget.eventMode,nX.set(e,t),this.hitTestFn,this.hitPruneFn);return r&&r[0]}propagate(e,t){if(!e.target)return;const i=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let r=0,s=i.length-1;r<s;r++)if(e.currentTarget=i[r],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let r=i.length-2;r>=0;r--)if(e.currentTarget=i[r],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,t,i=this._allInteractiveElements){if(i.length===0)return;e.eventPhase=e.BUBBLING_PHASE;const r=Array.isArray(t)?t:[t];for(let s=i.length-1;s>=0;s--)r.forEach(o=>{e.currentTarget=i[s],this.notifyTarget(e,o)})}propagationPath(e){const t=[e];for(let i=0;i<tX&&e!==this.rootTarget;i++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");t.push(e.parent),e=e.parent}return t.reverse(),t}hitTestMoveRecursive(e,t,i,r,s,o=!1){let a=!1;if(this._interactivePrune(e))return null;if((e.eventMode==="dynamic"||t==="dynamic")&&(da.pauseUpdate=!1),e.interactiveChildren&&e.children){const d=e.children;for(let f=d.length-1;f>=0;f--){const p=d[f],m=this.hitTestMoveRecursive(p,this._isInteractive(t)?t:p.eventMode,i,r,s,o||s(e,i));if(m){if(m.length>0&&!m[m.length-1].parent)continue;const v=e.isInteractive();(m.length>0||v)&&(v&&this._allInteractiveElements.push(e),m.push(e)),this._hitElements.length===0&&(this._hitElements=m),a=!0}}}const l=this._isInteractive(t),u=e.isInteractive();return l&&u&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:l&&!s(e,i)&&r(e,i)?u?[e]:[]:null}hitTestRecursive(e,t,i,r,s){if(this._interactivePrune(e)||s(e,i))return null;if((e.eventMode==="dynamic"||t==="dynamic")&&(da.pauseUpdate=!1),e.interactiveChildren&&e.children){const l=e.children;for(let u=l.length-1;u>=0;u--){const d=l[u],f=this.hitTestRecursive(d,this._isInteractive(t)?t:d.eventMode,i,r,s);if(f){if(f.length>0&&!f[f.length-1].parent)continue;const p=e.isInteractive();return(f.length>0||p)&&f.push(e),f}}}const o=this._isInteractive(t),a=e.isInteractive();return o&&r(e,i)?a?[e]:[]:null}_isInteractive(e){return e==="static"||e==="dynamic"}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||e.eventMode==="none"||e.eventMode==="passive"&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,t){var i;if(e.hitArea&&(e.worldTransform.applyInverse(t,Wy),!e.hitArea.contains(Wy.x,Wy.y)))return!0;if(e._mask){const r=e._mask.isMaskData?e._mask.maskObject:e._mask;if(r&&!((i=r.containsPoint)!=null&&i.call(r,t)))return!0}return!1}hitTestFn(e,t){return e.eventMode==="passive"?!1:e.hitArea?!0:e.containsPoint?e.containsPoint(t):!1}notifyTarget(e,t){var s,o;t=t??e.type;const i=`on${t}`;(o=(s=e.currentTarget)[i])==null||o.call(s,e);const r=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${t}capture`:t;this.notifyListeners(e,r),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)}mapPointerDown(e){if(!(e instanceof Zr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.createPointerEvent(e);if(this.dispatchEvent(t,"pointerdown"),t.pointerType==="touch")this.dispatchEvent(t,"touchstart");else if(t.pointerType==="mouse"||t.pointerType==="pen"){const r=t.button===2;this.dispatchEvent(t,r?"rightdown":"mousedown")}const i=this.trackingData(e.pointerId);i.pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t)}mapPointerMove(e){var l,u;if(!(e instanceof Zr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const t=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const i=t.pointerType==="mouse"||t.pointerType==="pen",r=this.trackingData(e.pointerId),s=this.findMountedTarget(r.overTargets);if(((l=r.overTargets)==null?void 0:l.length)>0&&s!==t.target){const d=e.type==="mousemove"?"mouseout":"pointerout",f=this.createPointerEvent(e,d,s);if(this.dispatchEvent(f,"pointerout"),i&&this.dispatchEvent(f,"mouseout"),!t.composedPath().includes(s)){const p=this.createPointerEvent(e,"pointerleave",s);for(p.eventPhase=p.AT_TARGET;p.target&&!t.composedPath().includes(p.target);)p.currentTarget=p.target,this.notifyTarget(p),i&&this.notifyTarget(p,"mouseleave"),p.target=p.target.parent;this.freeEvent(p)}this.freeEvent(f)}if(s!==t.target){const d=e.type==="mousemove"?"mouseover":"pointerover",f=this.clonePointerEvent(t,d);this.dispatchEvent(f,"pointerover"),i&&this.dispatchEvent(f,"mouseover");let p=s==null?void 0:s.parent;for(;p&&p!==this.rootTarget.parent&&p!==t.target;)p=p.parent;if(!p||p===this.rootTarget.parent){const m=this.clonePointerEvent(t,"pointerenter");for(m.eventPhase=m.AT_TARGET;m.target&&m.target!==s&&m.target!==this.rootTarget.parent;)m.currentTarget=m.target,this.notifyTarget(m),i&&this.notifyTarget(m,"mouseenter"),m.target=m.target.parent;this.freeEvent(m)}this.freeEvent(f)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(t,"pointermove"),a&&o.push("globalpointermove"),t.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(t,"touchmove"),a&&o.push("globaltouchmove")),i&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(t,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(u=t.target)==null?void 0:u.cursor),o.length>0&&this.all(t,o),this._allInteractiveElements.length=0,this._hitElements.length=0,r.overTargets=t.composedPath(),this.freeEvent(t)}mapPointerOver(e){var o;if(!(e instanceof Zr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId),i=this.createPointerEvent(e),r=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),r&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=(o=i.target)==null?void 0:o.cursor);const s=this.clonePointerEvent(i,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),r&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;t.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof Zr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId);if(t.overTargets){const i=e.pointerType==="mouse"||e.pointerType==="pen",r=this.findMountedTarget(t.overTargets),s=this.createPointerEvent(e,"pointerout",r);this.dispatchEvent(s),i&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(e,"pointerleave",r);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),i&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;t.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof Zr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=performance.now(),i=this.createPointerEvent(e);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const a=i.button===2;this.dispatchEvent(i,a?"rightup":"mouseup")}const r=this.trackingData(e.pointerId),s=this.findMountedTarget(r.pressTargetsByButton[e.button]);let o=s;if(s&&!i.composedPath().includes(s)){let a=s;for(;a&&!i.composedPath().includes(a);){if(i.currentTarget=a,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const l=i.button===2;this.notifyTarget(i,l?"rightupoutside":"mouseupoutside")}a=a.parent}delete r.pressTargetsByButton[e.button],o=a}if(o){const a=this.clonePointerEvent(i,"click");a.target=o,a.path=null,r.clicksByButton[e.button]||(r.clicksByButton[e.button]={clickCount:0,target:a.target,timeStamp:t});const l=r.clicksByButton[e.button];if(l.target===a.target&&t-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=t,a.detail=l.clickCount,a.pointerType==="mouse"){const u=a.button===2;this.dispatchEvent(a,u?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(i)}mapPointerUpOutside(e){if(!(e instanceof Zr)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const t=this.trackingData(e.pointerId),i=this.findMountedTarget(t.pressTargetsByButton[e.button]),r=this.createPointerEvent(e);if(i){let s=i;for(;s;)r.currentTarget=s,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch"?this.notifyTarget(r,"touchendoutside"):(r.pointerType==="mouse"||r.pointerType==="pen")&&this.notifyTarget(r,r.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete t.pressTargetsByButton[e.button]}this.freeEvent(r)}mapWheel(e){if(!(e instanceof Mc)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const t=this.createWheelEvent(e);this.dispatchEvent(t),this.freeEvent(t)}findMountedTarget(e){if(!e)return null;let t=e[0];for(let i=1;i<e.length&&e[i].parent===t;i++)t=e[i];return t}createPointerEvent(e,t,i){const r=this.allocateEvent(Zr);return this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,r.target=i??this.hitTest(r.global.x,r.global.y)??this._hitElements[0],typeof t=="string"&&(r.type=t),r}createWheelEvent(e){const t=this.allocateEvent(Mc);return this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,t.target=this.hitTest(t.global.x,t.global.y),t}clonePointerEvent(e,t){const i=this.allocateEvent(Zr);return i.nativeEvent=e.nativeEvent,i.originalEvent=e.originalEvent,this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.target=e.target,i.path=e.composedPath().slice(),i.type=t??i.type,i}copyWheelData(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}copyPointerData(e,t){e instanceof Zr&&t instanceof Zr&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)}copyMouseData(e,t){e instanceof Jg&&t instanceof Jg&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.copyFrom(e.client),t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.copyFrom(e.movement),t.screen.copyFrom(e.screen),t.shiftKey=e.shiftKey,t.global.copyFrom(e.global))}copyData(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.copyFrom(e.layer),t.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=null,t.target=null,t}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}notifyListeners(e,t){const i=e.currentTarget._events[t];if(i&&e.currentTarget.isInteractive())if("fn"in i)i.once&&e.currentTarget.removeListener(t,i.fn,void 0,!0),i.fn.call(i.context,e);else for(let r=0,s=i.length;r<s&&!e.propagationImmediatelyStopped;r++)i[r].once&&e.currentTarget.removeListener(t,i[r].fn,void 0,!0),i[r].fn.call(i[r].context,e)}}const rX=1,sX={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},nS=class iS{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new iX(null),da.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Zr(null),this.rootWheelEvent=new Mc(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...iS.defaultEventFeatures},{set:(t,i,r)=>(i==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=r),t[i]=r,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:t,resolution:i}=this.renderer;this.setTargetElement(t),this.resolution=i,iS._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===e)return;this.currentCursor=e;const i=this.cursorStyles[e];if(i)switch(typeof i){case"string":t&&(this.domElement.style.cursor=i);break;case"function":i(e);break;case"object":t&&Object.assign(this.domElement.style,i);break}else t&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let i=0,r=t.length;i<r;i++){const s=t[i],o=this.bootstrapEvent(this.rootPointerEvent,s);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,da.pointerMoved();const t=this.normalizeToPointerData(e);for(let i=0,r=t.length;i<r;i++){const s=this.bootstrapEvent(this.rootPointerEvent,t[i]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);const i=t!==this.domElement?"outside":"",r=this.normalizeToPointerData(e);for(let s=0,o=r.length;s<o;s++){const a=this.bootstrapEvent(this.rootPointerEvent,r[s]);a.type+=i,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this.normalizeToPointerData(e);for(let i=0,r=t.length;i<r;i++){const s=this.bootstrapEvent(this.rootPointerEvent,t[i]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this.removeEvents(),this.domElement=e,da.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;da.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;da.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,t,i){const r=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;e.x=(t-r.left)*(this.domElement.width/r.width)*s,e.y=(i-r.top)*(this.domElement.height/r.height)*s}normalizeToPointerData(e){const t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let i=0,r=e.changedTouches.length;i<r;i++){const s=e.changedTouches[i];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=e.type,t.push(s)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const i=e;typeof i.isPrimary>"u"&&(i.isPrimary=!0),typeof i.width>"u"&&(i.width=1),typeof i.height>"u"&&(i.height=1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="mouse"),typeof i.pointerId>"u"&&(i.pointerId=rX),typeof i.pressure>"u"&&(i.pressure=.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),i.isNormalized=!0,t.push(i)}else t.push(e);return t}normalizeWheelEvent(e){const t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=sX[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}};nS.extension={name:"events",type:[Ne.RendererSystem,Ne.CanvasRendererSystem]},nS.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let rS=nS;$e.add(rS);function pR(n){return n==="dynamic"||n==="static"}const oX={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??pR(rS.defaultEventMode)},set interactive(n){Pt("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=n,this.eventMode=n?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??rS.defaultEventMode},set eventMode(n){this._internalInteractive=pR(n),this._internalEventMode=n},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(n,e,t){const i=typeof t=="boolean"&&t||typeof t=="object"&&t.capture,r=typeof e=="function"?void 0:e;n=i?`${n}capture`:n,e=typeof e=="function"?e:e.handleEvent,this.on(n,e,r)},removeEventListener(n,e,t){const i=typeof t=="boolean"&&t||typeof t=="object"&&t.capture,r=typeof e=="function"?void 0:e;n=i?`${n}capture`:n,e=typeof e=="function"?e:e.handleEvent,this.off(n,e,r)},dispatchEvent(n){if(!(n instanceof ff))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return n.defaultPrevented=!1,n.path=null,n.target=this,n.manager.dispatchEvent(n),!n.defaultPrevented}};hn.mixin(oX);const aX={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};hn.mixin(aX);const lX=9,xm=100,uX=0,cX=0,mR=2,gR=1,hX=-1e3,dX=-1e3,fX=2;class E3{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(bo.tablet||bo.phone)&&this.createTouchHook();const t=document.createElement("div");t.style.width=`${xm}px`,t.style.height=`${xm}px`,t.style.position="absolute",t.style.top=`${uX}px`,t.style.left=`${cX}px`,t.style.zIndex=mR.toString(),this.div=t,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width=`${gR}px`,e.style.height=`${gR}px`,e.style.position="absolute",e.style.top=`${hX}px`,e.style.left=`${dX}px`,e.style.zIndex=fX.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(e=this.renderer.view.parentNode)==null||e.appendChild(this.div))}deactivate(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(e=this.div.parentNode)==null||e.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const t=e.children;if(t)for(let i=0;i<t.length;i++)this.updateAccessibleObjects(t[i])}update(){const e=performance.now();if(bo.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:t,y:i,width:r,height:s}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:l}=this.renderer,u=r/o*l,d=s/a*l;let f=this.div;f.style.left=`${t}px`,f.style.top=`${i}px`,f.style.width=`${o}px`,f.style.height=`${a}px`;for(let p=0;p<this.children.length;p++){const m=this.children[p];if(m.renderId!==this.renderId)m._accessibleActive=!1,wc(this.children,p,1),this.div.removeChild(m._accessibleDiv),this.pool.push(m._accessibleDiv),m._accessibleDiv=null,p--;else{f=m._accessibleDiv;let v=m.hitArea;const x=m.worldTransform;m.hitArea?(f.style.left=`${(x.tx+v.x*x.a)*u}px`,f.style.top=`${(x.ty+v.y*x.d)*d}px`,f.style.width=`${v.width*x.a*u}px`,f.style.height=`${v.height*x.d*d}px`):(v=m.getBounds(),this.capHitArea(v),f.style.left=`${v.x*u}px`,f.style.top=`${v.y*d}px`,f.style.width=`${v.width*u}px`,f.style.height=`${v.height*d}px`,f.title!==m.accessibleTitle&&m.accessibleTitle!==null&&(f.title=m.accessibleTitle),f.getAttribute("aria-label")!==m.accessibleHint&&m.accessibleHint!==null&&f.setAttribute("aria-label",m.accessibleHint)),(m.accessibleTitle!==f.title||m.tabIndex!==f.tabIndex)&&(f.title=m.accessibleTitle,f.tabIndex=m.tabIndex,this.debug&&this.updateDebugHTML(f))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:t,height:i}=this.renderer;e.x+e.width>t&&(e.width=t-e.x),e.y+e.height>i&&(e.height=i-e.y)}addChild(e){let t=this.pool.pop();t||(t=document.createElement("button"),t.style.width=`${xm}px`,t.style.height=`${xm}px`,t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=mR.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?t.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(t.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,t){const{displayObject:i}=e.target,r=this.renderer.events.rootBoundary,s=Object.assign(new ff(r),{target:i});r.rootTarget=this.renderer.lastObjectRendered,t.forEach(o=>r.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===lX&&this.activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}E3.extension={name:"accessibility",type:[Ne.RendererPlugin,Ne.CanvasRendererPlugin]};$e.add(E3);var sr=(n=>(n[n.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",n[n.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",n[n.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",n[n.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",n[n.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",n[n.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",n[n.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",n[n.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",n[n.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",n[n.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",n[n.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",n[n.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",n))(sr||{});const e0={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1};let po,ju;function _R(){ju={s3tc:po.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:po.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:po.getExtension("WEBGL_compressed_texture_etc"),etc1:po.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:po.getExtension("WEBGL_compressed_texture_pvrtc")||po.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:po.getExtension("WEBGL_compressed_texture_atc"),astc:po.getExtension("WEBGL_compressed_texture_astc")}}const pX={extension:{type:Ne.DetectionParser,priority:2},test:async()=>{const n=Fe.ADAPTER.createCanvas().getContext("webgl");return n?(po=n,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async n=>{ju||_R();const e=[];for(const t in ju)ju[t]&&e.push(t);return[...e,...n]},remove:async n=>(ju||_R(),n.filter(e=>!(e in ju)))};$e.add(pX);class mX extends A0{constructor(e,t={width:1,height:1,autoLoad:!0}){let i,r;typeof e=="string"?(i=e,r=new Uint8Array):(i=null,r=e),super(r,t),this.origin=i,this.buffer=r?new b1(r):null,this._load=null,this.loaded=!1,this.origin!==null&&t.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new b1(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}}class Fl extends mX{constructor(e,t){super(e,t),this.format=t.format,this.levels=t.levels||1,this._width=t.width,this._height=t.height,this._extension=Fl._formatToExtension(this.format),(t.levelBuffers||this.buffer)&&(this._levelBuffers=t.levelBuffers||Fl._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,t,i){const r=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;r.pixelStorei(r.UNPACK_ALIGNMENT,4);for(let s=0,o=this.levels;s<o;s++){const{levelID:a,levelWidth:l,levelHeight:u,levelBuffer:d}=this._levelBuffers[s];r.compressedTexImage2D(r.TEXTURE_2D,a,this.format,l,u,0,d)}return!0}onBlobLoaded(){this._levelBuffers=Fl._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(e,t,i,r,s,o,a){const l=new Array(i);let u=e.byteOffset,d=o,f=a,p=d+r-1&~(r-1),m=f+s-1&~(s-1),v=p*m*e0[t];for(let x=0;x<i;x++)l[x]={levelID:x,levelWidth:i>1?d:p,levelHeight:i>1?f:m,levelBuffer:new Uint8Array(e.buffer,u,v)},u+=v,d=d>>1||1,f=f>>1||1,p=d+r-1&~(r-1),m=f+s-1&~(s-1),v=p*m*e0[t];return l}}const Xy=4,Sm=124,gX=32,vR=20,_X=542327876,Em={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},vX={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Tm={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},yX=1,xX=2,SX=4,EX=64,TX=512,bX=131072,wX=827611204,AX=861165636,MX=894720068,CX=808540228,RX=4,PX={[wX]:sr.COMPRESSED_RGBA_S3TC_DXT1_EXT,[AX]:sr.COMPRESSED_RGBA_S3TC_DXT3_EXT,[MX]:sr.COMPRESSED_RGBA_S3TC_DXT5_EXT},IX={70:sr.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:sr.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:sr.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:sr.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:sr.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:sr.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:sr.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:sr.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:sr.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function LX(n){const e=new Uint32Array(n);if(e[0]!==_X)throw new Error("Invalid DDS file magic word");const t=new Uint32Array(n,0,Sm/Uint32Array.BYTES_PER_ELEMENT),i=t[Em.HEIGHT],r=t[Em.WIDTH],s=t[Em.MIPMAP_COUNT],o=new Uint32Array(n,Em.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,gX/Uint32Array.BYTES_PER_ELEMENT),a=o[yX];if(a&SX){const l=o[vX.FOURCC];if(l!==CX){const T=PX[l],S=Xy+Sm,w=new Uint8Array(n,S);return[new Fl(w,{format:T,width:r,height:i,levels:s})]}const u=Xy+Sm,d=new Uint32Array(e.buffer,u,vR/Uint32Array.BYTES_PER_ELEMENT),f=d[Tm.DXGI_FORMAT],p=d[Tm.RESOURCE_DIMENSION],m=d[Tm.MISC_FLAG],v=d[Tm.ARRAY_SIZE],x=IX[f];if(x===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${f}`);if(m===RX)throw new Error("DDSParser does not support cubemap textures");if(p===6)throw new Error("DDSParser does not supported 3D texture data");const y=new Array,g=Xy+Sm+vR;if(v===1)y.push(new Uint8Array(n,g));else{const T=e0[x];let S=0,w=r,M=i;for(let R=0;R<s;R++){const D=Math.max(1,w+3&-4),C=Math.max(1,M+3&-4),L=D*C*T;S+=L,w=w>>>1,M=M>>>1}let P=g;for(let R=0;R<v;R++)y.push(new Uint8Array(n,P,S)),P+=S}return y.map(T=>new Fl(T,{format:x,width:r,height:i,levels:s}))}throw a&EX?new Error("DDSParser does not support uncompressed texture data."):a&TX?new Error("DDSParser does not supported YUV uncompressed texture data."):a&bX?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&xX?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const yR=[171,75,84,88,32,49,49,187,13,10,26,10],DX=67305985,qr={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},sS=64,xR={[et.UNSIGNED_BYTE]:1,[et.UNSIGNED_SHORT]:2,[et.INT]:4,[et.UNSIGNED_INT]:4,[et.FLOAT]:4,[et.HALF_FLOAT]:8},NX={[Ee.RGBA]:4,[Ee.RGB]:3,[Ee.RG]:2,[Ee.RED]:1,[Ee.LUMINANCE]:1,[Ee.LUMINANCE_ALPHA]:2,[Ee.ALPHA]:1},UX={[et.UNSIGNED_SHORT_4_4_4_4]:2,[et.UNSIGNED_SHORT_5_5_5_1]:2,[et.UNSIGNED_SHORT_5_6_5]:2};function FX(n,e,t=!1){const i=new DataView(e);if(!OX(n,i))return null;const r=i.getUint32(qr.ENDIANNESS,!0)===DX,s=i.getUint32(qr.GL_TYPE,r),o=i.getUint32(qr.GL_FORMAT,r),a=i.getUint32(qr.GL_INTERNAL_FORMAT,r),l=i.getUint32(qr.PIXEL_WIDTH,r),u=i.getUint32(qr.PIXEL_HEIGHT,r)||1,d=i.getUint32(qr.PIXEL_DEPTH,r)||1,f=i.getUint32(qr.NUMBER_OF_ARRAY_ELEMENTS,r)||1,p=i.getUint32(qr.NUMBER_OF_FACES,r),m=i.getUint32(qr.NUMBER_OF_MIPMAP_LEVELS,r),v=i.getUint32(qr.BYTES_OF_KEY_VALUE_DATA,r);if(u===0||d!==1)throw new Error("Only 2D textures are supported");if(p!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(f!==1)throw new Error("WebGL does not support array textures");const x=4,y=4,g=l+3&-4,T=u+3&-4,S=new Array(f);let w=l*u;s===0&&(w=g*T);let M;if(s!==0?xR[s]?M=xR[s]*NX[o]:M=UX[s]:M=e0[a],M===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const P=t?BX(i,v,r):null;let R=w*M,D=l,C=u,L=g,Z=T,V=sS+v;for(let z=0;z<m;z++){const F=i.getUint32(V,r);let j=V+4;for(let Q=0;Q<f;Q++){let $=S[Q];$||($=S[Q]=new Array(m)),$[z]={levelID:z,levelWidth:m>1||s!==0?D:L,levelHeight:m>1||s!==0?C:Z,levelBuffer:new Uint8Array(e,j,R)},j+=R}V+=F+4,V=V%4!==0?V+4-V%4:V,D=D>>1||1,C=C>>1||1,L=D+x-1&~(x-1),Z=C+y-1&~(y-1),R=L*Z*M}return s!==0?{uncompressed:S.map(z=>{let F=z[0].levelBuffer,j=!1;return s===et.FLOAT?F=new Float32Array(z[0].levelBuffer.buffer,z[0].levelBuffer.byteOffset,z[0].levelBuffer.byteLength/4):s===et.UNSIGNED_INT?(j=!0,F=new Uint32Array(z[0].levelBuffer.buffer,z[0].levelBuffer.byteOffset,z[0].levelBuffer.byteLength/4)):s===et.INT&&(j=!0,F=new Int32Array(z[0].levelBuffer.buffer,z[0].levelBuffer.byteOffset,z[0].levelBuffer.byteLength/4)),{resource:new A0(F,{width:z[0].levelWidth,height:z[0].levelHeight}),type:s,format:j?kX(o):o}}),kvData:P}:{compressed:S.map(z=>new Fl(null,{format:a,width:l,height:u,levels:m,levelBuffers:z})),kvData:P}}function OX(n,e){for(let t=0;t<yR.length;t++)if(e.getUint8(t)!==yR[t])return console.error(`${n} is not a valid *.ktx file!`),!1;return!0}function kX(n){switch(n){case Ee.RGBA:return Ee.RGBA_INTEGER;case Ee.RGB:return Ee.RGB_INTEGER;case Ee.RG:return Ee.RG_INTEGER;case Ee.RED:return Ee.RED_INTEGER;default:return n}}function BX(n,e,t){const i=new Map;let r=0;for(;r<e;){const s=n.getUint32(sS+r,t),o=sS+r+4,a=3-(s+3)%4;if(s===0||s>e-r){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<s&&n.getUint8(o+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const u=new TextDecoder().decode(new Uint8Array(n.buffer,o,l)),d=new DataView(n.buffer,o+l+1,s-l-1);i.set(u,d),r+=4+s+a}return i}const zX={extension:{type:Ne.LoadParser,priority:hs.High},name:"loadDDS",test(n){return Ha(n,".dds")},async load(n,e,t){const i=await(await Fe.ADAPTER.fetch(n)).arrayBuffer(),r=LX(i).map(s=>{const o=new lt(s,{mipmap:Ws.OFF,alphaMode:ji.NO_PREMULTIPLIED_ALPHA,resolution:Uo(n),...e.data});return df(o,t,n)});return r.length===1?r[0]:r},unload(n){Array.isArray(n)?n.forEach(e=>e.destroy(!0)):n.destroy(!0)}};$e.add(zX);const GX={extension:{type:Ne.LoadParser,priority:hs.High},name:"loadKTX",test(n){return Ha(n,".ktx")},async load(n,e,t){const i=await(await Fe.ADAPTER.fetch(n)).arrayBuffer(),{compressed:r,uncompressed:s,kvData:o}=FX(n,i),a=r??s,l={mipmap:Ws.OFF,alphaMode:ji.NO_PREMULTIPLIED_ALPHA,resolution:Uo(n),...e.data},u=a.map(d=>{a===s&&Object.assign(l,{type:d.type,format:d.format});const f=d.resource??d,p=new lt(f,l);return p.ktxKeyValueData=o,df(p,t,n)});return u.length===1?u[0]:u},unload(n){Array.isArray(n)?n.forEach(e=>e.destroy(!0)):n.destroy(!0)}};$e.add(GX);const HX={extension:Ne.ResolveParser,test:n=>{const e=Gn.extname(n).slice(1);return["basis","ktx","dds"].includes(e)},parse:n=>{var t,i;const e=Gn.extname(n).slice(1);if(e==="ktx"){const r=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(r.some(s=>n.endsWith(s)))return{resolution:parseFloat(((t=Fe.RETINA_PREFIX.exec(n))==null?void 0:t[1])??"1"),format:r.find(s=>n.endsWith(s)),src:n}}return{resolution:parseFloat(((i=Fe.RETINA_PREFIX.exec(n))==null?void 0:i[1])??"1"),format:e,src:n}}};$e.add(HX);const bm=new ut,VX=4,T3=class od{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){var t;const e=(t=this.renderer)==null?void 0:t.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,t,i,r){const s=new Image;return s.src=await this.base64(e,t,i,r),s}async base64(e,t,i,r){const s=this.canvas(e,r);if(s.toBlob!==void 0)return new Promise((o,a)=>{s.toBlob(l=>{if(!l){a(new Error("ICanvas.toBlob failed!"));return}const u=new FileReader;u.onload=()=>o(u.result),u.onerror=a,u.readAsDataURL(l)},t,i)});if(s.toDataURL!==void 0)return s.toDataURL(t,i);if(s.convertToBlob!==void 0){const o=await s.convertToBlob({type:t,quality:i});return new Promise((a,l)=>{const u=new FileReader;u.onload=()=>a(u.result),u.onerror=l,u.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,t){const{pixels:i,width:r,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,t);o&&od._flipY(i,r,s),a&&od._unpremultiplyAlpha(i);const l=new IH(r,s,1),u=new ImageData(new Uint8ClampedArray(i.buffer),r,s);return l.context.putImageData(u,0,0),l.canvas}pixels(e,t){const{pixels:i,width:r,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(e,t);return o&&od._flipY(i,r,s),a&&od._unpremultiplyAlpha(i),i}_rawPixels(e,t){const i=this.renderer;if(!i)throw new Error("The Extract has already been destroyed");let r,s=!1,o=!1,a,l=!1;e&&(e instanceof Jl?a=e:(a=i.generateTexture(e,{region:t,resolution:i.resolution,multisample:i.multisample}),l=!0,t&&(bm.width=t.width,bm.height=t.height,t=bm)));const u=i.gl;if(a){if(r=a.baseTexture.resolution,t=t??a.frame,s=!1,o=a.baseTexture.alphaMode>0&&a.baseTexture.format===Ee.RGBA,!l){i.renderTexture.bind(a);const m=a.framebuffer.glFramebuffers[i.CONTEXT_UID];m.blitFramebuffer&&i.framebuffer.bind(m.blitFramebuffer)}}else r=i.resolution,t||(t=bm,t.width=i.width/r,t.height=i.height/r),s=!0,o=this._rendererPremultipliedAlpha,i.renderTexture.bind();const d=Math.max(Math.round(t.width*r),1),f=Math.max(Math.round(t.height*r),1),p=new Uint8Array(VX*d*f);return u.readPixels(Math.round(t.x*r),Math.round(t.y*r),d,f,u.RGBA,u.UNSIGNED_BYTE,p),l&&(a==null||a.destroy(!0)),{pixels:p,width:d,height:f,flipY:s,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(e,t,i){const r=t<<2,s=i>>1,o=new Uint8Array(r);for(let a=0;a<s;a++){const l=a*r,u=(i-a-1)*r;o.set(e.subarray(l,l+r)),e.copyWithin(l,u,u+r),e.set(o,u)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const t=e.length;for(let i=0;i<t;i+=4){const r=e[i+3];if(r!==0){const s=255.001/r;e[i]=e[i]*s+.5,e[i+1]=e[i+1]*s+.5,e[i+2]=e[i+2]*s+.5}}}};T3.extension={name:"extract",type:Ne.RendererSystem};let WX=T3;$e.add(WX);class XX{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function jX(n,e){var i;let t=!1;if((i=n==null?void 0:n._textures)!=null&&i.length){for(let r=0;r<n._textures.length;r++)if(n._textures[r]instanceof Pe){const s=n._textures[r].baseTexture;e.includes(s)||(e.push(s),t=!0)}}return t}function $X(n,e){if(n.baseTexture instanceof lt){const t=n.baseTexture;return e.includes(t)||e.push(t),!0}return!1}function YX(n,e){if(n._texture&&n._texture instanceof Pe){const t=n._texture.baseTexture;return e.includes(t)||e.push(t),!0}return!1}function qX(n,e){return e instanceof IE?(e.updateText(!0),!0):!1}function KX(n,e){if(e instanceof Fa){const t=e.toFontString();return ua.measureFont(t),!0}return!1}function ZX(n,e){if(n instanceof IE){e.includes(n.style)||e.push(n.style),e.includes(n)||e.push(n);const t=n._texture.baseTexture;return e.includes(t)||e.push(t),!0}return!1}function QX(n,e){return n instanceof Fa?(e.includes(n)||e.push(n),!0):!1}const b3=class w3{constructor(e){this.limiter=new XX(w3.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(ZX),this.registerFindHook(QX),this.registerFindHook(jX),this.registerFindHook($X),this.registerFindHook(YX),this.registerUploadHook(qX),this.registerUploadHook(KX)}upload(e){return new Promise(t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,ni.system.addOnce(this.tick,this,Ua.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let t=!1;if(e&&!e._destroyed){for(let i=0,r=this.uploadHooks.length;i<r;i++)if(this.uploadHooks[i](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)ni.system.addOnce(this.tick,this,Ua.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let t=0,i=e.length;t<i;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,i=this.addHooks.length;t<i&&!this.addHooks[t](e,this.queue);t++);if(e instanceof Oi)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&ni.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};b3.uploadsPerFrame=4;let oS=b3;Object.defineProperties(Fe,{UPLOADS_PER_FRAME:{get(){return oS.uploadsPerFrame},set(n){Pt("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),oS.uploadsPerFrame=n}}});function A3(n,e){return e instanceof lt?(e._glTextures[n.CONTEXT_UID]||n.texture.bind(e),!0):!1}function JX(n,e){if(!(e instanceof Ad))return!1;const{geometry:t}=e;e.finishPoly(),t.updateBatches();const{batches:i}=t;for(let r=0;r<i.length;r++){const{texture:s}=i[r].style;s&&A3(n,s.baseTexture)}return t.batchable||n.geometry.bind(t,e._resolveDirectShader(n)),!0}function ej(n,e){return n instanceof Ad?(e.push(n),!0):!1}class M3 extends oS{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(ej),this.registerUploadHook(A3),this.registerUploadHook(JX)}}M3.extension={name:"prepare",type:Ne.RendererSystem};$e.add(M3);const C3=class ad{constructor(e,t,i=null){this.linkedSheets=[],this._texture=e instanceof Pe?e:null,this.baseTexture=e instanceof lt?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;const r=this.baseTexture.resource;this.resolution=this._updateResolution(i||(r?r.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:t}=this.data.meta;let i=Uo(e,null);return i===null&&(i=typeof t=="number"?t:parseFloat(t??"1")),i!==1&&this.baseTexture.setResolution(i),i}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=ad.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;const i=ad.BATCH_SIZE;for(;t-e<i&&t<this._frameKeys.length;){const r=this._frameKeys[t],s=this._frames[r],o=s.frame;if(o){let a=null,l=null;const u=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,d=new ut(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);s.rotated?a=new ut(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new ut(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new ut(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[r]=new Pe(this.baseTexture,a,d,l,s.rotated?2:0,s.anchor,s.borders),Pe.addToCache(this.textures[r],r.toString())}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let i=0;i<e[t].length;i++){const r=e[t][i];this.animations[t].push(this.textures[r])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*ad.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*ad.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var t;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};C3.BATCH_SIZE=1e3;let SR=C3;const tj=["jpg","png","jpeg","avif","webp"];function R3(n,e,t){const i={};if(n.forEach(r=>{i[r]=e}),Object.keys(e.textures).forEach(r=>{i[r]=e.textures[r]}),!t){const r=Gn.dirname(n[0]);e.linkedSheets.forEach((s,o)=>{const a=R3([`${r}/${e.data.meta.related_multi_packs[o]}`],s,!0);Object.assign(i,a)})}return i}const nj={extension:Ne.Asset,cache:{test:n=>n instanceof SR,getCacheableAssets:(n,e)=>R3(n,e,!1)},resolver:{test:n=>{const e=n.split("?")[0].split("."),t=e.pop(),i=e.pop();return t==="json"&&tj.includes(i)},parse:n=>{var t;const e=n.split(".");return{resolution:parseFloat(((t=Fe.RETINA_PREFIX.exec(n))==null?void 0:t[1])??"1"),format:e[e.length-2],src:n}}},loader:{name:"spritesheetLoader",extension:{type:Ne.LoadParser,priority:hs.Normal},async testParse(n,e){return Gn.extname(e.src).toLowerCase()===".json"&&!!n.frames},async parse(n,e,t){var l,u;let i=Gn.dirname(e.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let r=i+n.meta.image;r=W1(r,e.src);const s=(await t.load([r]))[r],o=new SR(s.baseTexture,n,e.src);await o.parse();const a=(l=n==null?void 0:n.meta)==null?void 0:l.related_multi_packs;if(Array.isArray(a)){const d=[];for(const p of a){if(typeof p!="string")continue;let m=i+p;(u=e.data)!=null&&u.ignoreMultiPack||(m=W1(m,e.src),d.push(t.load({src:m,data:{ignoreMultiPack:!0}})))}const f=await Promise.all(d);o.linkedSheets=f,f.forEach(p=>{p.linkedSheets=[o].concat(o.linkedSheets.filter(m=>m!==p))})}return o},unload(n){n.destroy(!0)}}};$e.add(nj);const aS=class $u extends Fa{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new $u(Object.keys($u.defaultOptions).reduce((t,i)=>({...t,[i]:e[i]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete $u.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,t={}){const{availableFonts:i}=$u;if(i[e]){const r=i[e];return this._fonts.push(r),r.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return Fe.ADAPTER.fetch(e).then(r=>r.blob()).then(async r=>new Promise((s,o)=>{const a=URL.createObjectURL(r),l=new FileReader;l.onload=()=>s([a,l.result]),l.onerror=o,l.readAsDataURL(r)})).then(async([r,s])=>{const o=Object.assign({family:Gn.basename(e,Gn.extname(e)),weight:"normal",style:"normal",display:"auto",src:r,dataSrc:s,refs:1,originalUrl:e,fontFace:null},t);i[e]=o,this._fonts.push(o),this.styleID++;const a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const t=e.filter(i=>!this._overrides.includes(i));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...e){const t=e.filter(i=>this._overrides.includes(i));t.length>0&&(this._overrides=this._overrides.filter(i=>!t.includes(i)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,t)=>`${e}
            @font-face {
                font-family: "${t.family}";
                src: url('${t.dataSrc}');
                font-weight: ${t.weight};
                font-style: ${t.style};
                font-display: ${t.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=MH(e)),typeof e=="number"?AH(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const t=this.dropShadowAlpha,i=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),r=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&t<1&&(e+=(t*255|0).toString(16).padStart(2,"0"));const s=`${i}px ${r}px`;return this.dropShadowBlur>0?`text-shadow: ${s} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${s} ${e}`}reset(){Object.assign(this,$u.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(t=>setTimeout(t,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=Fe.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};aS.availableFonts={},aS.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let jy=aS;const wm=class Yu extends Zs{constructor(e="",t={}){super(Pe.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const i=new Image,r=Pe.from(i,{scaleMode:Fe.SCALE_MODE,resourceOptions:{autoLoad:!1}});r.orig=new ut,r.trim=new ut,this.texture=r;const s="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject"),u=document.createElementNS(o,"div"),d=document.createElementNS(o,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",a.appendChild(l),this.maxWidth=Yu.defaultMaxWidth,this.maxHeight=Yu.defaultMaxHeight,this._domElement=u,this._styleElement=d,this._svgRoot=a,this._foreignObject=l,this._foreignObject.appendChild(d),this._foreignObject.appendChild(u),this._image=i,this._loadImage=new Image,this._autoResolution=Yu.defaultAutoResolution,this._resolution=Yu.defaultResolution??Fe.RESOLUTION,this.text=e,this.style=t}measureText(e){var d,f;const{text:t,style:i,resolution:r}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:t,style:i.toCSS(r)}),this._styleElement.textContent=i.toGlobalCSS(),document.body.appendChild(this._svgRoot);const s=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=s;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const l=Math.min(this.maxWidth,Math.ceil(o)),u=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",l.toString()),this._svgRoot.setAttribute("height",u.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),i!==this._style&&(Object.assign(this._domElement,{style:(d=this._style)==null?void 0:d.toCSS(r)}),this._styleElement.textContent=(f=this._style)==null?void 0:f.toGlobalCSS()),{width:l+i.padding*2,height:u+i.padding*2}}async updateText(e=!0){const{style:t,_image:i,_loadImage:r}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;const{width:s,height:o}=this.measureText();i.width=r.width=Math.ceil(Math.max(1,s)),i.height=r.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise(l=>{r.onload=async()=>{if(a<this._updateID){l();return}await t.onBeforeDraw(),i.src=r.src,r.onload=null,r.src="",this.updateTexture(),l()};const u=new XMLSerializer().serializeToString(this._svgRoot);r.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(u)}`})}get source(){return this._image}updateTexture(){const{style:e,texture:t,_image:i,resolution:r}=this,{padding:s}=e,{baseTexture:o}=t;t.trim.width=t._frame.width=i.width/r,t.trim.height=t._frame.height=i.height/r,t.trim.x=-s,t.trim.y=-s,t.orig.width=t._frame.width-s*2,t.orig.height=t._frame.height-s*2,this._onTextureUpdate(),o.setRealSize(i.width,i.height,r),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var i,r,s,o,a;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},Yu.defaultDestroyOptions,e),super.destroy(e);const t=null;this.ownsStyle&&((i=this._style)==null||i.cleanFonts()),this._style=t,(r=this._svgRoot)==null||r.remove(),this._svgRoot=t,(s=this._domElement)==null||s.remove(),this._domElement=t,(o=this._foreignObject)==null||o.remove(),this._foreignObject=t,(a=this._styleElement)==null||a.remove(),this._styleElement=t,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=t,this._image.src="",this._image=t}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const t=_a(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const t=_a(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof jy?(this.ownsStyle=!1,this._style=e):e instanceof Fa?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=jy.from(e)):(this.ownsStyle=!0,this._style=new jy(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};wm.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},wm.defaultMaxWidth=2024,wm.defaultMaxHeight=2024,wm.defaultAutoResolution=!0;const ij=new lt(eu),rj=new ut(162,0,sd,100),sj=new Pe(ij,rj),oj=({x:n,y:e})=>ie(kt.Sprite,{texture:sj,x:n,y:e});function tg(n,e=0){return Math.random()*(n-e)+e}function Ol(n,e,t,i){let r=tg(t,e);if(n.length===2){const[s,o]=n;s>o?r=s+i:r=o+i}return n.push(r),r}function ER(n){sessionStorage.setItem("gameSpeed",n.toString())}function k0(){const n=sessionStorage.getItem("gameSpeed");return n===null?0:parseInt(n)}function TR(){sessionStorage.removeItem("gameSpeed")}function aj(n){localStorage.setItem("gameHighScore",n.toString())}function lj(){const n=localStorage.getItem("gameHighScore");return n===null?0:parseInt(n)}const tu=me.createContext(void 0),Am=200,uj=({xPos:n,update:e})=>{const[t,i]=me.useState(n),[r,s]=me.useState([]),[o,a]=me.useState([]),[l,u]=me.useState(0),d=me.useContext(tu),f=(d==null?void 0:d.store.cloudXPositions)||[],p=f.length>0?f[f.length-1]:n;return me.useEffect(()=>{const m=setInterval(()=>{const v=k0();u(v)},100);return()=>{clearInterval(m)}},[]),me.useEffect(()=>{const m=[],v=[],x=Array.from({length:cR},(y,g)=>{const T=Ol(m,p,p+100,sd),S=Ol(v,0,Am,sd)>Am?Am:Ol(v,0,Am,sd);if(g===cR-1){const w=m.sort((M,P)=>M-P);d&&d.dispatch({type:"UPDATE_CLOUD_X_POSITIONS",payload:w}),a(w)}return ie(oj,{x:T,y:S},T)});s(x.sort((y,g)=>y.props.x-g.props.x))},[]),kt.useTick(()=>{i(t-l)},l>0),me.useEffect(()=>{if(o.length===0)return;t+o.at(-1)+sd>0||e()},[t]),ie(kt.Container,{position:[t,0],children:r})};let Mm;const cj=new Uint8Array(16);function hj(){if(!Mm&&(Mm=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Mm))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Mm(cj)}const ci=[];for(let n=0;n<256;++n)ci.push((n+256).toString(16).slice(1));function dj(n,e=0){return ci[n[e+0]]+ci[n[e+1]]+ci[n[e+2]]+ci[n[e+3]]+"-"+ci[n[e+4]]+ci[n[e+5]]+"-"+ci[n[e+6]]+ci[n[e+7]]+"-"+ci[n[e+8]]+ci[n[e+9]]+"-"+ci[n[e+10]]+ci[n[e+11]]+ci[n[e+12]]+ci[n[e+13]]+ci[n[e+14]]+ci[n[e+15]]}let bR,$y,Yy=0,qy=0;function wR(n,e,t){let i=e&&t||0;const r=e||new Array(16);n=n||{};let s=n.node||bR,o=n.clockseq!==void 0?n.clockseq:$y;if(s==null||o==null){const p=n.random||(n.rng||hj)();s==null&&(s=bR=[p[0]|1,p[1],p[2],p[3],p[4],p[5]]),o==null&&(o=$y=(p[6]<<8|p[7])&16383)}let a=n.msecs!==void 0?n.msecs:Date.now(),l=n.nsecs!==void 0?n.nsecs:qy+1;const u=a-Yy+(l-qy)/1e4;if(u<0&&n.clockseq===void 0&&(o=o+1&16383),(u<0||a>Yy)&&n.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Yy=a,qy=l,$y=o,a+=122192928e5;const d=((a&268435455)*1e4+l)%4294967296;r[i++]=d>>>24&255,r[i++]=d>>>16&255,r[i++]=d>>>8&255,r[i++]=d&255;const f=a/4294967296*1e4&268435455;r[i++]=f>>>8&255,r[i++]=f&255,r[i++]=f>>>24&15|16,r[i++]=f>>>16&255,r[i++]=o>>>8|128,r[i++]=o&255;for(let p=0;p<6;++p)r[i+p]=s[p];return e||dj(r)}const Ky=({componentBuilder:n,total:e,width:t,skipFirstElement:i})=>{const[r,s]=me.useState(!1),[o,a]=me.useState([]);return me.useEffect(()=>{a(Array.from({length:e},(l,u)=>{let d=i?u+1:u;return n({key:wR(),xPos:t*d,update:()=>s(!0)})}))},[]),me.useEffect(()=>{if(r){o.shift();const l=o,u=n({key:wR(),xPos:t+o.at(-1).props.xPos/2,update:()=>s(!0)});l.push(u),a(l),s(!1)}},[r]),ie(dc,{children:o.map(l=>l)})},fj=({visible:n,gameSpeed:e})=>{const[t,i]=me.useState([]),[r,s]=me.useState(-.1);return me.useEffect(()=>{Al.load("./walking-dino.json").then(o=>{const a=o.textures;i(Object.keys(a).map(l=>a[l]))})},[]),me.useEffect(()=>{e%2===0&&s(r+.1)},[e]),t.length===0?null:ie(kt.Container,{visible:n,children:ie(kt.AnimatedSprite,{animationSpeed:r,isPlaying:!0,textures:t})})},pj=({visible:n})=>{const e=new lt(eu),t=new ut(1335,0,88,94),i=new Pe(e,t);return ie(kt.Container,{visible:n,children:ie(kt.Sprite,{texture:i})})},mj=({visible:n})=>{const e=new lt(eu),t=new ut(1775,0,89,94),i=new Pe(e,t);return ie(kt.Container,{visible:n,children:ie(kt.Sprite,{texture:i})})},gj=({visible:n,gameSpeed:e})=>{const[t,i]=me.useState([]),[r,s]=me.useState(-.1);return me.useEffect(()=>{Al.load("./running-dino.json").then(o=>{const a=o.textures;i(Object.keys(a).map(l=>a[l]))})},[]),me.useEffect(()=>{e%2===0&&s(r+.1)},[e]),t.length===0?null:ie(kt.Container,{visible:n,children:ie(kt.AnimatedSprite,{animationSpeed:r,isPlaying:!0,textures:t})})};let Zy=0;const _j=({gameSpeed:n,setRef:e})=>{const[t,i]=me.useState(0),[r,s]=me.useState(!1),[o,a]=me.useState(230),l=me.useRef(t),u=me.useRef(r),d=me.useRef(n),f=me.useRef(null),p=me.useContext(tu),m=(p==null?void 0:p.gameOver)||!1,v=y=>{const g=y.code;l.current===0&&((g==="Space"||g==="ArrowUp")&&!u.current?i(1):g==="ArrowDown"&&d.current>0&&s(!0))},x=y=>{y.code==="ArrowDown"&&s(!1)};return me.useEffect(()=>{l.current=t},[t]),me.useEffect(()=>{u.current=r},[r]),me.useEffect(()=>{d.current=n},[n]),me.useEffect(()=>{n===0&&(document.removeEventListener("keydown",v),document.removeEventListener("keyup",x))},[n]),me.useEffect(()=>{f.current&&e(f.current)},[f]),me.useEffect(()=>{document.addEventListener("keydown",v),document.addEventListener("keyup",x)},[]),me.useEffect(()=>{t==0&&a(r?265:230)},[r,t]),kt.useTick(()=>{if(n>0){if(t===1){const y=o-15;a(y),y<=10&&i(2)}else if(t===2){Zy+=.6;const y=o+Zy;a(y),y>=240&&(a(230),i(0),Zy=0)}}}),Et(kt.Container,{ref:f,position:[50,o],zIndex:2,children:[ie(pj,{visible:n===0||t!==0||!!m}),ie(fj,{visible:n>0&&t===0&&!r,gameSpeed:n}),ie(gj,{visible:r&&t===0,gameSpeed:n}),ie(mj,{visible:m===!0})]})};var vo=(n=>(n[n.TYPE_0=0]="TYPE_0",n[n.TYPE_1=1]="TYPE_1",n[n.TYPE_2=2]="TYPE_2",n[n.TYPE_3=3]="TYPE_3",n))(vo||{}),Md=(n=>(n[n.SMALL=0]="SMALL",n[n.BIG=1]="BIG",n))(Md||{}),Ml=(n=>(n[n.WIDTH_35=35]="WIDTH_35",n[n.WIDTH_37=37]="WIDTH_37",n))(Ml||{}),Cc=(n=>(n[n.WIDTH_50=50]="WIDTH_50",n[n.WIDTH_104=104]="WIDTH_104",n))(Cc||{}),qu=(n=>(n[n.DEFAULT=0]="DEFAULT",n[n.START=6]="START",n))(qu||{});const vj=(n,e)=>{const t={rectX:650,rectY:0,rectW:Cc.WIDTH_50,rectH:100};return n===vo.TYPE_1?(t.rectX=750,t.rectW=Cc.WIDTH_50):n===vo.TYPE_2&&(t.rectX=847,t.rectW=Cc.WIDTH_104),e===Md.SMALL&&(t.rectX=440,t.rectW=Ml.WIDTH_37,n===vo.TYPE_1?(t.rectX=511,t.rectW=Ml.WIDTH_35):n===vo.TYPE_2?(t.rectX=580,t.rectW=Ml.WIDTH_35):n===vo.TYPE_3&&(t.rectX=613,t.rectW=Ml.WIDTH_37)),t},yj=new lt(eu),xj=({x:n,y:e,treeType:t,isSmallTree:i})=>{const r=me.useMemo(()=>{const l=vj(t,i);return new ut(l.rectX,l.rectY,l.rectW,l.rectH)},[t,i]),s=me.useMemo(()=>new Pe(yj,r),[r]),o=me.useRef(null),a=me.useContext(tu);return kt.useTick(()=>{o.current&&a&&a.detectCollision(o.current)}),ie(kt.Sprite,{texture:s,x:n,y:e,ref:o})},Sj=({xPos:n,update:e})=>{const[t]=me.useState(Math.floor(tg(2))),[i,r]=me.useState(n),[s,o]=me.useState([]),[a,l]=me.useState([]),[u,d]=me.useState(0),f=me.useContext(tu),p=(f==null?void 0:f.store.treeXPositions)||[],m=p.length>0?p[p.length-1]:n,v=me.useMemo(()=>t===Md.SMALL?Math.floor(tg(4)):Math.floor(tg(3)),[]),x=me.useMemo(()=>t===Md.SMALL?v===vo.TYPE_0||v===vo.TYPE_3?Ml.WIDTH_37:Ml.WIDTH_35:v===vo.TYPE_2?Cc.WIDTH_104:Cc.WIDTH_50,[]);return me.useEffect(()=>{const y=setInterval(()=>{const g=k0();d(g)},100);return()=>{clearInterval(y)}},[]),me.useEffect(()=>{const y=[],g=Array.from({length:hR},(T,S)=>{const w=Ol(y,m||100,m+100,x);if(S===hR-1){const M=y.sort((P,R)=>P-R);f&&f.dispatch({type:"UPDATE_TREE_X_POSITIONS",payload:M}),l(M)}return ie(xj,{x:w,y:t===Md.SMALL?250:225,treeType:v,isSmallTree:t},w)});o(g.sort((T,S)=>T.props.x-S.props.x))},[]),kt.useTick(()=>{r(i-u*2)},u>0),me.useEffect(()=>{if(a.length===0)return;i+a.at(-1)+x>0||e()},[i]),ie(kt.Container,{position:[i,0],children:s})},Ej=(n,e)=>{switch(e.type){case"UPDATE_CLOUD_X_POSITIONS":return{...n,cloudXPositions:e.payload};case"UPDATE_TREE_X_POSITIONS":return{...n,treeXPositions:e.payload};case"UPDATE_BIRD_X_POSITIONS":return{...n,birdXPositions:e.payload};default:return n}},Tj={cloudXPositions:[],treeXPositions:[],birdXPositions:[]},bj=()=>{const[n,e]=me.useReducer(Ej,Tj);return{state:n,dispatch:e}},wj=({restartGame:n})=>{const[e,t]=me.useState(0),[i,r]=me.useState(null),[s,o]=me.useState(!1),[a,l]=me.useState(0),[u]=me.useState(lj()),d=bj(),{state:f,dispatch:p}=d,m=({key:S,xPos:w,update:M})=>ie(uj,{xPos:w,update:M},S),v=({key:S,xPos:w,update:M})=>ie(Sj,{xPos:w,update:M},S),x=({key:S,xPos:w,update:M})=>ie(Rj,{xPos:w,update:M},S),y=me.useCallback(S=>{if(S&&i){const w=S.getBounds(),M=i.getBounds();w.x<M.x+M.width&&w.x+w.width>M.x&&w.y<M.y+M.height-30&&w.y+w.height-30>M.y&&(t(qu.DEFAULT),TR(),o(!0))}},[i]),g=S=>{const w=S.code;(w==="Space"||w==="ArrowUp")&&(s?T():(t(qu.START),ER(qu.START)))},T=()=>{document.removeEventListener("keydown",g),n()};return me.useEffect(()=>{k0()>qu.DEFAULT&&TR(),document.addEventListener("keydown",g),s&&a>u&&aj(a)},[s]),me.useEffect(()=>{if(a>0&&a%200===0){const S=e+1;t(S),ER(S)}},[a]),me.useEffect(()=>{let S;return e>qu.DEFAULT&&!s&&(S=setInterval(()=>{const w=a+1;l(w)},100)),()=>{clearInterval(S)}},[e,s,a]),Et(kt.Stage,{width:OE,height:NW,options:{antialias:!0,background:"#f5ecdb"},children:[ie(kt.Container,{sortableChildren:!0,children:Et(tu.Provider,{value:{detectCollision:y,gameOver:s,store:f,dispatch:p},children:[a>=100&&ie(Ky,{componentBuilder:x,total:2,width:xl,skipFirstElement:!0}),ie(Ky,{componentBuilder:m,total:3,width:xl}),ie(_j,{gameSpeed:e,setRef:r}),ie(Ky,{componentBuilder:v,total:2,width:xl/2,skipFirstElement:!0}),ie(UW,{gameSpeed:e})]})}),Et(kt.Container,{children:[ie(kt.Text,{text:`Score: ${a}`,x:xl*.5,y:15,style:{fill:6241319,fontFamily:"AR One Sans",fontSize:22}}),ie(kt.Text,{text:`High Score: ${u}`,x:xl*1.33,y:15,style:{fill:6241319,fontFamily:"AR One Sans",fontSize:22}})]}),Et(kt.Container,{visible:s,children:[ie(Aj,{}),ie(Mj,{restartGame:T})]})]})},Aj=({})=>{const e=new lt(eu),t=new ut(950,25,385,30),i=new Pe(e,t);return ie(kt.Container,{position:[xl-385/2,150],children:ie(kt.Sprite,{texture:i})})},Mj=({restartGame:n})=>{const t=new lt(eu),i=new ut(0,0,70,65),r=new Pe(t,i);return ie(kt.Container,{position:[xl-70/2,50],children:ie(kt.Sprite,{interactive:!0,texture:r,cursor:"pointer",onclick:n})})},Cj=({x:n,y:e,gameSpeed:t})=>{const[i,r]=me.useState([]),[s,o]=me.useState(-.15);me.useEffect(()=>{Al.load("./flying-bird.json").then(u=>{const d=u.textures;r(Object.keys(d).map(f=>d[f]))})},[]);const a=me.useRef(null),l=me.useContext(tu);return kt.useTick(()=>{a.current&&l&&l.detectCollision(a.current)}),me.useEffect(()=>{l&&l.gameOver&&o(0)},[l]),i.length===0?null:ie(kt.AnimatedSprite,{animationSpeed:s,isPlaying:!0,textures:i,position:[n,e],ref:a})},Cm=250,Rj=({xPos:n,update:e})=>{const[t,i]=me.useState(n),[r,s]=me.useState([]),[o,a]=me.useState([]),[l,u]=me.useState(0),d=me.useContext(tu),f=(d==null?void 0:d.store.birdXPositions)||[],p=f.length>0?f[f.length-1]:n;return me.useEffect(()=>{const m=setInterval(()=>{const v=k0();u(v)},100);return()=>{clearInterval(m)}},[]),me.useEffect(()=>{const m=[],v=[],x=Array.from({length:dR},(y,g)=>{const T=Ol(m,p,p+100,ym),S=Ol(v,0,Cm,ym)>Cm?Cm:Ol(v,0,Cm,ym);if(g===dR-1){const w=m.sort((M,P)=>M-P);d&&d.dispatch({type:"UPDATE_BIRD_X_POSITIONS",payload:w}),a(w)}return ie(Cj,{x:T,y:S,gameSpeed:l},T)});s(x.sort((y,g)=>y.props.x-g.props.x))},[]),kt.useTick(()=>{i(t-l*3)},l>0),me.useEffect(()=>{if(o.length===0)return;t+o.at(-1)+ym>0||e()},[t]),ie(kt.Container,{position:[t,0],children:r})},kE=()=>{const n=[{name:"Marshall Wace",img:"/sponsors/marshall-wace.svg",link:"https://www.mwam.com/"}],e=[{name:"Optiver",img:"/sponsors/optiver.png",link:"https://optiver.com/"}],t=[{name:"Addepar",img:"/sponsors/addepar.png",link:"https://addepar.com/"}],i=[{name:"Compsoc",img:"/sponsors/compsoc.png",link:"https://comp-soc.com/"},{name:"MLH",img:"/sponsors/mlh.png",link:"https://mlh.io/"},{name:"Hackathons UK",img:"/sponsors/hackathonUK.png",link:"https://www.hackathons.org.uk/"}];return Et("footer",{children:[Et("div",{className:"scrollContainer",children:[Et("div",{className:"icon-container platinum",children:[ie("div",{className:"heading",children:"PLATINUM"}),n.map((r,s)=>ie("a",{href:r.link,target:"_blank",children:ie("img",{src:r.img,alt:r.name})},s))]}),Et("div",{className:"icon-container gold",children:[ie("div",{className:"heading",children:"GOLD"}),e.map((r,s)=>ie("a",{href:r.link,target:"_blank",children:ie("img",{src:r.img,alt:r.name})},s))]}),Et("div",{className:"icon-container silver",children:[ie("div",{className:"heading",children:"SILVER"}),t.map((r,s)=>ie("a",{href:r.link,target:"_blank",children:ie("img",{src:r.img,alt:r.name})},s))]}),Et("div",{className:"icon-container partners",children:[ie("div",{className:"heading",children:"PARTNERS"}),i.map((r,s)=>ie("a",{href:r.link,target:"_blank",children:ie("img",{src:r.img,alt:r.name})},s))]})]}),Et("div",{className:"scrollContainer second",children:[Et("div",{className:"icon-container platinum",children:[ie("div",{className:"heading",children:"PLATINUM"}),n.map((r,s)=>ie("a",{href:r.link,target:"_blank",children:ie("img",{src:r.img,alt:r.name})},s))]}),Et("div",{className:"icon-container gold",children:[ie("div",{className:"heading",children:"GOLD"}),e.map((r,s)=>ie("a",{href:r.link,target:"_blank",children:ie("img",{src:r.img,alt:r.name})},s))]}),Et("div",{className:"icon-container silver",children:[ie("div",{className:"heading",children:"SILVER"}),t.map((r,s)=>ie("a",{href:r.link,target:"_blank",children:ie("img",{src:r.img,alt:r.name})},s))]}),Et("div",{className:"icon-container partners",children:[ie("div",{className:"heading",children:"PARTNERS"}),i.map((r,s)=>ie("a",{href:r.link,target:"_blank",children:ie("img",{src:r.img,alt:r.name})},s))]})]})]})},Pj="/insta.png",Ij="/facebook.png",Lj="/yt.png",Dj="/in.png",Nj=({targetDate:n})=>{const e=()=>{const s=new Date().getTime(),a=new Date(n).getTime()-s;if(a<=0)return{days:0,hours:0,minutes:0,seconds:0};const l=Math.floor(a/(1e3*60*60*24)),u=Math.floor(a%(1e3*60*60*24)/(1e3*60*60)),d=Math.floor(a%(1e3*60*60)/(1e3*60)),f=Math.floor(a%(1e3*60)/1e3);return{days:l,hours:u,minutes:d,seconds:f}},[t,i]=me.useState(e());me.useEffect(()=>{const s=setInterval(()=>{i(e())},1e3);return()=>{clearInterval(s)}},[n]);const r=s=>s.toString().padStart(2,"0");return ie("div",{className:"countdown-timer",children:Et("div",{children:[r(t.days),":",r(t.hours),":",r(t.minutes),":",r(t.seconds)]})})},Uj=()=>{const[n,e]=me.useState(!1),t="2024-03-02T12:00:00",[i,r]=me.useState(!1),[s,o]=me.useState(!1),[a,l]=me.useState(window.innerWidth);return me.useEffect(()=>{const u=()=>{l(window.innerWidth)};return window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u)}},[]),me.useEffect(()=>{var u;(u=document.querySelector(".page"))==null||u.addEventListener("scroll",()=>{r(!0)}),document.addEventListener("keydown",d=>{d.code==="Space"&&o(!0)})},[]),me.useEffect(()=>{n&&e(!1)},[n]),ie("div",{className:"page w-full flex flex-col items-center",children:Et("div",{className:"main-box",children:[ie("a",{className:"no-hover",id:"mlh-trust-badge",href:"https://mlh.io/eu?utm_source=eu-hackathon&utm_medium=TrustBadge&utm_campaign=2024-season&utm_content=white",target:"_blank",children:ie("img",{id:"mlh-trust-img",src:"https://s3.amazonaws.com/logged-assets/trust-badge/2024/mlh-trust-badge-2024-white.svg",alt:"Major League Hacking 2024 Hackathon Season"})}),Et("div",{className:"part",children:[Et("div",{className:"header",children:[ie("div",{className:"pageHeader",children:"Hack The Burgh X"}),ie("div",{className:"description",children:"2-3rd March | Edinburgh, The Nucleus Building"})]}),ie("p",{children:"Hack The Burgh is back for its 10th year! Join us for a weekend of hacking, workshops, and fun. Whether you're a seasoned hacker or just starting out, we have something for everyone."}),Et("div",{className:"inner-box",children:[ie(Nj,{targetDate:t}),ie("h1",{children:"Event starts 2nd March | Registrations Closed"}),Et("div",{className:"links",children:[ie("a",{className:"not-active",href:"https://register.2024.hacktheburgh.com/",target:"_blank",children:"Register"}),ie("a",{className:"not-active",target:"_blank",href:"https://docs.google.com/forms/d/e/1FAIpQLSdWyk7F_E9m90cxkAr1AhJ9-xx_D5_u86ioZg8q3mawX3ydRw/viewform",children:"Volunteer"})]})]}),Et("div",{className:"socialIcons",children:[ie("a",{href:"https://www.instagram.com/hacktheburgh/",target:"_blank",children:ie("img",{src:Pj,alt:"Instagram"})}),ie("a",{href:"https://www.facebook.com/hacktheburgh/",target:"_blank",children:ie("img",{src:Ij,alt:"Facebook"})}),ie("a",{href:"https://www.youtube.com/channel/UCQKvr90vGzbgteMeM1A9nxQ",target:"_blank",children:ie("img",{src:Lj,alt:"YouTube"})}),ie("a",{href:"https://www.linkedin.com/company/hack-the-burgh/",target:"_blank",children:ie("img",{src:Dj,alt:"LinkedIn"})})]})]}),a>1e3&&ie("div",{className:"game",children:!n&&ie(wj,{restartGame:()=>e(!0)})}),ie(kE,{})]})})},Fj="/past-project-imgs/vibe-check.png",Oj="/past-project-imgs/pengu.png",kj="/past-project-imgs/pixeleconomy.png",Bj="/past-project-imgs/bread.png",zj=()=>Et("div",{className:"page",children:[ie("h1",{className:"title",children:"Previous Projects"}),Et("ul",{className:"past-projects",children:[ie("li",{children:Et("div",{className:"project",children:[ie("div",{className:"project-img",children:ie("img",{src:Fj,alt:"Vibe Check",className:"project-img"})}),ie("a",{target:"_blank",href:"https://devpost.com/software/vibe-check-tox0wn",children:"Vibe Check"}),ie("div",{className:"project-text",children:Et("p",{children:["Vibe Check is a web app to help students give real-time feedback to professors during lectures.",ie("br",{}),"Winner in 2022."]})})]})}),ie("li",{children:Et("div",{className:"project",children:[ie("div",{className:"project-img",children:ie("img",{src:Oj,alt:"Penguu",className:"project-img"})}),ie("a",{target:"_blank",href:"https://devpost.com/software/penguu",children:"Penguu"}),ie("div",{className:"project-text",children:Et("p",{children:["Penguu helps people with chronic illnesses to be able to live independently and safely at home, while maintaining a high level of privacy.",ie("br",{}),"Winner in 2022."]})})]})}),ie("li",{children:Et("div",{className:"project",children:[ie("div",{className:"project-img",children:ie("img",{src:kj,alt:"Pixel Economy",className:"project-img"})}),ie("a",{target:"_blank",href:"https://devpost.com/software/pixeleconomy",children:"Pixel Economy"}),ie("div",{className:"project-text",children:Et("p",{children:["PixelEconomy is an online, virtual marketplace for creating, selling and buying pixel art that makes learning the fundamentals of trading fun and accessible.",ie("br",{}),"Best of Show in 2020."]})})]})}),ie("li",{children:Et("div",{className:"project",children:[ie("div",{className:"project-img",children:ie("img",{src:Bj,alt:"Is it bread?",className:"project-img"})}),ie("a",{target:"_blank",href:"https://devpost.com/software/is-it-bread",children:"Is it bread?"}),ie("div",{className:"project-text",children:ie("p",{children:'Have you ever looked at an item and thought, "Is that bread?". Can you really trust yourself to make that judgement? Fear not, we have an intelligent app to decide that for you.'})})]})})]}),ie(kE,{})]}),Gj=()=>{const n=[{question:"How much does it cost?",answer:"If accepted to the event, tickets are free! We also offer travel reimbursements."},{question:"Who may attend?",answer:"Any student currently enrolled in full-time further education may join. If you graduated less than a year ago, you are also eligible."},{question:"I can't code, can I join?",answer:"Yes! If you're new to programming, a hackathon is the best place for you to go to. There'll be plenty of mentors ready to assist you with whatever problem you face. Don't hestitate to ask for help, we don't bite!"},{question:"What about teams?",answer:"You can team up with up to four other people! Don't worry if you haven't got a team  you're not alone. We'll help you form a team at the event."},{question:"What do I bring?",answer:"Yourself, and something to hack on. We'll be providing snacks and drinks throughout the weekend, but you need to bring your own device (and charger)."},{question:"Do I need a hotel?",answer:"You can sleep over if you'd like. You'll probably want to bring a sleeping bag and some spare clothes. Unfortunately, we don't have showers."}],e=[{day:"Saturday, 2nd March",events:["09:30 - Registration","11:00 - Opening Ceremony","12:00 - Hackathon Official Start","12:30 - Optiver Workshop","14:00 - Lunch","15:30 - Marshall Wace Workshop","16:30 - MLH GitHub Workshop","17:30 - Quiz by Marshall Wace","18:00 - AWS Cloud Club Workshop","18:00 - Tardis Workshop","19:00 - Dinner"],venues:["Ground Floor Reception","Oak Lecture Theatre","All Venues","Hawthorn","Ground Floor Reception / Cafe Area","Hawthorn","Hawthorn","Hawthorn","Hawthorn","Rowan","Ground Floor Reception / Cafe Area"]},{day:"Sunday, 3rd March",events:["00:00 - Midnight Pizza","01:00 - Minigame (organised by HTB)","08:00 - Breakfast","12:00 - Submission Deadline","12:00 - Lunch","13:00 - Project Demonstrations","14:30 - Judges' Deliberation","15:30 - Awards Ceremony","17:00 - Event Close"],venues:["Ground Floor Reception/ Cafe Area","Rowan","Ground Floor Reception/ Cafe Area","All Venues","Ground Floor Reception/ Cafe Area","Larch, Hawthorn","Hawthorn","Oak Lecture Theatre","All Venues"]}];return Et("div",{className:"page",children:[ie("div",{className:"title",children:"Information"}),ie("div",{className:"questions",children:n.map((t,i)=>Et("div",{className:"question",children:[ie("div",{className:"q",children:t.question}),ie("div",{className:"a",children:t.answer})]},i))}),ie("div",{className:"title",children:"Schedule"}),ie("div",{className:"schedule",children:e.map((t,i)=>Et(dc,{children:[ie("div",{className:"day",children:t.day},i),ie("div",{className:"events",children:t.events.map((r,s)=>Et("div",{className:"event",children:[Et("div",{className:"left",children:[ie("div",{className:"time",children:r.split(" - ")[0]}),ie("div",{className:"venue",children:t.venues[s]})]}),ie("div",{className:"seperator"}),ie("div",{className:"name",children:r.split(" - ")[1]})]},s))})]}))}),ie(kE,{})]})};function Hj(){const[n,e]=me.useState(!0),[t,i]=me.useState("Home");return me.useEffect(()=>{const r=window.innerHeight*.01,s=window.innerWidth*.01;document.documentElement.style.setProperty("--vh",`${r}px`),document.documentElement.style.setProperty("--vw",`${s}px`)},[]),ie("div",{className:"App",children:n?ie(E6,{setInScene:e}):ie(dc,{children:Et(w6,{children:[ie(b6,{page:t,setPage:i,setInScene:e}),t==="Home"?ie(dc,{children:ie(Uj,{})}):t==="Past Projects"?ie(zj,{}):t==="Information"?ie(Gj,{}):ie(dc,{children:" Error Page Not Found"})]})})})}Qy.createRoot(document.getElementById("root")).render(ie(ks.StrictMode,{children:ie(Hj,{})}))});export default Vj();
